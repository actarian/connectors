var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("easing.Back",["easing.Ease"],function(g){var n,i,t,e,r=_gsScope.GreenSockGlobals||_gsScope,o=r.com.greensock,a=2*Math.PI,s=Math.PI/2,l=o._class,u=function(e,t){var n=l("easing."+e,function(){},!0),i=n.prototype=new g;return i.constructor=n,i.getRatio=t,n},c=g.register||function(){},h=function(e,t,n,i,r){var o=l("easing."+e,{easeOut:new t,easeIn:new n,easeInOut:new i},!0);return c(o,e),o},v=function(e,t,n){this.t=e,this.v=t,n&&(((this.next=n).prev=this).c=n.v-t,this.gap=n.t-e)},d=function(e,t){var n=l("easing."+e,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),i=n.prototype=new g;return i.constructor=n,i.getRatio=t,i.config=function(e){return new n(e)},n},p=h("Back",d("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),d("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),d("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),f=l("easing.SlowMo",function(e,t,n){t=t||0===t?t:.7,null==e?e=.7:1<e&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=!0===n},!0),m=f.prototype=new g;return m.constructor=f,m.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1===e?0:1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},f.ease=new f(.7,.7),m.config=f.config=function(e,t,n){return new f(e,t,n)},(m=(n=l("easing.SteppedEase",function(e,t){e=e||1,this._p1=1/e,this._p2=e+(t?0:1),this._p3=t?1:0},!0)).prototype=new g).constructor=n,m.getRatio=function(e){return e<0?e=0:1<=e&&(e=.999999999),((this._p2*e|0)+this._p3)*this._p1},m.config=n.config=function(e,t){return new n(e,t)},(m=(i=l("easing.ExpoScaleEase",function(e,t,n){this._p1=Math.log(t/e),this._p2=t-e,this._p3=e,this._ease=n},!0)).prototype=new g).constructor=i,m.getRatio=function(e){return this._ease&&(e=this._ease.getRatio(e)),(this._p3*Math.exp(this._p1*e)-this._p3)/this._p2},m.config=i.config=function(e,t,n){return new i(e,t,n)},(m=(t=l("easing.RoughEase",function(e){for(var t,n,i,r,o,a,s=(e=e||{}).taper||"none",l=[],u=0,c=0|(e.points||20),h=c,d=!1!==e.randomize,p=!0===e.clamp,f=e.template instanceof g?e.template:null,m="number"==typeof e.strength?.4*e.strength:.4;-1<--h;)t=d?Math.random():1/c*h,n=f?f.getRatio(t):t,i="none"===s?m:"out"===s?(r=1-t)*r*m:"in"===s?t*t*m:t<.5?(r=2*t)*r*.5*m:(r=2*(1-t))*r*.5*m,d?n+=Math.random()*i-.5*i:h%2?n+=.5*i:n-=.5*i,p&&(1<n?n=1:n<0&&(n=0)),l[u++]={x:t,y:n};for(l.sort(function(e,t){return e.x-t.x}),a=new v(1,1,null),h=c;-1<--h;)o=l[h],a=new v(o.x,o.y,a);this._prev=new v(0,0,0!==a.t?a:a.next)},!0)).prototype=new g).constructor=t,m.getRatio=function(e){var t=this._prev;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return(this._prev=t).v+(e-t.t)/t.gap*t.c},m.config=function(e){return new t(e)},t.ease=new t,h("Bounce",u("BounceOut",function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),u("BounceIn",function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),u("BounceInOut",function(e){var t=e<.5;return(e=t?1-2*e:2*e-1)<1/2.75?e*=7.5625*e:e=e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),h("Circ",u("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),u("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),u("CircInOut",function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),h("Elastic",(e=function(e,t,n){var i=l("easing."+e,function(e,t){this._p1=1<=e?e:1,this._p2=(t||n)/(e<1?e:1),this._p3=this._p2/a*(Math.asin(1/this._p1)||0),this._p2=a/this._p2},!0),r=i.prototype=new g;return r.constructor=i,r.getRatio=t,r.config=function(e,t){return new i(e,t)},i})("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*this._p2)+1},.3),e("ElasticIn",function(e){return-this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)},.3),e("ElasticInOut",function(e){return(e*=2)<1?this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*this._p2)*.5+1},.45)),h("Expo",u("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),u("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),u("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),h("Sine",u("SineOut",function(e){return Math.sin(e*s)}),u("SineIn",function(e){return 1-Math.cos(e*s)}),u("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),l("easing.EaseLookup",{find:function(e){return g.map[e]}},!0),c(r.SlowMo,"SlowMo","ease,"),c(t,"RoughEase","ease,"),c(n,"SteppedEase","ease,"),p},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(){"use strict";var e=function(){return _gsScope.GreenSockGlobals||_gsScope};"undefined"!=typeof module&&module.exports?(require("../TweenLite.js"),module.exports=e()):"function"==typeof define&&define.amd&&define(["TweenLite"],e)}(),function(d,p){"use strict";var f={},i=d.document,m=d.GreenSockGlobals=d.GreenSockGlobals||d;if(!m.TweenLite){var e,t,n,g,v,r,o,y=function(e){var t,n=e.split("."),i=m;for(t=0;t<n.length;t++)i[n[t]]=i=i[n[t]]||{};return i},h=y("com.greensock"),x=1e-10,l=function(e){var t,n=[],i=e.length;for(t=0;t!==i;n.push(e[t++]));return n},E=function(){},T=(r=Object.prototype.toString,o=r.call([]),function(e){return null!=e&&(e instanceof Array||"object"==typeof e&&!!e.push&&r.call(e)===o)}),b={},_=function(s,l,u,c){this.sc=b[s]?b[s].sc:[],(b[s]=this).gsClass=null,this.func=u;var h=[];this.check=function(e){for(var t,n,i,r,o=l.length,a=o;-1<--o;)(t=b[l[o]]||new _(l[o],[])).gsClass?(h[o]=t.gsClass,a--):e&&t.sc.push(this);if(0===a&&u){if(i=(n=("com.greensock."+s).split(".")).pop(),r=y(n.join("."))[i]=this.gsClass=u.apply(u,h),c)if(m[i]=f[i]=r,"undefined"!=typeof module&&module.exports)if(s===p)for(o in module.exports=f[p]=r,f)r[o]=f[o];else f[p]&&(f[p][i]=r);else"function"==typeof define&&define.amd&&define((d.GreenSockAMDPath?d.GreenSockAMDPath+"/":"")+s.split(".").pop(),[],function(){return r});for(o=0;o<this.sc.length;o++)this.sc[o].check()}},this.check(!0)},a=d._gsDefine=function(e,t,n,i){return new _(e,t,n,i)},w=h._class=function(e,t,n){return t=t||function(){},a(e,[],function(){return t},n),t};a.globals=m;var s=[0,0,1,1],S=w("easing.Ease",function(e,t,n,i){this._func=e,this._type=n||0,this._power=i||0,this._params=t?s.concat(t):s},!0),M=S.map={},u=S.register=function(e,t,n,i){for(var r,o,a,s,l=t.split(","),u=l.length,c=(n||"easeIn,easeOut,easeInOut").split(",");-1<--u;)for(o=l[u],r=i?w("easing."+o,null,!0):h.easing[o]||{},a=c.length;-1<--a;)s=c[a],M[o+"."+s]=M[s+o]=r[s]=e.getRatio?e:e[s]||new e};for((n=S.prototype)._calcEnd=!1,n.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,n=this._power,i=1===t?1-e:2===t?e:e<.5?2*e:2*(1-e);return 1===n?i*=i:2===n?i*=i*i:3===n?i*=i*i*i:4===n&&(i*=i*i*i*i),1===t?1-i:2===t?i:e<.5?i/2:1-i/2},t=(e=["Linear","Quad","Cubic","Quart","Quint,Strong"]).length;-1<--t;)n=e[t]+",Power"+t,u(new S(null,null,1,t),n,"easeOut",!0),u(new S(null,null,2,t),n,"easeIn"+(0===t?",easeNone":"")),u(new S(null,null,3,t),n,"easeInOut");M.linear=h.easing.Linear.easeIn,M.swing=h.easing.Quad.easeInOut;var A=w("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});(n=A.prototype).addEventListener=function(e,t,n,i,r){r=r||0;var o,a,s=this._listeners[e],l=0;for(this!==g||v||g.wake(),null==s&&(this._listeners[e]=s=[]),a=s.length;-1<--a;)(o=s[a]).c===t&&o.s===n?s.splice(a,1):0===l&&o.pr<r&&(l=a+1);s.splice(l,0,{c:t,s:n,up:i,pr:r})},n.removeEventListener=function(e,t){var n,i=this._listeners[e];if(i)for(n=i.length;-1<--n;)if(i[n].c===t)return void i.splice(n,1)},n.dispatchEvent=function(e){var t,n,i,r=this._listeners[e];if(r)for(1<(t=r.length)&&(r=r.slice(0)),n=this._eventTarget;-1<--t;)(i=r[t])&&(i.up?i.c.call(i.s||n,{type:e,target:n}):i.c.call(i.s||n))};var R=d.requestAnimationFrame,N=d.cancelAnimationFrame,P=Date.now||function(){return(new Date).getTime()},L=P();for(t=(e=["ms","moz","webkit","o"]).length;-1<--t&&!R;)R=d[e[t]+"RequestAnimationFrame"],N=d[e[t]+"CancelAnimationFrame"]||d[e[t]+"CancelRequestAnimationFrame"];w("Ticker",function(e,t){var r,o,a,s,l,u=this,c=P(),n=!(!1===t||!R)&&"auto",h=500,d=33,p=function(e){var t,n,i=P()-L;h<i&&(c+=i-d),L+=i,u.time=(L-c)/1e3,t=u.time-l,(!r||0<t||!0===e)&&(u.frame++,l+=t+(s<=t?.004:s-t),n=!0),!0!==e&&(a=o(p)),n&&u.dispatchEvent("tick")};A.call(u),u.time=u.frame=0,u.tick=function(){p(!0)},u.lagSmoothing=function(e,t){if(!arguments.length)return h<1e10;h=e||1e10,d=Math.min(t,h,0)},u.sleep=function(){null!=a&&(n&&N?N(a):clearTimeout(a),o=E,a=null,u===g&&(v=!1))},u.wake=function(e){null!==a?u.sleep():e?c+=-L+(L=P()):10<u.frame&&(L=P()-h+5),o=0===r?E:n&&R?R:function(e){return setTimeout(e,1e3*(l-u.time)+1|0)},u===g&&(v=!0),p(2)},u.fps=function(e){if(!arguments.length)return r;s=1/((r=e)||60),l=this.time+s,u.wake()},u.useRAF=function(e){if(!arguments.length)return n;u.sleep(),n=e,u.fps(r)},u.fps(e),setTimeout(function(){"auto"===n&&u.frame<5&&"hidden"!==(i||{}).visibilityState&&u.useRAF(!1)},1500)}),(n=h.Ticker.prototype=new h.events.EventDispatcher).constructor=h.Ticker;var c=w("core.Animation",function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=!0===t.immediateRender,this.data=t.data,this._reversed=!0===t.reversed,J){v||g.wake();var n=this.vars.useFrames?Y:J;n.add(this,n._time),this.vars.paused&&this.paused(!0)}});g=c.ticker=new h.Ticker,(n=c.prototype)._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1;var C=function(){v&&2e3<P()-L&&("hidden"!==(i||{}).visibilityState||!g.lagSmoothing())&&g.wake();var e=setTimeout(C,2e3);e.unref&&e.unref()};C(),n.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},n.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},n.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},n.seek=function(e,t){return this.totalTime(Number(e),!1!==t)},n.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,!1!==t,!0)},n.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},n.render=function(e,t,n){},n.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},n.isActive=function(){var e,t=this._timeline,n=this._startTime;return!t||!this._gc&&!this._paused&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<n+this.totalDuration()/this._timeScale-1e-7},n._enabled=function(e,t){return v||g.wake(),this._gc=!e,this._active=this.isActive(),!0!==t&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(e,t){return this._enabled(!1,!1)},n.kill=function(e,t){return this._kill(e,t),this},n._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;return this},n._swapSelfInParams=function(e){for(var t=e.length,n=e.concat();-1<--t;)"{self}"===e[t]&&(n[t]=this);return n},n._callback=function(e){var t=this.vars,n=t[e],i=t[e+"Params"],r=t[e+"Scope"]||t.callbackScope||this;switch(i?i.length:0){case 0:n.call(r);break;case 1:n.call(r,i[0]);break;case 2:n.call(r,i[0],i[1]);break;default:n.apply(r,i)}},n.eventCallback=function(e,t,n,i){if("on"===(e||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[e];null==t?delete r[e]:(r[e]=t,r[e+"Params"]=T(n)&&-1!==n.join("").indexOf("{self}")?this._swapSelfInParams(n):n,r[e+"Scope"]=i),"onUpdate"===e&&(this._onUpdate=t)}return this},n.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},n.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&0<this._time&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},n.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},n.totalTime=function(e,t,n){if(v||g.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(e<0&&!n&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,r=this._timeline;if(i<e&&!n&&(e=i),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?i-e:e)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===e&&0!==this._duration||(H.length&&Z(),this.render(e,t,!1),H.length&&Z())}return this},n.progress=n.totalProgress=function(e,t){var n=this.duration();return arguments.length?this.totalTime(n*e,t):n?this._time/n:this.ratio},n.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},n.endTime=function(e){return this._startTime+(0!=e?this.totalDuration():this.duration())/this._timeScale},n.timeScale=function(e){if(!arguments.length)return this._timeScale;var t,n;for(e=e||x,this._timeline&&this._timeline.smoothChildTiming&&(n=(t=this._pauseTime)||0===t?t:this._timeline.totalTime(),this._startTime=n-(n-this._startTime)*this._timeScale/e),this._timeScale=e,n=this.timeline;n&&n.timeline;)n._dirty=!0,n.totalDuration(),n=n.timeline;return this},n.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(e){if(!arguments.length)return this._paused;var t,n,i=this._timeline;return e!=this._paused&&i&&(v||e||g.wake(),n=(t=i.rawTime())-this._pauseTime,!e&&i.smoothChildTiming&&(this._startTime+=n,this._uncache(!1)),this._pauseTime=e?t:null,this._paused=e,this._active=this.isActive(),!e&&0!==n&&this._initted&&this.duration()&&(t=i.smoothChildTiming?this._totalTime:(t-this._startTime)/this._timeScale,this.render(t,t===this._totalTime,!0))),this._gc&&!e&&this._enabled(!0,!1),this};var F=w("core.SimpleTimeline",function(e){c.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});(n=F.prototype=new c).constructor=F,n.kill()._gc=!1,n._first=n._last=n._recent=null,n._sortChildren=!1,n.add=n.insert=function(e,t,n,i){var r,o;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),r=this._last,this._sortChildren)for(o=e._startTime;r&&r._startTime>o;)r=r._prev;return r?(e._next=r._next,r._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=r,this._recent=e,this._timeline&&this._uncache(!0),this},n._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,e===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},n.render=function(e,t,n){var i,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;r;)i=r._next,(r._active||e>=r._startTime&&!r._paused&&!r._gc)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(e-r._startTime)*r._timeScale,t,n):r.render((e-r._startTime)*r._timeScale,t,n)),r=i},n.rawTime=function(){return v||g.wake(),this._totalTime};var O=w("TweenLite",function(e,t,n){if(c.call(this,t,n),this.render=O.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:O.selector(e)||e;var i,r,o,a=e.jquery||e.length&&e!==d&&e[0]&&(e[0]===d||e[0].nodeType&&e[0].style&&!e.nodeType),s=this.vars.overwrite;if(this._overwrite=s=null==s?q[O.defaultOverwrite]:"number"==typeof s?s>>0:q[s],(a||e instanceof Array||e.push&&T(e))&&"number"!=typeof e[0])for(this._targets=o=l(e),this._propLookup=[],this._siblings=[],i=0;i<o.length;i++)(r=o[i])?"string"!=typeof r?r.length&&r!==d&&r[0]&&(r[0]===d||r[0].nodeType&&r[0].style&&!r.nodeType)?(o.splice(i--,1),this._targets=o=o.concat(l(r))):(this._siblings[i]=K(r,this,!1),1===s&&1<this._siblings[i].length&&te(r,this,null,1,this._siblings[i])):"string"==typeof(r=o[i--]=O.selector(r))&&o.splice(i+1,1):o.splice(i--,1);else this._propLookup={},this._siblings=K(e,this,!1),1===s&&1<this._siblings.length&&te(e,this,null,1,this._siblings);(this.vars.immediateRender||0===t&&0===this._delay&&!1!==this.vars.immediateRender)&&(this._time=-x,this.render(Math.min(0,-this._delay)))},!0),$=function(e){return e&&e.length&&e!==d&&e[0]&&(e[0]===d||e[0].nodeType&&e[0].style&&!e.nodeType)};(n=O.prototype=new c).constructor=O,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,O.version="1.20.4",O.defaultEase=n._ease=new S(null,null,1,1),O.defaultOverwrite="auto",O.ticker=g,O.autoSleep=120,O.lagSmoothing=function(e,t){g.lagSmoothing(e,t)},O.selector=d.$||d.jQuery||function(e){var t=d.$||d.jQuery;return t?(O.selector=t)(e):void 0===i?e:i.querySelectorAll?i.querySelectorAll(e):i.getElementById("#"===e.charAt(0)?e.substr(1):e)};var H=[],I={},U=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,D=/[\+-]=-?[\.\d]/,B=function(e){for(var t,n=this._firstPT;n;)t=n.blob?1===e&&null!=this.end?this.end:e?this.join(""):this.start:n.c*e+n.s,n.m?t=n.m(t,this._target||n.t):t<1e-6&&-1e-6<t&&!n.blob&&(t=0),n.f?n.fp?n.t[n.p](n.fp,t):n.t[n.p](t):n.t[n.p]=t,n=n._next},k=function(e,t,n,i){var r,o,a,s,l,u,c,h=[],d=0,p="",f=0;for(h.start=e,h.end=t,e=h[0]=e+"",t=h[1]=t+"",n&&(n(h),e=h[0],t=h[1]),h.length=0,r=e.match(U)||[],o=t.match(U)||[],i&&(i._next=null,i.blob=1,h._firstPT=h._applyPT=i),l=o.length,s=0;s<l;s++)c=o[s],p+=(u=t.substr(d,t.indexOf(c,d)-d))||!s?u:",",d+=u.length,f?f=(f+1)%5:"rgba("===u.substr(-5)&&(f=1),c===r[s]||r.length<=s?p+=c:(p&&(h.push(p),p=""),a=parseFloat(r[s]),h.push(a),h._firstPT={_next:h._firstPT,t:h,p:h.length-1,s:a,c:("="===c.charAt(1)?parseInt(c.charAt(0)+"1",10)*parseFloat(c.substr(2)):parseFloat(c)-a)||0,f:0,m:f&&f<4?Math.round:0}),d+=c.length;return(p+=t.substr(d))&&h.push(p),h.setRatio=B,D.test(t)&&(h.end=null),h},V=function(e,t,n,i,r,o,a,s,l){"function"==typeof i&&(i=i(l||0,e));var u=typeof e[t],c="function"!==u?"":t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3),h="get"!==n?n:c?a?e[c](a):e[c]():e[t],d="string"==typeof i&&"="===i.charAt(1),p={t:e,p:t,s:h,f:"function"===u,pg:0,n:r||t,m:o?"function"==typeof o?o:Math.round:0,pr:0,c:d?parseInt(i.charAt(0)+"1",10)*parseFloat(i.substr(2)):parseFloat(i)-h||0};if(("number"!=typeof h||"number"!=typeof i&&!d)&&(a||isNaN(h)||!d&&isNaN(i)||"boolean"==typeof h||"boolean"==typeof i?(p.fp=a,p={t:k(h,d?parseFloat(p.s)+p.c+(p.s+"").replace(/[0-9\-\.]/g,""):i,s||O.defaultStringFilter,p),p:"setRatio",s:0,c:1,f:2,pg:0,n:r||t,pr:0,m:0}):(p.s=parseFloat(h),d||(p.c=parseFloat(i)-p.s||0))),p.c)return(p._next=this._firstPT)&&(p._next._prev=p),this._firstPT=p},z=O._internals={isArray:T,isSelector:$,lazyTweens:H,blobDif:k},G=O._plugins={},j=z.tweenLookup={},W=0,X=z.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},q={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},Y=c._rootFramesTimeline=new F,J=c._rootTimeline=new F,Q=30,Z=z.lazyRender=function(){var e,t=H.length;for(I={};-1<--t;)(e=H[t])&&!1!==e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0),e._lazy=!1);H.length=0};J._startTime=g.time,Y._startTime=g.frame,J._active=Y._active=!0,setTimeout(Z,1),c._updateRoot=O.render=function(){var e,t,n;if(H.length&&Z(),J.render((g.time-J._startTime)*J._timeScale,!1,!1),Y.render((g.frame-Y._startTime)*Y._timeScale,!1,!1),H.length&&Z(),g.frame>=Q){for(n in Q=g.frame+(parseInt(O.autoSleep,10)||120),j){for(e=(t=j[n].tweens).length;-1<--e;)t[e]._gc&&t.splice(e,1);0===t.length&&delete j[n]}if((!(n=J._first)||n._paused)&&O.autoSleep&&!Y._first&&1===g._listeners.tick.length){for(;n&&n._paused;)n=n._next;n||g.sleep()}}},g.addEventListener("tick",c._updateRoot);var K=function(e,t,n){var i,r,o=e._gsTweenID;if(j[o||(e._gsTweenID=o="t"+W++)]||(j[o]={target:e,tweens:[]}),t&&((i=j[o].tweens)[r=i.length]=t,n))for(;-1<--r;)i[r]===t&&i.splice(r,1);return j[o].tweens},ee=function(e,t,n,i){var r,o,a=e.vars.onOverwrite;return a&&(r=a(e,t,n,i)),(a=O.onOverwrite)&&(o=a(e,t,n,i)),!1!==r&&!1!==o},te=function(e,t,n,i,r){var o,a,s,l;if(1===i||4<=i){for(l=r.length,o=0;o<l;o++)if((s=r[o])!==t)s._gc||s._kill(null,e,t)&&(a=!0);else if(5===i)break;return a}var u,c=t._startTime+x,h=[],d=0,p=0===t._duration;for(o=r.length;-1<--o;)(s=r[o])===t||s._gc||s._paused||(s._timeline!==t._timeline?(u=u||ne(t,0,p),0===ne(s,u,p)&&(h[d++]=s)):s._startTime<=c&&s._startTime+s.totalDuration()/s._timeScale>c&&((p||!s._initted)&&c-s._startTime<=2e-10||(h[d++]=s)));for(o=d;-1<--o;)if(s=h[o],2===i&&s._kill(n,e,t)&&(a=!0),2!==i||!s._firstPT&&s._initted){if(2!==i&&!ee(s,t))continue;s._enabled(!1,!1)&&(a=!0)}return a},ne=function(e,t,n){for(var i=e._timeline,r=i._timeScale,o=e._startTime;i._timeline;){if(o+=i._startTime,r*=i._timeScale,i._paused)return-100;i=i._timeline}return t<(o/=r)?o-t:n&&o===t||!e._initted&&o-t<2*x?x:(o+=e.totalDuration()/e._timeScale/r)>t+x?0:o-t-x};n._init=function(){var e,t,n,i,r,o,a=this.vars,s=this._overwrittenProps,l=this._duration,u=!!a.immediateRender,c=a.ease;if(a.startAt){for(i in this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),r={},a.startAt)r[i]=a.startAt[i];if(r.data="isStart",r.overwrite=!1,r.immediateRender=!0,r.lazy=u&&!1!==a.lazy,r.startAt=r.delay=null,r.onUpdate=a.onUpdate,r.onUpdateParams=a.onUpdateParams,r.onUpdateScope=a.onUpdateScope||a.callbackScope||this,this._startAt=O.to(this.target,0,r),u)if(0<this._time)this._startAt=null;else if(0!==l)return}else if(a.runBackwards&&0!==l)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{for(i in 0!==this._time&&(u=!1),n={},a)X[i]&&"autoCSS"!==i||(n[i]=a[i]);if(n.overwrite=0,n.data="isFromStart",n.lazy=u&&!1!==a.lazy,n.immediateRender=u,this._startAt=O.to(this.target,0,n),u){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=c=c?c instanceof S?c:"function"==typeof c?new S(c,a.easeParams):M[c]||O.defaultEase:O.defaultEase,a.easeParams instanceof Array&&c.config&&(this._ease=c.config.apply(c,a.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(o=this._targets.length,e=0;e<o;e++)this._initProps(this._targets[e],this._propLookup[e]={},this._siblings[e],s?s[e]:null,e)&&(t=!0);else t=this._initProps(this.target,this._propLookup,this._siblings,s,0);if(t&&O._onPluginEvent("_onInitAllProps",this),s&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),a.runBackwards)for(n=this._firstPT;n;)n.s+=n.c,n.c=-n.c,n=n._next;this._onUpdate=a.onUpdate,this._initted=!0},n._initProps=function(e,t,n,i,r){var o,a,s,l,u,c;if(null==e)return!1;for(o in I[e._gsTweenID]&&Z(),this.vars.css||e.style&&e!==d&&e.nodeType&&G.css&&!1!==this.vars.autoCSS&&function(e,t){var n,i={};for(n in e)X[n]||n in t&&"transform"!==n&&"x"!==n&&"y"!==n&&"width"!==n&&"height"!==n&&"className"!==n&&"border"!==n||!(!G[n]||G[n]&&G[n]._autoCSS)||(i[n]=e[n],delete e[n]);e.css=i}(this.vars,e),this.vars)if(c=this.vars[o],X[o])c&&(c instanceof Array||c.push&&T(c))&&-1!==c.join("").indexOf("{self}")&&(this.vars[o]=c=this._swapSelfInParams(c,this));else if(G[o]&&(l=new G[o])._onInitTween(e,this.vars[o],this,r)){for(this._firstPT=u={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:1,n:o,pg:1,pr:l._priority,m:0},a=l._overwriteProps.length;-1<--a;)t[l._overwriteProps[a]]=this._firstPT;(l._priority||l._onInitAllProps)&&(s=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0),u._next&&(u._next._prev=u)}else t[o]=V.call(this,e,o,"get",c,o,0,null,this.vars.stringFilter,r);return i&&this._kill(i,e)?this._initProps(e,t,n,i,r):1<this._overwrite&&this._firstPT&&1<n.length&&te(e,this,t,this._overwrite,n)?(this._kill(t,e),this._initProps(e,t,n,i,r)):(this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration)&&(I[e._gsTweenID]=!0),s)},n.render=function(e,t,n){var i,r,o,a,s=this._time,l=this._duration,u=this._rawPrevTime;if(l-1e-7<=e&&0<=e)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(i=!0,r="onComplete",n=n||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||n)&&(this._startTime===this._timeline._duration&&(e=0),(u<0||e<=0&&-1e-7<=e||u===x&&"isPause"!==this.data)&&u!==e&&(n=!0,x<u&&(r="onReverseComplete")),this._rawPrevTime=a=!t||e||u===e?e:x);else if(e<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===l&&0<u)&&(r="onReverseComplete",i=this._reversed),e<0&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||n)&&(0<=u&&(u!==x||"isPause"!==this.data)&&(n=!0),this._rawPrevTime=a=!t||e||u===e?e:x)),(!this._initted||this._startAt&&this._startAt.progress())&&(n=!0);else if(this._totalTime=this._time=e,this._easeType){var c=e/l,h=this._easeType,d=this._easePower;(1===h||3===h&&.5<=c)&&(c=1-c),3===h&&(c*=2),1===d?c*=c:2===d?c*=c*c:3===d?c*=c*c*c:4===d&&(c*=c*c*c*c),this.ratio=1===h?1-c:2===h?c:e/l<.5?c/2:1-c/2}else this.ratio=this._ease.getRatio(e/l);if(this._time!==s||n){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!n&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=u,H.push(this),void(this._lazy=[e,t]);this._time&&!i?this.ratio=this._ease.getRatio(this._time/l):i&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&0<=e&&(this._active=!0),0===s&&(this._startAt&&(0<=e?this._startAt.render(e,!0,n):r||(r="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==l||t||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(e<0&&this._startAt&&-1e-4!==e&&this._startAt.render(e,!0,n),t||(this._time!==s||i||n)&&this._callback("onUpdate")),r&&(this._gc&&!n||(e<0&&this._startAt&&!this._onUpdate&&-1e-4!==e&&this._startAt.render(e,!0,n),i&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[r]&&this._callback(r),0===l&&this._rawPrevTime===x&&a!==x&&(this._rawPrevTime=0)))}},n._kill=function(e,t,n){if("all"===e&&(e=null),null==e&&(null==t||t===this.target))return this._lazy=!1,this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:O.selector(t)||t;var i,r,o,a,s,l,u,c,h,d=n&&this._time&&n._startTime===this._startTime&&this._timeline===n._timeline;if((T(t)||$(t))&&"number"!=typeof t[0])for(i=t.length;-1<--i;)this._kill(e,t[i],n)&&(l=!0);else{if(this._targets){for(i=this._targets.length;-1<--i;)if(t===this._targets[i]){s=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[i]=e?this._overwrittenProps[i]||{}:"all";break}}else{if(t!==this.target)return!1;s=this._propLookup,r=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(s){if(u=e||s,c=e!==r&&"all"!==r&&e!==s&&("object"!=typeof e||!e._tempKill),n&&(O.onOverwrite||this.vars.onOverwrite)){for(o in u)s[o]&&(h||(h=[]),h.push(o));if((h||!e)&&!ee(this,n,t,h))return!1}for(o in u)(a=s[o])&&(d&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,l=!0),a.pg&&a.t._kill(u)&&(l=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete s[o]),c&&(r[o]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},n.invalidate=function(){return this._notifyPluginsOfEnabled&&O._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],c.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-x,this.render(Math.min(0,-this._delay))),this},n._enabled=function(e,t){if(v||g.wake(),e&&this._gc){var n,i=this._targets;if(i)for(n=i.length;-1<--n;)this._siblings[n]=K(i[n],this,!0);else this._siblings=K(this.target,this,!0)}return c.prototype._enabled.call(this,e,t),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&O._onPluginEvent(e?"_onEnable":"_onDisable",this)},O.to=function(e,t,n){return new O(e,t,n)},O.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=0!=n.immediateRender,new O(e,t,n)},O.fromTo=function(e,t,n,i){return i.startAt=n,i.immediateRender=0!=i.immediateRender&&0!=n.immediateRender,new O(e,t,i)},O.delayedCall=function(e,t,n,i,r){return new O(t,0,{delay:e,onComplete:t,onCompleteParams:n,callbackScope:i,onReverseComplete:t,onReverseCompleteParams:n,immediateRender:!1,lazy:!1,useFrames:r,overwrite:0})},O.set=function(e,t){return new O(e,0,t)},O.getTweensOf=function(e,t){if(null==e)return[];var n,i,r,o;if(e="string"!=typeof e?e:O.selector(e)||e,(T(e)||$(e))&&"number"!=typeof e[0]){for(n=e.length,i=[];-1<--n;)i=i.concat(O.getTweensOf(e[n],t));for(n=i.length;-1<--n;)for(o=i[n],r=n;-1<--r;)o===i[r]&&i.splice(n,1)}else if(e._gsTweenID)for(n=(i=K(e).concat()).length;-1<--n;)(i[n]._gc||t&&!i[n].isActive())&&i.splice(n,1);return i||[]},O.killTweensOf=O.killDelayedCallsTo=function(e,t,n){"object"==typeof t&&(n=t,t=!1);for(var i=O.getTweensOf(e,t),r=i.length;-1<--r;)i[r]._kill(n,e)};var ie=w("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=ie.prototype},!0);if(n=ie.prototype,ie.version="1.19.0",ie.API=2,n._firstPT=null,n._addTween=V,n.setRatio=B,n._kill=function(e){var t,n=this._overwriteProps,i=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(t=n.length;-1<--t;)null!=e[n[t]]&&n.splice(t,1);for(;i;)null!=e[i.n]&&(i._next&&(i._next._prev=i._prev),i._prev?(i._prev._next=i._next,i._prev=null):this._firstPT===i&&(this._firstPT=i._next)),i=i._next;return!1},n._mod=n._roundProps=function(e){for(var t,n=this._firstPT;n;)(t=e[this._propName]||null!=n.n&&e[n.n.split(this._propName+"_").join("")])&&"function"==typeof t&&(2===n.f?n.t._applyPT.m=t:n.m=t),n=n._next},O._onPluginEvent=function(e,t){var n,i,r,o,a,s=t._firstPT;if("_onInitAllProps"===e){for(;s;){for(a=s._next,i=r;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:o)?s._prev._next=s:r=s,(s._next=i)?i._prev=s:o=s,s=a}s=t._firstPT=r}for(;s;)s.pg&&"function"==typeof s.t[e]&&s.t[e]()&&(n=!0),s=s._next;return n},ie.activate=function(e){for(var t=e.length;-1<--t;)e[t].API===ie.API&&(G[(new e[t])._propName]=e[t]);return!0},a.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var t,n=e.propName,i=e.priority||0,r=e.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},a=w("plugins."+n.charAt(0).toUpperCase()+n.substr(1)+"Plugin",function(){ie.call(this,n,i),this._overwriteProps=r||[]},!0===e.global),s=a.prototype=new ie(n);for(t in(s.constructor=a).API=e.API,o)"function"==typeof e[t]&&(s[o[t]]=e[t]);return a.version=e.version,ie.activate([a]),a},e=d._gsQueue){for(t=0;t<e.length;t++)e[t]();for(n in b)b[n].func||d.console.log("GSAP encountered missing dependency: "+n)}v=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenLite"),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE={})}(this,function(e){"use strict";function t(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,e)}}}});var n,i,c,h,r,o,a,s,l,u,d,p,f,m,g,v,y,x,E,T,Se="91",z=0,G=1,j=2,I=1,U=2,$=0,Y=1,J=2,Me=0,b=1,_=2,W=0,X=1,q=2,Q=3,Z=4,K=5,w=100,S=101,M=102,A=103,R=104,N=200,P=201,L=202,C=203,F=204,O=205,H=206,D=207,B=208,k=209,V=210,ee=0,te=1,ne=2,ie=3,re=4,oe=5,ae=6,se=7,le=0,ue=1,ce=2,he=0,Ae=1,de=2,pe=3,fe=4,me=301,ge=302,ve=303,ye=304,xe=305,Ee=306,Te=307,be=1e3,_e=1001,we=1002,Re=1003,Ne=1004,Pe=1005,Le=1006,Ce=1007,Fe=1008,Oe=1009,$e=1010,He=1011,Ie=1012,Ue=1013,De=1014,Be=1015,ke=1016,Ve=1017,ze=1018,Ge=1019,je=1020,We=1021,Xe=1022,qe=1023,Ye=1024,Je=1025,Qe=qe,Ze=1026,Ke=1027,et=33776,tt=33777,nt=33778,it=33779,rt=35840,ot=35841,at=35842,st=35843,lt=36196,ut=37808,ct=37809,ht=37810,dt=37811,pt=37812,ft=37813,mt=37814,gt=37815,vt=37816,yt=37817,xt=37818,Et=37819,Tt=37820,bt=37821,_t=2201,wt=2300,St=2301,Mt=2400,At=2401,Rt=2402,Nt=0,Pt=1,Lt=2,Ct=3e3,Ft=3001,Ot=3007,$t=3002,Ht=3004,It=3005,Ut=3006,Dt=3200,Bt=3201,kt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var r=[],e=0;e<256;e++)r[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]+"-"+r[255&t]+r[t>>8&255]+"-"+r[t>>16&15|64]+r[t>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*kt.DEG2RAD},radToDeg:function(e){return e*kt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Vt(e,t){this.x=e||0,this.y=t||0}function zt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Gt(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==i?i:1}function jt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function Wt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Vt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Vt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(n=new Vt,i=new Vt,function(e,t){return n.set(e,e),i.set(t,t),this.clamp(n,i)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}}),Object.assign(zt.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new zt).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(l=new jt,function(e){var t=this.elements,n=e.elements,i=1/l.setFromMatrixColumn(e,0).length(),r=1/l.setFromMatrixColumn(e,1).length(),o=1/l.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===e.order){var h=o*u,d=o*c,p=a*u,f=a*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-a*s,t[2]=f-h*l,t[6]=p+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m+y*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=g*a-v,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m-y*a,t[4]=-o*c,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,d=o*c,p=a*u,f=a*c;t[0]=s*u,t[4]=p*l-d,t[8]=h*l+f,t[1]=s*c,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var x=o*s,E=o*l,T=a*s,b=a*l;t[0]=s*u,t[4]=b-x*c,t[8]=T*c+E,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=E*c+T,t[10]=x-b*c}else if("XZY"===e.order){x=o*s,E=o*l,T=a*s,b=a*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=x*c+b,t[5]=o*u,t[9]=E*c-T,t[2]=T*c-E,t[6]=a*u,t[10]=b*c+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e._x,i=e._y,r=e._z,o=e._w,a=n+n,s=i+i,l=r+r,u=n*a,c=n*s,h=n*l,d=i*s,p=i*l,f=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[4]=c-v,t[8]=h+g,t[1]=c+v,t[5]=1-(u+f),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(o=new jt,a=new jt,s=new jt,function(e,t,n){var i=this.elements;return s.subVectors(e,t),0===s.lengthSq()&&(s.z=1),s.normalize(),o.crossVectors(n,s),0===o.lengthSq()&&(1===Math.abs(n.z)?s.x+=1e-4:s.z+=1e-4,s.normalize(),o.crossVectors(n,s)),o.normalize(),a.crossVectors(s,o),i[0]=o.x,i[4]=a.x,i[8]=s.x,i[1]=o.y,i[5]=a.y,i[9]=s.y,i[2]=o.z,i[6]=a.z,i[10]=s.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],E=n[15],T=i[0],b=i[4],_=i[8],w=i[12],S=i[1],M=i[5],A=i[9],R=i[13],N=i[2],P=i[6],L=i[10],C=i[14],F=i[3],O=i[7],$=i[11],H=i[15];return r[0]=o*T+a*S+s*N+l*F,r[4]=o*b+a*M+s*P+l*O,r[8]=o*_+a*A+s*L+l*$,r[12]=o*w+a*R+s*C+l*H,r[1]=u*T+c*S+h*N+d*F,r[5]=u*b+c*M+h*P+d*O,r[9]=u*_+c*A+h*L+d*$,r[13]=u*w+c*R+h*C+d*H,r[2]=p*T+f*S+m*N+g*F,r[6]=p*b+f*M+m*P+g*O,r[10]=p*_+f*A+m*L+g*$,r[14]=p*w+f*R+m*C+g*H,r[3]=v*T+y*S+x*N+E*F,r[7]=v*b+y*M+x*P+E*O,r[11]=v*_+y*A+x*L+E*$,r[15]=v*w+y*R+x*C+E*H,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(r=new jt,function(e){for(var t=0,n=e.count;t<n;t++)r.x=e.getX(t),r.y=e.getY(t),r.z=e.getZ(t),r.applyMatrix4(this),e.setXYZ(t,r.x,r.y,r.z);return e}),determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+r*s*c-i*l*c-r*a*h+n*l*h+i*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-i*o*d+i*l*u-r*s*u)+e[11]*(+t*l*c-t*a*d-r*o*c+n*o*d+r*a*u-n*l*u)+e[15]*(-i*a*u-t*s*c+t*a*h+i*o*c-n*o*h+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=i[5],c=i[6],h=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],y=i[14],x=i[15],E=p*y*h-v*f*h+v*c*m-u*y*m-p*c*x+u*f*x,T=g*f*h-d*y*h-g*c*m+l*y*m+d*c*x-l*f*x,b=d*v*h-g*p*h+g*u*m-l*v*m-d*u*x+l*p*x,_=g*p*c-d*v*c-g*u*f+l*v*f+d*u*y-l*p*y,w=r*E+o*T+a*b+s*_;if(0===w){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var M=1/w;return n[0]=E*M,n[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*x-o*f*x)*M,n[2]=(u*y*s-v*c*s+v*a*h-o*y*h-u*a*x+o*c*x)*M,n[3]=(p*c*s-u*f*s-p*a*h+o*f*h+u*a*m-o*c*m)*M,n[4]=T*M,n[5]=(d*y*s-g*f*s+g*a*m-r*y*m-d*a*x+r*f*x)*M,n[6]=(g*c*s-l*y*s-g*a*h+r*y*h+l*a*x-r*c*x)*M,n[7]=(l*f*s-d*c*s+d*a*h-r*f*h-l*a*m+r*c*m)*M,n[8]=b*M,n[9]=(g*p*s-d*v*s-g*o*m+r*v*m+d*o*x-r*p*x)*M,n[10]=(l*v*s-g*u*s+g*o*h-r*v*h-l*o*x+r*u*x)*M,n[11]=(d*u*s-l*p*s-d*o*h+r*p*h+l*o*m-r*u*m)*M,n[12]=_*M,n[13]=(d*v*a-g*p*a+g*o*f-r*v*f-d*o*y+r*p*y)*M,n[14]=(g*u*a-l*v*a-g*o*c+r*v*c+l*o*y-r*u*y)*M,n[15]=(l*p*a-d*u*a+d*o*c-r*p*c-l*o*f+r*u*f)*M,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,u=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,u*a+n,u*s-i*o,0,l*s-i*a,u*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:(c=new jt,h=new zt,function(e,t,n){var i=this.elements,r=c.set(i[0],i[1],i[2]).length(),o=c.set(i[4],i[5],i[6]).length(),a=c.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],h.copy(this);var s=1/r,l=1/o,u=1/a;return h.elements[0]*=s,h.elements[1]*=s,h.elements[2]*=s,h.elements[4]*=l,h.elements[5]*=l,h.elements[6]*=l,h.elements[8]*=u,h.elements[9]*=u,h.elements[10]*=u,t.setFromRotationMatrix(h),n.x=r,n.y=o,n.z=a,this}),makePerspective:function(e,t,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,i,r,o){var a=this.elements,s=1/(t-e),l=1/(n-i),u=1/(o-r),c=(t+e)*s,h=(n+i)*l,d=(o+r)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(Gt,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,o,a){var s=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3],h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(c!==f||s!==h||l!==d||u!==p){var m=1-a,g=s*h+l*d+u*p+c*f,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),E=Math.atan2(x,g*v);m=Math.sin(m*E)/x,a=Math.sin(a*E)/x}var T=a*v;if(s=s*m+h*T,l=l*m+d*T,u=u*m+p*T,c=c*m+f*T,m===1-a){var b=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=b,l*=b,u*=b,c*=b}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(Gt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Gt.prototype,{set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(n/2),u=a(i/2),c=a(r/2),h=s(n/2),d=s(i/2),p=s(r/2);return"XYZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"YXZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"ZXY"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"ZYX"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"YZX"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p):"XZY"===o&&(this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=i+s+h;return 0<d?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(a-r)*t):s<i&&h<i?(t=2*Math.sqrt(1+i-s-h),this._w=(c-l)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+u)/t):h<s?(t=2*Math.sqrt(1+s-i-h),this._w=(o-u)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-i-s),this._w=(a-r)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:(d=new jt,function(e,t){return void 0===d&&(d=new jt),(u=e.dot(t)+1)<1e-6?(u=0,Math.abs(e.x)>Math.abs(e.z)?d.set(-e.y,e.x,0):d.set(0,-e.z,e.y)):d.crossVectors(e,t),this._x=d.x,this._y=d.y,this._z=d.z,this._w=u,this.normalize()}),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+o*a+i*l-r*s,this._y=i*u+o*s+r*a-n*l,this._z=r*u+o*l+n*s-i*a,this._w=o*u-n*a-i*s-r*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),1<=a)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,a),u=Math.sin((1-t)*l)/s,c=Math.sin(t*l)/s;return this._w=o*u+this._w*c,this._x=n*u+this._x*c,this._y=i*u+this._y*c,this._z=r*u+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(jt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(E=new Gt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(E.setFromEuler(e))}),applyAxisAngle:(x=new Gt,function(e,t){return this.applyQuaternion(x.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*i-a*n,u=s*n+a*t-r*i,c=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=l*s+h*-r+u*-a-c*-o,this.y=u*s+h*-o+c*-r-l*-a,this.z=c*s+h*-a+l*-o-u*-r,this},project:(y=new zt,function(e){return y.multiplyMatrices(e.projectionMatrix,y.getInverse(e.matrixWorld)),this.applyMatrix4(y)}),unproject:(v=new zt,function(e){return v.multiplyMatrices(e.matrixWorld,v.getInverse(e.projectionMatrix)),this.applyMatrix4(v)}),transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:(m=new jt,g=new jt,function(e,t){return m.set(e,e,e),g.set(t,t,t),this.clamp(m,g)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(f=new jt,function(e){return f.copy(this).projectOnVector(e),this.sub(f)}),reflect:(p=new jt,function(e){return this.sub(p.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(kt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Wt.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,o,a,s,l){var u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=r,u[5]=s,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(T=new jt,function(e){for(var t=0,n=e.count;t<n;t++)T.x=e.getX(t),T.y=e.getY(t),T.z=e.getZ(t),T.applyMatrix3(this),e.setXYZ(t,T.x,T.y,T.z);return e}),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],x=i[7],E=i[2],T=i[5],b=i[8];return r[0]=o*f+a*v+s*E,r[3]=o*m+a*y+s*T,r[6]=o*g+a*x+s*b,r[1]=l*f+u*v+c*E,r[4]=l*m+u*y+c*T,r[7]=l*g+u*x+c*b,r[2]=h*f+d*v+p*E,r[5]=h*m+d*y+p*T,r[8]=h*g+d*x+p*b,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-n*r*u+n*a*s+i*r*l-i*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],p=d*l-u*h,f=u*c-d*s,m=h*s-l*c,g=r*p+o*f+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return i[0]=p*y,i[1]=(a*h-d*o)*y,i[2]=(u*o-a*l)*y,i[3]=f*y,i[4]=(d*r-a*c)*y,i[5]=(a*s-u*r)*y,i[6]=m*y,i[7]=(o*c-h*r)*y,i[8]=(l*r-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,o,a){var s=Math.cos(r),l=Math.sin(r);this.set(n*s,n*l,-n*(s*o+l*a)+o+e,-i*l,i*s,-i*(-l*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],o=i[3],a=i[6],s=i[1],l=i[4],u=i[7];return i[0]=t*r+n*s,i[3]=t*o+n*l,i[6]=t*a+n*u,i[1]=-n*r+t*s,i[4]=-n*o+t*l,i[7]=-n*a+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Xt,qt,Yt,Jt,Qt,Zt,Kt,en,tn,nn,rn,on,an,sn,ln,un,cn,hn=0;function dn(e,t,n,i,r,o,a,s,l,u){Object.defineProperty(this,"id",{value:hn++}),this.uuid=kt.generateUUID(),this.name="",this.image=void 0!==e?e:dn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:dn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:_e,this.wrapT=void 0!==i?i:_e,this.magFilter=void 0!==r?r:Le,this.minFilter=void 0!==o?o:Fe,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:qe,this.type=void 0!==s?s:Oe,this.offset=new Vt(0,0),this.repeat=new Vt(1,1),this.center=new Vt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ct,this.version=0,this.onUpdate=null}function pn(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1}function fn(e,t,n){this.width=e,this.height=t,this.scissor=new pn(0,0,e,t),this.scissorTest=!1,this.viewport=new pn(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=Le),this.texture=new dn(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function mn(e,t,n){fn.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function gn(e,t,n,i,r,o,a,s,l,u,c,h){dn.call(this,null,o,a,s,l,u,i,r,c,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==l?l:Re,this.minFilter=void 0!==u?u:Re,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function vn(e,t){this.min=void 0!==e?e:new jt(1/0,1/0,1/0),this.max=void 0!==t?t:new jt(-1/0,-1/0,-1/0)}function yn(e,t){this.center=void 0!==e?e:new jt,this.radius=void 0!==t?t:0}function xn(e,t){this.normal=void 0!==e?e:new jt(1,0,0),this.constant=void 0!==t?t:0}function En(e,t,n,i,r,o){this.planes=[void 0!==e?e:new xn,void 0!==t?t:new xn,void 0!==n?n:new xn,void 0!==i?i:new xn,void 0!==r?r:new xn,void 0!==o?o:new xn]}dn.DEFAULT_IMAGE=void 0,dn.DEFAULT_MAPPING=300,dn.prototype=Object.assign(Object.create(t.prototype),{constructor:dn,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=kt.generateUUID()),t||void 0!==e.images[i.uuid]||(e.images[i.uuid]={uuid:i.uuid,url:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height)}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(i)}),n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case be:e.x=e.x-Math.floor(e.x);break;case _e:e.x=e.x<0?0:1;break;case we:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case be:e.y=e.y-Math.floor(e.y);break;case _e:e.y=e.y<0?0:1;break;case we:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(dn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pn.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,o=e.elements,a=o[0],s=o[4],l=o[8],u=o[1],c=o[5],h=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+c+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,g=(c+1)/2,v=(f+1)/2,y=(s+u)/4,x=(l+d)/4,E=(h+p)/4;return g<m&&v<m?m<.01?(n=0,r=i=.707106781):(i=y/(n=Math.sqrt(m)),r=x/n):v<g?g<.01?(i=0,r=n=.707106781):(n=y/(i=Math.sqrt(g)),r=E/i):v<.01?(i=n=.707106781,r=0):(n=x/(r=Math.sqrt(v)),i=E/r),this.set(n,i,r,t),this}var T=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(T)<.001&&(T=1),this.x=(p-h)/T,this.y=(l-d)/T,this.z=(u-s)/T,this.w=Math.acos((a+c+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===Xt&&(Xt=new pn,qt=new pn),Xt.set(e,e,e,e),qt.set(t,t,t,t),this.clamp(Xt,qt)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),fn.prototype=Object.assign(Object.create(t.prototype),{constructor:fn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((mn.prototype=Object.create(fn.prototype)).constructor=mn).prototype.isWebGLRenderTargetCube=!0,((gn.prototype=Object.create(dn.prototype)).constructor=gn).prototype.isDataTexture=!0,Object.assign(vn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),r<u&&(r=u),o<c&&(o=c),a<h&&(a=h)}return this.min.set(t,n,i),this.max.set(r,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),r<u&&(r=u),o<c&&(o=c),a<h&&(a=h)}return this.min.set(t,n,i),this.max.set(r,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(Kt=new jt,function(e,t){var n=Kt.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new jt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new jt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var r,o,a,s=new jt;function t(e){var t=e.geometry;if(void 0!==t)if(t.isGeometry){var n=t.vertices;for(o=0,a=n.length;o<a;o++)s.copy(n[o]),s.applyMatrix4(e.matrixWorld),r.expandByPoint(s)}else if(t.isBufferGeometry){var i=t.attributes.position;if(void 0!==i)for(o=0,a=i.count;o<a;o++)s.fromBufferAttribute(i,o).applyMatrix4(e.matrixWorld),r.expandByPoint(s)}}return function(e){return r=this,e.updateMatrixWorld(!0),e.traverse(t),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new jt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(Zt=new jt,function(e){return this.clampPoint(e.center,Zt),Zt.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return 0<e.normal.x?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},intersectsTriangle:function(){var s=new jt,l=new jt,u=new jt,n=new jt,i=new jt,r=new jt,c=new jt,o=new jt,h=new jt,a=new jt;function d(e){var t,n;for(t=0,n=e.length-3;t<=n;t+=3){c.fromArray(e,t);var i=h.x*Math.abs(c.x)+h.y*Math.abs(c.y)+h.z*Math.abs(c.z),r=s.dot(c),o=l.dot(c),a=u.dot(c);if(Math.max(-Math.max(r,o,a),Math.min(r,o,a))>i)return!1}return!0}return function(e){if(this.isEmpty())return!1;this.getCenter(o),h.subVectors(this.max,o),s.subVectors(e.a,o),l.subVectors(e.b,o),u.subVectors(e.c,o),n.subVectors(l,s),i.subVectors(u,l),r.subVectors(s,u);var t=[0,-n.z,n.y,0,-i.z,i.y,0,-r.z,r.y,n.z,0,-n.x,i.z,0,-i.x,r.z,0,-r.x,-n.y,n.x,0,-i.y,i.x,0,-r.y,r.x,0];return!!d(t)&&(!!d(t=[1,0,0,0,1,0,0,0,1])&&(a.crossVectors(n,i),d(t=[a.x,a.y,a.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new jt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(Qt=new jt,function(e){return Qt.copy(e).clamp(this.min,this.max).sub(e).length()}),getBoundingSphere:(Jt=new jt,function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new yn),this.getCenter(e.center),e.radius=.5*this.getSize(Jt).length(),e}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Yt=[new jt,new jt,new jt,new jt,new jt,new jt,new jt,new jt],function(e){return this.isEmpty()||(Yt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yt)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(yn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(en=new vn,function(e,t){var n=this.center;void 0!==t?n.copy(t):en.setFromPoints(e).getCenter(n);for(var i=0,r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new jt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new vn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(xn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(on=new jt,an=new jt,function(e,t,n){var i=on.subVectors(n,t).cross(an.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new jt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:(rn=new jt,function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new jt);var n=e.delta(rn),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)}),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&0<n||n<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new jt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(tn=new jt,nn=new Wt,function(e,t){var n=t||nn.getNormalMatrix(e),i=this.coplanarPoint(tn).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(En.prototype,{set:function(e,t,n,i,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(a-i,c-s,f-h,y-m).normalize(),t[1].setComponents(a+i,c+s,f+h,y+m).normalize(),t[2].setComponents(a+r,c+l,f+d,y+g).normalize(),t[3].setComponents(a-r,c-l,f-d,y-g).normalize(),t[4].setComponents(a-o,c-u,f-p,y-v).normalize(),t[5].setComponents(a+o,c+u,f+p,y+v).normalize(),this},intersectsObject:(cn=new yn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),cn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(cn)}),intersectsSprite:(un=new yn,function(e){return un.center.set(0,0,0),un.radius=.7071067811865476,un.applyMatrix4(e.matrixWorld),this.intersectsSphere(un)}),intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:(sn=new jt,ln=new jt,function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];sn.x=0<i.normal.x?e.min.x:e.max.x,ln.x=0<i.normal.x?e.max.x:e.min.x,sn.y=0<i.normal.y?e.min.y:e.max.y,ln.y=0<i.normal.y?e.max.y:e.min.y,sn.z=0<i.normal.z?e.min.z:e.max.z,ln.z=0<i.normal.z?e.max.z:e.min.z;var r=i.distanceToPoint(sn),o=i.distanceToPoint(ln);if(r<0&&o<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var Tn,bn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},_n={merge:function(e){for(var t={},n=0;n<e.length;n++){var i=this.clone(e[n]);for(var r in i)t[r]=i[r]}return t},clone:function(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}return t}},wn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Sn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(Sn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function o(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(e,t,n){if(e=kt.euclideanModulo(e,1),t=kt.clamp(t,0,1),n=kt.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=o(r,i,e+1/3),this.g=o(r,i,e),this.b=o(r,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(a,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u,c=(u=n[1]).length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}t&&0<t.length&&(void 0!==(u=wn[t])?this.setHex(u):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=0<t?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,i=this.r,r=this.g,o=this.b,a=Math.max(i,r,o),s=Math.min(i,r,o),l=(s+a)/2;if(s===a)n=t=0;else{var u=a-s;switch(n=l<=.5?u/(a+s):u/(2-a-s),a){case i:t=(r-o)/u+(r<o?6:0);break;case r:t=(o-i)/u+2;break;case o:t=(i-r)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Tn={},function(e,t,n){return this.getHSL(Tn),Tn.h+=e,Tn.s+=t,Tn.l+=n,this.setHSL(Tn.h,Tn.s,Tn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Mn,An,Rn={common:{diffuse:{value:new Sn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Wt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Sn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Sn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Wt}}},Nn={basic:{uniforms:_n.merge([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.fog]),vertexShader:bn.meshbasic_vert,fragmentShader:bn.meshbasic_frag},lambert:{uniforms:_n.merge([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.fog,Rn.lights,{emissive:{value:new Sn(0)}}]),vertexShader:bn.meshlambert_vert,fragmentShader:bn.meshlambert_frag},phong:{uniforms:_n.merge([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,Rn.gradientmap,Rn.fog,Rn.lights,{emissive:{value:new Sn(0)},specular:{value:new Sn(1118481)},shininess:{value:30}}]),vertexShader:bn.meshphong_vert,fragmentShader:bn.meshphong_frag},standard:{uniforms:_n.merge([Rn.common,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,Rn.roughnessmap,Rn.metalnessmap,Rn.fog,Rn.lights,{emissive:{value:new Sn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:bn.meshphysical_vert,fragmentShader:bn.meshphysical_frag},points:{uniforms:_n.merge([Rn.points,Rn.fog]),vertexShader:bn.points_vert,fragmentShader:bn.points_frag},dashed:{uniforms:_n.merge([Rn.common,Rn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bn.linedashed_vert,fragmentShader:bn.linedashed_frag},depth:{uniforms:_n.merge([Rn.common,Rn.displacementmap]),vertexShader:bn.depth_vert,fragmentShader:bn.depth_frag},normal:{uniforms:_n.merge([Rn.common,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,{opacity:{value:1}}]),vertexShader:bn.normal_vert,fragmentShader:bn.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:bn.cube_vert,fragmentShader:bn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bn.equirect_vert,fragmentShader:bn.equirect_frag},distanceRGBA:{uniforms:_n.merge([Rn.common,Rn.displacementmap,{referencePosition:{value:new jt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bn.distanceRGBA_vert,fragmentShader:bn.distanceRGBA_frag},shadow:{uniforms:_n.merge([Rn.lights,Rn.fog,{color:{value:new Sn(0)},opacity:{value:1}}]),vertexShader:bn.shadow_vert,fragmentShader:bn.shadow_frag}};function Pn(l){var u=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),u.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=u.get(e);t&&(l.deleteBuffer(t.buffer),u.delete(e))},update:function(e,t){e.isInterleavedBufferAttribute&&(e=e.data);var n,i,r,o,a,s=u.get(e);void 0===s?u.set(e,function(e,t){var n=e.array,i=e.dynamic?l.DYNAMIC_DRAW:l.STATIC_DRAW,r=l.createBuffer();l.bindBuffer(t,r),l.bufferData(t,n,i),e.onUploadCallback();var o=l.FLOAT;return n instanceof Float32Array?o=l.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=l.UNSIGNED_SHORT:n instanceof Int16Array?o=l.SHORT:n instanceof Uint32Array?o=l.UNSIGNED_INT:n instanceof Int32Array?o=l.INT:n instanceof Int8Array?o=l.BYTE:n instanceof Uint8Array&&(o=l.UNSIGNED_BYTE),{buffer:r,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(e,t)):s.version<e.version&&(n=s.buffer,r=t,o=(i=e).array,a=i.updateRange,l.bindBuffer(r,n),!1===i.dynamic?l.bufferData(r,o,l.STATIC_DRAW):-1===a.count?l.bufferSubData(r,0,o):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(l.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1),s.version=e.version)}}}function Ln(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||Ln.DefaultOrder}function Cn(){this.mask=1}Nn.physical={uniforms:_n.merge([Nn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:bn.meshphysical_vert,fragmentShader:bn.meshphysical_frag},Ln.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ln.DefaultOrder="XYZ",Object.defineProperties(Ln.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Ln.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=kt.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:(An=new zt,function(e,t,n){return An.makeRotationFromQuaternion(e),this.setFromRotationMatrix(An,t,n)}),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Mn=new Gt,function(e){return Mn.setFromEuler(this),this.setFromQuaternion(Mn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new jt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Cn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Fn,On,$n,Hn,In,Un,Dn,Bn,kn,Vn,zn,Gn,jn,Wn,Xn,qn,Yn,Jn,Qn=0;function Zn(){Object.defineProperty(this,"id",{value:Qn++}),this.uuid=kt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zn.DefaultUp.clone();var e=new jt,t=new Ln,n=new Gt,i=new jt(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new zt},normalMatrix:{value:new Wt}}),this.matrix=new zt,this.matrixWorld=new zt,this.matrixAutoUpdate=Zn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Cn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Kn(){Zn.call(this),this.type="Camera",this.matrixWorldInverse=new zt,this.projectionMatrix=new zt}function ei(e,t,n,i,r,o){Kn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function ti(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new jt,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Sn,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Zn.DefaultUp=new jt(0,1,0),Zn.DefaultMatrixAutoUpdate=!0,Zn.prototype=Object.assign(Object.create(t.prototype),{constructor:Zn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(Yn=new Gt,function(e,t){return Yn.setFromAxisAngle(e,t),this.quaternion.multiply(Yn),this}),rotateOnWorldAxis:(qn=new Gt,function(e,t){return qn.setFromAxisAngle(e,t),this.quaternion.premultiply(qn),this}),rotateX:(Xn=new jt(1,0,0),function(e){return this.rotateOnAxis(Xn,e)}),rotateY:(Wn=new jt(0,1,0),function(e){return this.rotateOnAxis(Wn,e)}),rotateZ:(jn=new jt(0,0,1),function(e){return this.rotateOnAxis(jn,e)}),translateOnAxis:(Gn=new jt,function(e,t){return Gn.copy(e).applyQuaternion(this.quaternion),this.position.add(Gn.multiplyScalar(t)),this}),translateX:(zn=new jt(1,0,0),function(e){return this.translateOnAxis(zn,e)}),translateY:(Vn=new jt(0,1,0),function(e){return this.translateOnAxis(Vn,e)}),translateZ:(kn=new jt(0,0,1),function(e){return this.translateOnAxis(kn,e)}),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Bn=new zt,function(e){return e.applyMatrix4(Bn.getInverse(this.matrixWorld))}),lookAt:(Un=new zt,Dn=new jt,function(e,t,n){e.isVector3?Dn.copy(e):Dn.set(e,t,n),this.isCamera?Un.lookAt(this.position,Dn,this.up):Un.lookAt(Dn,this.position,this.up),this.quaternion.setFromRotationMatrix(Un)}),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new jt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Hn=new jt,In=new jt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Gt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hn,e,In),e}),getWorldScale:(On=new jt,$n=new Gt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new jt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(On,$n,e),e}),getWorldDirection:(Fn=new Gt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new jt),this.getWorldQuaternion(Fn),e.set(0,0,1).applyQuaternion(Fn)}),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},toJSON:function(n){var e=void 0===n||"string"==typeof n,t={};e&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(n)),t.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.matrix=this.matrix.toArray(),void 0!==this.geometry){i.geometry=r(n.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var u=a[s];r(n.shapes,u)}else r(n.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(r(n.materials,this.material[s]));i.material=c}else i.material=r(n.materials,this.material);if(0<this.children.length){i.children=[];for(s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(n).object)}if(e){var h=m(n.geometries),d=m(n.materials),p=m(n.textures),f=m(n.images);a=m(n.shapes);0<h.length&&(t.geometries=h),0<d.length&&(t.materials=d),0<p.length&&(t.textures=p),0<f.length&&(t.images=f),0<a.length&&(t.shapes=a)}return t.object=i,t;function m(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}}),Kn.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Kn,isCamera:!0,copy:function(e,t){return Zn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:(Jn=new Gt,function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new jt),this.getWorldQuaternion(Jn),e.set(0,0,-1).applyQuaternion(Jn)}),updateMatrixWorld:function(e){Zn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),ei.prototype=Object.assign(Object.create(Kn.prototype),{constructor:ei,isOrthographicCamera:!0,copy:function(e,t){return Kn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,o=n+e,a=i+t,s=i-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(r+=c*(this.view.offsetX/l))+c*(this.view.width/l),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(e){var t=Zn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(ti.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var ni,ii,ri,oi,ai,si,li,ui=0;function ci(){Object.defineProperty(this,"id",{value:ui+=2}),this.uuid=kt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function hi(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function di(e,t,n){hi.call(this,new Int8Array(e),t,n)}function pi(e,t,n){hi.call(this,new Uint8Array(e),t,n)}function fi(e,t,n){hi.call(this,new Uint8ClampedArray(e),t,n)}function mi(e,t,n){hi.call(this,new Int16Array(e),t,n)}function gi(e,t,n){hi.call(this,new Uint16Array(e),t,n)}function vi(e,t,n){hi.call(this,new Int32Array(e),t,n)}function yi(e,t,n){hi.call(this,new Uint32Array(e),t,n)}function xi(e,t,n){hi.call(this,new Float32Array(e),t,n)}function Ei(e,t,n){hi.call(this,new Float64Array(e),t,n)}function Ti(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function bi(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}ci.prototype=Object.assign(Object.create(t.prototype),{constructor:ci,isGeometry:!0,applyMatrix:function(e){for(var t=(new Wt).getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(e)}for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(li=new zt,function(e){return li.makeRotationX(e),this.applyMatrix(li),this}),rotateY:(si=new zt,function(e){return si.makeRotationY(e),this.applyMatrix(si),this}),rotateZ:(ai=new zt,function(e){return ai.makeRotationZ(e),this.applyMatrix(ai),this}),translate:(oi=new zt,function(e,t,n){return oi.makeTranslation(e,t,n),this.applyMatrix(oi),this}),scale:(ri=new zt,function(e,t,n){return ri.makeScale(e,t,n),this.applyMatrix(ri),this}),lookAt:(ii=new Zn,function(e){ii.lookAt(e),ii.updateMatrix(),this.applyMatrix(ii.matrix)}),fromBufferGeometry:function(e){var o=this,t=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=[],h=[],d=[],r=0,p=0;r<i.length;r+=3,p+=2)o.vertices.push(new jt(i[r],i[r+1],i[r+2])),void 0!==a&&c.push(new jt(a[r],a[r+1],a[r+2])),void 0!==s&&o.colors.push(new Sn(s[r],s[r+1],s[r+2])),void 0!==l&&h.push(new Vt(l[p],l[p+1])),void 0!==u&&d.push(new Vt(u[p],u[p+1]));function f(e,t,n,i){var r=new ti(e,t,n,void 0!==a?[c[e].clone(),c[t].clone(),c[n].clone()]:[],void 0!==s?[o.colors[e].clone(),o.colors[t].clone(),o.colors[n].clone()]:[],i);o.faces.push(r),void 0!==l&&o.faceVertexUvs[0].push([h[e].clone(),h[t].clone(),h[n].clone()]),void 0!==u&&o.faceVertexUvs[1].push([d[e].clone(),d[t].clone(),d[n].clone()])}var m=e.groups;if(0<m.length)for(r=0;r<m.length;r++)for(var g=m[r],v=g.start,y=(p=v,v+g.count);p<y;p+=3)void 0!==t?f(t[p],t[p+1],t[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==t)for(r=0;r<t.length;r+=3)f(t[r],t[r+1],t[r+2]);else for(r=0;r<i.length/3;r+=3)f(r,r+1,r+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(ni=new jt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ni).negate(),this.translate(ni.x,ni.y,ni.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new zt;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var e=new jt,t=new jt,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,r,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new jt;if(e){var s,l,u,c=new jt,h=new jt;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)a[(o=this.faces[i]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(i=0,r=this.faces.length;i<r;i++){var d=(o=this.faces[i]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var i=(n=this.faces[e]).vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new ci;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)l=new jt,u={a:new jt,b:new jt,c:new jt},a.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(r.normal),u.a.copy(r.vertexNormals[0]),u.b.copy(r.vertexNormals[1]),u.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new vn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new yn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(i=(new Wt).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=l.length;p<f;p++){var g,v,y,x=l[p],E=x.vertexNormals,T=x.vertexColors;(g=new ti(x.a+r,x.b+r,x.c+r)).normal.copy(x.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var b=0,_=E.length;b<_;b++)v=E[b].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),g.vertexNormals.push(v);g.color.copy(x.color);for(b=0,_=T.length;b<_;b++)y=T[b],g.vertexColors.push(y.clone());g.materialIndex=x.materialIndex+n,s.push(g)}for(p=0,f=c.length;p<f;p++){var w=c[p],S=[];if(void 0!==w){for(b=0,_=w.length;b<_;b++)S.push(w[b].clone());u.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,r,o,a,s,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[t]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=c[r.a],r.b=c[r.b],r.c=c[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(n);break}}for(n=d.length-1;0<=n;n--){var f=d[n];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new jt(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var i,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(i=[]),a&&a.length===t&&(r=[]);for(n=0;n<t;n++){var s=e[n]._id;i&&i.push(o[s]),r&&r.push(a[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];i.push(o.x,o.y,o.z)}var a=[],s=[],l={},u=[],c={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=0<p.normal.length(),g=0<p.vertexNormals.length,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,x=0;if(x=_(x=_(x=_(x=_(x=_(x=_(x=_(x=_(x,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),a.push(x),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var E=this.faceVertexUvs[0][r];a.push(M(E[0]),M(E[1]),M(E[2]))}if(m&&a.push(w(p.normal)),g){var T=p.vertexNormals;a.push(w(T[0]),w(T[1]),w(T[2]))}if(v&&a.push(S(p.color)),y){var b=p.vertexColors;a.push(S(b[0]),S(b[1]),S(b[2]))}}function _(e,t,n){return n?e|1<<t:e&~(1<<t)}function w(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function M(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=i,e.data.normals=s,0<u.length&&(e.data.colors=u),0<h.length&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new ci).copy(this)},copy:function(e){var t,n,i,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),i=0,r=c.length;i<r;i++){var h=c[i],d=[];for(o=0,a=h.length;o<a;o++){var p=h[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],i=0,r=f[t].vertices.length;i<r;i++)m.vertices.push(f[t].vertices[i].clone());if(void 0!==f[t].normals)for(m.normals=[],i=0,r=f[t].normals.length;i<r;i++)m.normals.push(f[t].normals[i].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],i=0,r=g[t].vertexNormals.length;i<r;i++){var y=g[t].vertexNormals[i],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),v.vertexNormals.push(x)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],i=0,r=g[t].faceNormals.length;i<r;i++)v.faceNormals.push(g[t].faceNormals[i].clone());this.morphNormals.push(v)}var E=e.skinWeights;for(t=0,n=E.length;t<n;t++)this.skinWeights.push(E[t].clone());var T=e.skinIndices;for(t=0,n=T.length;t<n;t++)this.skinIndices.push(T[t].clone());var b=e.lineDistances;for(t=0,n=b.length;t<n;t++)this.lineDistances.push(b[t]);var _=e.boundingBox;null!==_&&(this.boundingBox=_.clone());var w=e.boundingSphere;return null!==w&&(this.boundingSphere=w.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(hi.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(hi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new Sn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new Vt),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new jt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new pn),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(di.prototype=Object.create(hi.prototype)).constructor=di,(pi.prototype=Object.create(hi.prototype)).constructor=pi,(fi.prototype=Object.create(hi.prototype)).constructor=fi,(mi.prototype=Object.create(hi.prototype)).constructor=mi,(gi.prototype=Object.create(hi.prototype)).constructor=gi,(vi.prototype=Object.create(hi.prototype)).constructor=vi,(yi.prototype=Object.create(hi.prototype)).constructor=yi,(xi.prototype=Object.create(hi.prototype)).constructor=xi,(Ei.prototype=Object.create(hi.prototype)).constructor=Ei,Object.assign(Ti.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,r=e.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:i})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,o=r[0]&&0<r[0].length,a=r[1]&&0<r[1].length,s=e.morphTargets,l=s.length;if(0<l){t=[];for(var u=0;u<l;u++)t[u]=[];this.morphTargets.position=t}var c,h=e.morphNormals,d=h.length;if(0<d){c=[];for(u=0;u<d;u++)c[u]=[];this.morphTargets.normal=c}var p=e.skinIndices,f=e.skinWeights,m=p.length===i.length,g=f.length===i.length;for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=v.normal;this.normals.push(x,x,x)}var E,T=v.vertexColors;if(3===T.length)this.colors.push(T[0],T[1],T[2]);else{var b=v.color;this.colors.push(b,b,b)}if(!0===o)void 0!==(E=r[0][u])?this.uvs.push(E[0],E[1],E[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Vt,new Vt,new Vt));if(!0===a)void 0!==(E=r[1][u])?this.uvs2.push(E[0],E[1],E[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Vt,new Vt,new Vt));for(var _=0;_<l;_++){var w=s[_].vertices;t[_].push(w[v.a],w[v.b],w[v.c])}for(_=0;_<d;_++){var S=h[_].vertexNormals[u];c[_].push(S.a,S.b,S.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var _i,wi,Si,Mi,Ai,Ri,Ni,Pi,Li,Ci,Fi=1;function Oi(){Object.defineProperty(this,"id",{value:Fi+=2}),this.uuid=kt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function $i(e,t,n,i,r,o){ci.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new Hi(e,t,n,i,r,o)),this.mergeVertices()}function Hi(e,t,n,i,r,o){Oi.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var N=this;e=e||1,t=t||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var P=[],L=[],C=[],F=[],O=0,$=0;function a(e,t,n,i,r,o,a,s,l,u,c){var h,d,p=o/l,f=a/u,m=o/2,g=a/2,v=s/2,y=l+1,x=u+1,E=0,T=0,b=new jt;for(d=0;d<x;d++){var _=d*f-g;for(h=0;h<y;h++){var w=h*p-m;b[e]=w*i,b[t]=_*r,b[n]=v,L.push(b.x,b.y,b.z),b[e]=0,b[t]=0,b[n]=0<s?1:-1,C.push(b.x,b.y,b.z),F.push(h/l),F.push(1-d/u),E+=1}}for(d=0;d<u;d++)for(h=0;h<l;h++){var S=O+h+y*d,M=O+h+y*(d+1),A=O+(h+1)+y*(d+1),R=O+(h+1)+y*d;P.push(S,M,R),P.push(M,A,R),T+=6}N.addGroup($,T,c),$+=T,O+=E}a("z","y","x",-1,-1,n,t,e,o,r,0),a("z","y","x",1,-1,n,t,-e,o,r,1),a("x","z","y",1,1,e,n,t,i,o,2),a("x","z","y",1,-1,e,n,-t,i,o,3),a("x","y","z",1,-1,e,t,n,i,r,4),a("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(P),this.addAttribute("position",new xi(L,3)),this.addAttribute("normal",new xi(C,3)),this.addAttribute("uv",new xi(F,2))}function Ii(e,t,n,i){ci.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Ui(e,t,n,i)),this.mergeVertices()}function Ui(e,t,n,i){Oi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};var r,o,a=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(n)||1,u=Math.floor(i)||1,c=l+1,h=u+1,d=e/l,p=t/u,f=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*p-s;for(r=0;r<c;r++){var x=r*d-a;m.push(x,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-o/u)}}for(o=0;o<u;o++)for(r=0;r<l;r++){var E=r+c*o,T=r+c*(o+1),b=r+1+c*(o+1),_=r+1+c*o;f.push(E,T,_),f.push(T,b,_)}this.setIndex(f),this.addAttribute("position",new xi(m,3)),this.addAttribute("normal",new xi(g,3)),this.addAttribute("uv",new xi(v,2))}Oi.prototype=Object.assign(Object.create(t.prototype),{constructor:Oi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<bi(e)?yi:gi)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new hi(t,arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Wt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Ci=new zt,function(e){return Ci.makeRotationX(e),this.applyMatrix(Ci),this}),rotateY:(Li=new zt,function(e){return Li.makeRotationY(e),this.applyMatrix(Li),this}),rotateZ:(Pi=new zt,function(e){return Pi.makeRotationZ(e),this.applyMatrix(Pi),this}),translate:(Ni=new zt,function(e,t,n){return Ni.makeTranslation(e,t,n),this.applyMatrix(Ni),this}),scale:(Ri=new zt,function(e,t,n){return Ri.makeScale(e,t,n),this.applyMatrix(Ri),this}),lookAt:(Ai=new Zn,function(e){Ai.lookAt(e),Ai.updateMatrix(),this.applyMatrix(Ai.matrix)}),center:(Mi=new jt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mi).negate(),this.translate(Mi.x,Mi.y,Mi.z),this}),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new xi(3*t.vertices.length,3),i=new xi(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new xi(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new xi(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Ti).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new hi(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new hi(n,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new hi(i,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new hi(r,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new hi(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[a],u=0,c=l.length;u<c;u++){var h=l[u],d=new xi(3*h.length,3);s.push(d.copyVector3sArray(h))}this.morphAttributes[a]=s}if(0<e.skinIndices.length){var p=new xi(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var f=new xi(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new vn);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(wi=new vn,Si=new jt,function(){null===this.boundingSphere&&(this.boundingSphere=new yn);var e=this.attributes.position;if(e){var t=this.boundingSphere.center;wi.setFromBufferAttribute(e),wi.getCenter(t);for(var n=0,i=0,r=e.count;i<r;i++)Si.x=e.getX(i),Si.y=e.getY(i),Si.z=e.getZ(i),n=Math.max(n,t.distanceToSquared(Si));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new hi(new Float32Array(i.length),3));else for(var r=t.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,l,u,c=t.normal.array,h=new jt,d=new jt,p=new jt,f=new jt,m=new jt;if(e){var g=e.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var x=n[v],E=x.start;for(o=E,a=E+x.count;o<a;o+=3)s=3*g[o+0],l=3*g[o+1],u=3*g[o+2],h.fromArray(i,s),d.fromArray(i,l),p.fromArray(i,u),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[s]+=f.x,c[s+1]+=f.y,c[s+2]+=f.z,c[l]+=f.x,c[l+1]+=f.y,c[l+2]+=f.z,c[u]+=f.x,c[u+1]+=f.y,c[u+2]+=f.z}}else for(o=0,a=i.length;o<a;o+=9)h.fromArray(i,o),d.fromArray(i,o+3),p.fromArray(i,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[o]=f.x,c[o+1]=f.y,c[o+2]=f.z,c[o+3]=f.x,c[o+4]=f.y,c[o+5]=f.z,c[o+6]=f.x,c[o+7]=f.y,c[o+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var r=n[i].array,o=e.attributes[i],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)r[l]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:(_i=new jt,function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)_i.x=e.getX(t),_i.y=e.getY(t),_i.z=e.getZ(t),_i.normalize(),e.setXYZ(t,_i.x,_i.y,_i.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Oi,t=this.index.array,n=this.attributes;for(var i in n){for(var r=n[i],o=r.array,a=r.itemSize,s=new o.constructor(t.length*a),l=0,u=0,c=0,h=t.length;c<h;c++){l=t[c]*a;for(var d=0;d<a;d++)s[u++]=o[l++]}e.addAttribute(i,new hi(s,a))}var p=this.groups;for(c=0,h=p.length;c<h;c++){var f=p[c];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n];r=Array.prototype.slice.call(a.array);e.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;0<s.length&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new Oi).copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(n=0,i=u.length;n<i;n++)l.push(u[n].clone());this.morphAttributes[t]=l}var c=e.groups;for(n=0,i=c.length;n<i;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),($i.prototype=Object.create(ci.prototype)).constructor=$i,(Hi.prototype=Object.create(Oi.prototype)).constructor=Hi,(Ii.prototype=Object.create(ci.prototype)).constructor=Ii,(Ui.prototype=Object.create(Oi.prototype)).constructor=Ui;var Di,Bi,ki,Vi,zi,Gi,ji,Wi,Xi,qi,Yi,Ji,Qi,Zi,Ki,er,tr,nr,ir,rr,or,ar,sr,lr,ur=0;function cr(){Object.defineProperty(this,"id",{value:ur++}),this.uuid=kt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=X,this.side=$,this.flatShading=!1,this.vertexColors=Me,this.opacity=1,this.transparent=!1,this.blendSrc=F,this.blendDst=O,this.blendEquation=w,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ie,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function hr(e){cr.call(this),this.type="MeshBasicMaterial",this.color=new Sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function dr(e){cr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function pr(e,t){this.origin=void 0!==e?e:new jt,this.direction=void 0!==t?t:new jt}function fr(e,t){this.start=void 0!==e?e:new jt,this.end=void 0!==t?t:new jt}function mr(e,t,n){this.a=void 0!==e?e:new jt,this.b=void 0!==t?t:new jt,this.c=void 0!==n?n:new jt}function gr(e,t){Zn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Oi,this.material=void 0!==t?t:new hr({color:16777215*Math.random()}),this.drawMode=Nt,this.updateMorphTargets()}function vr(o,n,a,i){var s,l,u,c=new Sn(0),h=0;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return c},setClearColor:function(e,t){c.set(e),d(c,h=void 0!==t?t:1)},getClearAlpha:function(){return h},setClearAlpha:function(e){d(c,h=e)},render:function(e,t,n,i){var r=t.background;null===r?d(c,h):r&&r.isColor&&(d(r,1),i=!0),(o.autoClear||i)&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),r&&r.isCubeTexture?(void 0===u&&((u=new gr(new Hi(1,1,1),new dr({uniforms:Nn.cube.uniforms,vertexShader:Nn.cube.vertexShader,fragmentShader:Nn.cube.fragmentShader,side:Y,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),u.geometry.removeAttribute("uv"),u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},a.update(u.geometry)),u.material.uniforms.tCube.value=r,e.push(u,u.geometry,u.material,0,null)):r&&r.isTexture&&(void 0===s&&(s=new ei(-1,1,1,-1,0,1),l=new gr(new Ui(2,2),new hr({depthTest:!1,depthWrite:!1,fog:!1})),a.update(l.geometry)),l.material.map=r,o.renderBufferDirect(s,null,l.geometry,l.material,l,null))}}}function yr(n,o,a){var s;this.setMode=function(e){s=e},this.render=function(e,t){n.drawArrays(s,e,t),a.update(t,s)},this.renderInstances=function(e,t,n){var i=o.get("ANGLE_instanced_arrays");if(null!==i){var r=e.attributes.position;r.isInterleavedBufferAttribute?(n=r.data.count,i.drawArraysInstancedANGLE(s,0,n,e.maxInstancedCount)):i.drawArraysInstancedANGLE(s,t,n,e.maxInstancedCount),a.update(n,s,e.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function xr(t,n,e){var i;function r(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var o=void 0!==e.precision?e.precision:"highp",a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===e.logarithmicDepthBuffer,l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=0<u,v=!!n.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var e=n.get("EXT_texture_filter_anisotropic");return i=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:s,maxTextures:l,maxVertexTextures:u,maxTextureSize:c,maxCubemapSize:h,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}function Er(){var c=this,h=null,d=0,p=!1,f=!1,m=new xn,g=new Wt,v={value:null,needsUpdate:!1};function y(){v.value!==h&&(v.value=h,v.needsUpdate=0<d),c.numPlanes=d,c.numIntersection=0}function x(e,t,n,i){var r=null!==e?e.length:0,o=null;if(0!==r){if(o=v.value,!0!==i||null===o){var a=n+4*r,s=t.matrixWorldInverse;g.getNormalMatrix(s),(null===o||o.length<a)&&(o=new Float32Array(a));for(var l=0,u=n;l!==r;++l,u+=4)m.copy(e[l]).applyMatrix4(s,g),m.normal.toArray(o,u),o[u+3]=m.constant}v.value=o,v.needsUpdate=!0}return c.numPlanes=r,o}this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,n){var i=0!==e.length||t||0!==d||p;return p=t,h=x(e,n,0),d=e.length,i},this.beginShadows=function(){f=!0,x(null)},this.endShadows=function(){f=!1,y()},this.setState=function(e,t,n,i,r,o){if(!p||null===e||0===e.length||f&&!n)f?x(null):y();else{var a=f?0:d,s=4*a,l=r.clippingState||null;v.value=l,l=x(e,i,s,o);for(var u=0;u!==s;++u)l[u]=h[u];r.clippingState=l,this.numIntersection=t?this.numPlanes:0,this.numPlanes+=a}}}function Tr(n){var i={};return{get:function(e){if(void 0!==i[e])return i[e];var t;switch(e){case"WEBGL_depth_texture":t=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":t=n.getExtension("WEBGL_compressed_texture_etc1");break;default:t=n.getExtension(e)}return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),i[e]=t}}}function br(h,d,o){var a={},p={};function s(e){var t=e.target,n=a[t.id];for(var i in null!==n.index&&d.remove(n.index),n.attributes)d.remove(n.attributes[i]);t.removeEventListener("dispose",s),delete a[t.id];var r=p[t.id];r&&(d.remove(r),delete p[t.id]),(r=p[n.id])&&(d.remove(r),delete p[n.id]),o.memory.geometries--}return{get:function(e,t){var n=a[t.id];return n||(t.addEventListener("dispose",s),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Oi).setFromObject(e)),n=t._bufferGeometry),a[t.id]=n,o.memory.geometries++,n)},update:function(e){var t=e.index,n=e.attributes;for(var i in null!==t&&d.update(t,h.ELEMENT_ARRAY_BUFFER),n)d.update(n[i],h.ARRAY_BUFFER);var r=e.morphAttributes;for(var i in r)for(var o=r[i],a=0,s=o.length;a<s;a++)d.update(o[a],h.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=p[e.id];if(t)return t;var n,i=[],r=e.index,o=e.attributes;if(null!==r)for(var a=0,s=(n=r.array).length;a<s;a+=3){var l=n[a+0],u=n[a+1],c=n[a+2];i.push(l,u,u,c,c,l)}else for(a=0,s=(n=o.position.array).length/3-1;a<s;a+=3)l=a+0,u=a+1,c=a+2,i.push(l,u,u,c,c,l);return t=new(65535<bi(i)?yi:gi)(i,1),d.update(t,h.ELEMENT_ARRAY_BUFFER),p[e.id]=t}}}function _r(n,r,o){var a,s,l;this.setMode=function(e){a=e},this.setIndex=function(e){s=e.type,l=e.bytesPerElement},this.render=function(e,t){n.drawElements(a,t,s,e*l),o.update(t,a)},this.renderInstances=function(e,t,n){var i=r.get("ANGLE_instanced_arrays");null!==i?(i.drawElementsInstancedANGLE(a,n,s,t*l,e.maxInstancedCount),o.update(n,a,e.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function wr(i){var r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(e,t,n){switch(n=n||1,r.calls++,t){case i.TRIANGLES:r.triangles+=n*(e/3);break;case i.TRIANGLE_STRIP:case i.TRIANGLE_FAN:r.triangles+=n*(e-2);break;case i.LINES:r.lines+=n*(e/2);break;case i.LINE_STRIP:r.lines+=n*(e-1);break;case i.LINE_LOOP:r.lines+=n*e;break;case i.POINTS:r.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t)}}}}function Sr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Mr(p){var f={},m=new Float32Array(8);return{update:function(e,t,n,i){var r=e.morphTargetInfluences,o=r.length,a=f[t.id];if(void 0===a){a=[];for(var s=0;s<o;s++)a[s]=[s,0];f[t.id]=a}var l=n.morphTargets&&t.morphAttributes.position,u=n.morphNormals&&t.morphAttributes.normal;for(s=0;s<o;s++)0!==(c=a[s])[1]&&(l&&t.removeAttribute("morphTarget"+s),u&&t.removeAttribute("morphNormal"+s));for(s=0;s<o;s++)(c=a[s])[0]=s,c[1]=r[s];for(a.sort(Sr),s=0;s<8;s++){var c;if(c=a[s]){var h=c[0],d=c[1];if(d){l&&t.addAttribute("morphTarget"+s,l[h]),u&&t.addAttribute("morphNormal"+s,u[h]),m[s]=d;continue}}m[s]=0}i.getUniforms().setValue(p,"morphTargetInfluences",m)}}}function Ar(r,o){var a={};return{update:function(e){var t=o.render.frame,n=e.geometry,i=r.get(e,n);return a[i.id]!==t&&(n.isGeometry&&i.updateFromObject(e),r.update(i),a[i.id]=t),i},dispose:function(){a={}}}}function Rr(e,t,n,i,r,o,a,s,l,u){dn.call(this,e=void 0!==e?e:[],t=void 0!==t?t:me,n,i,r,o,a,s,l,u),this.flipY=!1}cr.prototype=Object.assign(Object.create(t.prototype),{constructor:cr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]="overdraw"===t?Number(n):n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==X&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==$&&(n.side=this.side),this.vertexColors!==Me&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var r=i(e.textures),o=i(e.images);0<r.length&&(n.textures=r),0<o.length&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var i=t.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((hr.prototype=Object.create(cr.prototype)).constructor=hr).prototype.isMeshBasicMaterial=!0,hr.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},((dr.prototype=Object.create(cr.prototype)).constructor=dr).prototype.isShaderMaterial=!0,dr.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=_n.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},dr.prototype.toJSON=function(e){var t=cr.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(pr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new jt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:(Yi=new jt,function(e){return this.origin.copy(this.at(e,Yi)),this}),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new jt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:(qi=new jt,function(e){var t=qi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(qi.copy(this.direction).multiplyScalar(t).add(this.origin),qi.distanceToSquared(e))}),distanceSqToSegment:(ji=new jt,Wi=new jt,Xi=new jt,function(e,t,n,i){ji.copy(e).add(t).multiplyScalar(.5),Wi.copy(t).sub(e).normalize(),Xi.copy(this.origin).sub(ji);var r,o,a,s,l=.5*e.distanceTo(t),u=-this.direction.dot(Wi),c=Xi.dot(this.direction),h=-Xi.dot(Wi),d=Xi.lengthSq(),p=Math.abs(1-u*u);if(0<p)if(o=u*c-h,s=l*p,0<=(r=u*h-c))if(-s<=o)if(o<=s){var f=1/p;a=(r*=f)*(r+u*(o*=f)+2*c)+o*(u*r+o+2*h)+d}else o=l,a=-(r=Math.max(0,-(u*o+c)))*r+o*(o+2*h)+d;else o=-l,a=-(r=Math.max(0,-(u*o+c)))*r+o*(o+2*h)+d;else o<=-s?a=-(r=Math.max(0,-(-u*l+c)))*r+(o=0<r?-l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d:o<=s?(r=0,a=(o=Math.min(Math.max(-l,-h),l))*(o+2*h)+d):a=-(r=Math.max(0,-(u*l+c)))*r+(o=0<r?l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d;else o=0<u?-l:l,a=-(r=Math.max(0,-(u*o+c)))*r+o*(o+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(Wi).multiplyScalar(o).add(ji),a}),intersectSphere:(Gi=new jt,function(e,t){Gi.subVectors(e.center,this.origin);var n=Gi.dot(this.direction),i=Gi.dot(Gi)-n*n,r=e.radius*e.radius;if(r<i)return null;var o=Math.sqrt(r-i),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)}),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=n?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,i,r,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return 0<=l?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),0<=u?(r=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(r=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),o<n||i<r?null:((n<r||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),0<=c?(a=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),s<n||i<a?null:((n<a||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(0<=n?n:i,t)))},intersectsBox:(zi=new jt,function(e){return null!==this.intersectBox(e,zi)}),intersectTriangle:(Di=new jt,Bi=new jt,ki=new jt,Vi=new jt,function(e,t,n,i,r){Bi.subVectors(t,e),ki.subVectors(n,e),Vi.crossVectors(Bi,ki);var o,a=this.direction.dot(Vi);if(0<a){if(i)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Di.subVectors(this.origin,e);var s=o*this.direction.dot(ki.crossVectors(Di,ki));if(s<0)return null;var l=o*this.direction.dot(Bi.cross(Di));if(l<0)return null;if(a<s+l)return null;var u=-o*Di.dot(Vi);return u<0?null:this.at(u/a,r)}),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(fr.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new jt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new jt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new jt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Ji=new jt,Qi=new jt,function(e,t){Ji.subVectors(e,this.start),Qi.subVectors(this.end,this.start);var n=Qi.dot(Qi),i=Qi.dot(Ji)/n;return t&&(i=kt.clamp(i,0,1)),i}),closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new jt),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(mr,{getNormal:(nr=new jt,function(e,t,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new jt),i.subVectors(n,t),nr.subVectors(e,t),i.cross(nr);var r=i.lengthSq();return 0<r?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}),getBarycoord:(Ki=new jt,er=new jt,tr=new jt,function(e,t,n,i,r){Ki.subVectors(i,t),er.subVectors(n,t),tr.subVectors(e,t);var o=Ki.dot(Ki),a=Ki.dot(er),s=Ki.dot(tr),l=er.dot(er),u=er.dot(tr),c=o*l-a*a;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new jt),0===c)return r.set(-2,-1,-1);var h=1/c,d=(l*s-a*u)*h,p=(o*u-a*s)*h;return r.set(1-d-p,p,d)}),containsPoint:(Zi=new jt,function(e,t,n,i){return mr.getBarycoord(e,t,n,i,Zi),0<=Zi.x&&0<=Zi.y&&Zi.x+Zi.y<=1})}),Object.assign(mr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:(sr=new jt,lr=new jt,function(){return sr.subVectors(this.c,this.b),lr.subVectors(this.a,this.b),.5*sr.cross(lr).length()}),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new jt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return mr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new jt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return mr.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return mr.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(ir=new xn,rr=[new fr,new fr,new fr],or=new jt,ar=new jt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new jt);var n=1/0;if(ir.setFromCoplanarPoints(this.a,this.b,this.c),ir.projectPoint(e,or),!0===this.containsPoint(or))t.copy(or);else{rr[0].set(this.a,this.b),rr[1].set(this.b,this.c),rr[2].set(this.c,this.a);for(var i=0;i<rr.length;i++){rr[i].closestPointToPoint(or,!0,ar);var r=or.distanceToSquared(ar);r<n&&(n=r,t.copy(ar))}}return t}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),gr.prototype=Object.assign(Object.create(Zn.prototype),{constructor:gr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Zn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=i.morphTargets;if(void 0!==s&&0<s.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:function(){var F=new zt,O=new pr,$=new yn,H=new jt,I=new jt,U=new jt,D=new jt,B=new jt,k=new jt,V=new Vt,z=new Vt,G=new Vt,s=new jt,j=new jt,u=new jt;function W(e,t,n,i,r,o,a){return mr.getBarycoord(e,t,n,i,s),r.multiplyScalar(s.x),o.multiplyScalar(s.y),a.multiplyScalar(s.z),r.add(o).add(a),r.clone()}function X(e,t,n,i,r,o,a,s){if(null===(t.side===Y?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,t.side!==J,s)))return null;u.copy(s),u.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(u);return l<n.near||l>n.far?null:{distance:l,point:u.clone(),object:e}}function q(e,t,n,i,r,o,a,s){H.fromBufferAttribute(i,o),I.fromBufferAttribute(i,a),U.fromBufferAttribute(i,s);var l=X(e,e.material,t,n,H,I,U,j);if(l){r&&(V.fromBufferAttribute(r,o),z.fromBufferAttribute(r,a),G.fromBufferAttribute(r,s),l.uv=W(j,H,I,U,V,z,G));var u=new ti(o,a,s);mr.getNormal(H,I,U,u.normal),l.face=u,l.faceIndex=o}return l}return function(e,t){var n,i=this.geometry,r=this.material,o=this.matrixWorld;if(void 0!==r&&(null===i.boundingSphere&&i.computeBoundingSphere(),$.copy(i.boundingSphere),$.applyMatrix4(o),!1!==e.ray.intersectsSphere($)&&(F.getInverse(o),O.copy(e.ray).applyMatrix4(F),null===i.boundingBox||!1!==O.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var a,s,l,u,c,h=i.index,d=i.attributes.position,p=i.attributes.uv;if(null!==h)for(u=0,c=h.count;u<c;u+=3)a=h.getX(u),s=h.getX(u+1),l=h.getX(u+2),(n=q(this,e,O,d,p,a,s,l))&&(n.faceIndex=Math.floor(u/3),t.push(n));else if(void 0!==d)for(u=0,c=d.count;u<c;u+=3)(n=q(this,e,O,d,p,a=u,s=u+1,l=u+2))&&(n.index=a,t.push(n))}else if(i.isGeometry){var f,m,g,v,y=Array.isArray(r),x=i.vertices,E=i.faces,T=i.faceVertexUvs[0];0<T.length&&(v=T);for(var b=0,_=E.length;b<_;b++){var w=E[b],S=y?r[w.materialIndex]:r;if(void 0!==S){if(f=x[w.a],m=x[w.b],g=x[w.c],!0===S.morphTargets){var M=i.morphTargets,A=this.morphTargetInfluences;H.set(0,0,0),I.set(0,0,0),U.set(0,0,0);for(var R=0,N=M.length;R<N;R++){var P=A[R];if(0!==P){var L=M[R].vertices;H.addScaledVector(D.subVectors(L[w.a],f),P),I.addScaledVector(B.subVectors(L[w.b],m),P),U.addScaledVector(k.subVectors(L[w.c],g),P)}}H.add(f),I.add(m),U.add(g),f=H,m=I,g=U}if(n=X(this,S,e,O,f,m,g,j)){if(v&&v[b]){var C=v[b];V.copy(C[0]),z.copy(C[1]),G.copy(C[2]),n.uv=W(j,f,m,g,V,z,G)}n.face=w,n.faceIndex=b,t.push(n)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((Rr.prototype=Object.create(dn.prototype)).constructor=Rr).prototype.isCubeTexture=!0,Object.defineProperty(Rr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Nr=new dn,Pr=new Rr;function Lr(){this.seq=[],this.map={}}var Cr=[],Fr=[],Or=new Float32Array(16),$r=new Float32Array(9);function Hr(e,t,n){var i=e[0];if(i<=0||0<i)return e;var r=t*n,o=Cr[r];if(void 0===o&&(o=new Float32Array(r),Cr[r]=o),0!==t){i.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function Ir(e,t){var n=Fr[t];void 0===n&&(n=new Int32Array(t),Fr[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocTextureUnit();return n}function Ur(e,t){e.uniform1f(this.addr,t)}function Dr(e,t){e.uniform1i(this.addr,t)}function Br(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function kr(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function Vr(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function zr(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Gr(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):($r.set(t.elements),e.uniformMatrix3fv(this.addr,!1,$r))}function jr(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Or.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Or))}function Wr(e,t,n){var i=n.allocTextureUnit();e.uniform1i(this.addr,i),n.setTexture2D(t||Nr,i)}function Xr(e,t,n){var i=n.allocTextureUnit();e.uniform1i(this.addr,i),n.setTextureCube(t||Pr,i)}function qr(e,t){e.uniform2iv(this.addr,t)}function Yr(e,t){e.uniform3iv(this.addr,t)}function Jr(e,t){e.uniform4iv(this.addr,t)}function Qr(e,t){e.uniform1fv(this.addr,t)}function Zr(e,t){e.uniform1iv(this.addr,t)}function Kr(e,t){e.uniform2fv(this.addr,Hr(t,this.size,2))}function eo(e,t){e.uniform3fv(this.addr,Hr(t,this.size,3))}function to(e,t){e.uniform4fv(this.addr,Hr(t,this.size,4))}function no(e,t){e.uniformMatrix2fv(this.addr,!1,Hr(t,this.size,4))}function io(e,t){e.uniformMatrix3fv(this.addr,!1,Hr(t,this.size,9))}function ro(e,t){e.uniformMatrix4fv(this.addr,!1,Hr(t,this.size,16))}function oo(e,t,n){var i=t.length,r=Ir(n,i);e.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTexture2D(t[o]||Nr,r[o])}function ao(e,t,n){var i=t.length,r=Ir(n,i);e.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTextureCube(t[o]||Pr,r[o])}function so(e,t,n){this.id=e,this.addr=n,this.setValue=function(e){switch(e){case 5126:return Ur;case 35664:return Br;case 35665:return kr;case 35666:return Vr;case 35674:return zr;case 35675:return Gr;case 35676:return jr;case 35678:case 36198:return Wr;case 35680:return Xr;case 5124:case 35670:return Dr;case 35667:case 35671:return qr;case 35668:case 35672:return Yr;case 35669:case 35673:return Jr}}(t.type)}function lo(e,t,n){this.id=e,this.addr=n,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Qr;case 35664:return Kr;case 35665:return eo;case 35666:return to;case 35674:return no;case 35675:return io;case 35676:return ro;case 35678:return oo;case 35680:return ao;case 5124:case 35670:return Zr;case 35667:case 35671:return qr;case 35668:case 35672:return Yr;case 35669:case 35673:return Jr}}(t.type)}function uo(e){this.id=e,Lr.call(this)}uo.prototype.setValue=function(e,t){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(e,t[o.id])}};var co=/([\w\d_]+)(\])?(\[|\.)?/g;function ho(e,t){e.seq.push(t),e.map[t.id]=t}function po(e,t,n){var i=e.name,r=i.length;for(co.lastIndex=0;;){var o=co.exec(i),a=co.lastIndex,s=o[1],l="]"===o[2],u=o[3];if(l&&(s|=0),void 0===u||"["===u&&a+2===r){ho(n,void 0===u?new so(s,e,t):new lo(s,e,t));break}var c=n.map[s];void 0===c&&ho(n,c=new uo(s)),n=c}}function fo(e,t,n){Lr.call(this),this.renderer=n;for(var i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;++r){var o=e.getActiveUniform(t,r),a=o.name;po(o,e.getUniformLocation(t,a),this)}}function mo(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(i),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),i}fo.prototype.setValue=function(e,t,n){var i=this.map[t];void 0!==i&&i.setValue(e,n,this.renderer)},fo.prototype.setOptional=function(e,t,n){var i=t[n];void 0!==i&&this.setValue(e,n,i)},fo.upload=function(e,t,n,i){for(var r=0,o=t.length;r!==o;++r){var a=t[r],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,i)}},fo.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var o=e[i];o.id in t&&n.push(o)}return n};var go=0;function vo(e){switch(e){case Ct:return["Linear","( value )"];case Ft:return["sRGB","( value )"];case $t:return["RGBE","( value )"];case Ht:return["RGBM","( value, 7.0 )"];case It:return["RGBM","( value, 16.0 )"];case Ut:return["RGBD","( value, 256.0 )"];case Ot:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function yo(e,t){var n=vo(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function xo(e){return""!==e}function Eo(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function To(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function bo(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var n=bn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return bo(n)})}function _o(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,i){for(var r="",o=parseInt(t);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r})}function wo(e,t,n,i,r,o){var a=e.context,s=i.defines,l=r.vertexShader,u=r.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===I?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===U&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(i.envMap.mapping){case me:case ge:h="ENVMAP_TYPE_CUBE";break;case Ee:case Te:h="ENVMAP_TYPE_CUBE_UV";break;case ve:case ye:h="ENVMAP_TYPE_EQUIREC";break;case xe:h="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case ge:case ye:d="ENVMAP_MODE_REFRACTION"}switch(i.combine){case le:p="ENVMAP_BLENDING_MULTIPLY";break;case ue:p="ENVMAP_BLENDING_MIX";break;case ce:p="ENVMAP_BLENDING_ADD"}}var f,m,g,v,y,x,E,T,b=0<e.gammaFactor?e.gammaFactor:1,_=(f=i.extensions,m=o,g=t,[(f=f||{}).derivatives||m.envMapCubeUV||m.bumpMap||m.normalMap||m.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(f.fragDepth||m.logarithmicDepthBuffer)&&g.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",f.drawBuffers&&g.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(f.shaderTextureLOD||m.envMap)&&g.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(xo).join("\n")),w=function(e){var t=[];for(var n in e){var i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),S=a.createProgram();i.isRawShaderMaterial?(0<(v=[w].filter(xo).join("\n")).length&&(v+="\n"),0<(y=[_,w].filter(xo).join("\n")).length&&(y+="\n")):(v=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,w,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(xo).join("\n"),y=[_,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,w,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+b,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+d:"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==he?"#define TONE_MAPPING":"",o.toneMapping!==he?bn.tonemapping_pars_fragment:"",o.toneMapping!==he?function(e,t){var n;switch(t){case Ae:n="Linear";break;case de:n="Reinhard";break;case pe:n="Uncharted2";break;case fe:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?bn.encodings_pars_fragment:"",o.mapEncoding?yo("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?yo("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?yo("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(x="linearToOutputTexel",E=o.outputEncoding,T=vo(E),"vec4 "+x+"( vec4 value ) { return LinearTo"+T[0]+T[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(xo).join("\n")),l=To(l=Eo(l=bo(l),o),o),u=To(u=Eo(u=bo(u),o),o);var M=v+(l=_o(l)),A=y+(u=_o(u)),R=mo(a,a.VERTEX_SHADER,M),N=mo(a,a.FRAGMENT_SHADER,A);a.attachShader(S,R),a.attachShader(S,N),void 0!==i.index0AttributeName?a.bindAttribLocation(S,0,i.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(S,0,"position"),a.linkProgram(S);var P,L,C=a.getProgramInfoLog(S).trim(),F=a.getShaderInfoLog(R).trim(),O=a.getShaderInfoLog(N).trim(),$=!0,H=!0;return!1===a.getProgramParameter(S,a.LINK_STATUS)?($=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(S,a.VALIDATE_STATUS),"gl.getProgramInfoLog",C,F,O)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==F&&""!==O||(H=!1),H&&(this.diagnostics={runnable:$,material:i,programLog:C,vertexShader:{log:F,prefix:v},fragmentShader:{log:O,prefix:y}}),a.deleteShader(R),a.deleteShader(N),this.getUniforms=function(){return void 0===P&&(P=new fo(a,S,e)),P},this.getAttributes=function(){return void 0===L&&(L=function(e,t){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var o=e.getActiveAttrib(t,r).name;n[o]=e.getAttribLocation(t,o)}return n}(a,S)),L},this.destroy=function(){a.deleteProgram(S),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=go++,this.code=n,this.usedTimes=1,this.program=S,this.vertexShader=R,this.fragmentShader=N,this}function So(h,l,d){var u=[],p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function f(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Ct,n===Ct&&t&&(n=Ot),n}this.getParameters=function(e,t,n,i,r,o,a){var s=p[e.type],l=a.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(d.floatVertexTextures)return 1024;var n=d.maxVertexUniforms,i=Math.floor((n-20)/4),r=Math.min(i,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(a):0,u=d.precision;null!==e.precision&&(u=d.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",u,"instead.");var c=h.getRenderTarget();return{shaderID:s,precision:u,supportsVertexTextures:d.vertexTextures,outputEncoding:f(c?c.texture:null,h.gammaOutput),map:!!e.map,mapEncoding:f(e.map,h.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:f(e.envMap,h.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===Ee||e.envMap.mapping===Te),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:f(e.emissiveMap,h.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!i,useFog:e.fog,fogExp:i&&i.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:e.skinning&&0<l,maxBones:l,useVertexTexture:d.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:h.maxMorphTargets,maxMorphNormals:h.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numClippingPlanes:r,numClipIntersection:o,dithering:e.dithering,shadowMapEnabled:h.shadowMap.enabled&&a.receiveShadow&&0<n.length,shadowMapType:h.shadowMap.type,toneMapping:h.toneMapping,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===J,flipSided:e.side===Y,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);for(var r=0;r<o.length;r++)n.push(t[o[r]]);return n.push(e.onBeforeCompile.toString()),n.push(h.gammaOutput),n.join()},this.acquireProgram=function(e,t,n,i){for(var r,o=0,a=u.length;o<a;o++){var s=u[o];if(s.code===i){++(r=s).usedTimes;break}}return void 0===r&&(r=new wo(h,l,i,e,t,n),u.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},this.programs=u}function Mo(){var i=new WeakMap;return{get:function(e){var t=i.get(e);return void 0===t&&(t={},i.set(e,t)),t},remove:function(e){i.delete(e)},update:function(e,t,n){i.get(e)[t]=n},dispose:function(){i=new WeakMap}}}function Ao(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ro(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function No(){var a=[],s=0,l=[],u=[];return{opaque:l,transparent:u,init:function(){s=0,l.length=0,u.length=0},push:function(e,t,n,i,r){var o=a[s];void 0===o?(o={id:e.id,object:e,geometry:t,material:n,program:n.program,renderOrder:e.renderOrder,z:i,group:r},a[s]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=n,o.program=n.program,o.renderOrder=e.renderOrder,o.z=i,o.group=r),(!0===n.transparent?u:l).push(o),s++},sort:function(){1<l.length&&l.sort(Ao),1<u.length&&u.sort(Ro)}}}function Po(){var r={};return{get:function(e,t){var n=e.id+","+t.id,i=r[n];return void 0===i&&(i=new No,r[n]=i),i},dispose:function(){r={}}}}function Lo(){var n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new jt,color:new Sn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vt};break;case"SpotLight":t={position:new jt,direction:new jt,color:new Sn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vt};break;case"PointLight":t={position:new jt,color:new Sn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new jt,skyColor:new Sn,groundColor:new Sn};break;case"RectAreaLight":t={color:new Sn,position:new jt,halfWidth:new jt,halfHeight:new jt}}return n[e.id]=t}}}var Co,Fo,Oo,$o,Ho,Io,Uo,Do,Bo,ko,Vo,zo,Go,jo,Wo,Xo,qo,Yo,Jo=0;function Qo(){var T=new Lo,b={id:Jo++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},_=new jt,w=new zt,S=new zt;return{setup:function(e,t,n){for(var i=0,r=0,o=0,a=0,s=0,l=0,u=0,c=0,h=n.matrixWorldInverse,d=0,p=e.length;d<p;d++){var f=e[d],m=f.color,g=f.intensity,v=f.distance,y=f.shadow&&f.shadow.map?f.shadow.map.texture:null;if(f.isAmbientLight)i+=m.r*g,r+=m.g*g,o+=m.b*g;else if(f.isDirectionalLight){if((E=T.get(f)).color.copy(f.color).multiplyScalar(f.intensity),E.direction.setFromMatrixPosition(f.matrixWorld),_.setFromMatrixPosition(f.target.matrixWorld),E.direction.sub(_),E.direction.transformDirection(h),E.shadow=f.castShadow,f.castShadow){var x=f.shadow;E.shadowBias=x.bias,E.shadowRadius=x.radius,E.shadowMapSize=x.mapSize}b.directionalShadowMap[a]=y,b.directionalShadowMatrix[a]=f.shadow.matrix,b.directional[a]=E,a++}else if(f.isSpotLight)(E=T.get(f)).position.setFromMatrixPosition(f.matrixWorld),E.position.applyMatrix4(h),E.color.copy(m).multiplyScalar(g),E.distance=v,E.direction.setFromMatrixPosition(f.matrixWorld),_.setFromMatrixPosition(f.target.matrixWorld),E.direction.sub(_),E.direction.transformDirection(h),E.coneCos=Math.cos(f.angle),E.penumbraCos=Math.cos(f.angle*(1-f.penumbra)),E.decay=0===f.distance?0:f.decay,E.shadow=f.castShadow,f.castShadow&&(x=f.shadow,E.shadowBias=x.bias,E.shadowRadius=x.radius,E.shadowMapSize=x.mapSize),b.spotShadowMap[l]=y,b.spotShadowMatrix[l]=f.shadow.matrix,b.spot[l]=E,l++;else if(f.isRectAreaLight)(E=T.get(f)).color.copy(m).multiplyScalar(g),E.position.setFromMatrixPosition(f.matrixWorld),E.position.applyMatrix4(h),S.identity(),w.copy(f.matrixWorld),w.premultiply(h),S.extractRotation(w),E.halfWidth.set(.5*f.width,0,0),E.halfHeight.set(0,.5*f.height,0),E.halfWidth.applyMatrix4(S),E.halfHeight.applyMatrix4(S),b.rectArea[u]=E,u++;else if(f.isPointLight)(E=T.get(f)).position.setFromMatrixPosition(f.matrixWorld),E.position.applyMatrix4(h),E.color.copy(f.color).multiplyScalar(f.intensity),E.distance=f.distance,E.decay=0===f.distance?0:f.decay,E.shadow=f.castShadow,f.castShadow&&(x=f.shadow,E.shadowBias=x.bias,E.shadowRadius=x.radius,E.shadowMapSize=x.mapSize,E.shadowCameraNear=x.camera.near,E.shadowCameraFar=x.camera.far),b.pointShadowMap[s]=y,b.pointShadowMatrix[s]=f.shadow.matrix,b.point[s]=E,s++;else if(f.isHemisphereLight){var E;(E=T.get(f)).direction.setFromMatrixPosition(f.matrixWorld),E.direction.transformDirection(h),E.direction.normalize(),E.skyColor.copy(f.color).multiplyScalar(g),E.groundColor.copy(f.groundColor).multiplyScalar(g),b.hemi[c]=E,c++}}b.ambient[0]=i,b.ambient[1]=r,b.ambient[2]=o,b.directional.length=a,b.spot.length=l,b.rectArea.length=u,b.point.length=s,b.hemi.length=c,b.hash=b.id+","+a+","+s+","+l+","+u+","+c+","+t.length},state:b}}function Zo(){var t=new Qo,n=[],i=[],r=[];return{init:function(){n.length=0,i.length=0,r.length=0},state:{lightsArray:n,shadowsArray:i,spritesArray:r,lights:t},setupLights:function(e){t.setup(n,i,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)},pushSprite:function(e){r.push(e)}}}function Ko(){var r={};return{get:function(e,t){var n=e.id+","+t.id,i=r[n];return void 0===i&&(i=new Zo,r[n]=i),i},dispose:function(){r={}}}}function ea(e){cr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Dt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function ta(e){cr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new jt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function na(x,m,e){for(var E=new En,T=new zt,b=new Vt,_=new Vt(e,e),w=new jt,S=new jt,v=1,y=2,t=1+(v|y),M=new Array(t),A=new Array(t),R={},N={0:Y,1:$,2:J},P=[new jt(1,0,0),new jt(-1,0,0),new jt(0,0,1),new jt(0,0,-1),new jt(0,1,0),new jt(0,-1,0)],L=[new jt(0,1,0),new jt(0,1,0),new jt(0,1,0),new jt(0,1,0),new jt(0,0,1),new jt(0,0,-1)],C=[new pn,new pn,new pn,new pn,new pn,new pn],n=0;n!==t;++n){var i=0!=(n&v),r=0!=(n&y),o=new ea({depthPacking:Bt,morphTargets:i,skinning:r});M[n]=o;var a=new ta({morphTargets:i,skinning:r});A[n]=a}var F=this;function g(e,t,n,i,r,o){var a=e.geometry,s=null,l=M,u=e.customDepthMaterial;if(n&&(l=A,u=e.customDistanceMaterial),u)s=u;else{var c=!1;t.morphTargets&&(a&&a.isBufferGeometry?c=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(c=a.morphTargets&&0<a.morphTargets.length)),e.isSkinnedMesh&&!1===t.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var h=e.isSkinnedMesh&&t.skinning,d=0;c&&(d|=v),h&&(d|=y),s=l[d]}if(x.localClippingEnabled&&!0===t.clipShadows&&0!==t.clippingPlanes.length){var p=s.uuid,f=t.uuid,m=R[p];void 0===m&&(m={},R[p]=m);var g=m[f];void 0===g&&(g=s.clone(),m[f]=g),s=g}return s.visible=t.visible,s.wireframe=t.wireframe,s.side=null!=t.shadowSide?t.shadowSide:N[t.side],s.clipShadows=t.clipShadows,s.clippingPlanes=t.clippingPlanes,s.clipIntersection=t.clipIntersection,s.wireframeLinewidth=t.wireframeLinewidth,s.linewidth=t.linewidth,n&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(i),s.nearDistance=r,s.farDistance=o),s}function O(e,t,n,i){if(!1!==e.visible){if(e.layers.test(t.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||E.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var r=m.update(e),o=e.material;if(Array.isArray(o))for(var a=r.groups,s=0,l=a.length;s<l;s++){var u=a[s],c=o[u.materialIndex];if(c&&c.visible){var h=g(e,c,i,S,n.near,n.far);x.renderBufferDirect(n,null,r,h,e,u)}}else if(o.visible){h=g(e,o,i,S,n.near,n.far);x.renderBufferDirect(n,null,r,h,e,null)}}for(var d=e.children,p=0,f=d.length;p<f;p++)O(d[p],t,n,i)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=I,this.render=function(e,t,n){if(!1!==F.enabled&&(!1!==F.autoUpdate||!1!==F.needsUpdate)&&0!==e.length){var i,r=x.context,o=x.state;o.disable(r.BLEND),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var a=0,s=e.length;a<s;a++){var l=e[a],u=l.shadow,c=l&&l.isPointLight;if(void 0!==u){var h=u.camera;if(b.copy(u.mapSize),b.min(_),c){var d=b.x,p=b.y;C[0].set(2*d,p,d,p),C[1].set(0,p,d,p),C[2].set(3*d,p,d,p),C[3].set(d,p,d,p),C[4].set(3*d,0,d,p),C[5].set(d,0,d,p),b.x*=4,b.y*=2}if(null===u.map){var f={minFilter:Re,magFilter:Re,format:qe};u.map=new fn(b.x,b.y,f),u.map.texture.name=l.name+".shadowMap",h.updateProjectionMatrix()}u.isSpotLightShadow&&u.update(l);var m=u.map,g=u.matrix;S.setFromMatrixPosition(l.matrixWorld),h.position.copy(S),c?(i=6,g.makeTranslation(-S.x,-S.y,-S.z)):(i=1,w.setFromMatrixPosition(l.target.matrixWorld),h.lookAt(w),h.updateMatrixWorld(),g.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),g.multiply(h.projectionMatrix),g.multiply(h.matrixWorldInverse)),x.setRenderTarget(m),x.clear();for(var v=0;v<i;v++){if(c){w.copy(h.position),w.add(P[v]),h.up.copy(L[v]),h.lookAt(w),h.updateMatrixWorld();var y=C[v];o.viewport(y)}T.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),E.setFromMatrix(T),O(t,n,h,c)}}else console.warn("THREE.WebGLShadowMap:",l,"has no shadow.")}F.needsUpdate=!1}}}function ia(e,t,n,i,r,o,a,s,l){dn.call(this,e,t,n,i,r,o,a,s,l),this.needsUpdate=!0}function ra(p,f,m,g,s){var v,y,x,E,T,b,_=new jt,w=new Gt,S=new jt;function M(){var e,t,n,i=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);v=f.createBuffer(),y=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,v),f.bufferData(f.ARRAY_BUFFER,i,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,y),f.bufferData(f.ELEMENT_ARRAY_BUFFER,r,f.STATIC_DRAW),e=f.createProgram(),t=f.createShader(f.VERTEX_SHADER),n=f.createShader(f.FRAGMENT_SHADER),f.shaderSource(t,["precision "+s.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),f.shaderSource(n,["precision "+s.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),f.compileShader(t),f.compileShader(n),f.attachShader(e,t),f.attachShader(e,n),f.linkProgram(e),x=e,E={position:f.getAttribLocation(x,"position"),uv:f.getAttribLocation(x,"uv")},T={uvOffset:f.getUniformLocation(x,"uvOffset"),uvScale:f.getUniformLocation(x,"uvScale"),rotation:f.getUniformLocation(x,"rotation"),center:f.getUniformLocation(x,"center"),scale:f.getUniformLocation(x,"scale"),color:f.getUniformLocation(x,"color"),map:f.getUniformLocation(x,"map"),opacity:f.getUniformLocation(x,"opacity"),modelViewMatrix:f.getUniformLocation(x,"modelViewMatrix"),projectionMatrix:f.getUniformLocation(x,"projectionMatrix"),fogType:f.getUniformLocation(x,"fogType"),fogDensity:f.getUniformLocation(x,"fogDensity"),fogNear:f.getUniformLocation(x,"fogNear"),fogFar:f.getUniformLocation(x,"fogFar"),fogColor:f.getUniformLocation(x,"fogColor"),fogDepth:f.getUniformLocation(x,"fogDepth"),alphaTest:f.getUniformLocation(x,"alphaTest")};var o=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");o.width=8,o.height=8;var a=o.getContext("2d");a.fillStyle="white",a.fillRect(0,0,8,8),b=new ia(o)}function A(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(e,t,n){if(0!==e.length){void 0===x&&M(),m.useProgram(x),m.initAttributes(),m.enableAttribute(E.position),m.enableAttribute(E.uv),m.disableUnusedAttributes(),m.disable(f.CULL_FACE),m.enable(f.BLEND),f.bindBuffer(f.ARRAY_BUFFER,v),f.vertexAttribPointer(E.position,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(E.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,y),f.uniformMatrix4fv(T.projectionMatrix,!1,n.projectionMatrix.elements),m.activeTexture(f.TEXTURE0),f.uniform1i(T.map,0);var i=0,r=0,o=t.fog;o?(f.uniform3f(T.fogColor,o.color.r,o.color.g,o.color.b),o.isFog?(f.uniform1f(T.fogNear,o.near),f.uniform1f(T.fogFar,o.far),f.uniform1i(T.fogType,1),r=i=1):o.isFogExp2&&(f.uniform1f(T.fogDensity,o.density),f.uniform1i(T.fogType,2),r=i=2)):(f.uniform1i(T.fogType,0),r=i=0);for(var a=0,s=e.length;a<s;a++){(c=e[a]).modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,c.matrixWorld),c.z=-c.modelViewMatrix.elements[14]}e.sort(A);var l=[],u=[];for(a=0,s=e.length;a<s;a++){var c,h=(c=e[a]).material;if(!1!==h.visible){c.onBeforeRender(p,t,n,void 0,h,void 0),f.uniform1f(T.alphaTest,h.alphaTest),f.uniformMatrix4fv(T.modelViewMatrix,!1,c.modelViewMatrix.elements),c.matrixWorld.decompose(_,w,S),l[0]=S.x,l[1]=S.y,u[0]=c.center.x-.5,u[1]=c.center.y-.5;var d=0;t.fog&&h.fog&&(d=r),i!==d&&(f.uniform1i(T.fogType,d),i=d),null!==h.map?(f.uniform2f(T.uvOffset,h.map.offset.x,h.map.offset.y),f.uniform2f(T.uvScale,h.map.repeat.x,h.map.repeat.y)):(f.uniform2f(T.uvOffset,0,0),f.uniform2f(T.uvScale,1,1)),f.uniform1f(T.opacity,h.opacity),f.uniform3f(T.color,h.color.r,h.color.g,h.color.b),f.uniform1f(T.rotation,h.rotation),f.uniform2fv(T.center,u),f.uniform2fv(T.scale,l),m.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst,h.blendEquationAlpha,h.blendSrcAlpha,h.blendDstAlpha,h.premultipliedAlpha),m.buffers.depth.setTest(h.depthTest),m.buffers.depth.setMask(h.depthWrite),m.buffers.color.setMask(h.colorWrite),g.setTexture2D(h.map||b,0),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),c.onAfterRender(p,t,n,void 0,h,void 0)}}m.enable(f.CULL_FACE),m.reset()}}}function oa(c,n,l){var i=new function(){var t=!1,o=new pn,n=null,a=new pn(0,0,0,0);return{setMask:function(e){n===e||t||(c.colorMask(e,e,e,e),n=e)},setLocked:function(e){t=e},setClear:function(e,t,n,i,r){!0===r&&(e*=i,t*=i,n*=i),o.set(e,t,n,i),!1===a.equals(o)&&(c.clearColor(e,t,n,i),a.copy(o))},reset:function(){t=!1,n=null,a.set(-1,0,0,0)}}},r=new function(){var t=!1,n=null,i=null,r=null;return{setTest:function(e){e?H(c.DEPTH_TEST):I(c.DEPTH_TEST)},setMask:function(e){n===e||t||(c.depthMask(e),n=e)},setFunc:function(e){if(i!==e){if(e)switch(e){case ee:c.depthFunc(c.NEVER);break;case te:c.depthFunc(c.ALWAYS);break;case ne:c.depthFunc(c.LESS);break;case ie:c.depthFunc(c.LEQUAL);break;case re:c.depthFunc(c.EQUAL);break;case oe:c.depthFunc(c.GEQUAL);break;case ae:c.depthFunc(c.GREATER);break;case se:c.depthFunc(c.NOTEQUAL);break;default:c.depthFunc(c.LEQUAL)}else c.depthFunc(c.LEQUAL);i=e}},setLocked:function(e){t=e},setClear:function(e){r!==e&&(c.clearDepth(e),r=e)},reset:function(){t=!1,r=i=n=null}}},t=new function(){var t=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,u=null;return{setTest:function(e){e?H(c.STENCIL_TEST):I(c.STENCIL_TEST)},setMask:function(e){n===e||t||(c.stencilMask(e),n=e)},setFunc:function(e,t,n){i===e&&r===t&&o===n||(c.stencilFunc(e,t,n),i=e,r=t,o=n)},setOp:function(e,t,n){a===e&&s===t&&l===n||(c.stencilOp(e,t,n),a=e,s=t,l=n)},setLocked:function(e){t=e},setClear:function(e){u!==e&&(c.clearStencil(e),u=e)},reset:function(){t=!1,u=l=s=a=o=r=i=n=null}}},e=c.getParameter(c.MAX_VERTEX_ATTRIBS),o=new Uint8Array(e),a=new Uint8Array(e),s=new Uint8Array(e),u={},h=null,d=null,p=null,f=null,m=null,g=null,v=null,y=null,x=null,E=!1,T=null,b=null,_=null,w=null,S=null,M=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),A=!1,R=0,N=c.getParameter(c.VERSION);-1!==N.indexOf("WebGL")?(R=parseFloat(/^WebGL\ ([0-9])/.exec(N)[1]),A=1<=R):-1!==N.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(N)[1]),A=2<=R);var P=null,L={},C=new pn,F=new pn;function O(e,t,n){var i=new Uint8Array(4),r=c.createTexture();c.bindTexture(e,r),c.texParameteri(e,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(e,c.TEXTURE_MAG_FILTER,c.NEAREST);for(var o=0;o<n;o++)c.texImage2D(t+o,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,i);return r}var $={};function H(e){!0!==u[e]&&(c.enable(e),u[e]=!0)}function I(e){!1!==u[e]&&(c.disable(e),u[e]=!1)}function U(e,t,n,i,r,o,a,s){if(e!==W?H(c.BLEND):I(c.BLEND),e!==K){if(e!==p||s!==E)switch(e){case q:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.SRC_ALPHA,c.ONE));break;case Q:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ZERO,c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ONE_MINUS_SRC_ALPHA)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ZERO,c.ONE_MINUS_SRC_COLOR));break;case Z:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ZERO,c.SRC_ALPHA)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ZERO,c.SRC_COLOR));break;default:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)):(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA))}x=y=v=g=m=f=null}else r=r||t,o=o||n,a=a||i,t===f&&r===v||(c.blendEquationSeparate(l.convert(t),l.convert(r)),f=t,v=r),n===m&&i===g&&o===y&&a===x||(c.blendFuncSeparate(l.convert(n),l.convert(i),l.convert(o),l.convert(a)),m=n,g=i,y=o,x=a);p=e,E=s}function D(e){T!==e&&(e?c.frontFace(c.CW):c.frontFace(c.CCW),T=e)}function B(e){e!==z?(H(c.CULL_FACE),e!==b&&(e===G?c.cullFace(c.BACK):e===j?c.cullFace(c.FRONT):c.cullFace(c.FRONT_AND_BACK))):I(c.CULL_FACE),b=e}function k(e,t,n){e?(H(c.POLYGON_OFFSET_FILL),w===t&&S===n||(c.polygonOffset(t,n),w=t,S=n)):I(c.POLYGON_OFFSET_FILL)}function V(e){void 0===e&&(e=c.TEXTURE0+M-1),P!==e&&(c.activeTexture(e),P=e)}return $[c.TEXTURE_2D]=O(c.TEXTURE_2D,c.TEXTURE_2D,1),$[c.TEXTURE_CUBE_MAP]=O(c.TEXTURE_CUBE_MAP,c.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),r.setClear(1),t.setClear(0),H(c.DEPTH_TEST),r.setFunc(ie),D(!1),B(G),H(c.CULL_FACE),H(c.BLEND),U(X),{buffers:{color:i,depth:r,stencil:t},initAttributes:function(){for(var e=0,t=o.length;e<t;e++)o[e]=0},enableAttribute:function(e){o[e]=1,0===a[e]&&(c.enableVertexAttribArray(e),a[e]=1),0!==s[e]&&(n.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,0),s[e]=0)},enableAttributeAndDivisor:function(e,t){o[e]=1,0===a[e]&&(c.enableVertexAttribArray(e),a[e]=1),s[e]!==t&&(n.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,t),s[e]=t)},disableUnusedAttributes:function(){for(var e=0,t=a.length;e!==t;++e)a[e]!==o[e]&&(c.disableVertexAttribArray(e),a[e]=0)},enable:H,disable:I,getCompressedTextureFormats:function(){if(null===h&&(h=[],n.get("WEBGL_compressed_texture_pvrtc")||n.get("WEBGL_compressed_texture_s3tc")||n.get("WEBGL_compressed_texture_etc1")||n.get("WEBGL_compressed_texture_astc")))for(var e=c.getParameter(c.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)h.push(e[t]);return h},useProgram:function(e){return d!==e&&(c.useProgram(e),d=e,!0)},setBlending:U,setMaterial:function(e,t){e.side===J?I(c.CULL_FACE):H(c.CULL_FACE);var n=e.side===Y;t&&(n=!n),D(n),!0===e.transparent?U(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):U(W),r.setFunc(e.depthFunc),r.setTest(e.depthTest),r.setMask(e.depthWrite),i.setMask(e.colorWrite),k(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:D,setCullFace:B,setLineWidth:function(e){e!==_&&(A&&c.lineWidth(e),_=e)},setPolygonOffset:k,setScissorTest:function(e){e?H(c.SCISSOR_TEST):I(c.SCISSOR_TEST)},activeTexture:V,bindTexture:function(e,t){null===P&&V();var n=L[P];void 0===n&&(n={type:void 0,texture:void 0},L[P]=n),n.type===e&&n.texture===t||(c.bindTexture(e,t||$[e]),n.type=e,n.texture=t)},compressedTexImage2D:function(){try{c.compressedTexImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{c.texImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===C.equals(e)&&(c.scissor(e.x,e.y,e.z,e.w),C.copy(e))},viewport:function(e){!1===F.equals(e)&&(c.viewport(e.x,e.y,e.z,e.w),F.copy(e))},reset:function(){for(var e=0;e<a.length;e++)1===a[e]&&(c.disableVertexAttribArray(e),a[e]=0);u={},L={},b=T=p=d=P=h=null,i.reset(),r.reset(),t.reset()}}}function aa(m,r,g,v,y,x,E){var f,T="undefined"!=typeof WebGL2RenderingContext&&m instanceof WebGL2RenderingContext,s={};function b(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var n=t/Math.max(e.width,e.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return i.width=Math.floor(e.width*n),i.height=Math.floor(e.height*n),i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function _(e){return kt.isPowerOfTwo(e.width)&&kt.isPowerOfTwo(e.height)}function w(e,t){return e.generateMipmaps&&t&&e.minFilter!==Re&&e.minFilter!==Le}function S(e,t,n,i){m.generateMipmap(e),v.get(t).__maxMipLevel=Math.log2(Math.max(n,i))}function o(e){return e===Re||e===Ne||e===Pe?m.NEAREST:m.LINEAR}function M(e){var t=e.target;t.removeEventListener("dispose",M),function(e){var t=v.get(e);if(e.image&&t.__image__webglTextureCube)m.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;m.deleteTexture(t.__webglTexture)}v.remove(e)}(t),t.isVideoTexture&&delete s[t.id],E.memory.textures--}function a(e){var t=e.target;t.removeEventListener("dispose",a),function(e){var t=v.get(e),n=v.get(e.texture);if(!e)return;void 0!==n.__webglTexture&&m.deleteTexture(n.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var i=0;i<6;i++)m.deleteFramebuffer(t.__webglFramebuffer[i]),t.__webglDepthbuffer&&m.deleteRenderbuffer(t.__webglDepthbuffer[i]);else m.deleteFramebuffer(t.__webglFramebuffer),t.__webglDepthbuffer&&m.deleteRenderbuffer(t.__webglDepthbuffer);v.remove(e.texture),v.remove(e)}(t),E.memory.textures--}function l(e,t){var n,i,r,o=v.get(e);if(e.isVideoTexture&&(i=(n=e).id,r=E.render.frame,s[i]!==r&&(s[i]=r,n.update())),0<e.version&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==a.complete)return void function(e,t,n){void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",M),e.__webglTexture=m.createTexture(),E.memory.textures++);g.activeTexture(m.TEXTURE0+n),g.bindTexture(m.TEXTURE_2D,e.__webglTexture),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,t.flipY),m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),m.pixelStorei(m.UNPACK_ALIGNMENT,t.unpackAlignment);var i=b(t.image,y.maxTextureSize);o=t,(o.wrapS!==_e||o.wrapT!==_e||o.minFilter!==Re&&o.minFilter!==Le)&&!1===_(i)&&(i=(r=i)instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof ImageBitmap?(void 0===f&&(f=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),f.width=kt.floorPowerOfTwo(r.width),f.height=kt.floorPowerOfTwo(r.height),f.getContext("2d").drawImage(r,0,0,f.width,f.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+r.width+"x"+r.height+"). Resized to "+f.width+"x"+f.height,r),f):r);var r;var o;var a=_(i),s=x.convert(t.format),l=x.convert(t.type);A(m.TEXTURE_2D,t,a);var u,c=t.mipmaps;if(t.isDepthTexture){var h=m.DEPTH_COMPONENT;if(t.type===Be){if(!T)throw new Error("Float Depth Texture only supported in WebGL2.0");h=m.DEPTH_COMPONENT32F}else T&&(h=m.DEPTH_COMPONENT16);t.format===Ze&&h===m.DEPTH_COMPONENT&&t.type!==Ie&&t.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=Ie,l=x.convert(t.type)),t.format===Ke&&(h=m.DEPTH_STENCIL,t.type!==je&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=je,l=x.convert(t.type))),g.texImage2D(m.TEXTURE_2D,0,h,i.width,i.height,0,s,l,null)}else if(t.isDataTexture)if(0<c.length&&a){for(var d=0,p=c.length;d<p;d++)u=c[d],g.texImage2D(m.TEXTURE_2D,d,s,u.width,u.height,0,s,l,u.data);t.generateMipmaps=!1,e.__maxMipLevel=c.length-1}else g.texImage2D(m.TEXTURE_2D,0,s,i.width,i.height,0,s,l,i.data),e.__maxMipLevel=0;else if(t.isCompressedTexture){for(var d=0,p=c.length;d<p;d++)u=c[d],t.format!==qe&&t.format!==Xe?-1<g.getCompressedTextureFormats().indexOf(s)?g.compressedTexImage2D(m.TEXTURE_2D,d,s,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):g.texImage2D(m.TEXTURE_2D,d,s,u.width,u.height,0,s,l,u.data);e.__maxMipLevel=c.length-1}else if(0<c.length&&a){for(var d=0,p=c.length;d<p;d++)u=c[d],g.texImage2D(m.TEXTURE_2D,d,s,s,l,u);t.generateMipmaps=!1,e.__maxMipLevel=c.length-1}else g.texImage2D(m.TEXTURE_2D,0,s,s,l,i),e.__maxMipLevel=0;w(t,a)&&S(m.TEXTURE_2D,t,i.width,i.height);e.__version=t.version,t.onUpdate&&t.onUpdate(t)}(o,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_2D,o.__webglTexture)}function A(e,t,n){var i;if(n?(m.texParameteri(e,m.TEXTURE_WRAP_S,x.convert(t.wrapS)),m.texParameteri(e,m.TEXTURE_WRAP_T,x.convert(t.wrapT)),m.texParameteri(e,m.TEXTURE_MAG_FILTER,x.convert(t.magFilter)),m.texParameteri(e,m.TEXTURE_MIN_FILTER,x.convert(t.minFilter))):(m.texParameteri(e,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(e,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),t.wrapS===_e&&t.wrapT===_e||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),m.texParameteri(e,m.TEXTURE_MAG_FILTER,o(t.magFilter)),m.texParameteri(e,m.TEXTURE_MIN_FILTER,o(t.minFilter)),t.minFilter!==Re&&t.minFilter!==Le&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t)),i=r.get("EXT_texture_filter_anisotropic")){if(t.type===Be&&null===r.get("OES_texture_float_linear"))return;if(t.type===ke&&null===r.get("OES_texture_half_float_linear"))return;(1<t.anisotropy||v.get(t).__currentAnisotropy)&&(m.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,y.getMaxAnisotropy())),v.get(t).__currentAnisotropy=t.anisotropy)}}function u(e,t,n,i){var r=x.convert(t.texture.format),o=x.convert(t.texture.type);g.texImage2D(i,0,r,t.width,t.height,0,r,o,null),m.bindFramebuffer(m.FRAMEBUFFER,e),m.framebufferTexture2D(m.FRAMEBUFFER,n,i,v.get(t.texture).__webglTexture,0),m.bindFramebuffer(m.FRAMEBUFFER,null)}function c(e,t){m.bindRenderbuffer(m.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_COMPONENT16,t.width,t.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,t.width,t.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,e)):m.renderbufferStorage(m.RENDERBUFFER,m.RGBA4,t.width,t.height),m.bindRenderbuffer(m.RENDERBUFFER,null)}function h(e){var t=v.get(e),n=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,t){if(t&&t.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(m.bindFramebuffer(m.FRAMEBUFFER,e),!t.depthTexture||!t.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");v.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),l(t.depthTexture,0);var n=v.get(t.depthTexture).__webglTexture;if(t.depthTexture.format===Ze)m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.TEXTURE_2D,n,0);else{if(t.depthTexture.format!==Ke)throw new Error("Unknown depthTexture format");m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.TEXTURE_2D,n,0)}}(t.__webglFramebuffer,e)}else if(n){t.__webglDepthbuffer=[];for(var i=0;i<6;i++)m.bindFramebuffer(m.FRAMEBUFFER,t.__webglFramebuffer[i]),t.__webglDepthbuffer[i]=m.createRenderbuffer(),c(t.__webglDepthbuffer[i],e)}else m.bindFramebuffer(m.FRAMEBUFFER,t.__webglFramebuffer),t.__webglDepthbuffer=m.createRenderbuffer(),c(t.__webglDepthbuffer,e);m.bindFramebuffer(m.FRAMEBUFFER,null)}this.setTexture2D=l,this.setTextureCube=function(e,t){var n=v.get(e);if(6===e.image.length)if(0<e.version&&n.__version!==e.version){n.__image__webglTextureCube||(e.addEventListener("dispose",M),n.__image__webglTextureCube=m.createTexture(),E.memory.textures++),g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var i=e&&e.isCompressedTexture,r=e.image[0]&&e.image[0].isDataTexture,o=[],a=0;a<6;a++)o[a]=i||r?r?e.image[a].image:e.image[a]:b(e.image[a],y.maxCubemapSize);var s=o[0],l=_(s),u=x.convert(e.format),c=x.convert(e.type);for(A(m.TEXTURE_CUBE_MAP,e,l),a=0;a<6;a++)if(i)for(var h,d=o[a].mipmaps,p=0,f=d.length;p<f;p++)h=d[p],e.format!==qe&&e.format!==Xe?-1<g.getCompressedTextureFormats().indexOf(u)?g.compressedTexImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+a,p,u,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+a,p,u,h.width,h.height,0,u,c,h.data);else r?g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,u,o[a].width,o[a].height,0,u,c,o[a].data):g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,u,u,c,o[a]);n.__maxMipLevel=i?d.length-1:0,w(e,l)&&S(m.TEXTURE_CUBE_MAP,e,s.width,s.height),n.__version=e.version,e.onUpdate&&e.onUpdate(e)}else g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,t){g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,v.get(e).__webglTexture)},this.setupRenderTarget=function(e){var t=v.get(e),n=v.get(e.texture);e.addEventListener("dispose",a),n.__webglTexture=m.createTexture(),E.memory.textures++;var i=!0===e.isWebGLRenderTargetCube,r=_(e);if(i){t.__webglFramebuffer=[];for(var o=0;o<6;o++)t.__webglFramebuffer[o]=m.createFramebuffer()}else t.__webglFramebuffer=m.createFramebuffer();if(i){for(g.bindTexture(m.TEXTURE_CUBE_MAP,n.__webglTexture),A(m.TEXTURE_CUBE_MAP,e.texture,r),o=0;o<6;o++)u(t.__webglFramebuffer[o],e,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+o);w(e.texture,r)&&S(m.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),g.bindTexture(m.TEXTURE_CUBE_MAP,null)}else g.bindTexture(m.TEXTURE_2D,n.__webglTexture),A(m.TEXTURE_2D,e.texture,r),u(t.__webglFramebuffer,e,m.COLOR_ATTACHMENT0,m.TEXTURE_2D),w(e.texture,r)&&S(m.TEXTURE_2D,e.texture,e.width,e.height),g.bindTexture(m.TEXTURE_2D,null);e.depthBuffer&&h(e)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(w(t,_(e))){var n=e.isWebGLRenderTargetCube?m.TEXTURE_CUBE_MAP:m.TEXTURE_2D,i=v.get(t).__webglTexture;g.bindTexture(n,i),S(n,t,e.width,e.height),g.bindTexture(n,null)}}}function sa(n,i){return{convert:function(e){var t;if(e===be)return n.REPEAT;if(e===_e)return n.CLAMP_TO_EDGE;if(e===we)return n.MIRRORED_REPEAT;if(e===Re)return n.NEAREST;if(e===Ne)return n.NEAREST_MIPMAP_NEAREST;if(e===Pe)return n.NEAREST_MIPMAP_LINEAR;if(e===Le)return n.LINEAR;if(e===Ce)return n.LINEAR_MIPMAP_NEAREST;if(e===Fe)return n.LINEAR_MIPMAP_LINEAR;if(e===Oe)return n.UNSIGNED_BYTE;if(e===Ve)return n.UNSIGNED_SHORT_4_4_4_4;if(e===ze)return n.UNSIGNED_SHORT_5_5_5_1;if(e===Ge)return n.UNSIGNED_SHORT_5_6_5;if(e===$e)return n.BYTE;if(e===He)return n.SHORT;if(e===Ie)return n.UNSIGNED_SHORT;if(e===Ue)return n.INT;if(e===De)return n.UNSIGNED_INT;if(e===Be)return n.FLOAT;if(e===ke&&null!==(t=i.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(e===We)return n.ALPHA;if(e===Xe)return n.RGB;if(e===qe)return n.RGBA;if(e===Ye)return n.LUMINANCE;if(e===Je)return n.LUMINANCE_ALPHA;if(e===Ze)return n.DEPTH_COMPONENT;if(e===Ke)return n.DEPTH_STENCIL;if(e===w)return n.FUNC_ADD;if(e===S)return n.FUNC_SUBTRACT;if(e===M)return n.FUNC_REVERSE_SUBTRACT;if(e===N)return n.ZERO;if(e===P)return n.ONE;if(e===L)return n.SRC_COLOR;if(e===C)return n.ONE_MINUS_SRC_COLOR;if(e===F)return n.SRC_ALPHA;if(e===O)return n.ONE_MINUS_SRC_ALPHA;if(e===H)return n.DST_ALPHA;if(e===D)return n.ONE_MINUS_DST_ALPHA;if(e===B)return n.DST_COLOR;if(e===k)return n.ONE_MINUS_DST_COLOR;if(e===V)return n.SRC_ALPHA_SATURATE;if((e===et||e===tt||e===nt||e===it)&&null!==(t=i.get("WEBGL_compressed_texture_s3tc"))){if(e===et)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===tt)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===nt)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===it)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===rt||e===ot||e===at||e===st)&&null!==(t=i.get("WEBGL_compressed_texture_pvrtc"))){if(e===rt)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ot)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===at)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===st)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===lt&&null!==(t=i.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===ut||e===ct||e===ht||e===dt||e===pt||e===ft||e===mt||e===gt||e===vt||e===yt||e===xt||e===Et||e===Tt||e===bt)&&null!==(t=i.get("WEBGL_compressed_texture_astc")))return e;if((e===A||e===R)&&null!==(t=i.get("EXT_blend_minmax"))){if(e===A)return t.MIN_EXT;if(e===R)return t.MAX_EXT}return e===je&&null!==(t=i.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}}}function la(e,t,n,i){Kn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ua(e){la.call(this),this.cameras=e||[]}function ca(i){var s=this,l=null,u=null,c=null,h=new zt,d=new zt;"undefined"!=typeof window&&"VRFrameData"in window&&(u=new window.VRFrameData);var p=new zt,f=new Gt,m=new jt,g=new la;g.bounds=new pn(0,0,.5,1),g.layers.enable(1);var v=new la;v.bounds=new pn(.5,0,.5,1),v.layers.enable(2);var r,o,y=new ua([g,v]);function e(){if(null!==l&&l.isPresenting){var e=l.getEyeParameters("left"),t=e.renderWidth,n=e.renderHeight;o=i.getPixelRatio(),r=i.getSize(),i.setDrawingBufferSize(2*t,n,1)}else s.enabled&&i.setDrawingBufferSize(r.width,r.height,o)}y.layers.enable(1),y.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return l},this.setDevice=function(e){void 0!==e&&(l=e)},this.setPoseTarget=function(e){void 0!==e&&(c=e)},this.getCamera=function(e){if(null===l)return e;l.depthNear=e.near,l.depthFar=e.far,l.getFrameData(u);var t=l.stageParameters;t?h.fromArray(t.sittingToStandingTransform):h.makeTranslation(0,s.userHeight,0);var n=u.pose,i=null!==c?c:e;if(i.matrix.copy(h),i.matrix.decompose(i.position,i.quaternion,i.scale),null!==n.orientation&&(f.fromArray(n.orientation),i.quaternion.multiply(f)),null!==n.position&&(f.setFromRotationMatrix(h),m.fromArray(n.position),m.applyQuaternion(f),i.position.add(m)),i.updateMatrixWorld(),!1===l.isPresenting)return e;g.near=e.near,v.near=e.near,g.far=e.far,v.far=e.far,y.matrixWorld.copy(e.matrixWorld),y.matrixWorldInverse.copy(e.matrixWorldInverse),g.matrixWorldInverse.fromArray(u.leftViewMatrix),v.matrixWorldInverse.fromArray(u.rightViewMatrix),d.getInverse(h),g.matrixWorldInverse.multiply(d),v.matrixWorldInverse.multiply(d);var r=i.parent;null!==r&&(p.getInverse(r.matrixWorld),g.matrixWorldInverse.multiply(p),v.matrixWorldInverse.multiply(p)),g.matrixWorld.getInverse(g.matrixWorldInverse),v.matrixWorld.getInverse(v.matrixWorldInverse),g.projectionMatrix.fromArray(u.leftProjectionMatrix),v.projectionMatrix.fromArray(u.rightProjectionMatrix),y.projectionMatrix.copy(g.projectionMatrix);var o=l.getLayers();if(o.length){var a=o[0];null!==a.leftBounds&&4===a.leftBounds.length&&g.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&v.bounds.fromArray(a.rightBounds)}return y},this.getStandingMatrix=function(){return h},this.submitFrame=function(){l&&l.isPresenting&&l.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function ha(e){console.log("THREE.WebGLRenderer",Se);var r=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",p=null,$=null;this.domElement=r,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ae,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var H,w,I,U,c,D,h,S,M,f,g,d,m,v,A,R,N,y,x,B=this,E=!1,T=null,b=null,k=-1,P="",V=null,z=null,_=new pn,L=new pn,C=null,G=0,F=r.width,j=r.height,W=1,O=new pn(0,0,F,j),X=new pn(0,0,F,j),q=!1,Y=new En,J=new Er,Q=!1,Z=!1,K=new zt,ee=new jt;function te(){return null===T?W:1}try{var ne={alpha:n,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u};if(r.addEventListener("webglcontextlost",ae,!1),r.addEventListener("webglcontextrestored",se,!1),null===(H=t||r.getContext("webgl",ne)||r.getContext("experimental-webgl",ne)))throw null!==r.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===H.getShaderPrecisionFormat&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function ie(){(w=new Tr(H)).get("WEBGL_depth_texture"),w.get("OES_texture_float"),w.get("OES_texture_float_linear"),w.get("OES_texture_half_float"),w.get("OES_texture_half_float_linear"),w.get("OES_standard_derivatives"),w.get("OES_element_index_uint"),w.get("ANGLE_instanced_arrays"),x=new sa(H,w),I=new xr(H,w,e),(U=new oa(H,w,x)).scissor(L.copy(X).multiplyScalar(W)),U.viewport(_.copy(O).multiplyScalar(W)),c=new wr(H),D=new Mo,h=new aa(H,w,U,D,I,x,c),S=new Pn(H),M=new br(H,S,c),f=new Ar(M,c),A=new Mr(H),g=new So(B,w,I),d=new Po,m=new Ko,v=new vr(B,U,M,s),R=new yr(H,w,c),N=new _r(H,w,c),y=new ra(B,H,U,h,I),c.programs=g.programs,B.context=H,B.capabilities=I,B.extensions=w,B.properties=D,B.renderLists=d,B.state=U,B.info=c}ie();var re=new ca(B);this.vr=re;var oe=new na(B,f,I.maxTextureSize);function ae(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function se(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1,ie()}function le(e){var t,n=e.target;n.removeEventListener("dispose",le),ue(t=n),D.remove(t)}function ue(e){var t=D.get(e).program;(e.program=void 0)!==t&&g.releaseProgram(t)}this.shadowMap=oe,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){var e=w.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=w.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(e){void 0!==e&&(W=e,this.setSize(F,j,!1))},this.getSize=function(){return{width:F,height:j}},this.setSize=function(e,t,n){var i=re.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(F=e,j=t,r.width=e*W,r.height=t*W,!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:F*W,height:j*W}},this.setDrawingBufferSize=function(e,t,n){F=e,j=t,W=n,r.width=e*n,r.height=t*n,this.setViewport(0,0,e,t)},this.getCurrentViewport=function(){return _},this.setViewport=function(e,t,n,i){O.set(e,j-t-i,n,i),U.viewport(_.copy(O).multiplyScalar(W))},this.setScissor=function(e,t,n,i){X.set(e,j-t-i,n,i),U.scissor(L.copy(X).multiplyScalar(W))},this.setScissorTest=function(e){U.setScissorTest(q=e)},this.getClearColor=function(){return v.getClearColor()},this.setClearColor=function(){v.setClearColor.apply(v,arguments)},this.getClearAlpha=function(){return v.getClearAlpha()},this.setClearAlpha=function(){v.setClearAlpha.apply(v,arguments)},this.clear=function(e,t,n){var i=0;(void 0===e||e)&&(i|=H.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=H.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=H.STENCIL_BUFFER_BIT),H.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,i){this.setRenderTarget(e),this.clear(t,n,i)},this.dispose=function(){r.removeEventListener("webglcontextlost",ae,!1),r.removeEventListener("webglcontextrestored",se,!1),d.dispose(),m.dispose(),D.dispose(),f.dispose(),re.dispose(),me()},this.renderBufferImmediate=function(e,t,n){U.initAttributes();var i=D.get(e);e.hasPositions&&!i.position&&(i.position=H.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=H.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=H.createBuffer()),e.hasColors&&!i.color&&(i.color=H.createBuffer());var r=t.getAttributes();if(e.hasPositions&&(H.bindBuffer(H.ARRAY_BUFFER,i.position),H.bufferData(H.ARRAY_BUFFER,e.positionArray,H.DYNAMIC_DRAW),U.enableAttribute(r.position),H.vertexAttribPointer(r.position,3,H.FLOAT,!1,0,0)),e.hasNormals){if(H.bindBuffer(H.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,a=3*e.count;o<a;o+=9){var s=e.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,u=(s[o+1]+s[o+4]+s[o+7])/3,c=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=u,s[o+2]=c,s[o+3]=l,s[o+4]=u,s[o+5]=c,s[o+6]=l,s[o+7]=u,s[o+8]=c}H.bufferData(H.ARRAY_BUFFER,e.normalArray,H.DYNAMIC_DRAW),U.enableAttribute(r.normal),H.vertexAttribPointer(r.normal,3,H.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(H.bindBuffer(H.ARRAY_BUFFER,i.uv),H.bufferData(H.ARRAY_BUFFER,e.uvArray,H.DYNAMIC_DRAW),U.enableAttribute(r.uv),H.vertexAttribPointer(r.uv,2,H.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==Me&&(H.bindBuffer(H.ARRAY_BUFFER,i.color),H.bufferData(H.ARRAY_BUFFER,e.colorArray,H.DYNAMIC_DRAW),U.enableAttribute(r.color),H.vertexAttribPointer(r.color,3,H.FLOAT,!1,0,0)),U.disableUnusedAttributes(),H.drawArrays(H.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,o){var a=r.isMesh&&r.matrixWorld.determinant()<0;U.setMaterial(i,a);var s=Te(e,t,i,r),l=n.id+"_"+s.id+"_"+(!0===i.wireframe),u=!1;l!==P&&(P=l,u=!0),r.morphTargetInfluences&&(A.update(r,n,i,s),u=!0);var c,h=n.index,d=n.attributes.position,p=1;!0===i.wireframe&&(h=M.getWireframeAttribute(n),p=2);var f=R;null!==h&&(c=S.get(h),(f=N).setIndex(c)),u&&(!function(e,t,n,i){if(n&&n.isInstancedBufferGeometry&&null===w.get("ANGLE_instanced_arrays"))return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===i&&(i=0);U.initAttributes();var r=n.attributes,o=t.getAttributes(),a=e.defaultAttributeValues;for(var s in o){var l=o[s];if(0<=l){var u=r[s];if(void 0!==u){var c=u.normalized,h=u.itemSize,d=S.get(u);if(void 0===d)continue;var p=d.buffer,f=d.type,m=d.bytesPerElement;if(u.isInterleavedBufferAttribute){var g=u.data,v=g.stride,y=u.offset;g&&g.isInstancedInterleavedBuffer?(U.enableAttributeAndDivisor(l,g.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):U.enableAttribute(l),H.bindBuffer(H.ARRAY_BUFFER,p),H.vertexAttribPointer(l,h,f,c,v*m,(i*v+y)*m)}else u.isInstancedBufferAttribute?(U.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):U.enableAttribute(l),H.bindBuffer(H.ARRAY_BUFFER,p),H.vertexAttribPointer(l,h,f,c,0,i*h*m)}else if(void 0!==a){var x=a[s];if(void 0!==x)switch(x.length){case 2:H.vertexAttrib2fv(l,x);break;case 3:H.vertexAttrib3fv(l,x);break;case 4:H.vertexAttrib4fv(l,x);break;default:H.vertexAttrib1fv(l,x)}}}}U.disableUnusedAttributes()}(i,s,n),null!==h&&H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,c.buffer));var m=1/0;null!==h?m=h.count:void 0!==d&&(m=d.count);var g=n.drawRange.start*p,v=n.drawRange.count*p,y=null!==o?o.start*p:0,x=null!==o?o.count*p:1/0,E=Math.max(g,y),T=Math.min(m,g+v,y+x)-1,b=Math.max(0,T-E+1);if(0!==b){if(r.isMesh)if(!0===i.wireframe)U.setLineWidth(i.wireframeLinewidth*te()),f.setMode(H.LINES);else switch(r.drawMode){case Nt:f.setMode(H.TRIANGLES);break;case Pt:f.setMode(H.TRIANGLE_STRIP);break;case Lt:f.setMode(H.TRIANGLE_FAN)}else if(r.isLine){var _=i.linewidth;void 0===_&&(_=1),U.setLineWidth(_*te()),r.isLineSegments?f.setMode(H.LINES):r.isLineLoop?f.setMode(H.LINE_LOOP):f.setMode(H.LINE_STRIP)}else r.isPoints&&f.setMode(H.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&f.renderInstances(n,E,b):f.render(E,b)}};var ce,he,de,pe=!(this.compile=function(n,e){($=m.get(n,e)).init(),n.traverse(function(e){e.isLight&&($.pushLight(e),e.castShadow&&$.pushShadow(e))}),$.setupLights(e),n.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var t=0;t<e.material.length;t++)Ee(e.material[t],n.fog,e);else Ee(e.material,n.fog,e)})}),fe=null;function me(){pe=!1}function ge(){var e=re.getDevice();e&&e.isPresenting?e.requestAnimationFrame(ve):window.requestAnimationFrame(ve)}function ve(e){!1!==pe&&(fe(e),ge())}function ye(e,t,n,i){for(var r=0,o=e.length;r<o;r++){var a=e[r],s=a.object,l=a.geometry,u=void 0===i?a.material:i,c=a.group;if(n.isArrayCamera)for(var h=(z=n).cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(s.layers.test(f.layers)){var m=f.bounds,g=m.x*F,v=m.y*j,y=m.z*F,x=m.w*j;U.viewport(_.set(g,v,y,x).multiplyScalar(W)),xe(s,t,f,l,u,c)}}else z=null,xe(s,t,n,l,u,c)}}function xe(e,t,n,i,r,o){if(e.onBeforeRender(B,t,n,i,r,o),$=m.get(t,z||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var a=e.isMesh&&e.matrixWorld.determinant()<0;U.setMaterial(r,a);var s=Te(n,t.fog,r,e);P="",l=s,u=r,e.render(function(e){B.renderBufferImmediate(e,l,u)})}else B.renderBufferDirect(n,t.fog,i,r,e,o);var l,u;e.onAfterRender(B,t,n,i,r,o),$=m.get(t,z||n)}function Ee(e,t,n){var i=D.get(e),r=$.state.lights,o=$.state.shadowsArray,a=g.getParameters(e,r.state,o,t,J.numPlanes,J.numIntersection,n),s=g.getProgramCode(e,a),l=i.program,u=!0;if(void 0===l)e.addEventListener("dispose",le);else if(l.code!==s)ue(e);else if(i.lightsHash!==r.state.hash)D.update(e,"lightsHash",r.state.hash),u=!1;else{if(void 0!==a.shaderID)return;u=!1}if(u){if(a.shaderID){var c=Nn[a.shaderID];i.shader={name:e.type,uniforms:_n.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else i.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(i.shader,B),l=g.acquireProgram(e,i.shader,a,s),i.program=l,e.program=l}var h=l.getAttributes();if(e.morphTargets)for(var d=e.numSupportedMorphTargets=0;d<B.maxMorphTargets;d++)0<=h["morphTarget"+d]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(d=e.numSupportedMorphNormals=0;d<B.maxMorphNormals;d++)0<=h["morphNormal"+d]&&e.numSupportedMorphNormals++;var p=i.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=J.numPlanes,i.numIntersection=J.numIntersection,p.clippingPlanes=J.uniform),i.fog=t,i.lightsHash=r.state.hash,e.lights&&(p.ambientLightColor.value=r.state.ambient,p.directionalLights.value=r.state.directional,p.spotLights.value=r.state.spot,p.rectAreaLights.value=r.state.rectArea,p.pointLights.value=r.state.point,p.hemisphereLights.value=r.state.hemi,p.directionalShadowMap.value=r.state.directionalShadowMap,p.directionalShadowMatrix.value=r.state.directionalShadowMatrix,p.spotShadowMap.value=r.state.spotShadowMap,p.spotShadowMatrix.value=r.state.spotShadowMatrix,p.pointShadowMap.value=r.state.pointShadowMap,p.pointShadowMatrix.value=r.state.pointShadowMatrix);var f=i.program.getUniforms(),m=fo.seqWithValue(f.seq,p);i.uniformsList=m}function Te(e,t,n,i){G=0;var r=D.get(n),o=$.state.lights;if(Q&&(Z||e!==V)){var a=e===V&&n.id===k;J.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,r,a)}!1===n.needsUpdate&&(void 0===r.program?n.needsUpdate=!0:n.fog&&r.fog!==t?n.needsUpdate=!0:n.lights&&r.lightsHash!==o.state.hash?n.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===J.numPlanes&&r.numIntersection===J.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Ee(n,t,i),n.needsUpdate=!1);var s,l,u,c,h,d,p,f,m,g,v,y,x,E,T,b,_=!1,w=!1,S=!1,M=r.program,A=M.getUniforms(),R=r.shader.uniforms;if(U.useProgram(M.program)&&(S=w=_=!0),n.id!==k&&(k=n.id,w=!0),_||e!==V){if(A.setValue(H,"projectionMatrix",e.projectionMatrix),I.logarithmicDepthBuffer&&A.setValue(H,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),V!==(z||e)&&(V=z||e,S=w=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var N=A.map.cameraPosition;void 0!==N&&N.setValue(H,ee.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&A.setValue(H,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){A.setOptional(H,i,"bindMatrix"),A.setOptional(H,i,"bindMatrixInverse");var P=i.skeleton;if(P){var L=P.bones;if(I.floatVertexTextures){if(void 0===P.boneTexture){var C=Math.sqrt(4*L.length);C=kt.ceilPowerOfTwo(C),C=Math.max(C,4);var F=new Float32Array(C*C*4);F.set(P.boneMatrices);var O=new gn(F,C,C,qe,Be);O.needsUpdate=!0,P.boneMatrices=F,P.boneTexture=O,P.boneTextureSize=C}A.setValue(H,"boneTexture",P.boneTexture),A.setValue(H,"boneTextureSize",P.boneTextureSize)}else A.setOptional(H,P,"boneMatrices")}}return w&&(A.setValue(H,"toneMappingExposure",B.toneMappingExposure),A.setValue(H,"toneMappingWhitePoint",B.toneMappingWhitePoint),n.lights&&(b=S,(T=R).ambientLightColor.needsUpdate=b,T.directionalLights.needsUpdate=b,T.pointLights.needsUpdate=b,T.spotLights.needsUpdate=b,T.rectAreaLights.needsUpdate=b,T.hemisphereLights.needsUpdate=b),t&&n.fog&&(E=t,(x=R).fogColor.value=E.color,E.isFog?(x.fogNear.value=E.near,x.fogFar.value=E.far):E.isFogExp2&&(x.fogDensity.value=E.density)),n.isMeshBasicMaterial?be(R,n):n.isMeshLambertMaterial?(be(R,n),v=R,(y=n).emissiveMap&&(v.emissiveMap.value=y.emissiveMap)):n.isMeshPhongMaterial?(be(R,n),n.isMeshToonMaterial?(_e(m=R,g=n),g.gradientMap&&(m.gradientMap.value=g.gradientMap)):_e(R,n)):n.isMeshStandardMaterial?(be(R,n),n.isMeshPhysicalMaterial?(f=n,(p=R).clearCoat.value=f.clearCoat,p.clearCoatRoughness.value=f.clearCoatRoughness,we(p,f)):we(R,n)):n.isMeshDepthMaterial?(be(R,n),h=R,(d=n).displacementMap&&(h.displacementMap.value=d.displacementMap,h.displacementScale.value=d.displacementScale,h.displacementBias.value=d.displacementBias)):n.isMeshDistanceMaterial?(be(R,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(R,n)):n.isMeshNormalMaterial?(be(R,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(R,n)):n.isLineBasicMaterial?(c=n,(u=R).diffuse.value=c.color,u.opacity.value=c.opacity,n.isLineDashedMaterial&&(l=n,(s=R).dashSize.value=l.dashSize,s.totalSize.value=l.dashSize+l.gapSize,s.scale.value=l.scale)):n.isPointsMaterial?function(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*W,e.scale.value=.5*j,e.map.value=t.map,null!==t.map){if(!0===t.map.matrixAutoUpdate){var n=t.map.offset,i=t.map.repeat,r=t.map.rotation,o=t.map.center;t.map.matrix.setUvTransform(n.x,n.y,i.x,i.y,r,o.x,o.y)}e.uvTransform.value.copy(t.map.matrix)}}(R,n):n.isShadowMaterial&&(R.color.value=n.color,R.opacity.value=n.opacity),void 0!==R.ltc_1&&(R.ltc_1.value=Rn.LTC_1),void 0!==R.ltc_2&&(R.ltc_2.value=Rn.LTC_2),fo.upload(H,r.uniformsList,R,B)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(fo.upload(H,r.uniformsList,R,B),n.uniformsNeedUpdate=!1),A.setValue(H,"modelViewMatrix",i.modelViewMatrix),A.setValue(H,"normalMatrix",i.normalMatrix),A.setValue(H,"modelMatrix",i.matrixWorld),M}function be(e,t){var n;if(e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=D.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var i=n.offset,r=n.repeat,o=n.rotation,a=n.center;n.matrix.setUvTransform(i.x,i.y,r.x,r.y,o,a.x,a.y)}e.uvTransform.value.copy(n.matrix)}}function _e(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function we(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}this.animate=function(e){null!==(fe=e)?pe||(ge(),pe=!0):me()},this.render=function(e,t,n,i){if(t&&t.isCamera){if(!E){P="",k=-1,!(V=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),re.enabled&&(t=re.getCamera(t)),($=m.get(e,t)).init(),e.onBeforeRender(B,e,t,n),K.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Y.setFromMatrix(K),Z=this.localClippingEnabled,Q=J.init(this.clippingPlanes,Z,t),(p=d.get(e,t)).init(),function e(t,n,i){if(!1===t.visible)return;var r=t.layers.test(n.layers);if(r)if(t.isLight)$.pushLight(t),t.castShadow&&$.pushShadow(t);else if(t.isSprite)t.frustumCulled&&!Y.intersectsSprite(t)||$.pushSprite(t);else if(t.isImmediateRenderObject)i&&ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4(K),p.push(t,null,t.material,ee.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||Y.intersectsObject(t))){i&&ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4(K);var o=f.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,l=0,u=s.length;l<u;l++){var c=s[l],h=a[c.materialIndex];h&&h.visible&&p.push(t,o,h,ee.z,c)}else a.visible&&p.push(t,o,a,ee.z,null)}var d=t.children;for(var l=0,u=d.length;l<u;l++)e(d[l],n,i)}(e,t,B.sortObjects),!0===B.sortObjects&&p.sort(),Q&&J.beginShadows();var r=$.state.shadowsArray;oe.render(r,e,t),$.setupLights(t),Q&&J.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),v.render(p,e,t,i);var o=p.opaque,a=p.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&ye(o,e,t,s),a.length&&ye(a,e,t,s)}else o.length&&ye(o,e,t),a.length&&ye(a,e,t);var l=$.state.spritesArray;y.render(l,e,t),n&&h.updateRenderTargetMipmap(n),U.buffers.depth.setTest(!0),U.buffers.depth.setMask(!0),U.buffers.color.setMask(!0),U.setPolygonOffset(!1),e.onAfterRender(B,e,t),re.enabled&&re.submitFrame(),$=p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=G;return e>=I.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+I.maxTextures),G+=1,e},this.setTexture2D=(ce=!1,function(e,t){e&&e.isWebGLRenderTarget&&(ce||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),ce=!0),e=e.texture),h.setTexture2D(e,t)}),this.setTexture=(he=!1,function(e,t){he||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),he=!0),h.setTexture2D(e,t)}),this.setTextureCube=(de=!1,function(e,t){e&&e.isWebGLRenderTargetCube&&(de||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),de=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?h.setTextureCube(e,t):h.setTextureCubeDynamic(e,t)}),this.getRenderTarget=function(){return T},this.setRenderTarget=function(e){(T=e)&&void 0===D.get(e).__webglFramebuffer&&h.setupRenderTarget(e);var t=null,n=!1;if(e){var i=D.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=i[e.activeCubeFace],n=!0):t=i,_.copy(e.viewport),L.copy(e.scissor),C=e.scissorTest}else _.copy(O).multiplyScalar(W),L.copy(X).multiplyScalar(W),C=q;if(b!==t&&(H.bindFramebuffer(H.FRAMEBUFFER,t),b=t),U.viewport(_),U.scissor(L),U.setScissorTest(C),n){var r=D.get(e.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,i,r,o){if(e&&e.isWebGLRenderTarget){var a=D.get(e).__webglFramebuffer;if(a){var s=!1;a!==b&&(H.bindFramebuffer(H.FRAMEBUFFER,a),s=!0);try{var l=e.texture,u=l.format,c=l.type;if(u!==qe&&x.convert(u)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Oe||x.convert(c)===H.getParameter(H.IMPLEMENTATION_COLOR_READ_TYPE)||c===Be&&(w.get("OES_texture_float")||w.get("WEBGL_color_buffer_float"))||c===ke&&w.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");H.checkFramebufferStatus(H.FRAMEBUFFER)===H.FRAMEBUFFER_COMPLETE?0<=t&&t<=e.width-i&&0<=n&&n<=e.height-r&&H.readPixels(t,n,i,r,x.convert(u),x.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&H.bindFramebuffer(H.FRAMEBUFFER,b)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var i=t.image.width,r=t.image.height,o=x.convert(t.format);this.setTexture2D(t,0),H.copyTexImage2D(H.TEXTURE_2D,n||0,o,e.x,e.y,i,r,0)},this.copyTextureToTexture=function(e,t,n,i){var r=t.image.width,o=t.image.height,a=x.convert(n.format),s=x.convert(n.type),l=t.isDataTexture?t.image.data:t.image;this.setTexture2D(n,0),H.texSubImage2D(H.TEXTURE_2D,i||0,e.x,e.y,r,o,a,s,l)}}function da(e,t){this.name="",this.color=new Sn(e),this.density=void 0!==t?t:25e-5}function pa(e,t,n){this.name="",this.color=new Sn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function fa(){Zn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ma(e){cr.call(this),this.type="SpriteMaterial",this.color=new Sn(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function ga(e){Zn.call(this),this.type="Sprite",this.material=void 0!==e?e:new ma,this.center=new Vt(.5,.5)}function va(){Zn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ya(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new zt)}}function xa(){Zn.call(this),this.type="Bone"}function Ea(e,t){gr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zt,this.bindMatrixInverse=new zt;var n=new ya(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Ta(e){cr.call(this),this.type="LineBasicMaterial",this.color=new Sn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function ba(e,t,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new _a(e,t);Zn.call(this),this.type="Line",this.geometry=void 0!==e?e:new Oi,this.material=void 0!==t?t:new Ta({color:16777215*Math.random()})}function _a(e,t){ba.call(this,e,t),this.type="LineSegments"}function wa(e,t){ba.call(this,e,t),this.type="LineLoop"}function Sa(e){cr.call(this),this.type="PointsMaterial",this.color=new Sn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function Ma(e,t){Zn.call(this),this.type="Points",this.geometry=void 0!==e?e:new Oi,this.material=void 0!==t?t:new Sa({color:16777215*Math.random()})}function Aa(){Zn.call(this),this.type="Group"}function Ra(e,t,n,i,r,o,a,s,l){dn.call(this,e,t,n,i,r,o,a,s,l),this.generateMipmaps=!1}function Na(e,t,n,i,r,o,a,s,l,u,c,h){dn.call(this,null,o,a,s,l,u,i,r,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Pa(e,t,n,i,r,o,a,s,l,u){if((u=void 0!==u?u:Ze)!==Ze&&u!==Ke)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Ze&&(n=Ie),void 0===n&&u===Ke&&(n=je),dn.call(this,null,i,r,o,a,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Re,this.minFilter=void 0!==s?s:Re,this.flipY=!1,this.generateMipmaps=!1}function La(e){Oi.call(this),this.type="WireframeGeometry";var t,n,i,r,o,a,s,l,u,c,h=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,i=m.length;t<i;t++){var g=m[t];for(n=0;n<3;n++)s=g[f[n]],l=g[f[(n+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[u=d[0]+","+d[1]]&&(p[u]={index1:d[0],index2:d[1]})}for(u in p)a=p[u],c=e.vertices[a.index1],h.push(c.x,c.y,c.z),c=e.vertices[a.index2],h.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,x,E,T,b;if(c=new jt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(x=e.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),r=0,o=x.length;r<o;++r)for(i=(t=(E=x[r]).start)+E.count;t<i;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),l=y.getX(t+(n+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[u=d[0]+","+d[1]]&&(p[u]={index1:d[0],index2:d[1]});for(u in p)a=p[u],c.fromBufferAttribute(v,a.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,a.index2),h.push(c.x,c.y,c.z)}else for(t=0,i=(v=e.attributes.position).count/3;t<i;t++)for(n=0;n<3;n++)T=3*t+n,c.fromBufferAttribute(v,T),h.push(c.x,c.y,c.z),b=3*t+(n+1)%3,c.fromBufferAttribute(v,b),h.push(c.x,c.y,c.z)}this.addAttribute("position",new xi(h,3))}function Ca(e,t,n){ci.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Fa(e,t,n)),this.mergeVertices()}function Fa(e,t,n){Oi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i,r,o=[],a=[],s=[],l=[],u=new jt,c=new jt,h=new jt,d=new jt,p=new jt,f=t+1;for(i=0;i<=n;i++){var m=i/n;for(r=0;r<=t;r++){var g=r/t;e(g,m,c),a.push(c.x,c.y,c.z),0<=g-1e-5?(e(g-1e-5,m,h),d.subVectors(c,h)):(e(g+1e-5,m,h),d.subVectors(h,c)),0<=m-1e-5?(e(g,m-1e-5,h),p.subVectors(c,h)):(e(g,m+1e-5,h),p.subVectors(h,c)),u.crossVectors(d,p).normalize(),s.push(u.x,u.y,u.z),l.push(g,m)}}for(i=0;i<n;i++)for(r=0;r<t;r++){var v=i*f+r,y=i*f+r+1,x=(i+1)*f+r+1,E=(i+1)*f+r;o.push(v,y,E),o.push(y,x,E)}this.setIndex(o),this.addAttribute("position",new xi(a,3)),this.addAttribute("normal",new xi(s,3)),this.addAttribute("uv",new xi(l,2))}function Oa(e,t,n,i){ci.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new $a(e,t,n,i)),this.mergeVertices()}function $a(i,o,e,t){Oi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:i,indices:o,radius:e,detail:t},e=e||1;var c=[],h=[];function a(e,t,n,i){var r,o,a=Math.pow(2,i),s=[];for(r=0;r<=a;r++){s[r]=[];var l=e.clone().lerp(n,r/a),u=t.clone().lerp(n,r/a),c=a-r;for(o=0;o<=c;o++)s[r][o]=0===o&&r===a?l:l.clone().lerp(u,o/c)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var h=Math.floor(o/2);o%2==0?(d(s[r][h+1]),d(s[r+1][h]),d(s[r][h])):(d(s[r][h+1]),d(s[r+1][h+1]),d(s[r+1][h]))}}function d(e){c.push(e.x,e.y,e.z)}function s(e,t){var n=3*e;t.x=i[n+0],t.y=i[n+1],t.z=i[n+2]}function p(e,t,n,i){i<0&&1===e.x&&(h[t]=e.x-1),0===n.x&&0===n.z&&(h[t]=i/2/Math.PI+.5)}function f(e){return Math.atan2(e.z,-e.x)}!function(e){for(var t=new jt,n=new jt,i=new jt,r=0;r<o.length;r+=3)s(o[r+0],t),s(o[r+1],n),s(o[r+2],i),a(t,n,i,e)}(t=t||0),function(e){for(var t=new jt,n=0;n<c.length;n+=3)t.x=c[n+0],t.y=c[n+1],t.z=c[n+2],t.normalize().multiplyScalar(e),c[n+0]=t.x,c[n+1]=t.y,c[n+2]=t.z}(e),function(){for(var e=new jt,t=0;t<c.length;t+=3){e.x=c[t+0],e.y=c[t+1],e.z=c[t+2];var n=f(e)/2/Math.PI+.5,i=(r=e,Math.atan2(-r.y,Math.sqrt(r.x*r.x+r.z*r.z))/Math.PI+.5);h.push(n,1-i)}var r;(function(){for(var e=new jt,t=new jt,n=new jt,i=new jt,r=new Vt,o=new Vt,a=new Vt,s=0,l=0;s<c.length;s+=9,l+=6){e.set(c[s+0],c[s+1],c[s+2]),t.set(c[s+3],c[s+4],c[s+5]),n.set(c[s+6],c[s+7],c[s+8]),r.set(h[l+0],h[l+1]),o.set(h[l+2],h[l+3]),a.set(h[l+4],h[l+5]),i.copy(e).add(t).add(n).divideScalar(3);var u=f(i);p(r,l+0,e,u),p(o,l+2,t,u),p(a,l+4,n,u)}})(),function(){for(var e=0;e<h.length;e+=6){var t=h[e+0],n=h[e+2],i=h[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);.9<r&&o<.1&&(t<.2&&(h[e+0]+=1),n<.2&&(h[e+2]+=1),i<.2&&(h[e+4]+=1))}}()}(),this.addAttribute("position",new xi(c,3)),this.addAttribute("normal",new xi(c.slice(),3)),this.addAttribute("uv",new xi(h,2)),0===t?this.computeVertexNormals():this.normalizeNormals()}function Ha(e,t){ci.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ia(e,t)),this.mergeVertices()}function Ia(e,t){$a.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ua(e,t){ci.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Da(e,t)),this.mergeVertices()}function Da(e,t){$a.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ba(e,t){ci.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ka(e,t)),this.mergeVertices()}function ka(e,t){var n=(1+Math.sqrt(5))/2;$a.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Va(e,t){ci.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new za(e,t)),this.mergeVertices()}function za(e,t){var n=(1+Math.sqrt(5))/2,i=1/n;$a.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ga(e,t,n,i,r,o){ci.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new ja(e,t,n,i,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function ja(a,s,l,u,e){Oi.call(this),this.type="TubeBufferGeometry",this.parameters={path:a,tubularSegments:s,radius:l,radialSegments:u,closed:e},s=s||64,l=l||1,u=u||8,e=e||!1;var c=a.computeFrenetFrames(s,e);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;var r,h,d=new jt,p=new jt,t=new Vt,f=new jt,m=[],g=[],n=[],o=[];function i(e){f=a.getPointAt(e/s,f);var t=c.normals[e],n=c.binormals[e];for(h=0;h<=u;h++){var i=h/u*Math.PI*2,r=Math.sin(i),o=-Math.cos(i);p.x=o*t.x+r*n.x,p.y=o*t.y+r*n.y,p.z=o*t.z+r*n.z,p.normalize(),g.push(p.x,p.y,p.z),d.x=f.x+l*p.x,d.y=f.y+l*p.y,d.z=f.z+l*p.z,m.push(d.x,d.y,d.z)}}!function(){for(r=0;r<s;r++)i(r);i(!1===e?s:0),function(){for(r=0;r<=s;r++)for(h=0;h<=u;h++)t.x=r/s,t.y=h/u,n.push(t.x,t.y)}(),function(){for(h=1;h<=s;h++)for(r=1;r<=u;r++){var e=(u+1)*(h-1)+(r-1),t=(u+1)*h+(r-1),n=(u+1)*h+r,i=(u+1)*(h-1)+r;o.push(e,t,i),o.push(t,n,i)}}()}(),this.setIndex(o),this.addAttribute("position",new xi(m,3)),this.addAttribute("normal",new xi(g,3)),this.addAttribute("uv",new xi(n,2))}function Wa(e,t,n,i,r,o,a){ci.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Xa(e,t,n,i,r,o)),this.mergeVertices()}function Xa(e,t,n,i,r,o){Oi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,o=o||3;var a,s,l=[],u=[],c=[],h=[],d=new jt,p=new jt,f=new jt,m=new jt,g=new jt,v=new jt,y=new jt;for(a=0;a<=n;++a){var x=a/n*r*Math.PI*2;for(A(x,r,o,e,f),A(x+.01,r,o,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=i;++s){var E=s/i*Math.PI*2,T=-t*Math.cos(E),b=t*Math.sin(E);d.x=f.x+(T*y.x+b*g.x),d.y=f.y+(T*y.y+b*g.y),d.z=f.z+(T*y.z+b*g.z),u.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),c.push(p.x,p.y,p.z),h.push(a/n),h.push(s/i)}}for(s=1;s<=n;s++)for(a=1;a<=i;a++){var _=(i+1)*(s-1)+(a-1),w=(i+1)*s+(a-1),S=(i+1)*s+a,M=(i+1)*(s-1)+a;l.push(_,w,M),l.push(w,S,M)}function A(e,t,n,i,r){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,l=Math.cos(s);r.x=i*(2+l)*.5*o,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new xi(u,3)),this.addAttribute("normal",new xi(c,3)),this.addAttribute("uv",new xi(h,2))}function qa(e,t,n,i,r){ci.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Ya(e,t,n,i,r)),this.mergeVertices()}function Ya(e,t,n,i,r){Oi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,a,s=[],l=[],u=[],c=[],h=new jt,d=new jt,p=new jt;for(o=0;o<=n;o++)for(a=0;a<=i;a++){var f=a/i*r,m=o/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),l.push(d.x,d.y,d.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(d,h).normalize(),u.push(p.x,p.y,p.z),c.push(a/i),c.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=i;a++){var g=(i+1)*o+a-1,v=(i+1)*(o-1)+a-1,y=(i+1)*(o-1)+a,x=(i+1)*o+a;s.push(g,v,x),s.push(v,y,x)}this.setIndex(s),this.addAttribute("position",new xi(l,3)),this.addAttribute("normal",new xi(u,3)),this.addAttribute("uv",new xi(c,2))}((ea.prototype=Object.create(cr.prototype)).constructor=ea).prototype.isMeshDepthMaterial=!0,ea.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},((ta.prototype=Object.create(cr.prototype)).constructor=ta).prototype.isMeshDistanceMaterial=!0,ta.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},(ia.prototype=Object.create(dn.prototype)).constructor=ia,la.prototype=Object.assign(Object.create(Kn.prototype),{constructor:la,isPerspectiveCamera:!0,copy:function(e,t){return Kn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*kt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*kt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*kt.RAD2DEG*Math.atan(Math.tan(.5*kt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*kt.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*i/a,t-=o.offsetY*n/s,i*=o.width/a,n*=o.height/s}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far)},toJSON:function(e){var t=Zn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),ua.prototype=Object.assign(Object.create(la.prototype),{constructor:ua,isArrayCamera:!0}),da.prototype.isFogExp2=!0,da.prototype.clone=function(){return new da(this.color.getHex(),this.density)},da.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},pa.prototype.isFog=!0,pa.prototype.clone=function(){return new pa(this.color.getHex(),this.near,this.far)},pa.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},fa.prototype=Object.assign(Object.create(Zn.prototype),{constructor:fa,copy:function(e,t){return Zn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Zn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),((ma.prototype=Object.create(cr.prototype)).constructor=ma).prototype.isSpriteMaterial=!0,ma.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},ga.prototype=Object.assign(Object.create(Zn.prototype),{constructor:ga,isSprite:!0,raycast:(Co=new jt,Fo=new jt,Oo=new jt,function(e,t){Fo.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(Fo,Co),Oo.setFromMatrixScale(this.matrixWorld);var n=Oo.x*Oo.y/4;if(!(Fo.distanceToSquared(Co)>n)){var i=e.ray.origin.distanceTo(Co);i<e.near||i>e.far||t.push({distance:i,point:Co.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Zn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),va.prototype=Object.assign(Object.create(Zn.prototype),{constructor:va,copy:function(e){Zn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var r=t[n];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);n.splice(i,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Io=new jt,function(e,t){Io.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Io);this.getObjectForDistance(n).raycast(e,t)}),update:($o=new jt,Ho=new jt,function(e){var t=this.levels;if(1<t.length){$o.setFromMatrixPosition(e.matrixWorld),Ho.setFromMatrixPosition(this.matrixWorld);var n=$o.distanceTo(Ho);t[0].object.visible=!0;for(var i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(;i<r;i++)t[i].object.visible=!1}}),toJSON:function(e){var t=Zn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(ya.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new zt;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Uo=new zt,Do=new zt,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,o=e.length;r<o;r++){var a=e[r]?e[r].matrixWorld:Do;Uo.multiplyMatrices(a,t[r]),Uo.toArray(n,16*r)}void 0!==i&&(i.needsUpdate=!0)}),clone:function(){return new ya(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),xa.prototype=Object.assign(Object.create(Zn.prototype),{constructor:xa,isBone:!0}),Ea.prototype=Object.assign(Object.create(gr.prototype),{constructor:Ea,isSkinnedMesh:!0,initBones:function(){var e,t,n,i,r=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,i=this.geometry.bones.length;n<i;n++)t=this.geometry.bones[n],e=new xa,r.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,i=this.geometry.bones.length;n<i;n++)-1!==(t=this.geometry.bones[n]).parent&&null!==t.parent&&void 0!==r[t.parent]?r[t.parent].add(r[n]):this.add(r[n])}return this.updateMatrixWorld(!0),r},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new pn,r=this.geometry.attributes.skinWeight;for(t=0;t<r.count;t++)i.x=r.getX(t),i.y=r.getY(t),i.z=r.getZ(t),i.w=r.getW(t),(e=1/i.manhattanLength())!==1/0?i.multiplyScalar(e):i.set(1,0,0,0),r.setXYZW(t,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function(e){gr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((Ta.prototype=Object.create(cr.prototype)).constructor=Ta).prototype.isLineBasicMaterial=!0,Ta.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},ba.prototype=Object.assign(Object.create(Zn.prototype),{constructor:ba,isLine:!0,computeLineDistances:(zo=new jt,Go=new jt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],i=1,r=t.count;i<r;i++)zo.fromBufferAttribute(t,i-1),Go.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=zo.distanceTo(Go);e.addAttribute("lineDistance",new THREE.Float32BufferAttribute(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for((n=e.lineDistances)[0]=0,i=1,r=o.length;i<r;i++)n[i]=n[i-1],n[i]+=o[i-1].distanceTo(o[i])}return this}),raycast:(Bo=new zt,ko=new pr,Vo=new yn,function(e,t){var n=e.linePrecision,i=n*n,r=this.geometry,o=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),Vo.copy(r.boundingSphere),Vo.applyMatrix4(o),!1!==e.ray.intersectsSphere(Vo)){Bo.getInverse(o),ko.copy(e.ray).applyMatrix4(Bo);var a=new jt,s=new jt,l=new jt,u=new jt,c=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var h=r.index,d=r.attributes.position.array;if(null!==h)for(var p=h.array,f=0,m=p.length-1;f<m;f+=c){var g=p[f],v=p[f+1];a.fromArray(d,3*g),s.fromArray(d,3*v),i<ko.distanceSqToSegment(a,s,u,l)||(u.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(u))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else for(f=0,m=d.length/3-1;f<m;f+=c)a.fromArray(d,3*f),s.fromArray(d,3*f+3),i<ko.distanceSqToSegment(a,s,u,l)||(u.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(u))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else if(r.isGeometry){var y=r.vertices,x=y.length;for(f=0;f<x-1;f+=c){var E;i<ko.distanceSqToSegment(y[f],y[f+1],u,l)||(u.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(u))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_a.prototype=Object.assign(Object.create(ba.prototype),{constructor:_a,isLineSegments:!0,computeLineDistances:(jo=new jt,Wo=new jt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],i=0,r=t.count;i<r;i+=2)jo.fromBufferAttribute(t,i),Wo.fromBufferAttribute(t,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+jo.distanceTo(Wo);e.addAttribute("lineDistance",new THREE.Float32BufferAttribute(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for(n=e.lineDistances,i=0,r=o.length;i<r;i+=2)jo.copy(o[i]),Wo.copy(o[i+1]),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+jo.distanceTo(Wo)}return this})}),wa.prototype=Object.assign(Object.create(ba.prototype),{constructor:wa,isLineLoop:!0}),((Sa.prototype=Object.create(cr.prototype)).constructor=Sa).prototype.isPointsMaterial=!0,Sa.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},Ma.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Ma,isPoints:!0,raycast:(Xo=new zt,qo=new pr,Yo=new yn,function(r,o){var a=this,e=this.geometry,s=this.matrixWorld,t=r.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Yo.copy(e.boundingSphere),Yo.applyMatrix4(s),Yo.radius+=t,!1!==r.ray.intersectsSphere(Yo)){Xo.getInverse(s),qo.copy(r.ray).applyMatrix4(Xo);var n=t/((this.scale.x+this.scale.y+this.scale.z)/3),l=n*n,i=new jt,u=new jt;if(e.isBufferGeometry){var c=e.index,h=e.attributes.position.array;if(null!==c)for(var d=c.array,p=0,f=d.length;p<f;p++){var m=d[p];i.fromArray(h,3*m),y(i,m)}else{p=0;for(var g=h.length/3;p<g;p++)i.fromArray(h,3*p),y(i,p)}}else{var v=e.vertices;for(p=0,g=v.length;p<g;p++)y(v[p],p)}}function y(e,t){var n=qo.distanceSqToPoint(e);if(n<l){qo.closestPointToPoint(e,u),u.applyMatrix4(s);var i=r.ray.origin.distanceTo(u);if(i<r.near||i>r.far)return;o.push({distance:i,distanceToRay:Math.sqrt(n),point:u.clone(),index:t,face:null,object:a})}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Aa.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Aa,isGroup:!0}),Ra.prototype=Object.assign(Object.create(dn.prototype),{constructor:Ra,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((Na.prototype=Object.create(dn.prototype)).constructor=Na).prototype.isCompressedTexture=!0,((Pa.prototype=Object.create(dn.prototype)).constructor=Pa).prototype.isDepthTexture=!0,(La.prototype=Object.create(Oi.prototype)).constructor=La,(Ca.prototype=Object.create(ci.prototype)).constructor=Ca,(Fa.prototype=Object.create(Oi.prototype)).constructor=Fa,(Oa.prototype=Object.create(ci.prototype)).constructor=Oa,($a.prototype=Object.create(Oi.prototype)).constructor=$a,(Ha.prototype=Object.create(ci.prototype)).constructor=Ha,(Ia.prototype=Object.create($a.prototype)).constructor=Ia,(Ua.prototype=Object.create(ci.prototype)).constructor=Ua,(Da.prototype=Object.create($a.prototype)).constructor=Da,(Ba.prototype=Object.create(ci.prototype)).constructor=Ba,(ka.prototype=Object.create($a.prototype)).constructor=ka,(Va.prototype=Object.create(ci.prototype)).constructor=Va,(za.prototype=Object.create($a.prototype)).constructor=za,(Ga.prototype=Object.create(ci.prototype)).constructor=Ga,(ja.prototype=Object.create(Oi.prototype)).constructor=ja,(Wa.prototype=Object.create(ci.prototype)).constructor=Wa,(Xa.prototype=Object.create(Oi.prototype)).constructor=Xa,(qa.prototype=Object.create(ci.prototype)).constructor=qa,(Ya.prototype=Object.create(Oi.prototype)).constructor=Ya;var Ja=function(e,t,n){n=n||2;var i,r,o,a,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=Qa(e,0,h,n,!0),p=[];if(!d)return p;if(c&&(d=function(e,t,n,i){var r,o,a,s,l,u=[];for(r=0,o=t.length;r<o;r++)a=t[r]*i,s=r<o-1?t[r+1]*i:e.length,(l=Qa(e,a,s,i,!1))===l.next&&(l.steiner=!0),u.push(ss(l));for(u.sort(rs),r=0;r<u.length;r++)os(u[r],n),n=Za(n,n.next);return n}(e,t,d,n)),e.length>80*n){i=o=e[0],r=a=e[1];for(var f=n;f<h;f+=n)(s=e[f])<i&&(i=s),(l=e[f+1])<r&&(r=l),o<s&&(o=s),a<l&&(a=l);u=0!==(u=Math.max(o-i,a-r))?1/u:0}return Ka(d,p,n,i,r,u),p};function Qa(e,t,n,i,r){var o,a;if(r===0<function(e,t,n,i){for(var r=0,o=t,a=n-i;o<n;o+=i)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}(e,t,n,i))for(o=t;o<n;o+=i)a=fs(o,e[o],e[o+1],a);else for(o=n-i;t<=o;o-=i)a=fs(o,e[o],e[o+1],a);return a&&cs(a,a.next)&&(ms(a),a=a.next),a}function Za(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!cs(i,i.next)&&0!==us(i.prev,i,i.next))i=i.next;else{if(ms(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function Ka(e,t,n,i,r,o,a){if(e){!a&&o&&function(e,t,n,i){var r=e;for(;null===r.z&&(r.z=as(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next,r!==e;);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,a,s,l,u=1;do{for(n=e,o=e=null,a=0;n;){for(a++,i=n,t=s=0;t<u&&(s++,i=i.nextZ);t++);for(l=u;0<s||0<l&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(n=(r=n).nextZ,s--):(i=(r=i).nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(1<a)}(r)}(e,i,r,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?ts(e,i,r,o):es(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),ms(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?Ka(e=ns(e,t,n),t,n,i,r,o,2):2===a&&is(e,t,n,i,r,o):Ka(Za(e),t,n,i,r,o,1);break}}}function es(e){var t=e.prev,n=e,i=e.next;if(0<=us(t,n,i))return!1;for(var r=e.next.next;r!==e.prev;){if(ls(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=us(r.prev,r,r.next))return!1;r=r.next}return!0}function ts(e,t,n,i){var r=e.prev,o=e,a=e.next;if(0<=us(r,o,a))return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=as(s,l,t,n,i),d=as(u,c,t,n,i),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&ls(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=us(p.prev,p,p.next))return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&ls(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=us(p.prev,p,p.next))return!1;p=p.prevZ}return!0}function ns(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!cs(r,o)&&hs(r,i,i.next,o)&&ds(r,o)&&ds(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),ms(i),ms(i.next),i=e=o),i=i.next}while(i!==e);return i}function is(e,t,n,i,r,o){var a,s,l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&hs(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(a,s)&&ds(a,s)&&ds(s,a)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next,n!==e;);return i}(a,s))){var c=ps(l,u);return l=Za(l,l.next),c=Za(c,c.next),Ka(l,t,n,i,r,o),void Ka(c,t,n,i,r,o)}u=u.next}l=l.next}while(l!==e)}function rs(e,t){return e.x-t.x}function os(e,t){if(t=function(e,t){var n,i=t,r=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&a<s){if((a=s)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n.prev;var l,u=n,c=n.x,h=n.y,d=1/0;i=n.next;for(;i!==u;)r>=i.x&&i.x>=c&&r!==i.x&&ls(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(r-i.x))<d||l===d&&i.x>n.x)&&ds(i,e)&&(n=i,d=l),i=i.next;return n}(e,t)){var n=ps(t,e);Za(n,n.next)}}function as(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ss(e){for(var t=e,n=e;t.x<n.x&&(n=t),(t=t.next)!==e;);return n}function ls(e,t,n,i,r,o,a,s){return 0<=(r-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(i-s)-(n-a)*(t-s)&&0<=(n-a)*(o-s)-(r-a)*(i-s)}function us(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function cs(e,t){return e.x===t.x&&e.y===t.y}function hs(e,t,n,i){return!!(cs(e,t)&&cs(n,i)||cs(e,i)&&cs(n,t))||0<us(e,t,n)!=0<us(e,t,i)&&0<us(n,i,e)!=0<us(n,i,t)}function ds(e,t){return us(e.prev,e,e.next)<0?0<=us(e,t,e.next)&&0<=us(e,e.prev,t):us(e,t,e.prev)<0||us(e,e.next,t)<0}function ps(e,t){var n=new gs(e.i,e.x,e.y),i=new gs(t.i,t.x,t.y),r=e.next,o=t.prev;return(e.next=t).prev=e,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function fs(e,t,n,i){var r=new gs(e,t,n);return i?(r.next=i.next,(r.prev=i).next.prev=r,i.next=r):(r.prev=r).next=r,r}function ms(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gs(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var vs={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},isClockWise:function(e){return vs.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],r=[];ys(e),xs(n,e);var o=e.length;t.forEach(ys);for(var a=0;a<t.length;a++)i.push(o),o+=t[a].length,xs(n,t[a]);var s=Ja(n,i);for(a=0;a<s.length;a+=3)r.push(s.slice(a,a+3));return r}};function ys(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function xs(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Es(e,t){ci.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ts(e,t)),this.mergeVertices()}function Ts(e,t){void 0!==e&&(Oi.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function bs(e,t){ci.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new _s(e,t)),this.mergeVertices()}function _s(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ci;var i=n.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Ts.call(this,i,t),this.type="TextBufferGeometry"}function ws(e,t,n,i,r,o,a){ci.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Ss(e,t,n,i,r,o,a)),this.mergeVertices()}function Ss(e,t,n,i,r,o,a){Oi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var s,l,u=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=0,h=[],d=new jt,p=new jt,f=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],x=l/n;for(s=0;s<=t;s++){var E=s/t;d.x=-e*Math.cos(i+E*r)*Math.sin(o+x*a),d.y=e*Math.cos(o+x*a),d.z=e*Math.sin(i+E*r)*Math.sin(o+x*a),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(E,1-x),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(s=0;s<t;s++){var T=h[l][s+1],b=h[l][s],_=h[l+1][s],w=h[l+1][s+1];(0!==l||0<o)&&f.push(T,b,w),(l!==n-1||u<Math.PI)&&f.push(b,_,w)}this.setIndex(f),this.addAttribute("position",new xi(m,3)),this.addAttribute("normal",new xi(g,3)),this.addAttribute("uv",new xi(v,2))}function Ms(e,t,n,i,r,o){ci.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new As(e,t,n,i,r,o)),this.mergeVertices()}function As(e,t,n,i,r,o){Oi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},e=e||.5,t=t||1,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,l,u=[],c=[],h=[],d=[],p=e,f=(t-e)/(i=void 0!==i?Math.max(1,i):1),m=new jt,g=new Vt;for(s=0;s<=i;s++){for(l=0;l<=n;l++)a=r+l/n*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<i;s++){var v=s*(n+1);for(l=0;l<n;l++){var y=a=l+v,x=a+n+1,E=a+n+2,T=a+1;u.push(y,x,T),u.push(x,E,T)}}this.setIndex(u),this.addAttribute("position",new xi(c,3)),this.addAttribute("normal",new xi(h,3)),this.addAttribute("uv",new xi(d,2))}function Rs(e,t,n,i){ci.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new Ns(e,t,n,i)),this.mergeVertices()}function Ns(e,t,n,i){Oi.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=kt.clamp(i,0,2*Math.PI);var r,o,a,s=[],l=[],u=[],c=1/t,h=new jt,d=new Vt;for(o=0;o<=t;o++){var p=n+o*c*i,f=Math.sin(p),m=Math.cos(p);for(a=0;a<=e.length-1;a++)h.x=e[a].x*f,h.y=e[a].y,h.z=e[a].x*m,l.push(h.x,h.y,h.z),d.x=o/t,d.y=a/(e.length-1),u.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var g=r=a+o*e.length,v=r+e.length,y=r+e.length+1,x=r+1;s.push(g,v,x),s.push(v,y,x)}if(this.setIndex(s),this.addAttribute("position",new xi(l,3)),this.addAttribute("uv",new xi(u,2)),this.computeVertexNormals(),i===2*Math.PI){var E=this.attributes.normal.array,T=new jt,b=new jt,_=new jt;for(r=t*e.length*3,a=o=0;o<e.length;o++,a+=3)T.x=E[a+0],T.y=E[a+1],T.z=E[a+2],b.x=E[r+a+0],b.y=E[r+a+1],b.z=E[r+a+2],_.addVectors(T,b).normalize(),E[a+0]=E[r+a+0]=_.x,E[a+1]=E[r+a+1]=_.y,E[a+2]=E[r+a+2]=_.z}}function Ps(e,t){ci.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ls(e,t)),this.mergeVertices()}function Ls(e,f){Oi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:f},f=f||12;var m=[],g=[],v=[],y=[],t=0,x=0;if(!1===Array.isArray(e))i(e);else for(var n=0;n<e.length;n++)i(e[n]),this.addGroup(t,x,n),t+=x,x=0;function i(e){var t,n,i,r=g.length/3,o=e.extractPoints(f),a=o.shape,s=o.holes;if(!1===vs.isClockWise(a))for(a=a.reverse(),t=0,n=s.length;t<n;t++)i=s[t],!0===vs.isClockWise(i)&&(s[t]=i.reverse());var l=vs.triangulateShape(a,s);for(t=0,n=s.length;t<n;t++)i=s[t],a=a.concat(i);for(t=0,n=a.length;t<n;t++){var u=a[t];g.push(u.x,u.y,0),v.push(0,0,1),y.push(u.x,u.y)}for(t=0,n=l.length;t<n;t++){var c=l[t],h=c[0]+r,d=c[1]+r,p=c[2]+r;m.push(h,d,p),x+=3}}this.setIndex(m),this.addAttribute("position",new xi(g,3)),this.addAttribute("normal",new xi(v,3)),this.addAttribute("uv",new xi(y,2))}function Cs(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function Fs(e,t){Oi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,i,r,o,a=[],s=Math.cos(kt.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(o=new ci).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)n=m[c[g]],i=m[c[(g+1)%3]],l[0]=Math.min(n,i),l[1]=Math.max(n,i),void 0===u[r=l[0]+","+l[1]]?u[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:u[r].face2=p;for(r in u){var v=u[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];a.push(y.x,y.y,y.z),y=h[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new xi(a,3))}function Os(e,t,n,i,r,o,a,s){ci.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new $s(e,t,n,i,r,o,a,s)),this.mergeVertices()}function $s(v,y,x,E,T,e,b,_){Oi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:v,radiusBottom:y,height:x,radialSegments:E,heightSegments:T,openEnded:e,thetaStart:b,thetaLength:_};var w=this;v=void 0!==v?v:1,y=void 0!==y?y:1,x=x||1,E=Math.floor(E)||8,T=Math.floor(T)||1,e=void 0!==e&&e,b=void 0!==b?b:0,_=void 0!==_?_:2*Math.PI;var S=[],M=[],A=[],R=[],N=0,P=[],L=x/2,C=0;function t(e){var t,n,i,r=new Vt,o=new jt,a=0,s=!0===e?v:y,l=!0===e?1:-1;for(n=N,t=1;t<=E;t++)M.push(0,L*l,0),A.push(0,l,0),R.push(.5,.5),N++;for(i=N,t=0;t<=E;t++){var u=t/E*_+b,c=Math.cos(u),h=Math.sin(u);o.x=s*h,o.y=L*l,o.z=s*c,M.push(o.x,o.y,o.z),A.push(0,l,0),r.x=.5*c+.5,r.y=.5*h*l+.5,R.push(r.x,r.y),N++}for(t=0;t<E;t++){var d=n+t,p=i+t;!0===e?S.push(p,p+1,d):S.push(p+1,p,d),a+=3}w.addGroup(C,a,!0===e?1:2),C+=a}!function(){var e,t,n=new jt,i=new jt,r=0,o=(y-v)/x;for(t=0;t<=T;t++){var a=[],s=t/T,l=s*(y-v)+v;for(e=0;e<=E;e++){var u=e/E,c=u*_+b,h=Math.sin(c),d=Math.cos(c);i.x=l*h,i.y=-s*x+L,i.z=l*d,M.push(i.x,i.y,i.z),n.set(h,o,d).normalize(),A.push(n.x,n.y,n.z),R.push(u,1-s),a.push(N++)}P.push(a)}for(e=0;e<E;e++)for(t=0;t<T;t++){var p=P[t][e],f=P[t+1][e],m=P[t+1][e+1],g=P[t][e+1];S.push(p,f,g),S.push(f,m,g),r+=6}w.addGroup(C,r,0),C+=r}(),!1===e&&(0<v&&t(!0),0<y&&t(!1)),this.setIndex(S),this.addAttribute("position",new xi(M,3)),this.addAttribute("normal",new xi(A,3)),this.addAttribute("uv",new xi(R,2))}function Hs(e,t,n,i,r,o,a){Os.call(this,0,e,t,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function Is(e,t,n,i,r,o,a){$s.call(this,0,e,t,n,i,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function Us(e,t,n,i){ci.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Ds(e,t,n,i)),this.mergeVertices()}function Ds(e,t,n,i){Oi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,o,a=[],s=[],l=[],u=[],c=new jt,h=new Vt;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=n+o/t*i;c.x=e*Math.cos(d),c.y=e*Math.sin(d),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[r]/e+1)/2,h.y=(s[r+1]/e+1)/2,u.push(h.x,h.y)}for(r=1;r<=t;r++)a.push(r,r+1,0);this.setIndex(a),this.addAttribute("position",new xi(s,3)),this.addAttribute("normal",new xi(l,3)),this.addAttribute("uv",new xi(u,2))}(Es.prototype=Object.create(ci.prototype)).constructor=Es,((Ts.prototype=Object.create(Oi.prototype)).constructor=Ts).prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],n=this.getAttribute("uv"),i=n?Array.prototype.slice.call(n.array):[],r=this.index;return{position:t,uv:i,index:r?Array.prototype.slice.call(r.array):[]}},Ts.prototype.addShapeList=function(e,t){var n=e.length;t.arrays=this.getArrays();for(var i=0;i<n;i++){var r=e[i];this.addShape(r,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new xi(t.arrays.position,3)),this.addAttribute("uv",new xi(t.arrays.uv,2))},Ts.prototype.addShape=function(e,t){var n,i,r,o,a,s,l,u,c=t.arrays?t.arrays:this.getArrays(),h=c.position,d=c.index,p=c.uv,f=[],m=void 0!==t.amount?t.amount:100,g=void 0!==t.bevelThickness?t.bevelThickness:6,v=void 0!==t.bevelSize?t.bevelSize:g-2,y=void 0!==t.bevelSegments?t.bevelSegments:3,x=void 0===t.bevelEnabled||t.bevelEnabled,E=void 0!==t.curveSegments?t.curveSegments:12,T=void 0!==t.steps?t.steps:1,b=t.extrudePath,_=!1,w=void 0!==t.UVGenerator?t.UVGenerator:Es.WorldUVGenerator;b&&(n=b.getSpacedPoints(T),x=!(_=!0),i=void 0!==t.frames?t.frames:b.computeFrenetFrames(T,!1),r=new jt,o=new jt,a=new jt),x||(v=g=y=0);var S=this,M=e.extractPoints(E),A=M.shape,R=M.holes;if(!vs.isClockWise(A))for(A=A.reverse(),l=0,u=R.length;l<u;l++)s=R[l],vs.isClockWise(s)&&(R[l]=s.reverse());var N=vs.triangulateShape(A,R),P=A;for(l=0,u=R.length;l<u;l++)s=R[l],A=A.concat(s);function L(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var C,F,O,$,H,I,U=A.length,D=N.length;function B(e,t,n){var i,r,o,a=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=a*a+s*s,h=a*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),p=Math.sqrt(l*l+u*u),f=t.x-s/d,m=t.y+a/d,g=((n.x-u/p-f)*u-(n.y+l/p-m)*l)/(a*u-s*l),v=(i=f+a*g-e.x)*i+(r=m+s*g-e.y)*r;if(v<=2)return new Vt(i,r);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?l>Number.EPSILON&&(y=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(i=-s,r=a,o=Math.sqrt(c)):(i=a,r=s,o=Math.sqrt(c/2))}return new Vt(i/o,r/o)}for(var k=[],V=0,z=P.length,G=z-1,j=V+1;V<z;V++,G++,j++)G===z&&(G=0),j===z&&(j=0),k[V]=B(P[V],P[G],P[j]);var W,X,q=[],Y=k.concat();for(l=0,u=R.length;l<u;l++){for(s=R[l],W=[],V=0,G=(z=s.length)-1,j=V+1;V<z;V++,G++,j++)G===z&&(G=0),j===z&&(j=0),W[V]=B(s[V],s[G],s[j]);q.push(W),Y=Y.concat(W)}for(C=0;C<y;C++){for(O=C/y,$=g*Math.cos(O*Math.PI/2),F=v*Math.sin(O*Math.PI/2),V=0,z=P.length;V<z;V++)Q((H=L(P[V],k[V],F)).x,H.y,-$);for(l=0,u=R.length;l<u;l++)for(s=R[l],W=q[l],V=0,z=s.length;V<z;V++)Q((H=L(s[V],W[V],F)).x,H.y,-$)}for(F=v,V=0;V<U;V++)H=x?L(A[V],Y[V],F):A[V],_?(o.copy(i.normals[0]).multiplyScalar(H.x),r.copy(i.binormals[0]).multiplyScalar(H.y),a.copy(n[0]).add(o).add(r),Q(a.x,a.y,a.z)):Q(H.x,H.y,0);for(X=1;X<=T;X++)for(V=0;V<U;V++)H=x?L(A[V],Y[V],F):A[V],_?(o.copy(i.normals[X]).multiplyScalar(H.x),r.copy(i.binormals[X]).multiplyScalar(H.y),a.copy(n[X]).add(o).add(r),Q(a.x,a.y,a.z)):Q(H.x,H.y,m/T*X);for(C=y-1;0<=C;C--){for(O=C/y,$=g*Math.cos(O*Math.PI/2),F=v*Math.sin(O*Math.PI/2),V=0,z=P.length;V<z;V++)Q((H=L(P[V],k[V],F)).x,H.y,m+$);for(l=0,u=R.length;l<u;l++)for(s=R[l],W=q[l],V=0,z=s.length;V<z;V++)H=L(s[V],W[V],F),_?Q(H.x,H.y+n[T-1].y,n[T-1].x+$):Q(H.x,H.y,m+$)}function J(e,t){var n,i;for(V=e.length;0<=--V;){(i=(n=V)-1)<0&&(i=e.length-1);var r=0,o=T+2*y;for(r=0;r<o;r++){var a=U*r,s=U*(r+1);K(t+n+a,t+i+a,t+i+s,t+n+s)}}}function Q(e,t,n){f.push(e),f.push(t),f.push(n)}function Z(e,t,n){ee(e),ee(t),ee(n);var i=h.length/3,r=w.generateTopUV(S,h,i-3,i-2,i-1);te(r[0]),te(r[1]),te(r[2])}function K(e,t,n,i){ee(e),ee(t),ee(i),ee(t),ee(n),ee(i);var r=h.length/3,o=w.generateSideWallUV(S,h,r-6,r-3,r-2,r-1);te(o[0]),te(o[1]),te(o[3]),te(o[1]),te(o[2]),te(o[3])}function ee(e){d.push(h.length/3),h.push(f[3*e+0]),h.push(f[3*e+1]),h.push(f[3*e+2])}function te(e){p.push(e.x),p.push(e.y)}!function(){var e=h.length/3;if(x){var t=0,n=U*t;for(V=0;V<D;V++)Z((I=N[V])[2]+n,I[1]+n,I[0]+n);for(n=U*(t=T+2*y),V=0;V<D;V++)Z((I=N[V])[0]+n,I[1]+n,I[2]+n)}else{for(V=0;V<D;V++)Z((I=N[V])[2],I[1],I[0]);for(V=0;V<D;V++)Z((I=N[V])[0]+U*T,I[1]+U*T,I[2]+U*T)}S.addGroup(e,h.length/3-e,0)}(),function(){var e=h.length/3,t=0;for(J(P,t),t+=P.length,l=0,u=R.length;l<u;l++)J(s=R[l],t),t+=s.length;S.addGroup(e,h.length/3-e,1)}(),t.arrays||(this.setIndex(d),this.addAttribute("position",new xi(h,3)),this.addAttribute("uv",new xi(p,2)))},Es.WorldUVGenerator={generateTopUV:function(e,t,n,i,r){var o=t[3*n],a=t[3*n+1],s=t[3*i],l=t[3*i+1],u=t[3*r],c=t[3*r+1];return[new Vt(o,a),new Vt(s,l),new Vt(u,c)]},generateSideWallUV:function(e,t,n,i,r,o){var a=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*i],c=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-c)<.01?[new Vt(a,1-l),new Vt(u,1-h),new Vt(d,1-f),new Vt(m,1-v)]:[new Vt(s,1-l),new Vt(c,1-h),new Vt(p,1-f),new Vt(g,1-v)]}},(bs.prototype=Object.create(ci.prototype)).constructor=bs,(_s.prototype=Object.create(Ts.prototype)).constructor=_s,(ws.prototype=Object.create(ci.prototype)).constructor=ws,(Ss.prototype=Object.create(Oi.prototype)).constructor=Ss,(Ms.prototype=Object.create(ci.prototype)).constructor=Ms,(As.prototype=Object.create(Oi.prototype)).constructor=As,(Rs.prototype=Object.create(ci.prototype)).constructor=Rs,(Ns.prototype=Object.create(Oi.prototype)).constructor=Ns,((Ps.prototype=Object.create(ci.prototype)).constructor=Ps).prototype.toJSON=function(){var e=ci.prototype.toJSON.call(this);return Cs(this.parameters.shapes,e)},((Ls.prototype=Object.create(Oi.prototype)).constructor=Ls).prototype.toJSON=function(){var e=Oi.prototype.toJSON.call(this);return Cs(this.parameters.shapes,e)},(Fs.prototype=Object.create(Oi.prototype)).constructor=Fs,(Os.prototype=Object.create(ci.prototype)).constructor=Os,($s.prototype=Object.create(Oi.prototype)).constructor=$s,(Hs.prototype=Object.create(Os.prototype)).constructor=Hs,(Is.prototype=Object.create($s.prototype)).constructor=Is,(Us.prototype=Object.create(ci.prototype)).constructor=Us,(Ds.prototype=Object.create(Oi.prototype)).constructor=Ds;var Bs=Object.freeze({WireframeGeometry:La,ParametricGeometry:Ca,ParametricBufferGeometry:Fa,TetrahedronGeometry:Ha,TetrahedronBufferGeometry:Ia,OctahedronGeometry:Ua,OctahedronBufferGeometry:Da,IcosahedronGeometry:Ba,IcosahedronBufferGeometry:ka,DodecahedronGeometry:Va,DodecahedronBufferGeometry:za,PolyhedronGeometry:Oa,PolyhedronBufferGeometry:$a,TubeGeometry:Ga,TubeBufferGeometry:ja,TorusKnotGeometry:Wa,TorusKnotBufferGeometry:Xa,TorusGeometry:qa,TorusBufferGeometry:Ya,TextGeometry:bs,TextBufferGeometry:_s,SphereGeometry:ws,SphereBufferGeometry:Ss,RingGeometry:Ms,RingBufferGeometry:As,PlaneGeometry:Ii,PlaneBufferGeometry:Ui,LatheGeometry:Rs,LatheBufferGeometry:Ns,ShapeGeometry:Ps,ShapeBufferGeometry:Ls,ExtrudeGeometry:Es,ExtrudeBufferGeometry:Ts,EdgesGeometry:Fs,ConeGeometry:Hs,ConeBufferGeometry:Is,CylinderGeometry:Os,CylinderBufferGeometry:$s,CircleGeometry:Us,CircleBufferGeometry:Ds,BoxGeometry:$i,BoxBufferGeometry:Hi});function ks(e){cr.call(this),this.type="ShadowMaterial",this.color=new Sn(0),this.transparent=!0,this.setValues(e)}function Vs(e){dr.call(this,e),this.type="RawShaderMaterial"}function zs(e){cr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Sn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Gs(e){zs.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function js(e){cr.call(this),this.type="MeshPhongMaterial",this.color=new Sn(16777215),this.specular=new Sn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ws(e){js.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Xs(e){cr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function qs(e){cr.call(this),this.type="MeshLambertMaterial",this.color=new Sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ys(e){Ta.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}((ks.prototype=Object.create(cr.prototype)).constructor=ks).prototype.isShadowMaterial=!0,ks.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this},((Vs.prototype=Object.create(dr.prototype)).constructor=Vs).prototype.isRawShaderMaterial=!0,((zs.prototype=Object.create(cr.prototype)).constructor=zs).prototype.isMeshStandardMaterial=!0,zs.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Gs.prototype=Object.create(zs.prototype)).constructor=Gs).prototype.isMeshPhysicalMaterial=!0,Gs.prototype.copy=function(e){return zs.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},((js.prototype=Object.create(cr.prototype)).constructor=js).prototype.isMeshPhongMaterial=!0,js.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Ws.prototype=Object.create(js.prototype)).constructor=Ws).prototype.isMeshToonMaterial=!0,Ws.prototype.copy=function(e){return js.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},((Xs.prototype=Object.create(cr.prototype)).constructor=Xs).prototype.isMeshNormalMaterial=!0,Xs.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((qs.prototype=Object.create(cr.prototype)).constructor=qs).prototype.isMeshLambertMaterial=!0,qs.prototype.copy=function(e){return cr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Ys.prototype=Object.create(Ta.prototype)).constructor=Ys).prototype.isLineDashedMaterial=!0,Ys.prototype.copy=function(e){return Ta.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Js=Object.freeze({ShadowMaterial:ks,SpriteMaterial:ma,RawShaderMaterial:Vs,ShaderMaterial:dr,PointsMaterial:Sa,MeshPhysicalMaterial:Gs,MeshStandardMaterial:zs,MeshPhongMaterial:js,MeshToonMaterial:Ws,MeshNormalMaterial:Xs,MeshLambertMaterial:qs,MeshDepthMaterial:ea,MeshDistanceMaterial:ta,MeshBasicMaterial:hr,LineDashedMaterial:Ys,LineBasicMaterial:Ta,Material:cr}),Qs={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Zs(e,t,n){var i=this,r=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===r&&void 0!==i.onStart&&i.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var Ks=new Zs,el={};function tl(e){this.manager=void 0!==e?e:Ks}function nl(e){this.manager=void 0!==e?e:Ks,this._parser=null}function il(e){this.manager=void 0!==e?e:Ks,this._parser=null}function rl(e){this.manager=void 0!==e?e:Ks}function ol(e){this.manager=void 0!==e?e:Ks}function al(e){this.manager=void 0!==e?e:Ks}function sl(){this.type="Curve",this.arcLengthDivisions=200}function ll(e,t,n,i,r,o,a,s){sl.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function ul(e,t,n,i,r,o){ll.call(this,e,t,n,n,i,r,o),this.type="ArcCurve"}function cl(){var r=0,o=0,a=0,s=0;function u(e,t,n,i){a=-3*(r=e)+3*t-2*(o=n)-i,s=2*e-2*t+n+i}return{initCatmullRom:function(e,t,n,i,r){u(t,n,r*(n-e),r*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,r,o,a){var s=(t-e)/r-(n-e)/(r+o)+(n-t)/o,l=(n-t)/o-(i-t)/(o+a)+(i-n)/a;u(t,n,s*=o,l*=o)},calc:function(e){var t=e*e;return r+o*e+a*t+s*(t*e)}}}Object.assign(tl.prototype,{load:function(a,e,t,n){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);var s=this,i=Qs.get(a);if(void 0!==i)return s.manager.itemStart(a),setTimeout(function(){e&&e(i),s.manager.itemEnd(a)},0),i;if(void 0===el[a]){var r=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(r){var o=r[1],l=!!r[2],u=r[3];u=window.decodeURIComponent(u),l&&(u=window.atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),p=0;p<u.length;p++)d[p]=u.charCodeAt(p);c="blob"===h?new Blob([d.buffer],{type:o}):d.buffer;break;case"document":var f=new DOMParser;c=f.parseFromString(u,o);break;case"json":c=JSON.parse(u);break;default:c=u}window.setTimeout(function(){e&&e(c),s.manager.itemEnd(a)},0)}catch(e){window.setTimeout(function(){n&&n(e),s.manager.itemEnd(a),s.manager.itemError(a)},0)}}else{el[a]=[],el[a].push({onLoad:e,onProgress:t,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",a,!0),m.addEventListener("load",function(e){var t=this.response;Qs.add(a,t);var n=el[a];if(delete el[a],200===this.status){for(var i=0,r=n.length;i<r;i++){(o=n[i]).onLoad&&o.onLoad(t)}s.manager.itemEnd(a)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(i=0,r=n.length;i<r;i++){(o=n[i]).onLoad&&o.onLoad(t)}s.manager.itemEnd(a)}else{for(i=0,r=n.length;i<r;i++){var o;(o=n[i]).onError&&o.onError(e)}s.manager.itemEnd(a),s.manager.itemError(a)}},!1),m.addEventListener("progress",function(e){for(var t=el[a],n=0,i=t.length;n<i;n++){var r=t[n];r.onProgress&&r.onProgress(e)}},!1),m.addEventListener("error",function(e){var t=el[a];delete el[a];for(var n=0,i=t.length;n<i;n++){var r=t[n];r.onError&&r.onError(e)}s.manager.itemEnd(a),s.manager.itemError(a)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return s.manager.itemStart(a),m}el[a].push({onLoad:e,onProgress:t,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(nl.prototype,{load:function(e,o,t,i){var a=this,s=[],l=new Na;l.image=s;var r=new tl(this.manager);function n(n){r.load(e[n],function(e){var t=a._parser(e,!0);s[n]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(u+=1)&&(1===t.mipmapCount&&(l.minFilter=Le),l.format=t.format,l.needsUpdate=!0,o&&o(l))},t,i)}if(r.setPath(this.path),r.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,h=e.length;c<h;++c)n(c);else r.load(e,function(e){var t=a._parser(e,!0);if(t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,i=0;i<n;i++){s[i]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)s[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+r]),s[i].format=t.format,s[i].width=t.width,s[i].height=t.height}else l.image.width=t.width,l.image.height=t.height,l.mipmaps=t.mipmaps;1===t.mipmapCount&&(l.minFilter=Le),l.format=t.format,l.needsUpdate=!0,o&&o(l)},t,i);return l},setPath:function(e){return this.path=e,this}}),Object.assign(il.prototype,{load:function(e,n,t,i){var r=this,o=new gn,a=new tl(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var t=r._parser(e);t&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:_e,o.wrapT=void 0!==t.wrapT?t.wrapT:_e,o.magFilter=void 0!==t.magFilter?t.magFilter:Le,o.minFilter=void 0!==t.minFilter?t.minFilter:Fe,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=Le),o.needsUpdate=!0,n&&n(o,t))},t,i),o}}),Object.assign(rl.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=Qs.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){Qs.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemEnd(t),r.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ol.prototype,{crossOrigin:"Anonymous",load:function(e,n,t,i){var r=new Rr,o=new rl(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(t){o.load(e[t],function(e){r.images[t]=e,6===++a&&(r.needsUpdate=!0,n&&n(r))},void 0,i)}for(var l=0;l<e.length;++l)s(l);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(al.prototype,{crossOrigin:"Anonymous",load:function(n,i,e,t){var r=new dn,o=new rl(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(n,function(e){r.image=e;var t=0<n.search(/\.(jpg|jpeg)$/)||0===n.search(/^data\:image\/jpeg/);r.format=t?Xe:qe,r.needsUpdate=!0,void 0!==i&&i(r)},e,t),r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(sl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(r),i.push(o),r=t;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,i=this.getLengths(),r=0,o=i.length;n=t||e*i[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=i[r=Math.floor(s+(l-s)/2)]-n)<0)s=r+1;else{if(!(0<a)){l=r;break}l=r-1}if(i[r=l]===n)return r/(o-1);var u=i[r];return(r+(n-u)/(i[r+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),1<n&&(n=1);var i=this.getPoint(t);return this.getPoint(n).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,i,r,o=new jt,a=[],s=[],l=[],u=new jt,c=new zt;for(n=0;n<=e;n++)i=n/e,a[n]=this.getTangentAt(i),a[n].normalize();s[0]=new jt,l[0]=new jt;var h=Number.MAX_VALUE,d=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z);for(d<=h&&(h=d,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),f<=h&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(a[n-1],a[n]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(kt.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,r))),l[n].crossVectors(a[n],s[n]);if(!0===t)for(r=Math.acos(kt.clamp(s[0].dot(s[e]),-1,1)),r/=e,0<a[0].dot(u.crossVectors(s[0],s[e]))&&(r=-r),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],r*n)),l[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),((ll.prototype=Object.create(sl.prototype)).constructor=ll).prototype.isEllipseCurve=!0,ll.prototype.getPoint=function(e,t){for(var n=t||new Vt,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;i<r;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);var a=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)},ll.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ll.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},ll.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},((ul.prototype=Object.create(ll.prototype)).constructor=ul).prototype.isArcCurve=!0;var hl=new jt,dl=new cl,pl=new cl,fl=new cl;function ml(e,t,n,i){sl.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function gl(e,t,n,i,r){var o=.5*(i-t),a=.5*(r-n),s=e*e;return(2*n-2*i+o+a)*(e*s)+(-3*n+3*i-2*o-a)*s+o*e+n}function vl(e,t,n,i){return(a=1-e)*a*t+2*(1-(o=e))*o*n+(r=e)*r*i;var r,o,a}function yl(e,t,n,i,r){return(u=1-e)*u*u*t+3*(l=1-(s=e))*l*s*n+3*(1-(a=e))*a*a*i+(o=e)*o*o*r;var o,a,s,l,u}function xl(e,t,n,i){sl.call(this),this.type="CubicBezierCurve",this.v0=e||new Vt,this.v1=t||new Vt,this.v2=n||new Vt,this.v3=i||new Vt}function El(e,t,n,i){sl.call(this),this.type="CubicBezierCurve3",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt,this.v3=i||new jt}function Tl(e,t){sl.call(this),this.type="LineCurve",this.v1=e||new Vt,this.v2=t||new Vt}function bl(e,t){sl.call(this),this.type="LineCurve3",this.v1=e||new jt,this.v2=t||new jt}function _l(e,t,n){sl.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Vt,this.v1=t||new Vt,this.v2=n||new Vt}function wl(e,t,n){sl.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt}function Sl(e){sl.call(this),this.type="SplineCurve",this.points=e||[]}((ml.prototype=Object.create(sl.prototype)).constructor=ml).prototype.isCatmullRomCurve3=!0,ml.prototype.getPoint=function(e,t){var n,i,r,o,a=t||new jt,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),h=u-c;if(this.closed?c+=0<c?0:(Math.floor(Math.abs(c)/s.length)+1)*s.length:0===h&&c===l-1&&(c=l-2,h=1),this.closed||0<c?n=s[(c-1)%l]:(hl.subVectors(s[0],s[1]).add(s[0]),n=hl),i=s[c%l],r=s[(c+1)%l],this.closed||c+2<l?o=s[(c+2)%l]:(hl.subVectors(s[l-1],s[l-2]).add(s[l-1]),o=hl),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(i),d),f=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),dl.initNonuniformCatmullRom(n.x,i.x,r.x,o.x,p,f,m),pl.initNonuniformCatmullRom(n.y,i.y,r.y,o.y,p,f,m),fl.initNonuniformCatmullRom(n.z,i.z,r.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(dl.initCatmullRom(n.x,i.x,r.x,o.x,this.tension),pl.initCatmullRom(n.y,i.y,r.y,o.y,this.tension),fl.initCatmullRom(n.z,i.z,r.z,o.z,this.tension));return a.set(dl.calc(h),pl.calc(h),fl.calc(h)),a},ml.prototype.copy=function(e){sl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ml.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ml.prototype.fromJSON=function(e){sl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new jt).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},((xl.prototype=Object.create(sl.prototype)).constructor=xl).prototype.isCubicBezierCurve=!0,xl.prototype.getPoint=function(e,t){var n=t||new Vt,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(yl(e,i.x,r.x,o.x,a.x),yl(e,i.y,r.y,o.y,a.y)),n},xl.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},xl.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},xl.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((El.prototype=Object.create(sl.prototype)).constructor=El).prototype.isCubicBezierCurve3=!0,El.prototype.getPoint=function(e,t){var n=t||new jt,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(yl(e,i.x,r.x,o.x,a.x),yl(e,i.y,r.y,o.y,a.y),yl(e,i.z,r.z,o.z,a.z)),n},El.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},El.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},El.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((Tl.prototype=Object.create(sl.prototype)).constructor=Tl).prototype.isLineCurve=!0,Tl.prototype.getPoint=function(e,t){var n=t||new Vt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Tl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Tl.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Tl.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Tl.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Tl.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((bl.prototype=Object.create(sl.prototype)).constructor=bl).prototype.isLineCurve3=!0,bl.prototype.getPoint=function(e,t){var n=t||new jt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},bl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},bl.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},bl.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},bl.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((_l.prototype=Object.create(sl.prototype)).constructor=_l).prototype.isQuadraticBezierCurve=!0,_l.prototype.getPoint=function(e,t){var n=t||new Vt,i=this.v0,r=this.v1,o=this.v2;return n.set(vl(e,i.x,r.x,o.x),vl(e,i.y,r.y,o.y)),n},_l.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_l.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_l.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((wl.prototype=Object.create(sl.prototype)).constructor=wl).prototype.isQuadraticBezierCurve3=!0,wl.prototype.getPoint=function(e,t){var n=t||new jt,i=this.v0,r=this.v1,o=this.v2;return n.set(vl(e,i.x,r.x,o.x),vl(e,i.y,r.y,o.y),vl(e,i.z,r.z,o.z)),n},wl.prototype.copy=function(e){return sl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},wl.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},wl.prototype.fromJSON=function(e){return sl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((Sl.prototype=Object.create(sl.prototype)).constructor=Sl).prototype.isSplineCurve=!0,Sl.prototype.getPoint=function(e,t){var n=t||new Vt,i=this.points,r=(i.length-1)*e,o=Math.floor(r),a=r-o,s=i[0===o?o:o-1],l=i[o],u=i[o>i.length-2?i.length-1:o+1],c=i[o>i.length-3?i.length-1:o+2];return n.set(gl(a,s.x,l.x,u.x,c.x),gl(a,s.y,l.y,u.y,c.y)),n},Sl.prototype.copy=function(e){sl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this},Sl.prototype.toJSON=function(){var e=sl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e},Sl.prototype.fromJSON=function(e){sl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new Vt).fromArray(i))}return this};var Ml=Object.freeze({ArcCurve:ul,CatmullRomCurve3:ml,CubicBezierCurve:xl,CubicBezierCurve3:El,EllipseCurve:ll,LineCurve:Tl,LineCurve3:bl,QuadraticBezierCurve:_l,QuadraticBezierCurve3:wl,SplineCurve:Sl});function Al(){sl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Rl(e){Al.call(this),this.type="Path",this.currentPoint=new Vt,e&&this.setFromPoints(e)}function Nl(e){Rl.call(this,e),this.uuid=kt.generateUUID(),this.type="Shape",this.holes=[]}function Pl(e,t){Zn.call(this),this.type="Light",this.color=new Sn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ll(e,t,n){Pl.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.groundColor=new Sn(t)}function Cl(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Vt(512,512),this.map=null,this.matrix=new zt}function Fl(){Cl.call(this,new la(50,1,.5,500))}function Ol(e,t,n,i,r,o){Pl.call(this,e,t),this.type="SpotLight",this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.target=new Zn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Fl}function $l(e,t,n,i){Pl.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Cl(new la(90,1,.5,500))}function Hl(){Cl.call(this,new ei(-5,5,5,-5,.5,500))}function Il(e,t){Pl.call(this,e,t),this.type="DirectionalLight",this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.target=new Zn,this.shadow=new Hl}function Ul(e,t){Pl.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Dl(e,t,n,i){Pl.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function Bl(e,t,n,i){Ql.call(this,e,t,n,i)}function kl(e,t,n){Ql.call(this,e,t,n)}function Vl(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function zl(e,t,n,i){Vl.call(this,e,t,n,i)}function Gl(e,t,n,i){Ql.call(this,e,t,n,i)}function jl(e,t,n,i){Ql.call(this,e,t,n,i)}function Wl(e,t,n,i){Ql.call(this,e,t,n,i)}function Xl(e,t,n,i){Vl.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ql(e,t,n,i){Vl.call(this,e,t,n,i)}function Yl(e,t,n,i){Vl.call(this,e,t,n,i)}Al.prototype=Object.assign(Object.create(sl.prototype),{constructor:Al,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Tl(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var r=n[i]-t,o=this.curves[i],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],a=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){sl.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=sl.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){sl.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push((new Ml[i.type]).fromJSON(i))}return this}}),Rl.prototype=Object.assign(Object.create(Al.prototype),{constructor:Rl,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new Tl(this.currentPoint.clone(),new Vt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,i){var r=new _l(this.currentPoint.clone(),new Vt(e,t),new Vt(n,i));this.curves.push(r),this.currentPoint.set(n,i)},bezierCurveTo:function(e,t,n,i,r,o){var a=new xl(this.currentPoint.clone(),new Vt(e,t),new Vt(n,i),new Vt(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(e){var t=new Sl([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,i,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,i,r,o)},absarc:function(e,t,n,i,r,o){this.absellipse(e,t,n,n,i,r,o)},ellipse:function(e,t,n,i,r,o,a,s){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,n,i,r,o,a,s)},absellipse:function(e,t,n,i,r,o,a,s){var l=new ll(e,t,n,i,r,o,a,s);if(0<this.curves.length){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return Al.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Al.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Al.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Nl.prototype=Object.assign(Object.create(Rl.prototype),{constructor:Nl,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Rl.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=Rl.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){Rl.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push((new Rl).fromJSON(i))}return this}}),Pl.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Pl,isLight:!0,copy:function(e){return Zn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Zn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Ll.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Ll,isHemisphereLight:!0,copy:function(e){return Pl.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Cl.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Fl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Fl,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*kt.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix())}}),Ol.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Ol,isSpotLight:!0,copy:function(e){return Pl.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),$l.prototype=Object.assign(Object.create(Pl.prototype),{constructor:$l,isPointLight:!0,copy:function(e){return Pl.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Hl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Hl}),Il.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Il,isDirectionalLight:!0,copy:function(e){return Pl.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ul.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Ul,isAmbientLight:!0}),Dl.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Dl,isRectAreaLight:!0,copy:function(e){return Pl.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Pl.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Bl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:Bl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),kl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:kl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Vl.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{var o;n:{i:if(!(e<i)){for(var a=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===a)break;if(r=i,e<(i=t[++n]))break t}o=t.length;break n}if(r<=e)break e;var s=t[1];e<s&&(n=2,r=s);for(a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===a)break;if(i=r,(r=t[--n-1])<=e)break t}o=n,n=0}for(;n<o;){var l=n+o>>>1;e<t[l]?o=l:n=l+1}if(i=t[n],void 0===(r=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i,o=0;o!==i;++o)t[o]=n[r+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Vl.prototype,{beforeStart_:Vl.prototype.copySampleValue_,afterEnd_:Vl.prototype.copySampleValue_}),zl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:zl,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(n-t)/(i-t),u=s+a;s!==u;s+=4)Gt.slerpFlat(r,0,o,s-a,o,s,l);return r}}),Gl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:Gl,ValueTypeName:"quaternion",DefaultInterpolation:St,InterpolantFactoryMethodLinear:function(e){return new zl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),jl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:jl,ValueTypeName:"color"}),Wl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:Wl,ValueTypeName:"number"}),Xl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Xl,DefaultSettings_:{endingStart:Mt,endingEnd:Mt},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,o=e+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case At:r=e,a=2*t-n;break;case Rt:a=t+i[r=i.length-2]-i[r+1];break;default:r=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case At:o=e,s=2*n-t;break;case Rt:s=n+i[o=1]-i[0];break;default:o=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-n),this._offsetPrev=r*u,this._offsetNext=o*u},interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f,E=0;E!==a;++E)r[E]=g*o[u+E]+v*o[l+E]+y*o[s+E]+x*o[c+E];return r}}),ql.prototype=Object.assign(Object.create(Vl.prototype),{constructor:ql,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=(n-t)/(i-t),c=1-u,h=0;h!==a;++h)r[h]=o[l+h]*c+o[s+h]*u;return r}}),Yl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Yl,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Jl={arraySlice:function(e,t,n){return Jl.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(n){for(var e=n.length,t=new Array(e),i=0;i!==e;++i)t[i]=i;return t.sort(function(e,t){return n[e]-n[t]}),t},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*t,l=0;l!==t;++l)r[a++]=e[s+l];return r},flattenJSON:function(e,t,n,i){for(var r=1,o=e[0];void 0!==o&&void 0===o[i];)o=e[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[i])&&(t.push(o.time),n.push.apply(n,a)),void 0!==(o=e[r++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[i])&&(t.push(o.time),a.toArray(n,n.length)),void 0!==(o=e[r++]););else for(;void 0!==(a=o[i])&&(t.push(o.time),n.push(a)),void 0!==(o=e[r++]););}}};function Ql(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Jl.convertArray(t,this.TimeBufferType),this.values=Jl.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()}function Zl(e,t,n,i){Ql.call(this,e,t,n,i)}function Kl(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=kt.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function eu(e){this.manager=void 0!==e?e:Ks,this.textures={}}function tu(e){this.manager=void 0!==e?e:Ks}Object.assign(Ql,{parse:function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=Ql._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var n=[],i=[];Jl.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Jl.convertArray(e.times,Array),values:Jl.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Wl;case"vector":case"vector2":case"vector3":case"vector4":return Zl;case"color":return jl;case"quaternion":return Gl;case"bool":case"boolean":return kl;case"string":return Bl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}}),Object.assign(Ql.prototype,{constructor:Ql,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:St,InterpolantFactoryMethodDiscrete:function(e){return new Yl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new ql(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Xl(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case wt:t=this.InterpolantFactoryMethodDiscrete;break;case St:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wt;case this.InterpolantFactoryMethodLinear:return St;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<e;)++r;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==r||o!==i){o<=r&&(r=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Jl.arraySlice(n,r,o),this.values=Jl.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==r;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&s<o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==i&&Jl.isTypedArray(i)){a=0;for(var l=i.length;a!==l;++a){var u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),i=2302===this.getInterpolation(),r=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(i)s=!0;else for(var u=a*n,c=u-n,h=u+n,d=0;d!==n;++d){var p=t[u+d];if(p!==t[c+d]||p!==t[h+d]){s=!0;break}}if(s){if(a!==r){e[r]=e[a];var f=a*n,m=r*n;for(d=0;d!==n;++d)t[m+d]=t[f+d]}++r}}if(0<o){e[r]=e[o];for(f=o*n,m=r*n,d=0;d!==n;++d)t[m+d]=t[f+d];++r}return r!==e.length&&(this.times=Jl.arraySlice(e,0,r),this.values=Jl.arraySlice(t,0,r*n)),this}}),Zl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:Zl,ValueTypeName:"vector"}),Object.assign(Kl,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,o=n.length;r!==o;++r)t.push(Ql.parse(n[r]).scale(i));return new Kl(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t},r=0,o=n.length;r!==o;++r)t.push(Ql.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,o=[],a=0;a<r;a++){var s=[],l=[];s.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);var u=Jl.getKeyframeOrder(s);s=Jl.sortedArray(s,1,u),l=Jl.sortedArray(l,1,u),i||0!==s[0]||(s.push(r),l.push(l[0])),o.push(new Wl(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/n))}return new Kl(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var i=e;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(r);if(l&&1<l.length){var u=i[h=l[1]];u||(i[h]=u=[]),u.push(s)}}var c=[];for(var h in i)c.push(Kl.CreateFromMorphTargetSequence(h,i[h],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,i,r){if(0!==n.length){var o=[],a=[];Jl.flattenJSON(n,o,a,i),0!==o.length&&r.push(new e(t,o,a))}},i=[],r=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)c[u[h].morphTargets[d]]=-1;for(var p in c){var f=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var g=u[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}i.push(new Wl(".morphTargetInfluence["+p+"]",f,m))}o=c.length*(a||1)}else{var v=".bones["+t[l].name+"]";n(Zl,v+".position",u,"pos",i),n(Gl,v+".quaternion",u,"rot",i),n(Zl,v+".scale",u,"scl",i)}}return 0===i.length?null:new Kl(r,o,i)}}),Object.assign(Kl.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(eu.prototype,{load:function(e,t,n,i){var r=this;new tl(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},n,i)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=new Js[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(i.uniforms=e.uniforms),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalScale){var r=e.normalScale;!1===Array.isArray(r)&&(r=[r,r]),i.normalScale=(new Vt).fromArray(r)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),i}}),Object.assign(tu.prototype,{load:function(e,t,n,i){var r=this;new tl(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},n,i)},parse:function(e){var t=new Oi,n=e.data.index;if(void 0!==n){var i=new au[n.type](n.array);t.setIndex(new hi(i,1))}var r=e.data.attributes;for(var o in r){var a=r[o];i=new au[a.type](a.array);t.addAttribute(o,new hi(i,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var l=0,u=s.length;l!==u;++l){var c=s[l];t.addGroup(c.start,c.count,c.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new jt;void 0!==h.center&&d.fromArray(h.center),t.boundingSphere=new yn(d,h.radius)}return t}});var nu,iu,ru,ou,au={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function su(){}su.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,i=t.length;n<i;n+=2){var r=t[n],o=t[n+1];if(r.test(e))return o}return null}},Object.assign(su.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var i=[],r=0;r<e.length;++r)i[r]=this.createMaterial(e[r],t,n);return i},createMaterial:(nu={NoBlending:W,NormalBlending:X,AdditiveBlending:q,SubtractiveBlending:Q,MultiplyBlending:Z,CustomBlending:K},iu=new Sn,ru=new al,ou=new eu,function(e,u,c){var h={};function t(e,t,n,i,r){var o,a=u+e,s=su.Handlers.get(a);null!==s?o=s.load(a):(ru.setCrossOrigin(c),o=ru.load(a)),void 0!==t&&(o.repeat.fromArray(t),1!==t[0]&&(o.wrapS=be),1!==t[1]&&(o.wrapT=be)),void 0!==n&&o.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(o.wrapS=be),"mirror"===i[0]&&(o.wrapS=we),"repeat"===i[1]&&(o.wrapT=be),"mirror"===i[1]&&(o.wrapT=we)),void 0!==r&&(o.anisotropy=r);var l=kt.generateUUID();return h[l]=o,l}var n={uuid:kt.generateUUID(),type:"MeshLambertMaterial"};for(var i in e){var r=e[i];switch(i){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":n.name=r;break;case"blending":n.blending=nu[r];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",i,"is no longer supported.");break;case"colorDiffuse":n.color=iu.fromArray(r).getHex();break;case"colorSpecular":n.specular=iu.fromArray(r).getHex();break;case"colorEmissive":n.emissive=iu.fromArray(r).getHex();break;case"specularCoef":n.shininess=r;break;case"shading":"basic"===r.toLowerCase()&&(n.type="MeshBasicMaterial"),"phong"===r.toLowerCase()&&(n.type="MeshPhongMaterial"),"standard"===r.toLowerCase()&&(n.type="MeshStandardMaterial");break;case"mapDiffuse":n.map=t(r,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":n.emissiveMap=t(r,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":n.lightMap=t(r,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":n.aoMap=t(r,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":n.bumpMap=t(r,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":n.bumpScale=r;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":n.normalMap=t(r,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":n.normalScale=r;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":n.specularMap=t(r,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":n.metalnessMap=t(r,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":n.roughnessMap=t(r,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":n.alphaMap=t(r,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":n.side=Y;break;case"doubleSided":n.side=J;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),n.opacity=r;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":n[i]=r;break;case"vertexColors":!0===r&&(n.vertexColors=_),"face"===r&&(n.vertexColors=b);break;default:console.error("THREE.Loader.createMaterial: Unsupported",i,r)}}return"MeshBasicMaterial"===n.type&&delete n.emissive,"MeshPhongMaterial"!==n.type&&delete n.specular,n.opacity<1&&(n.transparent=!0),ou.setTextures(h),ou.parse(n)})});var lu={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")}};function uu(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:Ks,this.withCredentials=!1}function cu(e){this.manager=void 0!==e?e:Ks,this.texturePath=""}Object.assign(uu.prototype,{load:function(o,a,e,t){var s=this,l=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:lu.extractUrlBase(o),n=new tl(this.manager);n.setWithCredentials(this.withCredentials),n.load(o,function(e){var t=JSON.parse(e),n=t.metadata;if(void 0!==n){var i=n.type;if(void 0!==i&&"object"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+o+" should be loaded with THREE.ObjectLoader instead.")}var r=s.parse(t,l);a(r.geometry,r.materials)},e,t)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var n=new ci;return function(e,t){function n(e,t){return e&1<<t}var i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,x,E,T,b,_,w,S,M,A,R=e.faces,N=e.vertices,P=e.normals,L=e.colors,C=e.scale,F=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&F++;for(i=0;i<F;i++)t.faceVertexUvs[i]=[]}for(a=0,s=N.length;a<s;)(E=new jt).x=N[a++]*C,E.y=N[a++]*C,E.z=N[a++]*C,t.vertices.push(E);for(a=0,s=R.length;a<s;)if(p=n(d=R[a++],0),f=n(d,1),m=n(d,3),g=n(d,4),v=n(d,5),y=n(d,6),x=n(d,7),p){if((b=new ti).a=R[a],b.b=R[a+1],b.c=R[a+3],(_=new ti).a=R[a+1],_.b=R[a+2],_.c=R[a+3],a+=4,f&&(h=R[a++],b.materialIndex=h,_.materialIndex=h),o=t.faces.length,m)for(i=0;i<F;i++)for(M=e.uvs[i],t.faceVertexUvs[i][o]=[],t.faceVertexUvs[i][o+1]=[],r=0;r<4;r++)A=new Vt(M[2*(c=R[a++])],M[2*c+1]),2!==r&&t.faceVertexUvs[i][o].push(A),0!==r&&t.faceVertexUvs[i][o+1].push(A);if(g&&(u=3*R[a++],b.normal.set(P[u++],P[u++],P[u]),_.normal.copy(b.normal)),v)for(i=0;i<4;i++)u=3*R[a++],S=new jt(P[u++],P[u++],P[u]),2!==i&&b.vertexNormals.push(S),0!==i&&_.vertexNormals.push(S);if(y&&(w=L[l=R[a++]],b.color.setHex(w),_.color.setHex(w)),x)for(i=0;i<4;i++)w=L[l=R[a++]],2!==i&&b.vertexColors.push(new Sn(w)),0!==i&&_.vertexColors.push(new Sn(w));t.faces.push(b),t.faces.push(_)}else{if((T=new ti).a=R[a++],T.b=R[a++],T.c=R[a++],f&&(h=R[a++],T.materialIndex=h),o=t.faces.length,m)for(i=0;i<F;i++)for(M=e.uvs[i],t.faceVertexUvs[i][o]=[],r=0;r<3;r++)A=new Vt(M[2*(c=R[a++])],M[2*c+1]),t.faceVertexUvs[i][o].push(A);if(g&&(u=3*R[a++],T.normal.set(P[u++],P[u++],P[u])),v)for(i=0;i<3;i++)u=3*R[a++],S=new jt(P[u++],P[u++],P[u]),T.vertexNormals.push(S);if(y&&(l=R[a++],T.color.setHex(L[l])),x)for(i=0;i<3;i++)l=R[a++],T.vertexColors.push(new Sn(L[l]));t.faces.push(T)}}(e,n),function(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,r=e.skinWeights.length;i<r;i+=n){var o=e.skinWeights[i],a=1<n?e.skinWeights[i+1]:0,s=2<n?e.skinWeights[i+2]:0,l=3<n?e.skinWeights[i+3]:0;t.skinWeights.push(new pn(o,a,s,l))}if(e.skinIndices)for(i=0,r=e.skinIndices.length;i<r;i+=n){var u=e.skinIndices[i],c=1<n?e.skinIndices[i+1]:0,h=2<n?e.skinIndices[i+2]:0,d=3<n?e.skinIndices[i+3]:0;t.skinIndices.push(new pn(u,c,h,d))}t.bones=e.bones,t.bones&&0<t.bones.length&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,n),function(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var i=0,r=e.morphTargets.length;i<r;i++){t.morphTargets[i]={},t.morphTargets[i].name=e.morphTargets[i].name,t.morphTargets[i].vertices=[];for(var o=t.morphTargets[i].vertices,a=e.morphTargets[i].vertices,s=0,l=a.length;s<l;s+=3){var u=new jt;u.x=a[s]*n,u.y=a[s+1]*n,u.z=a[s+2]*n,o.push(u)}}if(void 0!==e.morphColors&&0<e.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,h=e.morphColors[0].colors;for(i=0,r=c.length;i<r;i++)c[i].color.fromArray(h,3*i)}}(e,n),function(e,t){var n=[],i=[];void 0!==e.animation&&i.push(e.animation),void 0!==e.animations&&(e.animations.length?i=i.concat(e.animations):i.push(e.animations));for(var r=0;r<i.length;r++){var o=Kl.parseAnimation(i[r],t.bones);o&&n.push(o)}if(t.morphTargets){var a=Kl.CreateClipsFromMorphTargetSequences(t.morphTargets,10);n=n.concat(a)}0<n.length&&(t.animations=n)}(e,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:{geometry:n,materials:su.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}),Object.assign(cu.prototype,{load:function(i,r,e,o){""===this.texturePath&&(this.texturePath=i.substring(0,i.lastIndexOf("/")+1));var a=this;new tl(a.manager).load(i,function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void 0!==o&&o(e),void console.error("THREE:ObjectLoader: Can't parse "+i+".",e.message)}var n=t.metadata;void 0!==n&&void 0!==n.type&&"geometry"!==n.type.toLowerCase()?a.parse(t,r):console.error("THREE.ObjectLoader: Can't load "+i+". Use THREE.JSONLoader instead.")},e,o)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,i,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,i=e.length;n<i;n++){var r=(new Nl).fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var i=new uu,r=new tu,o=0,a=e.length;o<a;o++){var s,l=e[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Bs[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Bs[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Bs[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Bs[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Bs[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Bs[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Bs[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Bs[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Bs[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Bs[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Bs[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Bs[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var u=[];for(o=0,a=l.shapes.length;o<a;o++){var c=t[l.shapes[o]];u.push(c)}s=new Bs[l.type](u,l.curveSegments);break;case"BufferGeometry":s=r.parse(l);break;case"Geometry":s=i.parse(l,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),n[l.uuid]=s}return n},parseMaterials:function(e,t){var n={};if(void 0!==e){var i=new eu;i.setTextures(t);for(var r=0,o=e.length;r<o;r++){var a=e[r];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(i.parse(a.materials[l]));n[a.uuid]=s}else n[a.uuid]=i.parse(a)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=Kl.parse(e[n]);t.push(i)}return t},parseImages:function(e,t){var n=this,i={};function r(e){return n.manager.itemStart(e),o.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemEnd(e),n.manager.itemError(e)})}if(void 0!==e&&0<e.length){var o=new rl(new Zs(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.texturePath+l.url;i[l.uuid]=r(u)}}return i},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var i={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var a=e[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new dn(t[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,du)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],pu),s.wrapT=n(a.wrap[1],pu)),void 0!==a.format&&(s.format=a.format),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,fu)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,fu)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),i[a.uuid]=s}return i},parseObject:function(e,t,o){var n;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function r(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];void 0===o[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(o[r])}return t}return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),o[e]}}switch(e.type){case"Scene":n=new fa,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new Sn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new pa(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new da(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new la(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new ei(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new Ul(e.color,e.intensity);break;case"DirectionalLight":n=new Il(e.color,e.intensity);break;case"PointLight":n=new $l(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new Dl(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new Ol(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new Ll(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=r(e.material);n=a.bones&&0<a.bones.length?new Ea(a,s):new gr(a,s);break;case"LOD":n=new va;break;case"Line":n=new ba(i(e.geometry),r(e.material),e.mode);break;case"LineLoop":n=new wa(i(e.geometry),r(e.material));break;case"LineSegments":n=new _a(i(e.geometry),r(e.material));break;case"PointCloud":case"Points":n=new Ma(i(e.geometry),r(e.material));break;case"Sprite":n=new ga(r(e.material));break;case"Group":n=new Aa;break;default:n=new Zn}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.children)for(var l=e.children,u=0;u<l.length;u++)n.add(this.parseObject(l[u],t,o));if("LOD"===e.type)for(var c=e.levels,h=0;h<c.length;h++){var d=c[h],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var hu,du={UVMapping:300,CubeReflectionMapping:me,CubeRefractionMapping:ge,EquirectangularReflectionMapping:ve,EquirectangularRefractionMapping:ye,SphericalReflectionMapping:xe,CubeUVReflectionMapping:Ee,CubeUVRefractionMapping:Te},pu={RepeatWrapping:be,ClampToEdgeWrapping:_e,MirroredRepeatWrapping:we},fu={NearestFilter:Re,NearestMipMapNearestFilter:Ne,NearestMipMapLinearFilter:Pe,LinearFilter:Le,LinearMipMapNearestFilter:Ce,LinearMipMapLinearFilter:Fe};function mu(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:Ks,this.options=void 0}function gu(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function vu(e){this.type="Font",this.data=e}function yu(e,t,n,i,r,o){var a=o.glyphs[e]||o.glyphs["?"];if(a){var s,l,u,c,h,d,p,f,m=new gu;if(a.o)for(var g=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,y=g.length;v<y;){switch(g[v++]){case"m":s=g[v++]*n+i,l=g[v++]*n+r,m.moveTo(s,l);break;case"l":s=g[v++]*n+i,l=g[v++]*n+r,m.lineTo(s,l);break;case"q":u=g[v++]*n+i,c=g[v++]*n+r,h=g[v++]*n+i,d=g[v++]*n+r,m.quadraticCurveTo(h,d,u,c);break;case"b":u=g[v++]*n+i,c=g[v++]*n+r,h=g[v++]*n+i,d=g[v++]*n+r,p=g[v++]*n+i,f=g[v++]*n+r,m.bezierCurveTo(h,d,p,f,u,c)}}return{offsetX:a.ha*n,path:m}}}function xu(e){this.manager=void 0!==e?e:Ks}mu.prototype={constructor:mu,setOptions:function(e){return this.options=e,this},load:function(t,n,e,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=Qs.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){n&&n(o),r.manager.itemEnd(t)},0),o;fetch(t).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,r.options)}).then(function(e){Qs.add(t,e),n&&n(e),r.manager.itemEnd(t)}).catch(function(e){i&&i(e),r.manager.itemEnd(t),r.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(gu.prototype,{moveTo:function(e,t){this.currentPath=new Rl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,i){this.currentPath.quadraticCurveTo(e,t,n,i)},bezierCurveTo:function(e,t,n,i,r,o){this.currentPath.bezierCurveTo(e,t,n,i,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],o=new Nl;o.curves=r.curves,t.push(o)}return t}function i(e,t){for(var n=t.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=t[r],s=t[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],l=-l,s=t[r],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var c=u*(e.x-a.x)-l*(e.y-a.y);if(0===c)return!0;if(c<0)continue;i=!i}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return i}var r=vs.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,l,u=[];if(1===o.length)return s=o[0],(l=new Nl).curves=s.curves,u.push(l),u;var c=!r(o[0].getPoints());c=e?!c:c;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=r(h=(s=o[v]).getPoints()),(a=e?!a:a)?(!c&&f[g]&&g++,f[g]={s:new Nl,p:h},f[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return n(o);if(1<f.length){for(var x=!1,E=[],T=0,b=f.length;T<b;T++)p[T]=[];for(T=0,b=f.length;T<b;T++)for(var _=m[T],w=0;w<_.length;w++){for(var S=_[w],M=!0,A=0;A<f.length;A++)i(S.p,f[A].p)&&(T!==A&&E.push({froms:T,tos:A,hole:w}),M?(M=!1,p[A].push(S)):x=!0);M&&p[T].push(S)}0<E.length&&(x||(m=p))}v=0;for(var R=f.length;v<R;v++){l=f[v].s,u.push(l);for(var N=0,P=(d=m[v]).length;N<P;N++)l.holes.push(d[N].h)}return u}}),Object.assign(vu.prototype,{isFont:!0,generateShapes:function(e,t,n){void 0===t&&(t=100),void 0===n&&(n=4);for(var i=[],r=function(e,t,n,i){for(var r=String(e).split(""),o=t/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*o,s=[],l=0,u=0,c=0;c<r.length;c++){var h=r[c];if("\n"===h)l=0,u-=a;else{var d=yu(h,n,o,l,u,i);l+=d.offsetX,s.push(d.path)}}return s}(e,t,n,this.data),o=0,a=r.length;o<a;o++)Array.prototype.push.apply(i,r[o].toShapes());return i}}),Object.assign(xu.prototype,{load:function(e,i,t,n){var r=this,o=new tl(this.manager);o.setPath(this.path),o.load(e,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var e=r.parse(n);i&&i(e)},t,n)},parse:function(e){return new vu(e)},setPath:function(e){return this.path=e,this}});var Eu,Tu,bu,_u,wu,Su,Mu,Au,Ru,Nu,Pu,Lu,Cu,Fu,Ou,$u={getContext:function(){return void 0===hu&&(hu=new(window.AudioContext||window.webkitAudioContext)),hu},setContext:function(e){hu=e}};function Hu(e){this.manager=void 0!==e?e:Ks}function Iu(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new la,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new la,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Uu(e,t,n){Zn.call(this),this.type="CubeCamera";var r=new la(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new jt(1,0,0)),this.add(r);var o=new la(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new jt(-1,0,0)),this.add(o);var a=new la(90,1,e,t);a.up.set(0,0,1),a.lookAt(new jt(0,1,0)),this.add(a);var s=new la(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new jt(0,-1,0)),this.add(s);var l=new la(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new jt(0,0,1)),this.add(l);var u=new la(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new jt(0,0,-1)),this.add(u);var i={format:Xe,magFilter:Le,minFilter:Le};this.renderTarget=new mn(n,n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,r,n),n.activeCubeFace=1,e.render(t,o,n),n.activeCubeFace=2,e.render(t,a,n),n.activeCubeFace=3,e.render(t,s,n),n.activeCubeFace=4,e.render(t,l,n),n.texture.generateMipmaps=i,n.activeCubeFace=5,e.render(t,u,n),e.setRenderTarget(null)},this.clear=function(e,t,n,i){for(var r=this.renderTarget,o=0;o<6;o++)r.activeCubeFace=o,e.setRenderTarget(r),e.clear(t,n,i);e.setRenderTarget(null)}}function Du(){Zn.call(this),this.type="AudioListener",this.context=$u.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Bu(e){Zn.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function ku(e){Bu.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Vu(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function zu(e,t,n){this.binding=e,this.valueSize=n;var i,r=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Hu.prototype,{load:function(e,t,n,i){var r=new tl(this.manager);r.setResponseType("arraybuffer"),r.load(e,function(e){$u.getContext().decodeAudioData(e,function(e){t(e)})},n,i)}}),Object.assign(Iu.prototype,{update:(Ru=new zt,Nu=new zt,function(e){if(Eu!==this||Tu!==e.focus||bu!==e.fov||_u!==e.aspect*this.aspect||wu!==e.near||Su!==e.far||Mu!==e.zoom||Au!==this.eyeSep){Eu=this,Tu=e.focus,bu=e.fov,_u=e.aspect*this.aspect,wu=e.near,Su=e.far,Mu=e.zoom;var t,n,i=e.projectionMatrix.clone(),r=(Au=this.eyeSep/2)*wu/Tu,o=wu*Math.tan(kt.DEG2RAD*bu*.5)/Mu;Nu.elements[12]=-Au,Ru.elements[12]=Au,t=-o*_u+r,n=o*_u+r,i.elements[0]=2*wu/(n-t),i.elements[8]=(n+t)/(n-t),this.cameraL.projectionMatrix.copy(i),t=-o*_u-r,n=o*_u-r,i.elements[0]=2*wu/(n-t),i.elements[8]=(n+t)/(n-t),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Nu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Ru)})}),(Uu.prototype=Object.create(Zn.prototype)).constructor=Uu,Du.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Du,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:(Pu=new jt,Lu=new Gt,Cu=new jt,Fu=new jt,function(e){Zn.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;this.matrixWorld.decompose(Pu,Lu,Cu),Fu.set(0,0,-1).applyQuaternion(Lu),t.positionX?(t.positionX.setValueAtTime(Pu.x,this.context.currentTime),t.positionY.setValueAtTime(Pu.y,this.context.currentTime),t.positionZ.setValueAtTime(Pu.z,this.context.currentTime),t.forwardX.setValueAtTime(Fu.x,this.context.currentTime),t.forwardY.setValueAtTime(Fu.y,this.context.currentTime),t.forwardZ.setValueAtTime(Fu.z,this.context.currentTime),t.upX.setValueAtTime(n.x,this.context.currentTime),t.upY.setValueAtTime(n.y,this.context.currentTime),t.upZ.setValueAtTime(n.z,this.context.currentTime)):(t.setPosition(Pu.x,Pu.y,Pu.z),t.setOrientation(Fu.x,Fu.y,Fu.z,n.x,n.y,n.z))})}),Bu.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Bu,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),ku.prototype=Object.assign(Object.create(Bu.prototype),{constructor:ku,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:(Ou=new jt,function(e){Zn.prototype.updateMatrixWorld.call(this,e),Ou.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Ou.x,Ou.y,Ou.z)})}),Object.assign(Vu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(zu.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,r=e*i+i,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==i;++a)n[r+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*t;this._mixBufferRegion(n,i,a,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){o.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=3*n;e.getValue(t,i);for(var r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,r){if(.5<=i)for(var o=0;o!==r;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,i){Gt.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*i}}});var Gu,ju,Wu,Xu,qu,Yu,Ju,Qu,Zu,Ku,ec,tc,nc,ic,rc,oc,ac,sc,lc,uc,cc,hc,dc,pc,fc,mc,gc,vc,yc,xc,Ec,Tc,bc,_c="\\[\\]\\.:\\/";function wc(e,t,n){var i=n||Sc.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function Sc(e,t,n){this.path=t,this.parsedPath=n||Sc.parseTrackName(t),this.node=Sc.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Mc(){this.uuid=kt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Ac(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,r=i.length,o=new Array(r),a={endingStart:Mt,endingEnd:Mt},s=0;s!==r;++s){var l=i[s].createInterpolant(null);(o[s]=l).settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=_t,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Rc(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Nc(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Pc(){Oi.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Lc(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}function Cc(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Fc(e,t,n){Cc.call(this,e,t),this.meshPerAttribute=n||1}function Oc(e,t,n){hi.call(this,e,t),this.meshPerAttribute=n||1}function $c(e,t,n,i){this.ray=new pr(e,t),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Hc(e,t){return e.distance-t.distance}function Ic(e,t,n,i){if(!1!==e.visible&&(e.raycast(t,n),!0===i))for(var r=e.children,o=0,a=r.length;o<a;o++)Ic(r[o],t,n,!0)}function Uc(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Dc(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Bc(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function kc(e,t){this.min=void 0!==e?e:new Vt(1/0,1/0),this.max=void 0!==t?t:new Vt(-1/0,-1/0)}function Vc(e){Zn.call(this),this.material=e,this.render=function(){}}function zc(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new Oi,u=new xi(2*a*3,3);l.addAttribute("position",u),_a.call(this,l,new Ta({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Gc(e,t){Zn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Oi,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,o=1;r<32;r++,o++){var a=r/32*Math.PI*2,s=o/32*Math.PI*2;i.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new xi(i,3));var l=new Ta({fog:!1});this.cone=new _a(n,l),this.add(this.cone),this.update()}function jc(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var i=0;i<t.children.length;i++)n.push.apply(n,e(t.children[i]));return n}(e),n=new Oi,i=[],r=[],o=new Sn(0,0,1),a=new Sn(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.addAttribute("position",new xi(i,3)),n.addAttribute("color",new xi(r,3));var u=new Ta({vertexColors:_,depthTest:!1,depthWrite:!1,transparent:!0});_a.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Wc(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new Ss(t,4,2),r=new hr({wireframe:!0,fog:!1});gr.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Xc(e,t){Zn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new Ta({fog:!1}),i=new Oi;i.addAttribute("position",new hi(new Float32Array(15),3)),this.line=new ba(i,n),this.add(this.line),this.update()}function qc(e,t,n){Zn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new Da(t);i.rotateY(.5*Math.PI),this.material=new hr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=_);var r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.addAttribute("color",new hi(o,3)),this.add(new gr(i,this.material)),this.update()}function Yc(e,t,n,i){e=e||10,t=t||10,n=new Sn(void 0!==n?n:4473924),i=new Sn(void 0!==i?i:8947848);for(var r=t/2,o=e/t,a=e/2,s=[],l=[],u=0,c=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=u===r?n:i;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var p=new Oi;p.addAttribute("position",new xi(s,3)),p.addAttribute("color",new xi(l,3));var f=new Ta({vertexColors:_});_a.call(this,p,f)}function Jc(e,t,n,i,r,o){e=e||10,t=t||16,n=n||8,i=i||64,r=new Sn(void 0!==r?r:4473924),o=new Sn(void 0!==o?o:8947848);var a,s,l,u,c,h,d,p=[],f=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,p.push(0,0,0),p.push(a,0,s),d=1&u?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?r:o,h=e-e/n*u,c=0;c<i;c++)l=c/i*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,p.push(a,0,s),f.push(d.r,d.g,d.b),l=(c+1)/i*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,p.push(a,0,s),f.push(d.r,d.g,d.b);var m=new Oi;m.addAttribute("position",new xi(p,3)),m.addAttribute("color",new xi(f,3));var g=new Ta({vertexColors:_});_a.call(this,m,g)}function Qc(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Oi,u=new xi(2*a*3,3);l.addAttribute("position",u),_a.call(this,l,new Ta({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Zc(e,t,n){Zn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var i=new Oi;i.addAttribute("position",new xi([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new Ta({fog:!1});this.lightPlane=new ba(i,r),this.add(this.lightPlane),(i=new Oi).addAttribute("position",new xi([0,0,0,0,0,1],3)),this.targetLine=new ba(i,r),this.add(this.targetLine),this.update()}function Kc(e){var t=new Oi,n=new Ta({color:16777215,vertexColors:b}),i=[],r=[],o={},a=new Sn(16755200),s=new Sn(16711680),l=new Sn(43775),u=new Sn(16777215),c=new Sn(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(i.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.addAttribute("position",new xi(i,3)),t.addAttribute("color",new xi(r,3)),_a.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function eh(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Oi;r.setIndex(new hi(n,1)),r.addAttribute("position",new hi(i,3)),_a.call(this,r,new Ta({color:t})),this.matrixAutoUpdate=!1,this.update()}function th(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Oi;r.setIndex(new hi(i,1)),r.addAttribute("position",new xi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),_a.call(this,r,new Ta({color:n})),this.geometry.computeBoundingSphere()}function nh(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var i=void 0!==n?n:16776960,r=new Oi;r.addAttribute("position",new xi([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),ba.call(this,r,new Ta({color:i}));var o=new Oi;o.addAttribute("position",new xi([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new gr(o,new hr({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}function ih(e,t,n,i,r,o){Zn.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===xc&&((xc=new Oi).addAttribute("position",new xi([0,0,0,0,1,0],3)),(Ec=new $s(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new ba(xc,new Ta({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new gr(Ec,new hr({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}function rh(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Oi;n.addAttribute("position",new xi(t,3)),n.addAttribute("color",new xi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new Ta({vertexColors:_});_a.call(this,n,i)}Object.assign(wc.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Sc,{Composite:wc,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Sc.Composite(e,t,n):new Sc(e,t,n)},sanitizeNodeName:(Zu=new RegExp("["+_c+"]","g"),function(e){return e.replace(/\s/g,"_").replace(Zu,"")}),parseTrackName:(Gu="[^"+_c+"]",ju="[^"+_c.replace("\\.","")+"]",Wu=/((?:WC+[\/:])*)/.source.replace("WC",Gu),Xu=/(WCOD+)?/.source.replace("WCOD",ju),qu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Gu),Yu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Gu),Ju=new RegExp("^"+Wu+Xu+qu+Yu+"$"),Qu=["material","materials","bones"],function(e){var t=Ju.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==Qu.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===e.name||r===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(r);if(void 0!==t)return t}if(e.children){var o=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.name===r||n.uuid===r)return n;var i=o(n.children);if(i)return i}return null},n=o(e.children);if(n)return n}return null}}),Object.assign(Sc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=Sc.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[i];if(void 0!==s){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var u=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===r){r=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===r){r=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Sc.prototype,{_getValue_unbound:Sc.prototype.getValue,_setValue_unbound:Sc.prototype.setValue}),Object.assign(Mc.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,p=i[d];if(void 0===p){p=t++,i[d]=p,e.push(h);for(var f=0,m=s;f!==m;++f)a[f].push(new Sc(h,r[f],o[f]))}else if(p<n){l=e[p];var g=--n,v=e[g];e[i[v.uuid]=p]=v,e[i[d]=g]=h;for(f=0,m=s;f!==m;++f){var y=a[f],x=y[g],E=y[p];y[p]=x,void 0===E&&(E=new Sc(h,r[f],o[f])),y[g]=E}}else e[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,u=n[l];if(void 0!==u&&t<=u){var c=t++,h=e[c];e[n[h.uuid]=u]=h,e[n[l]=c]=s;for(var d=0,p=r;d!==p;++d){var f=i[d],m=f[c],g=f[u];f[u]=m,f[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a].uuid,u=i[l];if(void 0!==u)if(delete i[l],u<n){var c=--n,h=e[c],d=e[v=--t];e[i[h.uuid]=u]=h,e[i[d.uuid]=c]=d,e.pop();for(var p=0,f=o;p!==f;++p){var m=(y=r[p])[c],g=y[v];y[u]=m,y[c]=g,y.pop()}}else{var v;e[i[(d=e[v=--t]).uuid]=u]=d,e.pop();for(p=0,f=o;p!==f;++p){var y;(y=r[p])[u]=y[v],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[e]=i,o.push(e),a.push(t),r.push(c);for(var h=u,d=s.length;h!==d;++h){var p=s[h];c[h]=new Sc(p,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];o[t[e[a]]=n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}),Object.assign(Ac.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,r=e._clip.duration,o=r/i,a=i/r;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+n,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulate(i,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(2200===i){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=t)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o=2202===i;if(-1===r&&(0<=e?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),n<=t||t<0){var a=Math.floor(t/n);t-=n*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&r))return n-(this.time=t)}return this.time=t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=At,i.endingEnd=At):(i.endingStart=e?this.zeroSlopeAtStart?At:Mt:Rt,i.endingEnd=t?this.zeroSlopeAtEnd?At:Mt:Rt)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=n,this}}),Rc.prototype=Object.assign(Object.create(t.prototype),{constructor:Rc,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==r;++c){var h=i[c],d=h.name,p=u[d];if(void 0!==p)o[c]=p;else{if(void 0!==(p=o[c])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[c].binding.parsedPath;++(p=new zu(Sc.create(n,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[c]=p}a[c].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var r=e._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;t[n._cacheIndex=i]=n,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;s[l._byClipCacheIndex=u]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],o=this._bindings;void 0===r&&(r={},i[t]=r),(r[n]=e)._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=t[t.length-1],l=e._cacheIndex;t[s._cacheIndex=l]=s,t.pop(),delete a[r];e:{for(var u in a)break e;delete o[i]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(e[(n=new ql(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];t[e.__cacheIndex=i]=e,t[r.__cacheIndex=n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?Kl.findByName(n,e):e,o=null!==r?r.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[i];if(void 0!==l)return l;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var u=new Ac(this,r,t);return this._bindAction(u,s),this._addInactiveAction(u,o,i),u},existingAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?Kl.findByName(n,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0;for(var r=this._nActiveBindings=0;r!==t;++r)e[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(i,e,r,o)}var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,t[c._cacheIndex=u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Nc.prototype.clone=function(){return new Nc(void 0===this.value.clone?this.value:this.value.clone())},Pc.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Pc,isInstancedBufferGeometry:!0,copy:function(e){return Oi.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(Lc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Lc.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}}),Object.defineProperty(Cc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Cc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Fc.prototype=Object.assign(Object.create(Cc.prototype),{constructor:Fc,isInstancedInterleavedBuffer:!0,copy:function(e){return Cc.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Oc.prototype=Object.assign(Object.create(hi.prototype),{constructor:Oc,isInstancedBufferAttribute:!0,copy:function(e){return hi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign($c.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return Ic(e,this,i,t),i.sort(Hc),i},intersectObjects:function(e,t,n){var i=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,o=e.length;r<o;r++)Ic(e[r],this,i,t);return i.sort(Hc),i}}),Object.assign(Uc.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Dc.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(kt.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Bc.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),Object.assign(kc.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(ec=new Vt,function(e,t){var n=ec.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Vt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Vt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Vt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Vt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(Ku=new Vt,function(e){return Ku.copy(e).clamp(this.min,this.max).sub(e).length()}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),((Vc.prototype=Object.create(Zn.prototype)).constructor=Vc).prototype.isImmediateRenderObject=!0,((zc.prototype=Object.create(_a.prototype)).constructor=zc).prototype.update=(tc=new jt,nc=new jt,ic=new Wt,function(){var e=["a","b","c"];this.object.updateMatrixWorld(!0),ic.getNormalMatrix(this.object.matrixWorld);var t=this.object.matrixWorld,n=this.geometry.attributes.position,i=this.object.geometry;if(i&&i.isGeometry)for(var r=i.vertices,o=i.faces,a=0,s=0,l=o.length;s<l;s++)for(var u=o[s],c=0,h=u.vertexNormals.length;c<h;c++){var d=r[u[e[c]]],p=u.vertexNormals[c];tc.copy(d).applyMatrix4(t),nc.copy(p).applyMatrix3(ic).normalize().multiplyScalar(this.size).add(tc),n.setXYZ(a,tc.x,tc.y,tc.z),a+=1,n.setXYZ(a,nc.x,nc.y,nc.z),a+=1}else if(i&&i.isBufferGeometry){var f=i.attributes.position,m=i.attributes.normal;for(c=a=0,h=f.count;c<h;c++)tc.set(f.getX(c),f.getY(c),f.getZ(c)).applyMatrix4(t),nc.set(m.getX(c),m.getY(c),m.getZ(c)),nc.applyMatrix3(ic).normalize().multiplyScalar(this.size).add(tc),n.setXYZ(a,tc.x,tc.y,tc.z),a+=1,n.setXYZ(a,nc.x,nc.y,nc.z),a+=1}n.needsUpdate=!0}),((Gc.prototype=Object.create(Zn.prototype)).constructor=Gc).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Gc.prototype.update=(rc=new jt,oc=new jt,function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),rc.setFromMatrixPosition(this.light.matrixWorld),oc.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(oc.sub(rc)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((jc.prototype=Object.create(_a.prototype)).constructor=jc).prototype.updateMatrixWorld=(ac=new jt,sc=new zt,lc=new zt,function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");lc.getInverse(this.root.matrixWorld);for(var r=0,o=0;r<t.length;r++){var a=t[r];a.parent&&a.parent.isBone&&(sc.multiplyMatrices(lc,a.matrixWorld),ac.setFromMatrixPosition(sc),i.setXYZ(o,ac.x,ac.y,ac.z),sc.multiplyMatrices(lc,a.parent.matrixWorld),ac.setFromMatrixPosition(sc),i.setXYZ(o+1,ac.x,ac.y,ac.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Zn.prototype.updateMatrixWorld.call(this,e)}),((Wc.prototype=Object.create(gr.prototype)).constructor=Wc).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Wc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((Xc.prototype=Object.create(Zn.prototype)).constructor=Xc).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Xc.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,i=n.array;i[0]=e,i[1]=-t,i[2]=0,i[3]=e,i[4]=t,i[5]=0,i[6]=-e,i[7]=t,i[8]=0,i[9]=-e,i[10]=-t,i[11]=0,i[12]=e,i[13]=-t,i[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},((qc.prototype=Object.create(Zn.prototype)).constructor=qc).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},qc.prototype.update=(uc=new jt,cc=new Sn,hc=new Sn,function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");cc.copy(this.light.color),hc.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var r=n<i/2?cc:hc;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(uc.setFromMatrixPosition(this.light.matrixWorld).negate())}),(Yc.prototype=Object.create(_a.prototype)).constructor=Yc,(Jc.prototype=Object.create(_a.prototype)).constructor=Jc,((Qc.prototype=Object.create(_a.prototype)).constructor=Qc).prototype.update=(dc=new jt,pc=new jt,fc=new Wt,function(){this.object.updateMatrixWorld(!0),fc.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry,i=n.vertices,r=n.faces,o=0,a=0,s=r.length;a<s;a++){var l=r[a],u=l.normal;dc.copy(i[l.a]).add(i[l.b]).add(i[l.c]).divideScalar(3).applyMatrix4(e),pc.copy(u).applyMatrix3(fc).normalize().multiplyScalar(this.size).add(dc),t.setXYZ(o,dc.x,dc.y,dc.z),o+=1,t.setXYZ(o,pc.x,pc.y,pc.z),o+=1}t.needsUpdate=!0}),((Zc.prototype=Object.create(Zn.prototype)).constructor=Zc).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Zc.prototype.update=(mc=new jt,gc=new jt,vc=new jt,function(){mc.setFromMatrixPosition(this.light.matrixWorld),gc.setFromMatrixPosition(this.light.target.matrixWorld),vc.subVectors(gc,mc),this.lightPlane.lookAt(vc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vc),this.targetLine.scale.z=vc.length()}),((Kc.prototype=Object.create(_a.prototype)).constructor=Kc).prototype.update=function(){var l,u,c=new jt,h=new Kn;function e(e,t,n,i){c.set(t,n,i).unproject(h);var r=u[e];if(void 0!==r)for(var o=l.getAttribute("position"),a=0,s=r.length;a<s;a++)o.setXYZ(r[a],c.x,c.y,c.z)}return function(){l=this.geometry,u=this.pointMap;h.projectionMatrix.copy(this.camera.projectionMatrix),e("c",0,0,-1),e("t",0,0,1),e("n1",-1,-1,-1),e("n2",1,-1,-1),e("n3",-1,1,-1),e("n4",1,1,-1),e("f1",-1,-1,1),e("f2",1,-1,1),e("f3",-1,1,1),e("f4",1,1,1),e("u1",.7,1.1,-1),e("u2",-.7,1.1,-1),e("u3",0,2,-1),e("cf1",-1,0,1),e("cf2",1,0,1),e("cf3",0,-1,1),e("cf4",0,1,1),e("cn1",-1,0,-1),e("cn2",1,0,-1),e("cn3",0,-1,-1),e("cn4",0,1,-1),l.getAttribute("position").needsUpdate=!0}}(),((eh.prototype=Object.create(_a.prototype)).constructor=eh).prototype.update=(yc=new vn,function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&yc.setFromObject(this.object),!yc.isEmpty()){var t=yc.min,n=yc.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),eh.prototype.setFromObject=function(e){return this.object=e,this.update(),this},((th.prototype=Object.create(_a.prototype)).constructor=th).prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Zn.prototype.updateMatrixWorld.call(this,e))},((nh.prototype=Object.create(ba.prototype)).constructor=nh).prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),Zn.prototype.updateMatrixWorld.call(this,e)},((ih.prototype=Object.create(Zn.prototype)).constructor=ih).prototype.setDirection=(bc=new jt,function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(bc.set(e.z,0,-e.x).normalize(),Tc=Math.acos(e.y),this.quaternion.setFromAxisAngle(bc,Tc))}),ih.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},ih.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},(rh.prototype=Object.create(_a.prototype)).constructor=rh;var oh;function ah(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ml.call(this,e),this.type="catmullrom",this.closed=!0}function sh(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ml.call(this,e),this.type="catmullrom"}function lh(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ml.call(this,e),this.type="catmullrom"}sl.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(sl.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},Object.assign(Al.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new ci,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new jt(r.x,r.y,r.z||0))}return t}}),Object.assign(Rl.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ah.prototype=Object.create(ml.prototype),sh.prototype=Object.create(ml.prototype),lh.prototype=Object.create(ml.prototype),Object.assign(lh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Yc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},jc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(su.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),lu.extractUrlBase(e)}}),Object.assign(kc.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(vn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),fr.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(kt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),kt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),kt.ceilPowerOfTwo(e)}}),Object.assign(Wt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(zt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return void 0===oh&&(oh=new jt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),oh.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,o)}}),xn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Gt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(pr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(mr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(mr,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),mr.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),mr.getNormal(e,t,n,i)}}),Object.assign(Nl.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Es(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ps(this,e)}}),Object.assign(Vt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(jt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(pn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ci.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Zn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Zn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(va.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ya.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(sl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),la.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Pl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(hi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Oi.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Oi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Nc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(cr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Sn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(js.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(dr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ha.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(ha.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(na.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(fn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(ca.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Bu.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Hu).load(e,function(e){t.setBuffer(e)}),this},Vu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Uu.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var uh={merge:function(e,t,n){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},ch={crossOrigin:void 0,loadTexture:function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new al;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},loadTextureCube:function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new ol;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};var hh={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};e.WebGLRenderTargetCube=mn,e.WebGLRenderTarget=fn,e.WebGLRenderer=ha,e.ShaderLib=Nn,e.UniformsLib=Rn,e.UniformsUtils=_n,e.ShaderChunk=bn,e.FogExp2=da,e.Fog=pa,e.Scene=fa,e.Sprite=ga,e.LOD=va,e.SkinnedMesh=Ea,e.Skeleton=ya,e.Bone=xa,e.Mesh=gr,e.LineSegments=_a,e.LineLoop=wa,e.Line=ba,e.Points=Ma,e.Group=Aa,e.VideoTexture=Ra,e.DataTexture=gn,e.CompressedTexture=Na,e.CubeTexture=Rr,e.CanvasTexture=ia,e.DepthTexture=Pa,e.Texture=dn,e.CompressedTextureLoader=nl,e.DataTextureLoader=il,e.CubeTextureLoader=ol,e.TextureLoader=al,e.ObjectLoader=cu,e.MaterialLoader=eu,e.BufferGeometryLoader=tu,e.DefaultLoadingManager=Ks,e.LoadingManager=Zs,e.JSONLoader=uu,e.ImageLoader=rl,e.ImageBitmapLoader=mu,e.FontLoader=xu,e.FileLoader=tl,e.Loader=su,e.LoaderUtils=lu,e.Cache=Qs,e.AudioLoader=Hu,e.SpotLightShadow=Fl,e.SpotLight=Ol,e.PointLight=$l,e.RectAreaLight=Dl,e.HemisphereLight=Ll,e.DirectionalLightShadow=Hl,e.DirectionalLight=Il,e.AmbientLight=Ul,e.LightShadow=Cl,e.Light=Pl,e.StereoCamera=Iu,e.PerspectiveCamera=la,e.OrthographicCamera=ei,e.CubeCamera=Uu,e.ArrayCamera=ua,e.Camera=Kn,e.AudioListener=Du,e.PositionalAudio=ku,e.AudioContext=$u,e.AudioAnalyser=Vu,e.Audio=Bu,e.VectorKeyframeTrack=Zl,e.StringKeyframeTrack=Bl,e.QuaternionKeyframeTrack=Gl,e.NumberKeyframeTrack=Wl,e.ColorKeyframeTrack=jl,e.BooleanKeyframeTrack=kl,e.PropertyMixer=zu,e.PropertyBinding=Sc,e.KeyframeTrack=Ql,e.AnimationUtils=Jl,e.AnimationObjectGroup=Mc,e.AnimationMixer=Rc,e.AnimationClip=Kl,e.Uniform=Nc,e.InstancedBufferGeometry=Pc,e.BufferGeometry=Oi,e.Geometry=ci,e.InterleavedBufferAttribute=Lc,e.InstancedInterleavedBuffer=Fc,e.InterleavedBuffer=Cc,e.InstancedBufferAttribute=Oc,e.Face3=ti,e.Object3D=Zn,e.Raycaster=$c,e.Layers=Cn,e.EventDispatcher=t,e.Clock=Uc,e.QuaternionLinearInterpolant=zl,e.LinearInterpolant=ql,e.DiscreteInterpolant=Yl,e.CubicInterpolant=Xl,e.Interpolant=Vl,e.Triangle=mr,e.Math=kt,e.Spherical=Dc,e.Cylindrical=Bc,e.Plane=xn,e.Frustum=En,e.Sphere=yn,e.Ray=pr,e.Matrix4=zt,e.Matrix3=Wt,e.Box3=vn,e.Box2=kc,e.Line3=fr,e.Euler=Ln,e.Vector4=pn,e.Vector3=jt,e.Vector2=Vt,e.Quaternion=Gt,e.Color=Sn,e.ImmediateRenderObject=Vc,e.VertexNormalsHelper=zc,e.SpotLightHelper=Gc,e.SkeletonHelper=jc,e.PointLightHelper=Wc,e.RectAreaLightHelper=Xc,e.HemisphereLightHelper=qc,e.GridHelper=Yc,e.PolarGridHelper=Jc,e.FaceNormalsHelper=Qc,e.DirectionalLightHelper=Zc,e.CameraHelper=Kc,e.BoxHelper=eh,e.Box3Helper=th,e.PlaneHelper=nh,e.ArrowHelper=ih,e.AxesHelper=rh,e.Shape=Nl,e.Path=Rl,e.ShapePath=gu,e.Font=vu,e.CurvePath=Al,e.Curve=sl,e.ShapeUtils=vs,e.WebGLUtils=sa,e.WireframeGeometry=La,e.ParametricGeometry=Ca,e.ParametricBufferGeometry=Fa,e.TetrahedronGeometry=Ha,e.TetrahedronBufferGeometry=Ia,e.OctahedronGeometry=Ua,e.OctahedronBufferGeometry=Da,e.IcosahedronGeometry=Ba,e.IcosahedronBufferGeometry=ka,e.DodecahedronGeometry=Va,e.DodecahedronBufferGeometry=za,e.PolyhedronGeometry=Oa,e.PolyhedronBufferGeometry=$a,e.TubeGeometry=Ga,e.TubeBufferGeometry=ja,e.TorusKnotGeometry=Wa,e.TorusKnotBufferGeometry=Xa,e.TorusGeometry=qa,e.TorusBufferGeometry=Ya,e.TextGeometry=bs,e.TextBufferGeometry=_s,e.SphereGeometry=ws,e.SphereBufferGeometry=Ss,e.RingGeometry=Ms,e.RingBufferGeometry=As,e.PlaneGeometry=Ii,e.PlaneBufferGeometry=Ui,e.LatheGeometry=Rs,e.LatheBufferGeometry=Ns,e.ShapeGeometry=Ps,e.ShapeBufferGeometry=Ls,e.ExtrudeGeometry=Es,e.ExtrudeBufferGeometry=Ts,e.EdgesGeometry=Fs,e.ConeGeometry=Hs,e.ConeBufferGeometry=Is,e.CylinderGeometry=Os,e.CylinderBufferGeometry=$s,e.CircleGeometry=Us,e.CircleBufferGeometry=Ds,e.BoxGeometry=$i,e.BoxBufferGeometry=Hi,e.ShadowMaterial=ks,e.SpriteMaterial=ma,e.RawShaderMaterial=Vs,e.ShaderMaterial=dr,e.PointsMaterial=Sa,e.MeshPhysicalMaterial=Gs,e.MeshStandardMaterial=zs,e.MeshPhongMaterial=js,e.MeshToonMaterial=Ws,e.MeshNormalMaterial=Xs,e.MeshLambertMaterial=qs,e.MeshDepthMaterial=ea,e.MeshDistanceMaterial=ta,e.MeshBasicMaterial=hr,e.LineDashedMaterial=Ys,e.LineBasicMaterial=Ta,e.Material=cr,e.Float64BufferAttribute=Ei,e.Float32BufferAttribute=xi,e.Uint32BufferAttribute=yi,e.Int32BufferAttribute=vi,e.Uint16BufferAttribute=gi,e.Int16BufferAttribute=mi,e.Uint8ClampedBufferAttribute=fi,e.Uint8BufferAttribute=pi,e.Int8BufferAttribute=di,e.BufferAttribute=hi,e.ArcCurve=ul,e.CatmullRomCurve3=ml,e.CubicBezierCurve=xl,e.CubicBezierCurve3=El,e.EllipseCurve=ll,e.LineCurve=Tl,e.LineCurve3=bl,e.QuadraticBezierCurve=_l,e.QuadraticBezierCurve3=wl,e.SplineCurve=Sl,e.REVISION=Se,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=z,e.CullFaceBack=G,e.CullFaceFront=j,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=I,e.PCFSoftShadowMap=U,e.FrontSide=$,e.BackSide=Y,e.DoubleSide=J,e.FlatShading=1,e.SmoothShading=2,e.NoColors=Me,e.FaceColors=b,e.VertexColors=_,e.NoBlending=W,e.NormalBlending=X,e.AdditiveBlending=q,e.SubtractiveBlending=Q,e.MultiplyBlending=Z,e.CustomBlending=K,e.AddEquation=w,e.SubtractEquation=S,e.ReverseSubtractEquation=M,e.MinEquation=A,e.MaxEquation=R,e.ZeroFactor=N,e.OneFactor=P,e.SrcColorFactor=L,e.OneMinusSrcColorFactor=C,e.SrcAlphaFactor=F,e.OneMinusSrcAlphaFactor=O,e.DstAlphaFactor=H,e.OneMinusDstAlphaFactor=D,e.DstColorFactor=B,e.OneMinusDstColorFactor=k,e.SrcAlphaSaturateFactor=V,e.NeverDepth=ee,e.AlwaysDepth=te,e.LessDepth=ne,e.LessEqualDepth=ie,e.EqualDepth=re,e.GreaterEqualDepth=oe,e.GreaterDepth=ae,e.NotEqualDepth=se,e.MultiplyOperation=le,e.MixOperation=ue,e.AddOperation=ce,e.NoToneMapping=he,e.LinearToneMapping=Ae,e.ReinhardToneMapping=de,e.Uncharted2ToneMapping=pe,e.CineonToneMapping=fe,e.UVMapping=300,e.CubeReflectionMapping=me,e.CubeRefractionMapping=ge,e.EquirectangularReflectionMapping=ve,e.EquirectangularRefractionMapping=ye,e.SphericalReflectionMapping=xe,e.CubeUVReflectionMapping=Ee,e.CubeUVRefractionMapping=Te,e.RepeatWrapping=be,e.ClampToEdgeWrapping=_e,e.MirroredRepeatWrapping=we,e.NearestFilter=Re,e.NearestMipMapNearestFilter=Ne,e.NearestMipMapLinearFilter=Pe,e.LinearFilter=Le,e.LinearMipMapNearestFilter=Ce,e.LinearMipMapLinearFilter=Fe,e.UnsignedByteType=Oe,e.ByteType=$e,e.ShortType=He,e.UnsignedShortType=Ie,e.IntType=Ue,e.UnsignedIntType=De,e.FloatType=Be,e.HalfFloatType=ke,e.UnsignedShort4444Type=Ve,e.UnsignedShort5551Type=ze,e.UnsignedShort565Type=Ge,e.UnsignedInt248Type=je,e.AlphaFormat=We,e.RGBFormat=Xe,e.RGBAFormat=qe,e.LuminanceFormat=Ye,e.LuminanceAlphaFormat=Je,e.RGBEFormat=Qe,e.DepthFormat=Ze,e.DepthStencilFormat=Ke,e.RGB_S3TC_DXT1_Format=et,e.RGBA_S3TC_DXT1_Format=tt,e.RGBA_S3TC_DXT3_Format=nt,e.RGBA_S3TC_DXT5_Format=it,e.RGB_PVRTC_4BPPV1_Format=rt,e.RGB_PVRTC_2BPPV1_Format=ot,e.RGBA_PVRTC_4BPPV1_Format=at,e.RGBA_PVRTC_2BPPV1_Format=st,e.RGB_ETC1_Format=lt,e.RGBA_ASTC_4x4_Format=ut,e.RGBA_ASTC_5x4_Format=ct,e.RGBA_ASTC_5x5_Format=ht,e.RGBA_ASTC_6x5_Format=dt,e.RGBA_ASTC_6x6_Format=pt,e.RGBA_ASTC_8x5_Format=ft,e.RGBA_ASTC_8x6_Format=mt,e.RGBA_ASTC_8x8_Format=gt,e.RGBA_ASTC_10x5_Format=vt,e.RGBA_ASTC_10x6_Format=yt,e.RGBA_ASTC_10x8_Format=xt,e.RGBA_ASTC_10x10_Format=Et,e.RGBA_ASTC_12x10_Format=Tt,e.RGBA_ASTC_12x12_Format=bt,e.LoopOnce=2200,e.LoopRepeat=_t,e.LoopPingPong=2202,e.InterpolateDiscrete=wt,e.InterpolateLinear=St,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=Mt,e.ZeroSlopeEnding=At,e.WrapAroundEnding=Rt,e.TrianglesDrawMode=Nt,e.TriangleStripDrawMode=Pt,e.TriangleFanDrawMode=Lt,e.LinearEncoding=Ct,e.sRGBEncoding=Ft,e.GammaEncoding=Ot,e.RGBEEncoding=$t,e.LogLuvEncoding=3003,e.RGBM7Encoding=Ht,e.RGBM16Encoding=It,e.RGBDEncoding=Ut,e.BasicDepthPacking=Dt,e.RGBADepthPacking=Bt,e.CubeGeometry=$i,e.Face4=function(e,t,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ti(e,t,n,r,o,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ma(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ga(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ma(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Sa(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Sa(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Sa(e)},e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new jt(e,t,n)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new hi(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new di(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new pi(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new fi(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new mi(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new gi(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new vi(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new yi(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xi(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ei(e,t)},e.ClosedSplineCurve3=ah,e.SplineCurve3=sh,e.Spline=lh,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new rh(e)},e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new eh(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new _a(new Fs(e.geometry),new Ta({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new _a(new La(e.geometry),new Ta({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new tl(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new il(e)},e.GeometryUtils=uh,e.ImageUtils=ch,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},e.SceneUtils=hh,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},Object.defineProperty(e,"__esModule",{value:!0})});var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,n,i;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(i=Detector.getWebGLErrorMessage()).id=n,t.appendChild(i)}};"object"==typeof module&&(module.exports=Detector),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){var t,Y,o,J,Q,Z,K,ee,r,te,ne,n=[],i=0,ie=[],a=0,s=[],l=0,u=[],c=0,h=[],d=0,re={objects:[],lights:[],elements:[]},oe=new THREE.Vector3,ae=new THREE.Vector4,m=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),g=new THREE.Box3,v=new Array(3),se=new THREE.Matrix4,le=new THREE.Matrix4,ue=new THREE.Matrix4,ce=new THREE.Matrix3,he=new THREE.Frustum,de=new THREE.Vector4,pe=new THREE.Vector4;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var fe=new function(){var l=[],r=[],u=[],c=null,h=null,d=new THREE.Matrix3;function i(e){var t=e.position,n=e.positionWorld,i=e.positionScreen;n.copy(t).applyMatrix4(ne),i.copy(n).applyMatrix4(le);var r=1/i.w;i.x*=r,i.y*=r,i.z*=r,e.visible=-1<=i.x&&i.x<=1&&-1<=i.y&&i.y<=1&&-1<=i.z&&i.z<=1}function p(e,t,n){return!0===e.visible||!0===t.visible||!0===n.visible||(v[0]=e.positionScreen,v[1]=t.positionScreen,v[2]=n.positionScreen,m.intersectsBox(g.setFromPoints(v)))}function f(e,t,n){return(n.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(n.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(e){h=(c=e).material,d.getNormalMatrix(c.matrixWorld),l.length=0,r.length=0,u.length=0},projectVertex:i,checkTriangleVisibility:p,checkBackfaceCulling:f,pushVertex:function(e,t,n){(o=ve()).position.set(e,t,n),i(o)},pushNormal:function(e,t,n){l.push(e,t,n)},pushColor:function(e,t,n){r.push(e,t,n)},pushUv:function(e,t){u.push(e,t)},pushLine:function(e,t){var n=ie[e],i=ie[t];n.positionScreen.copy(n.position).applyMatrix4(ue),i.positionScreen.copy(i.position).applyMatrix4(ue),!0===Te(n.positionScreen,i.positionScreen)&&(n.positionScreen.multiplyScalar(1/n.positionScreen.w),i.positionScreen.multiplyScalar(1/i.positionScreen.w),(K=xe()).id=c.id,K.v1.copy(n),K.v2.copy(i),K.z=Math.max(n.positionScreen.z,i.positionScreen.z),K.renderOrder=c.renderOrder,K.material=c.material,c.material.vertexColors===THREE.VertexColors&&(K.vertexColors[0].fromArray(r,3*e),K.vertexColors[1].fromArray(r,3*t)),re.elements.push(K))},pushTriangle:function(e,t,n){var i=ie[e],r=ie[t],o=ie[n];if(!1!==p(i,r,o)&&(h.side===THREE.DoubleSide||!0===f(i,r,o))){(Q=ye()).id=c.id,Q.v1.copy(i),Q.v2.copy(r),Q.v3.copy(o),Q.z=(i.positionScreen.z+r.positionScreen.z+o.positionScreen.z)/3,Q.renderOrder=c.renderOrder,Q.normalModel.fromArray(l,3*e),Q.normalModel.applyMatrix3(d).normalize();for(var a=0;a<3;a++){var s=Q.vertexNormalsModel[a];s.fromArray(l,3*arguments[a]),s.applyMatrix3(d).normalize(),Q.uvs[a].fromArray(u,2*arguments[a])}Q.vertexNormalsLength=3,Q.material=c.material,re.elements.push(Q)}}}};function me(e){(t=function(){if(Y===i){var e=new THREE.RenderableObject;return n.push(e),i++,Y++,e}return n[Y++]}()).id=e.id,t.object=e,oe.setFromMatrixPosition(e.matrixWorld),oe.applyMatrix4(le),t.z=oe.z,t.renderOrder=e.renderOrder,re.objects.push(t)}function ge(e,t,n){var i=1/e.w;e.z*=i,-1<=e.z&&e.z<=1&&((r=function(){if(te===d){var e=new THREE.RenderableSprite;return h.push(e),d++,te++,e}return h[te++]}()).id=t.id,r.x=e.x*i,r.y=e.y*i,r.z=e.z,r.renderOrder=t.renderOrder,r.object=t,r.rotation=t.rotation,r.scale.x=t.scale.x*Math.abs(r.x-(e.x+n.projectionMatrix.elements[0])/(e.w+n.projectionMatrix.elements[12])),r.scale.y=t.scale.y*Math.abs(r.y-(e.y+n.projectionMatrix.elements[5])/(e.w+n.projectionMatrix.elements[13])),r.material=t.material,re.elements.push(r))}function ve(){if(J===a){var e=new THREE.RenderableVertex;return ie.push(e),a++,J++,e}return ie[J++]}function ye(){if(Z===l){var e=new THREE.RenderableFace;return s.push(e),l++,Z++,e}return s[Z++]}function xe(){if(ee===c){var e=new THREE.RenderableLine;return u.push(e),c++,ee++,e}return u[ee++]}function Ee(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function Te(e,t){var n=0,i=1,r=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return 0<=r&&0<=o&&0<=a&&0<=s||!(r<0&&o<0||a<0&&s<0)&&(r<0?n=Math.max(n,r/(r-o)):o<0&&(i=Math.min(i,r/(r-o))),a<0?n=Math.max(n,a/(a-s)):s<0&&(i=Math.min(i,a/(a-s))),!(i<n)&&(e.lerp(t,n),t.lerp(e,1-i),!0))}this.projectScene=function(e,t,n,i){te=ee=Z=0,!(re.elements.length=0)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),se.copy(t.matrixWorldInverse),le.multiplyMatrices(t.projectionMatrix,se),he.setFromMatrix(le),Y=0,re.objects.length=0,re.lights.length=0,function e(t){if(!1!==t.visible){if(t instanceof THREE.Light)re.lights.push(t);else if(t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Points){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===he.intersectsObject(t))return;me(t)}else if(t instanceof THREE.Sprite){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===he.intersectsSprite(t))return;me(t)}for(var n=t.children,i=0,r=n.length;i<r;i++)e(n[i])}}(e),!0===n&&re.objects.sort(Ee);for(var r=re.objects,o=0,a=r.length;o<a;o++){var s=r[o].object,l=s.geometry;if(fe.setObject(s),ne=s.matrixWorld,J=0,s instanceof THREE.Mesh){if(l instanceof THREE.BufferGeometry){var u=l.attributes,c=l.groups;if(void 0===u.position)continue;for(var h=0,d=(q=u.position.array).length;h<d;h+=3)fe.pushVertex(q[h],q[h+1],q[h+2]);if(void 0!==u.normal){var p=u.normal.array;for(h=0,d=p.length;h<d;h+=3)fe.pushNormal(p[h],p[h+1],p[h+2])}if(void 0!==u.uv){var f=u.uv.array;for(h=0,d=f.length;h<d;h+=2)fe.pushUv(f[h],f[h+1])}if(null!==l.index){var m=l.index.array;if(0<c.length)for(var g=0;g<c.length;g++){var v=c[g];for(h=v.start,d=v.start+v.count;h<d;h+=3)fe.pushTriangle(m[h],m[h+1],m[h+2])}else for(h=0,d=m.length;h<d;h+=3)fe.pushTriangle(m[h],m[h+1],m[h+2])}else for(h=0,d=q.length/3;h<d;h+=3)fe.pushTriangle(h,h+1,h+2)}else if(l instanceof THREE.Geometry){var y=l.vertices,x=l.faces,E=l.faceVertexUvs[0];ce.getNormalMatrix(ne);for(var T=s.material,b=Array.isArray(T),_=0,w=y.length;_<w;_++){var S=y[_];if(oe.copy(S),!0===T.morphTargets)for(var M=l.morphTargets,A=s.morphTargetInfluences,R=0,N=M.length;R<N;R++){var P=A[R];if(0!==P){var L=M[R].vertices[_];oe.x+=(L.x-S.x)*P,oe.y+=(L.y-S.y)*P,oe.z+=(L.z-S.z)*P}}fe.pushVertex(oe.x,oe.y,oe.z)}for(var C=0,F=x.length;C<F;C++){var O=x[C];if(void 0!==(T=!0===b?s.material[O.materialIndex]:s.material)){var $=T.side,H=ie[O.a],I=ie[O.b],U=ie[O.c];if(!1!==fe.checkTriangleVisibility(H,I,U)){var D=fe.checkBackfaceCulling(H,I,U);if($!==THREE.DoubleSide){if($===THREE.FrontSide&&!1===D)continue;if($===THREE.BackSide&&!0===D)continue}(Q=ye()).id=s.id,Q.v1.copy(H),Q.v2.copy(I),Q.v3.copy(U),Q.normalModel.copy(O.normal),!1!==D||$!==THREE.BackSide&&$!==THREE.DoubleSide||Q.normalModel.negate(),Q.normalModel.applyMatrix3(ce).normalize();for(var B=O.vertexNormals,k=0,V=Math.min(B.length,3);k<V;k++){var z=Q.vertexNormalsModel[k];z.copy(B[k]),!1!==D||$!==THREE.BackSide&&$!==THREE.DoubleSide||z.negate(),z.applyMatrix3(ce).normalize()}Q.vertexNormalsLength=B.length;var G=E[C];if(void 0!==G)for(var j=0;j<3;j++)Q.uvs[j].copy(G[j]);Q.color=O.color,Q.material=T,Q.z=(H.positionScreen.z+I.positionScreen.z+U.positionScreen.z)/3,Q.renderOrder=s.renderOrder,re.elements.push(Q)}}}}}else if(s instanceof THREE.Line){if(ue.multiplyMatrices(le,ne),l instanceof THREE.BufferGeometry){if(void 0!==(u=l.attributes).position){for(h=0,d=(q=u.position.array).length;h<d;h+=3)fe.pushVertex(q[h],q[h+1],q[h+2]);if(void 0!==u.color){var W=u.color.array;for(h=0,d=W.length;h<d;h+=3)fe.pushColor(W[h],W[h+1],W[h+2])}if(null!==l.index)for(h=0,d=(m=l.index.array).length;h<d;h+=2)fe.pushLine(m[h],m[h+1]);else{var X=s instanceof THREE.LineSegments?2:1;for(h=0,d=q.length/3-1;h<d;h+=X)fe.pushLine(h,h+1)}}}else if(l instanceof THREE.Geometry){if(0===(y=s.geometry.vertices).length)continue;(H=ve()).positionScreen.copy(y[0]).applyMatrix4(ue);for(X=s instanceof THREE.LineSegments?2:1,_=1,w=y.length;_<w;_++)(H=ve()).positionScreen.copy(y[_]).applyMatrix4(ue),0<(_+1)%X||(I=ie[J-2],de.copy(H.positionScreen),pe.copy(I.positionScreen),!0===Te(de,pe)&&(de.multiplyScalar(1/de.w),pe.multiplyScalar(1/pe.w),(K=xe()).id=s.id,K.v1.positionScreen.copy(de),K.v2.positionScreen.copy(pe),K.z=Math.max(de.z,pe.z),K.renderOrder=s.renderOrder,K.material=s.material,s.material.vertexColors===THREE.VertexColors&&(K.vertexColors[0].copy(s.geometry.colors[_]),K.vertexColors[1].copy(s.geometry.colors[_-1])),re.elements.push(K)))}}else if(s instanceof THREE.Points){if(ue.multiplyMatrices(le,ne),l instanceof THREE.Geometry)for(_=0,w=(y=s.geometry.vertices).length;_<w;_++){S=y[_];ae.set(S.x,S.y,S.z,1),ae.applyMatrix4(ue),ge(ae,s,t)}else if(l instanceof THREE.BufferGeometry){if(void 0!==(u=l.attributes).position){var q;for(h=0,d=(q=u.position.array).length;h<d;h+=3)ae.set(q[h],q[h+1],q[h+2],1),ae.applyMatrix4(ue),ge(ae,s,t)}}}else s instanceof THREE.Sprite&&(ae.set(ne.elements[12],ne.elements[13],ne.elements[14],1),ae.applyMatrix4(le),ge(ae,s,t))}return!0===i&&re.elements.sort(Ee),re}},THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},THREE.FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immedates.","    // Immedates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},THREE.EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var n={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},i=e.getDrawingBufferSize();(t=new THREE.WebGLRenderTarget(i.width,i.height,n)).texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===THREE.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize();e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){var t,n,i=!1,r=this.passes.length;for(n=0;n<r;n++)if(!1!==(t=this.passes[n]).enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),t.needsSwap){if(i){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(t instanceof THREE.MaskPass?i=!0:t instanceof THREE.ClearMaskPass&&(i=!1))}},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize();(e=this.renderTarget1.clone()).setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(e,t)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(e,t){},render:function(e,t,n,i,r){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),THREE.RenderPass=function(e,t,n,i,r){THREE.Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==r?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(e,t,n,i,r){var o,a,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(o=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.render(this.scene,this.camera,this.renderToScreen?null:n,this.clear),this.clearColor&&e.setClearColor(o,a),this.scene.overrideMaterial=null,e.autoClear=s}}),THREE.ShaderPass=function(e,t){THREE.Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(e,t,n,i,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}),THREE.OutlinePass=function(e,t,n,i){this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==i?i:[],this.visibleEdgeColor=new THREE.Color(1,1,1),this.hiddenEdgeColor=new THREE.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,THREE.Pass.call(this),this.resolution=void 0!==e?new THREE.Vector2(e.x,e.y):new THREE.Vector2(256,256);var r,o,a,s={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},l=Math.round(this.resolution.x/this.downSampleRatio),u=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new THREE.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=THREE.DoubleSide,this.renderTargetMaskBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,s),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthMaterial.side=THREE.DoubleSide,this.depthMaterial.depthPacking=THREE.RGBADepthPacking,this.depthMaterial.blending=THREE.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=THREE.DoubleSide,this.prepareMaskMaterial.fragmentShader=(r=this.prepareMaskMaterial.fragmentShader,o=this.renderCamera,a=o.isPerspectiveCamera?"perspective":"orthographic",r.replace(/DEPTH_TO_VIEW_Z/g,a+"DepthToViewZ")),this.renderTargetDepthBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,s),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new THREE.WebGLRenderTarget(l,u,s),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new THREE.WebGLRenderTarget(l,u,s),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new THREE.WebGLRenderTarget(Math.round(l/2),Math.round(u/2),s),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new THREE.WebGLRenderTarget(l,u,s),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new THREE.WebGLRenderTarget(Math.round(l/2),Math.round(u/2),s),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(l,u),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(Math.round(l/2),Math.round(u/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===THREE.CopyShader&&console.error("THREE.OutlinePass relies on THREE.CopyShader");var c=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.tempPulseColor1=new THREE.Color,this.tempPulseColor2=new THREE.Color,this.textureMatrix=new THREE.Matrix4},THREE.OutlinePass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.OutlinePass,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var n=Math.round(e/this.downSampleRatio),i=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,i),this.renderTargetBlurBuffer1.setSize(n,i),this.renderTargetEdgeBuffer1.setSize(n,i),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(n,i),n=Math.round(n/2),i=Math.round(i/2),this.renderTargetBlurBuffer2.setSize(n,i),this.renderTargetEdgeBuffer2.setSize(n,i),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(n,i)},changeVisibilityOfSelectedObjects:function(t){function e(e){e instanceof THREE.Mesh&&(e.visible=t)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(e)}},changeVisibilityOfNonSelectedObjects:function(r){var o=[];function e(e){e instanceof THREE.Mesh&&o.push(e)}for(var t=0;t<this.selectedObjects.length;t++){this.selectedObjects[t].traverse(e)}this.renderScene.traverse(function(e){if(e instanceof THREE.Mesh||e instanceof THREE.Line||e instanceof THREE.Sprite){for(var t=!1,n=0;n<o.length;n++)if(o[n].id===e.id){t=!0;break}if(!t){var i=e.visible;r&&!e.bVisible||(e.visible=r),e.bVisible=i}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,n,i,r){if(0!==this.selectedObjects.length){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,r&&e.context.disable(e.context.STENCIL_TEST),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.render(this.renderScene,this.renderCamera,this.renderTargetDepthBuffer,!0),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new THREE.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.render(this.renderScene,this.renderCamera,this.renderTargetMaskBuffer,!0),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=a,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.render(this.scene,this.camera,this.renderTargetMaskDownSampleBuffer,!0),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),0<this.pulsePeriod){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=THREE.OutlinePass.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.render(this.scene,this.camera,this.renderTargetBlurBuffer1,!0),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=THREE.OutlinePass.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=THREE.OutlinePass.BlurDirectionX,e.render(this.scene,this.camera,this.renderTargetBlurBuffer2,!0),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=THREE.OutlinePass.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer2,!0),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,r&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,n,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}},getPrepareMaskMaterial:function(){return new THREE.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new THREE.Vector2(.5,.5)},textureMatrix:{value:new THREE.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),THREE.OutlinePass.BlurDirectionX=new THREE.Vector2(1,0),THREE.OutlinePass.BlurDirectionY=new THREE.Vector2(0,1),THREE.GLNode=function(e){this.uuid=THREE.Math.generateUUID(),this.name="",this.allows={},this.type=e,this.userData={}},THREE.GLNode.prototype.isNode=!0,THREE.GLNode.prototype.parse=function(e,t){t=t||{},e.parsing=!0;var n=e.material;this.build(e.addCache(t.cache,t.requires).addSlot(t.slot),"v4"),n.clearVertexNode(),n.clearFragmentNode(),e.removeCache().removeSlot(),e.parsing=!1},THREE.GLNode.prototype.parseAndBuildCode=function(e,t,n){return n=n||{},this.parse(e,n),this.buildCode(e,t,n)},THREE.GLNode.prototype.buildCode=function(e,t,n){n=n||{};var i=e.material,r={result:this.build(e.addCache(n.cache,n.requires).addSlot(n.slot),t)};return e.isShader("vertex")?r.code=i.clearVertexNode():r.code=i.clearFragmentNode(),e.removeCache().removeSlot(),r},THREE.GLNode.prototype.build=function(e,t,n){t=t||this.getType(e,t);var i=e.material,r=i.getDataNode(n||this.uuid);if(e.parsing&&this.appendDepsNode(e,r,t),!1===this.allows[e.shader])throw new Error("Shader "+shader+" is not compatible with this node.");return-1===i.nodes.indexOf(this)&&i.nodes.push(this),void 0!==this.updateFrame&&-1===i.updaters.indexOf(this)&&i.updaters.push(this),this.generate(e,t,n)},THREE.GLNode.prototype.appendDepsNode=function(e,t,n){t.deps=(t.deps||0)+1;var i=e.getFormatLength(n);(i>(t.outputMax||0)||this.getType(e,n))&&(t.outputMax=i,t.output=n)},THREE.GLNode.prototype.getType=function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type},THREE.GLNode.prototype.getJSONNode=function(e){if(!(void 0===e||"string"==typeof e)&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},THREE.GLNode.prototype.createJSONNode=function(e){var t=void 0===e||"string"==typeof e,n={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return n.uuid=this.uuid,n.type=this.nodeType+"Node",""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.nodes[this.uuid]=n),n},THREE.GLNode.prototype.toJSON=function(e){return this.getJSONNode(e)||this.createJSONNode(e)},THREE.RawNode=function(e){THREE.GLNode.call(this,"v4"),this.value=e},THREE.RawNode.prototype=Object.create(THREE.GLNode.prototype),THREE.RawNode.prototype.constructor=THREE.RawNode,THREE.RawNode.prototype.nodeType="Raw",THREE.RawNode.prototype.generate=function(e){e.material;var t=this.value.parseAndBuildCode(e,this.type),n=t.code+"\n";return"vertex"==e.shader?n+="gl_Position = "+t.result+";":n+="gl_FragColor = "+t.result+";",n},THREE.RawNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t},THREE.TempNode=function(e,t){THREE.GLNode.call(this,e),t=t||{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique},THREE.TempNode.prototype=Object.create(THREE.GLNode.prototype),THREE.TempNode.prototype.constructor=THREE.TempNode,THREE.TempNode.prototype.build=function(e,t,n,i){t=t||this.getType(e);var r=e.material;if(this.isShared(e,t)){var o=this.isUnique(e,t);o&&void 0===this.constructor.uuid&&(this.constructor.uuid=THREE.Math.generateUUID()),n=e.getUuid(n||this.getUuid(),!o);var a=r.getDataNode(n);if(e.parsing)return a.deps?(this.appendDepsNode(e,a,t),this.generate(e,l,n)):THREE.GLNode.prototype.build.call(this,e,t,n);if(o)return a.name=a.name||THREE.GLNode.prototype.build.call(this,e,t,n),a.name;if(!e.optimize||1==a.deps)return THREE.GLNode.prototype.build.call(this,e,t,n);n=this.getUuid(!1);var s=this.getTemp(e,n),l=a.output||this.getType(e);if(s)return e.format(s,l,t);s=THREE.TempNode.prototype.generate.call(this,e,t,n,a.output,i);var u=this.generate(e,l,n);return e.isShader("vertex")?r.addVertexNode(s+"="+u+";"):r.addFragmentNode(s+"="+u+";"),e.format(s,l,t)}return THREE.GLNode.prototype.build.call(this,e,t,n)},THREE.TempNode.prototype.isShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},THREE.TempNode.prototype.isUnique=function(e,t){return this.unique},THREE.TempNode.prototype.getUuid=function(e){var t=(e||null==e)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t},THREE.TempNode.prototype.getTemp=function(e,t){t=t||this.uuid;var n=e.material;return e.isShader("vertex")&&n.vertexTemps[t]?n.vertexTemps[t].name:n.fragmentTemps[t]?n.fragmentTemps[t].name:void 0},THREE.TempNode.prototype.generate=function(e,t,n,i,r){return this.isShared(e,t)||console.error("THREE.TempNode is not shared!"),n=n||this.uuid,e.isShader("vertex")?e.material.getVertexTemp(n,i||this.getType(e),r).name:e.material.getFragmentTemp(n,i||this.getType(e),r).name},THREE.InputNode=function(e,t){(t=t||{}).shared=void 0!==t.shared&&t.shared,THREE.TempNode.call(this,e,t),this.readonly=!1},THREE.InputNode.prototype=Object.create(THREE.TempNode.prototype),THREE.InputNode.prototype.constructor=THREE.InputNode,THREE.InputNode.prototype.isReadonly=function(e){return this.readonly},THREE.InputNode.prototype.generate=function(e,t,n,i,r,o){var a=e.material;n=e.getUuid(n||this.getUuid()),i=i||this.getType(e);var s=a.getDataNode(n);return this.isReadonly(e)&&void 0!==this.generateReadonly?this.generateReadonly(e,t,n,i,r,o):e.isShader("vertex")?(s.vertex||(s.vertex=a.createVertexUniform(i,this.value,r,o)),e.format(s.vertex.name,i,t)):(s.fragment||(s.fragment=a.createFragmentUniform(i,this.value,r,o)),e.format(s.fragment.name,i,t))},THREE.ConstNode=function(e,t){THREE.TempNode.call(this),this.eval(e||THREE.ConstNode.PI,t)},THREE.ConstNode.PI="PI",THREE.ConstNode.PI2="PI2",THREE.ConstNode.RECIPROCAL_PI="RECIPROCAL_PI",THREE.ConstNode.RECIPROCAL_PI2="RECIPROCAL_PI2",THREE.ConstNode.LOG2="LOG2",THREE.ConstNode.EPSILON="EPSILON",THREE.ConstNode.prototype=Object.create(THREE.TempNode.prototype),THREE.ConstNode.prototype.constructor=THREE.ConstNode,THREE.ConstNode.prototype.nodeType="Const",THREE.ConstNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},THREE.ConstNode.prototype.eval=function(e,t){var n,i,r="",o=(e=(e||"").trim()).match(/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i);this.useDefine=t,o&&1<o.length?(i=o[1],n=o[2],r=o[3]):(n=e,i="fv1"),this.name=n,this.type=i,this.value=r},THREE.ConstNode.prototype.build=function(e,t){return"source"!==t?(e.include(this),e.format(this.name,this.getType(e),t)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":void 0},THREE.ConstNode.prototype.generate=function(e,t){return e.format(this.name,this.getType(e),t)},THREE.ConstNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).name=this.name,t.out=this.type,this.value&&(t.value=this.value),!0===t.useDefine&&(t.useDefine=!0)),t},THREE.VarNode=function(e){THREE.GLNode.call(this,e)},THREE.VarNode.prototype=Object.create(THREE.GLNode.prototype),THREE.VarNode.prototype.constructor=THREE.VarNode,THREE.VarNode.prototype.nodeType="Var",THREE.VarNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},THREE.VarNode.prototype.generate=function(e,t){var n=e.material.getVar(this.uuid,this.type);return e.format(n.name,this.getType(e),t)},THREE.VarNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).out=this.type),t},THREE.FunctionNode=function(e,t,n,i){e=e||"",this.isMethod="string"!=typeof t,this.useKeywords=!0,THREE.TempNode.call(this,this.isMethod?null:t),this.isMethod?this.eval(e,t,n,i):this.eval(e,n,i)},THREE.FunctionNode.rDeclaration=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\((.*?)\)/i,THREE.FunctionNode.rProperties=/[a-z_0-9]+/gi,THREE.FunctionNode.prototype=Object.create(THREE.TempNode.prototype),THREE.FunctionNode.prototype.constructor=THREE.FunctionNode,THREE.FunctionNode.prototype.nodeType="Function",THREE.FunctionNode.prototype.isShared=function(e,t){return!this.isMethod},THREE.FunctionNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},THREE.FunctionNode.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},THREE.FunctionNode.prototype.getIncludeByName=function(e){for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]},THREE.FunctionNode.prototype.generate=function(e,t){for(var n,i=0,r=this.value,o=0;o<this.includes.length;o++)e.include(this.includes[o],this);for(var a in this.extensions)e.material.extensions[a]=!0;for(;n=THREE.FunctionNode.rProperties.exec(this.value);){var s=n[0],l=!this.isMethod||!this.getInputByName(s),u=s;if(this.keywords[s]||this.useKeywords&&l&&THREE.NodeLib.containsKeyword(s)){var c=this.keywords[s];if(!c){var h=THREE.NodeLib.getKeywordData(s);h.cache&&(c=e.keywords[s]),c=c||THREE.NodeLib.getKeyword(s,e),h.cache&&(e.keywords[s]=c)}u=c.build(e)}s!=u&&(r=r.substring(0,n.index+i)+u+r.substring(n.index+s.length+i),i+=u.length-s.length),void 0===this.getIncludeByName(u)&&THREE.NodeLib.contains(u)&&e.include(THREE.NodeLib.get(u))}return"source"===t?r:this.isMethod?(e.include(this,!1,r),this.name):e.format("("+r+")",this.getType(e),t)},THREE.FunctionNode.prototype.eval=function(e,t,n,i){if(e=(e||"").trim(),this.includes=t||[],this.extensions=n||{},this.keywords=i||{},this.isMethod){var r=e.match(THREE.FunctionNode.rDeclaration);if(this.inputs=[],r&&4==r.length){this.type=r[1],this.name=r[2];var o=r[3].match(THREE.FunctionNode.rProperties);if(o)for(var a=0;a<o.length;){var s,l,u=o[a++];"in"==u||"out"==u||"inout"==u?s=o[a++]:(s=u,u=""),l=o[a++],this.inputs.push({name:l,type:s,qualifier:u})}}else this.type="",this.name=""}this.value=e},THREE.FunctionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){for(var n in(t=this.createJSONNode(e)).src=this.value,t.isMethod=this.isMethod,t.useKeywords=this.useKeywords,this.isMethod||(t.out=this.type),t.extensions=JSON.parse(JSON.stringify(this.extensions)),t.keywords={},this.keywords)t.keywords[n]=this.keywords[n].toJSON(e).uuid;if(this.includes.length){t.includes=[];for(var i=0;i<this.includes.length;i++)t.includes.push(this.includes[i].toJSON(e).uuid)}}return t},THREE.FunctionCallNode=function(e,t){THREE.TempNode.call(this),this.setFunction(e,t)},THREE.FunctionCallNode.prototype=Object.create(THREE.TempNode.prototype),THREE.FunctionCallNode.prototype.constructor=THREE.FunctionCallNode,THREE.FunctionCallNode.prototype.nodeType="FunctionCall",THREE.FunctionCallNode.prototype.setFunction=function(e,t){this.value=e,this.inputs=t||[]},THREE.FunctionCallNode.prototype.getFunction=function(){return this.value},THREE.FunctionCallNode.prototype.getType=function(e){return this.value.getType(e)},THREE.FunctionCallNode.prototype.generate=function(e,t){e.material;for(var n=this.getType(e),i=this.value,r=i.build(e,t)+"(",o=[],a=0;a<i.inputs.length;a++){var s=i.inputs[a],l=this.inputs[a]||this.inputs[s.name];o.push(l.build(e,e.getTypeByFormat(s.type)))}return r+=o.join(",")+")",e.format(r,n,t)},THREE.FunctionCallNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){var n=this.value;if((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,n.inputs.length){t.inputs={};for(var i=0;i<n.inputs.length;i++){var r=n.inputs[i],o=this.inputs[i]||this.inputs[r.name];t.inputs[r.name]=o.toJSON(e).uuid}}}return t},THREE.AttributeNode=function(e,t){THREE.GLNode.call(this,t),this.name=e},THREE.AttributeNode.prototype=Object.create(THREE.GLNode.prototype),THREE.AttributeNode.prototype.constructor=THREE.AttributeNode,THREE.AttributeNode.prototype.nodeType="Attribute",THREE.AttributeNode.prototype.getAttributeType=function(e){return"number"==typeof this.type?e.getConstructorFromLength(this.type):this.type},THREE.AttributeNode.prototype.getType=function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)},THREE.AttributeNode.prototype.generate=function(e,t){var n=this.getAttributeType(e),i=e.material.getAttribute(this.name,n);return e.format(e.isShader("vertex")?this.name:i.varying.name,this.getType(e),t)},THREE.AttributeNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).out=this.type),t},THREE.NodeBuilder=function(e){this.material=e,this.caches=[],this.slots=[],this.keywords={},this.parsing=!1,this.optimize=!0,this.update()},THREE.NodeBuilder.type={float:"fv1",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"iv1"},THREE.NodeBuilder.constructors=["float","vec2","vec3","vec4"],THREE.NodeBuilder.elements=["x","y","z","w"],THREE.NodeBuilder.prototype={constructor:THREE.NodeBuilder,addCache:function(e,t){return this.caches.push({name:e||"",requires:t||{}}),this.update()},removeCache:function(){return this.caches.pop(),this.update()},addSlot:function(e){return this.slots.push({name:e||""}),this.update()},removeSlot:function(){return this.slots.pop(),this.update()},isCache:function(e){for(var t=this.caches.length;t--;)if(this.caches[t].name==e)return!0;return!1},isSlot:function(e){for(var t=this.slots.length;t--;)if(this.slots[t].name==e)return!0;return!1},update:function(){var e=this.caches[this.caches.length-1],t=this.slots[this.slots.length-1];return this.slot=t?t.name:"",this.cache=e?e.name:"",this.requires=e?e.requires:{},this},require:function(e,t){return this.requires[e]=t,this},include:function(e,t,n){return this.material.include(this,e,t,n),this},colorToVector:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},getConstructorFromLength:function(e){return THREE.NodeBuilder.constructors[e-1]},getFormatName:function(e){return e.replace(/c/g,"v3").replace(/fv1/g,"v1").replace(/iv1/g,"i")},isFormatMatrix:function(e){return/^m/.test(e)},getFormatLength:function(e){return parseInt(this.getFormatName(e).substr(1))},getFormatFromLength:function(e){return 1==e?"fv1":"v"+e},format:function(e,t,n){switch(this.getFormatName(n+"="+t)){case"v1=v2":case"v1=v3":case"v1=v4":return e+".x";case"v1=i":return"float("+e+")";case"v2=v1":return"vec2("+e+")";case"v2=v3":case"v2=v4":return e+".xy";case"v2=i":return"vec2(float("+e+"))";case"v3=v1":return"vec3("+e+")";case"v3=v2":return"vec3("+e+",0.0)";case"v3=v4":return e+".xyz";case"v3=i":return"vec2(float("+e+"))";case"v4=v1":return"vec4("+e+")";case"v4=v2":return"vec4("+e+",0.0,1.0)";case"v4=v3":return"vec4("+e+",1.0)";case"v4=i":return"vec4(float("+e+"))";case"i=v1":return"int("+e+")";case"i=v2":case"i=v3":case"i=v4":return"int("+e+".x)"}return e},getTypeByFormat:function(e){return THREE.NodeBuilder.type[e]||e},getUuid:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return THREE.NodeBuilder.elements[e]},getIndexByElement:function(e){return THREE.NodeBuilder.elements.indexOf(e)},isShader:function(e){return this.shader==e},setShader:function(e){return this.shader=e,this}},THREE.NodeLib={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,t,n){n=void 0===n||n,this.keywords[e]={callback:t,cache:n}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,t){return this.keywords[e].callback.call(this,t)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return null!=this.nodes[e]},containsKeyword:function(e){return null!=this.keywords[e]}},THREE.NodeLib.addKeyword("uv",function(){return new THREE.UVNode}),THREE.NodeLib.addKeyword("uv2",function(){return new THREE.UVNode(1)}),THREE.NodeLib.addKeyword("position",function(){return new THREE.PositionNode}),THREE.NodeLib.addKeyword("worldPosition",function(){return new THREE.PositionNode(THREE.PositionNode.WORLD)}),THREE.NodeLib.addKeyword("normal",function(){return new THREE.NormalNode}),THREE.NodeLib.addKeyword("worldNormal",function(){return new THREE.NormalNode(THREE.NormalNode.WORLD)}),THREE.NodeLib.addKeyword("viewPosition",function(){return new THREE.PositionNode(THREE.NormalNode.VIEW)}),THREE.NodeLib.addKeyword("viewNormal",function(){return new THREE.NormalNode(THREE.NormalNode.VIEW)}),THREE.NodeLib.addKeyword("time",function(){return new THREE.TimerNode}),THREE.NodeLib.add(new THREE.ConstNode("vec3 LUMA vec3(0.2125, 0.7154, 0.0721)")),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 scale ) {","\tvec3 q0 = dFdx( eye_pos );","\tvec3 q1 = dFdy( eye_pos );","\tvec2 st0 = dFdx( mUv.st );","\tvec2 st1 = dFdy( mUv.st );","\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );","\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );","\tvec3 N = normalize( surf_norm );","\tvec3 mapN = map * 2.0 - 1.0;","\tmapN.xy = scale * mapN.xy;","\tmat3 tsn = mat3( S, T, N );","\treturn normalize( tsn * mapN );","}"].join("\n"),null,{derivatives:!0})),THREE.NodeLib.add(new THREE.FunctionNode(["float snoise(vec2 co) {","\treturn fract( sin( dot(co.xy, vec2(12.9898,78.233) ) ) * 43758.5453 );","}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 hue_rgb(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 saturation_rgb(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3(dot(rgb, LUMA));","\treturn mix(intensity, rgb, adjustment);","}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["float luminance_rgb(vec3 rgb) {","\treturn dot(rgb, LUMA);","}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 vibrance_rgb(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))),THREE.NodeFrame=function(e){this.time=void 0!==e?e:0,this.frameId=0},THREE.NodeFrame.prototype.update=function(e){return++this.frameId,this.time+=e,this.delta=e,this},THREE.NodeFrame.prototype.updateNode=function(e){return e.frameId===this.frameId||(e.updateFrame(this),e.frameId=this.frameId),this},THREE.NodeMaterial=function(e,t){THREE.ShaderMaterial.call(this),this.vertex=e||new THREE.RawNode(new THREE.PositionNode(THREE.PositionNode.PROJECTION)),this.fragment=t||new THREE.RawNode(new THREE.ColorNode(16711680)),this.updaters=[]},THREE.NodeMaterial.types={t:"sampler2D",tc:"samplerCube",bv1:"bool",iv1:"int",fv1:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"},THREE.NodeMaterial.addShortcuts=function(i,r,o){function a(t,n){return{get:function(){return this[t][n]},set:function(e){this[t][n]=e}}}return function(){for(var e={},t=0;t<o.length;++t){var n=o[t];e[n]=a(r,n)}Object.defineProperties(i,e)}()},THREE.NodeMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.NodeMaterial.prototype.constructor=THREE.NodeMaterial,THREE.NodeMaterial.prototype.type="NodeMaterial",THREE.NodeMaterial.prototype.updateFrame=function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])},THREE.NodeMaterial.prototype.build=function(){var e,t;this.nodes=[],this.defines={},this.uniforms={},this.attributes={},this.extensions={},this.nodeData={},this.vertexUniform=[],this.fragmentUniform=[],this.vars=[],this.vertexTemps=[],this.fragmentTemps=[],this.uniformList=[],this.consts=[],this.functions=[],this.updaters=[],this.requires={uv:[],color:[],lights:this.lights,fog:this.fog},this.vertexPars="",this.fragmentPars="",this.vertexCode="",this.fragmentCode="",this.vertexNode="",this.fragmentNode="",this.prefixCode=["#ifdef GL_EXT_shader_texture_lod","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>"].join("\n");var n=new THREE.NodeBuilder(this);return e=this.vertex.build(n.setShader("vertex"),"v4"),t=this.fragment.build(n.setShader("fragment"),"v4"),this.requires.uv[0]&&(this.addVertexPars("varying vec2 vUv;"),this.addFragmentPars("varying vec2 vUv;"),this.addVertexCode("vUv = uv;")),this.requires.uv[1]&&(this.addVertexPars("varying vec2 vUv2; attribute vec2 uv2;"),this.addFragmentPars("varying vec2 vUv2;"),this.addVertexCode("vUv2 = uv2;")),this.requires.color[0]&&(this.addVertexPars("varying vec4 vColor; attribute vec4 color;"),this.addFragmentPars("varying vec4 vColor;"),this.addVertexCode("vColor = color;")),this.requires.color[1]&&(this.addVertexPars("varying vec4 vColor2; attribute vec4 color2;"),this.addFragmentPars("varying vec4 vColor2;"),this.addVertexCode("vColor2 = color2;")),this.requires.position&&(this.addVertexPars("varying vec3 vPosition;"),this.addFragmentPars("varying vec3 vPosition;"),this.addVertexCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVertexPars("varying vec3 vWPosition;"),this.addFragmentPars("varying vec3 vWPosition;"),this.addVertexCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVertexPars("varying vec3 vObjectNormal;"),this.addFragmentPars("varying vec3 vObjectNormal;"),this.addVertexCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVertexPars("varying vec3 vWNormal;"),this.addFragmentPars("varying vec3 vWNormal;"),this.addVertexCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")),this.fog=this.requires.fog,this.lights=this.requires.lights,this.transparent=this.requires.transparent||this.blending>THREE.NormalBlending,this.vertexShader=[this.prefixCode,this.vertexPars,this.getCodePars(this.vertexUniform,"uniform"),this.getIncludes(this.consts.vertex),this.getIncludes(this.functions.vertex),"void main(){",this.getCodePars(this.vertexTemps),e,this.vertexCode,"}"].join("\n"),this.fragmentShader=[this.prefixCode,this.fragmentPars,this.getCodePars(this.fragmentUniform,"uniform"),this.getIncludes(this.consts.fragment),this.getIncludes(this.functions.fragment),"void main(){",this.getCodePars(this.fragmentTemps),this.fragmentCode,t,"}"].join("\n"),this.needsUpdate=!0,this.dispose(),this},THREE.NodeMaterial.prototype.define=function(e,t){this.defines[e]=null==t?1:t},THREE.NodeMaterial.prototype.isDefined=function(e){return null!=this.defines[e]},THREE.NodeMaterial.prototype.mergeUniform=function(e){for(var t in e)this.uniforms[t]=e[t]},THREE.NodeMaterial.prototype.createUniform=function(e,t,n,i){var r=this.uniformList.length,o={type:e,value:t,name:n||"nVu"+r,needsUpdate:i};return this.uniformList.push(o),o},THREE.NodeMaterial.prototype.getVertexTemp=function(e,t,n){var i=this.vertexTemps[e];if(!i){var r=this.vertexTemps.length;i={name:n||"nVt"+r,type:t},this.vertexTemps.push(i),this.vertexTemps[e]=i}return i},THREE.NodeMaterial.prototype.getFragmentTemp=function(e,t,n){var i=this.fragmentTemps[e];if(!i){var r=this.fragmentTemps.length;i={name:n||"nVt"+r,type:t},this.fragmentTemps.push(i),this.fragmentTemps[e]=i}return i},THREE.NodeMaterial.prototype.getVar=function(e,t,n){var i=this.vars[e];if(!i){var r=this.vars.length,o=n||"nVv"+r;i={name:o,type:t},this.vars.push(i),this.vars[e]=i,this.addVertexPars("varying "+t+" "+o+";"),this.addFragmentPars("varying "+t+" "+o+";")}return i},THREE.NodeMaterial.prototype.getAttribute=function(e,t){if(!this.attributes[e]){var n=this.getVar(e,t);this.addVertexPars("attribute "+t+" "+e+";"),this.addVertexCode(n.name+" = "+e+";"),this.attributes[e]={varying:n,name:e,type:t}}return this.attributes[e]},THREE.NodeMaterial.prototype.getIncludes=function(){function i(e,t){return e.deps.length-t.deps.length}return function(e){if(!e)return"";for(var t="",n=(e=e.sort(i),0);n<e.length;n++)e[n].src&&(t+=e[n].src+"\n");return t}}(),THREE.NodeMaterial.prototype.addVertexPars=function(e){this.vertexPars+=e+"\n"},THREE.NodeMaterial.prototype.addFragmentPars=function(e){this.fragmentPars+=e+"\n"},THREE.NodeMaterial.prototype.addVertexCode=function(e){this.vertexCode+=e+"\n"},THREE.NodeMaterial.prototype.addFragmentCode=function(e){this.fragmentCode+=e+"\n"},THREE.NodeMaterial.prototype.addVertexNode=function(e){this.vertexNode+=e+"\n"},THREE.NodeMaterial.prototype.clearVertexNode=function(){var e=this.vertexNode;return this.vertexNode="",e},THREE.NodeMaterial.prototype.addFragmentNode=function(e){this.fragmentNode+=e+"\n"},THREE.NodeMaterial.prototype.clearFragmentNode=function(){var e=this.fragmentNode;return this.fragmentNode="",e},THREE.NodeMaterial.prototype.getCodePars=function(e,t){t=t||"";for(var n="",i=0,r=e.length;i<r;++i){var o=e[i].type,a=e[i].name,s=e[i].value;"t"==o&&s instanceof THREE.CubeTexture&&(o="tc");var l=THREE.NodeMaterial.types[o];if(null==l)throw new Error("Node pars "+o+" not found.");n+=t+" "+l+" "+a+";\n"}return n},THREE.NodeMaterial.prototype.createVertexUniform=function(e,t,n,i){var r=this.createUniform(e,t,n,i);return this.vertexUniform.push(r),this.vertexUniform[r.name]=r,this.uniforms[r.name]=r},THREE.NodeMaterial.prototype.createFragmentUniform=function(e,t,n,i){var r=this.createUniform(e,t,n,i);return this.fragmentUniform.push(r),this.fragmentUniform[r.name]=r,this.uniforms[r.name]=r},THREE.NodeMaterial.prototype.getDataNode=function(e){return this.nodeData[e]=this.nodeData[e]||{}},THREE.NodeMaterial.prototype.include=function(e,t,n,i){var r;(t="string"==typeof t?THREE.NodeLib.get(t):t)instanceof THREE.FunctionNode?r=this.functions[e.shader]=this.functions[e.shader]||[]:t instanceof THREE.ConstNode&&(r=this.consts[e.shader]=this.consts[e.shader]||[]);var o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(e,"source")),t instanceof THREE.FunctionNode&&n&&r[n.name]&&-1==r[n.name].deps.indexOf(t)&&(r[n.name].deps.push(t),t.includes&&t.includes.length))for(var a=0;this.include(e,t.includes[a++],n),a<t.includes.length;);i&&(o.src=i)},THREE.NodeMaterial.prototype.toJSON=function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.materials&&(e.materials={}),!e.materials[this.uuid]){var t={};t.uuid=this.uuid,t.type=this.type,e.materials[t.uuid]=t,""!==this.name&&(t.name=this.name),this.blending!==THREE.NormalBlending&&(t.blending=this.blending),!0===this.flatShading&&(t.flatShading=this.flatShading),this.side!==THREE.FrontSide&&(t.side=this.side),!0===this.transparent&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,!0===this.wireframe&&(t.wireframe=this.wireframe),1<this.wireframeLinewidth&&(t.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(t.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(t.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(t.morphTargets=!0),!0===this.skinning&&(t.skinning=!0),t.fog=this.fog,t.lights=this.lights,!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.vertex=this.vertex.toJSON(e).uuid,t.fragment=this.fragment.toJSON(e).uuid}return e.material=this.uuid,e},THREE.PositionNode=function(e){THREE.TempNode.call(this,"v3"),this.scope=e||THREE.PositionNode.LOCAL},THREE.PositionNode.LOCAL="local",THREE.PositionNode.WORLD="world",THREE.PositionNode.VIEW="view",THREE.PositionNode.PROJECTION="projection",THREE.PositionNode.prototype=Object.create(THREE.TempNode.prototype),THREE.PositionNode.prototype.constructor=THREE.PositionNode,THREE.PositionNode.prototype.nodeType="Position",THREE.PositionNode.prototype.getType=function(e){switch(this.scope){case THREE.PositionNode.PROJECTION:return"v4"}return this.type},THREE.PositionNode.prototype.isShared=function(e){switch(this.scope){case THREE.PositionNode.LOCAL:case THREE.PositionNode.WORLD:return!1}return!0},THREE.PositionNode.prototype.generate=function(e,t){var n,i=e.material;switch(this.scope){case THREE.PositionNode.LOCAL:i.requires.position=!0,n=e.isShader("vertex")?"transformed":"vPosition";break;case THREE.PositionNode.WORLD:i.requires.worldPosition=!0,n=(e.isShader("vertex"),"vWPosition");break;case THREE.PositionNode.VIEW:n=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case THREE.PositionNode.PROJECTION:n=e.isShader("vertex")?"(projectionMatrix * modelViewMatrix * vec4( position, 1.0 ))":"vec4( 0.0 )"}return e.format(n,this.getType(e),t)},THREE.PositionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},THREE.NormalNode=function(e){THREE.TempNode.call(this,"v3"),this.scope=e||THREE.NormalNode.LOCAL},THREE.NormalNode.LOCAL="local",THREE.NormalNode.WORLD="world",THREE.NormalNode.VIEW="view",THREE.NormalNode.prototype=Object.create(THREE.TempNode.prototype),THREE.NormalNode.prototype.constructor=THREE.NormalNode,THREE.NormalNode.prototype.nodeType="Normal",THREE.NormalNode.prototype.isShared=function(e){switch(this.scope){case THREE.NormalNode.WORLD:return!0}return!1},THREE.NormalNode.prototype.generate=function(e,t){var n,i=e.material;switch(this.scope){case THREE.NormalNode.LOCAL:i.requires.normal=!0,n=e.isShader("vertex")?"normal":"vObjectNormal";break;case THREE.NormalNode.WORLD:i.requires.worldNormal=!0,n=e.isShader("vertex")?"( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz":"vWNormal";break;case THREE.NormalNode.VIEW:n="vNormal"}return e.format(n,this.getType(e),t)},THREE.NormalNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},THREE.UVNode=function(e){THREE.TempNode.call(this,"v2",{shared:!1}),this.index=e||0},THREE.UVNode.vertexDict=["uv","uv2"],THREE.UVNode.fragmentDict=["vUv","vUv2"],THREE.UVNode.prototype=Object.create(THREE.TempNode.prototype),THREE.UVNode.prototype.constructor=THREE.UVNode,THREE.UVNode.prototype.nodeType="UV",THREE.UVNode.prototype.generate=function(e,t){var n;return e.material.requires.uv[this.index]=!0,n=e.isShader("vertex")?THREE.UVNode.vertexDict[this.index]:THREE.UVNode.fragmentDict[this.index],e.format(n,this.getType(e),t)},THREE.UVNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},THREE.ScreenUVNode=function(e){THREE.TempNode.call(this,"v2"),this.resolution=e},THREE.ScreenUVNode.prototype=Object.create(THREE.TempNode.prototype),THREE.ScreenUVNode.prototype.constructor=THREE.ScreenUVNode,THREE.ScreenUVNode.prototype.nodeType="ScreenUV",THREE.ScreenUVNode.prototype.generate=function(e,t){var n;e.material;return e.isShader("fragment")?n="(gl_FragCoord.xy/"+this.resolution.build(e,"v2")+")":(console.warn("THREE.ScreenUVNode is not compatible with "+e.shader+" shader."),n="vec2( 0.0 )"),e.format(n,this.getType(e),t)},THREE.ScreenUVNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).resolution=this.resolution.toJSON(e).uuid),t},THREE.ColorsNode=function(e){THREE.TempNode.call(this,"v4",{shared:!1}),this.index=e||0},THREE.ColorsNode.vertexDict=["color","color2"],THREE.ColorsNode.fragmentDict=["vColor","vColor2"],THREE.ColorsNode.prototype=Object.create(THREE.TempNode.prototype),THREE.ColorsNode.prototype.constructor=THREE.ColorsNode,THREE.ColorsNode.prototype.generate=function(e,t){var n;return e.material.requires.color[this.index]=!0,n=e.isShader("vertex")?THREE.ColorsNode.vertexDict[this.index]:THREE.ColorsNode.fragmentDict[this.index],e.format(n,this.getType(e),t)},THREE.ColorsNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},THREE.CameraNode=function(e,t){THREE.TempNode.call(this,"v3"),this.setScope(e||THREE.CameraNode.POSITION),this.setCamera(t)},THREE.CameraNode.fDepthColor=new THREE.FunctionNode(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n")),THREE.CameraNode.POSITION="position",THREE.CameraNode.DEPTH="depth",THREE.CameraNode.TO_VERTEX="toVertex",THREE.CameraNode.prototype=Object.create(THREE.TempNode.prototype),THREE.CameraNode.prototype.constructor=THREE.CameraNode,THREE.CameraNode.prototype.nodeType="Camera",THREE.CameraNode.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0!==e?this.onUpdateFrame:void 0},THREE.CameraNode.prototype.setScope=function(e){switch(this.scope){case THREE.CameraNode.DEPTH:delete this.near,delete this.far}switch(this.scope=e){case THREE.CameraNode.DEPTH:var t=this.camera;this.near=new THREE.FloatNode(t?t.near:1),this.far=new THREE.FloatNode(t?t.far:1200)}},THREE.CameraNode.prototype.getType=function(e){switch(this.scope){case THREE.CameraNode.DEPTH:return"fv1"}return this.type},THREE.CameraNode.prototype.isUnique=function(e){switch(this.scope){case THREE.CameraNode.DEPTH:case THREE.CameraNode.TO_VERTEX:return!0}return!1},THREE.CameraNode.prototype.isShared=function(e){switch(this.scope){case THREE.CameraNode.POSITION:return!1}return!0},THREE.CameraNode.prototype.generate=function(e,t){var n;e.material;switch(this.scope){case THREE.CameraNode.POSITION:n="cameraPosition";break;case THREE.CameraNode.DEPTH:var i=THREE.CameraNode.fDepthColor;e.include(i),n=i.name+"("+this.near.build(e,"fv1")+","+this.far.build(e,"fv1")+")";break;case THREE.CameraNode.TO_VERTEX:n="normalize( "+new THREE.PositionNode(THREE.PositionNode.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(n,this.getType(e),t)},THREE.CameraNode.prototype.onUpdateFrame=function(e){switch(this.scope){case THREE.CameraNode.DEPTH:var t=this.camera;this.near.number=t.near,this.far.number=t.far}},THREE.CameraNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch((t=this.createJSONNode(e)).scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case THREE.CameraNode.DEPTH:t.near=this.near.number,t.far=this.far.number}return t},THREE.ReflectNode=function(e){THREE.TempNode.call(this,"v3",{unique:!0}),this.scope=e||THREE.ReflectNode.CUBE},THREE.ReflectNode.CUBE="cube",THREE.ReflectNode.SPHERE="sphere",THREE.ReflectNode.VECTOR="vector",THREE.ReflectNode.prototype=Object.create(THREE.TempNode.prototype),THREE.ReflectNode.prototype.constructor=THREE.ReflectNode,THREE.ReflectNode.prototype.nodeType="Reflect",THREE.ReflectNode.prototype.getType=function(e){switch(this.scope){case THREE.ReflectNode.SPHERE:return"v2"}return this.type},THREE.ReflectNode.prototype.generate=function(e,t){var n;switch(this.scope){case THREE.ReflectNode.VECTOR:e.material.addFragmentNode("vec3 reflectVec = inverseTransformDirection( reflect( -normalize( vViewPosition ), normal ), viewMatrix );"),n="reflectVec";break;case THREE.ReflectNode.CUBE:var i=new THREE.ReflectNode(THREE.ReflectNode.VECTOR).build(e,"v3");e.material.addFragmentNode("vec3 reflectCubeVec = vec3( -1.0 * "+i+".x, "+i+".yz );"),n="reflectCubeVec";break;case THREE.ReflectNode.SPHERE:i=new THREE.ReflectNode(THREE.ReflectNode.VECTOR).build(e,"v3");e.material.addFragmentNode("vec2 reflectSphereVec = normalize((viewMatrix * vec4("+i+", 0.0 )).xyz + vec3(0.0,0.0,1.0)).xy * 0.5 + 0.5;"),n="reflectSphereVec"}return e.format(n,this.getType(this.type),t)},THREE.ReflectNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},THREE.LightNode=function(e){THREE.TempNode.call(this,"v3",{shared:!1}),this.scope=e||THREE.LightNode.TOTAL},THREE.LightNode.TOTAL="total",THREE.LightNode.prototype=Object.create(THREE.TempNode.prototype),THREE.LightNode.prototype.constructor=THREE.LightNode,THREE.LightNode.prototype.nodeType="Light",THREE.LightNode.prototype.generate=function(e,t){return e.isCache("light")?e.format("reflectedLight.directDiffuse",this.getType(e),t):(console.warn('THREE.LightNode is only compatible in "light" channel.'),e.format("vec3( 0.0 )",this.getType(e),t))},THREE.LightNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},THREE.IntNode=function(e){THREE.InputNode.call(this,"iv1"),this.value=[Math.floor(e||0)]},THREE.IntNode.prototype=Object.create(THREE.InputNode.prototype),THREE.IntNode.prototype.constructor=THREE.IntNode,THREE.IntNode.prototype.nodeType="Int",Object.defineProperties(THREE.IntNode.prototype,{number:{get:function(){return this.value[0]},set:function(e){this.value[0]=Math.floor(e)}}}),THREE.IntNode.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format(this.number,i,t)},THREE.IntNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).number=this.number,!0===this.readonly&&(t.readonly=!0)),t},THREE.FloatNode=function(e){THREE.InputNode.call(this,"fv1"),this.value=[e||0]},THREE.FloatNode.prototype=Object.create(THREE.InputNode.prototype),THREE.FloatNode.prototype.constructor=THREE.FloatNode,THREE.FloatNode.prototype.nodeType="Float",Object.defineProperties(THREE.FloatNode.prototype,{number:{get:function(){return this.value[0]},set:function(e){this.value[0]=e}}}),THREE.FloatNode.prototype.generateReadonly=function(e,t,n,i,r,o){var a=this.number;return e.format(Math.floor(a)!==a?a:a+".0",i,t)},THREE.FloatNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).number=this.number,!0===this.readonly&&(t.readonly=!0)),t},THREE.ColorNode=function(e){THREE.InputNode.call(this,"c"),this.value=new THREE.Color(e||0)},THREE.ColorNode.prototype=Object.create(THREE.InputNode.prototype),THREE.ColorNode.prototype.constructor=THREE.ColorNode,THREE.ColorNode.prototype.nodeType="Color",THREE.NodeMaterial.addShortcuts(THREE.ColorNode.prototype,"value",["r","g","b"]),THREE.ColorNode.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",i,t)},THREE.ColorNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).r=this.r,t.g=this.g,t.b=this.b,!0===this.readonly&&(t.readonly=!0)),t},THREE.Vector2Node=function(e,t){THREE.InputNode.call(this,"v2"),this.value=new THREE.Vector2(e,t)},THREE.Vector2Node.prototype=Object.create(THREE.InputNode.prototype),THREE.Vector2Node.prototype.constructor=THREE.Vector2Node,THREE.Vector2Node.prototype.nodeType="Vector2",THREE.NodeMaterial.addShortcuts(THREE.Vector2Node.prototype,"value",["x","y"]),THREE.Vector2Node.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("vec2( "+this.x+", "+this.y+" )",i,t)},THREE.Vector2Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,!0===this.readonly&&(t.readonly=!0)),t},THREE.Vector3Node=function(e,t,n){THREE.InputNode.call(this,"v3"),this.type="v3",this.value=new THREE.Vector3(e,t,n)},THREE.Vector3Node.prototype=Object.create(THREE.InputNode.prototype),THREE.Vector3Node.prototype.constructor=THREE.Vector3Node,THREE.Vector3Node.prototype.nodeType="Vector3",THREE.NodeMaterial.addShortcuts(THREE.Vector3Node.prototype,"value",["x","y","z"]),THREE.Vector3Node.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",i,t)},THREE.Vector3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,!0===this.readonly&&(t.readonly=!0)),t},THREE.Vector4Node=function(e,t,n,i){THREE.InputNode.call(this,"v4"),this.value=new THREE.Vector4(e,t,n,i)},THREE.Vector4Node.prototype=Object.create(THREE.InputNode.prototype),THREE.Vector4Node.prototype.constructor=THREE.Vector4Node,THREE.Vector4Node.prototype.nodeType="Vector4",THREE.NodeMaterial.addShortcuts(THREE.Vector4Node.prototype,"value",["x","y","z","w"]),THREE.Vector4Node.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",i,t)},THREE.Vector4Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,!0===this.readonly&&(t.readonly=!0)),t},THREE.TextureNode=function(e,t,n,i){THREE.InputNode.call(this,"v4",{shared:!0}),this.value=e,this.coord=t||new THREE.UVNode,this.bias=n,this.project=void 0!==i&&i},THREE.TextureNode.prototype=Object.create(THREE.InputNode.prototype),THREE.TextureNode.prototype.constructor=THREE.TextureNode,THREE.TextureNode.prototype.nodeType="Texture",THREE.TextureNode.prototype.getTexture=function(e,t){return THREE.InputNode.prototype.generate.call(this,e,t,this.value.uuid,"t")},THREE.TextureNode.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var n,i,r=this.getTexture(e,t),o=this.coord.build(e,this.project?"v4":"v2"),a=this.bias?this.bias.build(e,"fv1"):void 0;return null==a&&e.requires.bias&&(a=e.requires.bias.build(e,"fv1")),n=this.project?"texture2DProj":a?"tex2DBias":"tex2D",i=a?n+"("+r+","+o+","+a+")":n+"("+r+","+o+")",e.isSlot("color")?i="mapTexelToLinear("+i+")":e.isSlot("emissive")?i="emissiveMapTexelToLinear("+i+")":e.isSlot("environment")&&(i="envMapTexelToLinear("+i+")"),e.format(i,this.type,t)},THREE.TextureNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.coord=this.coord.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},THREE.Matrix3Node=function(e){THREE.InputNode.call(this,"m3"),this.value=e||new THREE.Matrix3},THREE.Matrix3Node.prototype=Object.create(THREE.InputNode.prototype),THREE.Matrix3Node.prototype.constructor=THREE.Matrix3Node,THREE.Matrix3Node.prototype.nodeType="Matrix3",THREE.Matrix3Node.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("mat3( "+this.value.elements.join(", ")+" )",i,t)},THREE.Matrix3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat(),!0===this.readonly&&(t.readonly=!0)),t},THREE.Matrix4Node=function(e){THREE.InputNode.call(this,"m4"),this.value=e||new THREE.Matrix4},THREE.Matrix4Node.prototype=Object.create(THREE.InputNode.prototype),THREE.Matrix4Node.prototype.constructor=THREE.Matrix4Node,THREE.Matrix4Node.prototype.nodeType="Matrix4",THREE.Matrix4Node.prototype.generateReadonly=function(e,t,n,i,r,o){return e.format("mat4( "+this.value.elements.join(", ")+" )",i,t)},THREE.Matrix4Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat(),!0===this.readonly&&(t.readonly=!0)),t},THREE.CubeTextureNode=function(e,t,n){THREE.InputNode.call(this,"v4",{shared:!0}),this.value=e,this.coord=t||new THREE.ReflectNode,this.bias=n},THREE.CubeTextureNode.prototype=Object.create(THREE.InputNode.prototype),THREE.CubeTextureNode.prototype.constructor=THREE.CubeTextureNode,THREE.CubeTextureNode.prototype.nodeType="CubeTexture",THREE.CubeTextureNode.prototype.getTexture=function(e,t){return THREE.InputNode.prototype.generate.call(this,e,t,this.value.uuid,"t")},THREE.CubeTextureNode.prototype.generate=function(e,t){if("samplerCube"===t)return this.getTexture(e,t);var n,i=this.getTexture(e,t),r=this.coord.build(e,"v3"),o=this.bias?this.bias.build(e,"fv1"):void 0;return null==o&&e.requires.bias&&(o=e.requires.bias.build(e,"fv1")),n=o?"texCubeBias("+i+","+r+","+o+")":"texCube("+i+","+r+")",e.isSlot("color")?n="mapTexelToLinear("+n+")":e.isSlot("emissive")?n="emissiveMapTexelToLinear("+n+")":e.isSlot("environment")&&(n="envMapTexelToLinear("+n+")"),e.format(n,this.type,t)},THREE.CubeTextureNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.uuid,t.coord=this.coord.toJSON(e).uuid,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},THREE.Math1Node=function(e,t){THREE.TempNode.call(this),this.a=e,this.method=t||THREE.Math1Node.SIN},THREE.Math1Node.RAD="radians",THREE.Math1Node.DEG="degrees",THREE.Math1Node.EXP="exp",THREE.Math1Node.EXP2="exp2",THREE.Math1Node.LOG="log",THREE.Math1Node.LOG2="log2",THREE.Math1Node.SQRT="sqrt",THREE.Math1Node.INV_SQRT="inversesqrt",THREE.Math1Node.FLOOR="floor",THREE.Math1Node.CEIL="ceil",THREE.Math1Node.NORMALIZE="normalize",THREE.Math1Node.FRACT="fract",THREE.Math1Node.SAT="saturate",THREE.Math1Node.SIN="sin",THREE.Math1Node.COS="cos",THREE.Math1Node.TAN="tan",THREE.Math1Node.ASIN="asin",THREE.Math1Node.ACOS="acos",THREE.Math1Node.ARCTAN="atan",THREE.Math1Node.ABS="abs",THREE.Math1Node.SIGN="sign",THREE.Math1Node.LENGTH="length",THREE.Math1Node.NEGATE="negate",THREE.Math1Node.INVERT="invert",THREE.Math1Node.prototype=Object.create(THREE.TempNode.prototype),THREE.Math1Node.prototype.constructor=THREE.Math1Node,THREE.Math1Node.prototype.nodeType="Math1",THREE.Math1Node.prototype.getType=function(e){switch(this.method){case THREE.Math1Node.LENGTH:return"fv1"}return this.a.getType(e)},THREE.Math1Node.prototype.generate=function(e,t){e.material;var n=this.getType(e),i=this.a.build(e,n);switch(this.method){case THREE.Math1Node.NEGATE:i="(-"+i+")";break;case THREE.Math1Node.INVERT:i="(1.0-"+i+")";break;default:i=this.method+"("+i+")"}return e.format(i,n,t)},THREE.Math1Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.method=this.method),t},THREE.Math2Node=function(e,t,n){THREE.TempNode.call(this),this.a=e,this.b=t,this.method=n||THREE.Math2Node.DISTANCE},THREE.Math2Node.MIN="min",THREE.Math2Node.MAX="max",THREE.Math2Node.MOD="mod",THREE.Math2Node.STEP="step",THREE.Math2Node.REFLECT="reflect",THREE.Math2Node.DISTANCE="distance",THREE.Math2Node.DOT="dot",THREE.Math2Node.CROSS="cross",THREE.Math2Node.POW="pow",THREE.Math2Node.prototype=Object.create(THREE.TempNode.prototype),THREE.Math2Node.prototype.constructor=THREE.Math2Node,THREE.Math2Node.prototype.nodeType="Math2",THREE.Math2Node.prototype.getInputType=function(e){return e.getFormatLength(this.b.getType(e))>e.getFormatLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},THREE.Math2Node.prototype.getType=function(e){switch(this.method){case THREE.Math2Node.DISTANCE:case THREE.Math2Node.DOT:return"fv1";case THREE.Math2Node.CROSS:return"v3"}return this.getInputType(e)},THREE.Math2Node.prototype.generate=function(e,t){e.material;var n,i,r=this.getInputType(e),o=e.getFormatLength(this.a.getType(e)),a=e.getFormatLength(this.b.getType(e));switch(this.method){case THREE.Math2Node.CROSS:n=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case THREE.Math2Node.STEP:n=this.a.build(e,1==o?"fv1":r),i=this.b.build(e,r);break;case THREE.Math2Node.MIN:case THREE.Math2Node.MAX:case THREE.Math2Node.MOD:n=this.a.build(e,r),i=this.b.build(e,1==a?"fv1":r);break;default:n=this.a.build(e,r),i=this.b.build(e,r)}return e.format(this.method+"("+n+","+i+")",this.getType(e),t)},THREE.Math2Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.method=this.method),t},THREE.Math3Node=function(e,t,n,i){THREE.TempNode.call(this),this.a=e,this.b=t,this.c=n,this.method=i||THREE.Math3Node.MIX},THREE.Math3Node.MIX="mix",THREE.Math3Node.REFRACT="refract",THREE.Math3Node.SMOOTHSTEP="smoothstep",THREE.Math3Node.FACEFORWARD="faceforward",THREE.Math3Node.prototype=Object.create(THREE.TempNode.prototype),THREE.Math3Node.prototype.constructor=THREE.Math3Node,THREE.Math3Node.prototype.nodeType="Math3",THREE.Math3Node.prototype.getType=function(e){var t=e.getFormatLength(this.a.getType(e)),n=e.getFormatLength(this.b.getType(e)),i=e.getFormatLength(this.c.getType(e));return n<t&&i<t?this.a.getType(e):i<n?this.b.getType(e):this.c.getType(e)},THREE.Math3Node.prototype.generate=function(e,t){e.material;var n,i,r,o=this.getType(e),a=(e.getFormatLength(this.a.getType(e)),e.getFormatLength(this.b.getType(e)),e.getFormatLength(this.c.getType(e)));switch(this.method){case THREE.Math3Node.REFRACT:n=this.a.build(e,o),i=this.b.build(e,o),r=this.c.build(e,"fv1");break;case THREE.Math3Node.MIX:n=this.a.build(e,o),i=this.b.build(e,o),r=this.c.build(e,1==a?"fv1":o);break;default:n=this.a.build(e,o),i=this.b.build(e,o),r=this.c.build(e,o)}return e.format(this.method+"("+n+","+i+","+r+")",o,t)},THREE.Math3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.c=this.c.toJSON(e).uuid,t.method=this.method),t},THREE.OperatorNode=function(e,t,n){THREE.TempNode.call(this),this.a=e,this.b=t,this.op=n||THREE.OperatorNode.ADD},THREE.OperatorNode.ADD="+",THREE.OperatorNode.SUB="-",THREE.OperatorNode.MUL="*",THREE.OperatorNode.DIV="/",THREE.OperatorNode.prototype=Object.create(THREE.TempNode.prototype),THREE.OperatorNode.prototype.constructor=THREE.OperatorNode,THREE.OperatorNode.prototype.nodeType="Operator",THREE.OperatorNode.prototype.getType=function(e){var t=this.a.getType(e),n=this.b.getType(e);return e.isFormatMatrix(t)?"v4":e.getFormatLength(n)>e.getFormatLength(t)?n:t},THREE.OperatorNode.prototype.generate=function(e,t){e.material.getDataNode(this.uuid);var n=this.getType(e),i=this.a.build(e,n),r=this.b.build(e,n);return e.format("("+i+this.op+r+")",n,t)},THREE.OperatorNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t},THREE.SwitchNode=function(e,t){THREE.GLNode.call(this),this.node=e,this.components=t||"x"},THREE.SwitchNode.prototype=Object.create(THREE.GLNode.prototype),THREE.SwitchNode.prototype.constructor=THREE.SwitchNode,THREE.SwitchNode.prototype.nodeType="Switch",THREE.SwitchNode.prototype.getType=function(e){return e.getFormatFromLength(this.components.length)},THREE.SwitchNode.prototype.generate=function(e,t){var n=this.node.getType(e),i=e.getFormatLength(n)-1,r=this.node.build(e,n);if(0<i){var o,a=0,s=e.colorToVector(this.components),l=s.length;for(o=0;o<l;o++)a=Math.max(a,e.getIndexByElement(s.charAt(o)));for(i<a&&(a=i),r+=".",o=0;o<l;o++){s.charAt(o);var u=e.getIndexByElement(s.charAt(o));a<u&&(u=a),r+=e.getElementByIndex(u)}return e.format(r,this.getType(e),t)}return e.format(r,n,t)},THREE.SwitchNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).node=this.node.toJSON(e).uuid,t.components=this.components),t},THREE.JoinNode=function(e,t,n,i){THREE.TempNode.call(this,"fv1"),this.x=e,this.y=t,this.z=n,this.w=i},THREE.JoinNode.inputs=["x","y","z","w"],THREE.JoinNode.prototype=Object.create(THREE.TempNode.prototype),THREE.JoinNode.prototype.constructor=THREE.JoinNode,THREE.JoinNode.prototype.nodeType="Join",THREE.JoinNode.prototype.getNumElements=function(){for(var e=THREE.JoinNode.inputs,t=e.length;t--;)if(void 0!==this[e[t]]){++t;break}return Math.max(t,2)},THREE.JoinNode.prototype.getType=function(e){return e.getFormatFromLength(this.getNumElements())},THREE.JoinNode.prototype.generate=function(e,t){e.material;for(var n=this.getType(e),i=this.getNumElements(),r=THREE.JoinNode.inputs,o=[],a=0;a<i;a++){var s=this[r[a]];o.push(s?s.build(e,"fv1"):"0.")}var l=(1<i?e.getConstructorFromLength(i):"")+"("+o.join(",")+")";return e.format(l,n,t)},THREE.JoinNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){(t=this.createJSONNode(e)).inputs={};for(var n=this.getNumElements(),i=THREE.JoinNode.inputs,r=0;r<n;r++){var o=this[i[r]];o&&(t.inputs[i[r]]=o.toJSON(e).uuid)}}return t},THREE.TimerNode=function(e,t){THREE.FloatNode.call(this),this.scale=void 0!==e?e:1,this.scope=t||THREE.TimerNode.GLOBAL,this.timeScale=1!==this.scale},THREE.TimerNode.GLOBAL="global",THREE.TimerNode.LOCAL="local",THREE.TimerNode.DELTA="delta",THREE.TimerNode.prototype=Object.create(THREE.FloatNode.prototype),THREE.TimerNode.prototype.constructor=THREE.TimerNode,THREE.TimerNode.prototype.nodeType="Timer",THREE.TimerNode.prototype.isReadonly=function(e){return!1},THREE.TimerNode.prototype.isUnique=function(e){return this.timeScale&&(this.scope===THREE.TimerNode.GLOBAL||this.scope===THREE.TimerNode.DELTA)},THREE.TimerNode.prototype.updateFrame=function(e){var t=this.timeScale?this.scale:1;switch(this.scope){case THREE.TimerNode.LOCAL:this.number+=e.delta*t;break;case THREE.TimerNode.DELTA:this.number=e.delta*t;break;default:this.number=e.time*t}},THREE.TimerNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope,t.scale=this.scale,t.timeScale=this.timeScale),t},THREE.RoughnessToBlinnExponentNode=function(){THREE.TempNode.call(this,"fv1")},THREE.RoughnessToBlinnExponentNode.getSpecularMIPLevel=new THREE.FunctionNode(["float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {","\tfloat maxMIPLevelScalar = float( maxMIPLevel );","\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n")),THREE.RoughnessToBlinnExponentNode.prototype=Object.create(THREE.TempNode.prototype),THREE.RoughnessToBlinnExponentNode.prototype.constructor=THREE.RoughnessToBlinnExponentNode,THREE.RoughnessToBlinnExponentNode.prototype.nodeType="RoughnessToBlinnExponent",THREE.RoughnessToBlinnExponentNode.prototype.generate=function(e,t){var n=e.material;return e.isShader("fragment")?n.isDefined("PHYSICAL")?(e.include(THREE.RoughnessToBlinnExponentNode.getSpecularMIPLevel),e.isCache("clearCoat")?e.format("getSpecularMIPLevel( Material_ClearCoat_BlinnShininessExponent( material ), 8 )",this.type,t):e.format("getSpecularMIPLevel( Material_BlinnShininessExponent( material ), 8 )",this.type,t)):(console.warn("THREE.RoughnessToBlinnExponentNode is only compatible with PhysicalMaterial."),e.format("0.0",this.type,t)):(console.warn("THREE.RoughnessToBlinnExponentNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t))},THREE.VelocityNode=function(e,t){THREE.Vector3Node.call(this),this.params={},this.velocity=new THREE.Vector3,this.setTarget(e),this.setParams(t)},THREE.VelocityNode.prototype=Object.create(THREE.Vector3Node.prototype),THREE.VelocityNode.prototype.constructor=THREE.VelocityNode,THREE.VelocityNode.prototype.nodeType="Velocity",THREE.VelocityNode.prototype.isReadonly=function(e){return!1},THREE.VelocityNode.prototype.setParams=function(e){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=e||{},this.params.type){case"elastic":this.moment=new THREE.Vector3,this.speed=new THREE.Vector3,this.springVelocity=new THREE.Vector3,this.lastVelocity=new THREE.Vector3}},THREE.VelocityNode.prototype.setTarget=function(e){this.target&&(delete this.position,delete this.oldPosition),(this.target=e)&&(this.position=e.getWorldPosition(),this.oldPosition=this.position.clone())},THREE.VelocityNode.prototype.updateFrameVelocity=function(e){this.target&&(this.position=this.target.getWorldPosition(),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},THREE.VelocityNode.prototype.updateFrame=function(e){switch(this.updateFrameVelocity(e),this.params.type){case"elastic":var t=e.delta*(this.params.fps||60),n=Math.pow(this.params.spring,t),i=Math.pow(this.params.damping,t);this.velocity.multiplyScalar(Math.exp(-this.params.damping*t)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(i).multiplyScalar(1-n)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(n),this.moment.add(this.springVelocity),this.moment.multiplyScalar(i),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},THREE.VelocityNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.target&&(t.target=this.target.uuid),t.params=JSON.parse(JSON.stringify(this.params))),t},THREE.LuminanceNode=function(e){THREE.TempNode.call(this,"fv1"),this.rgb=e},THREE.LuminanceNode.prototype=Object.create(THREE.TempNode.prototype),THREE.LuminanceNode.prototype.constructor=THREE.LuminanceNode,THREE.LuminanceNode.prototype.nodeType="Luminance",THREE.LuminanceNode.prototype.generate=function(e,t){return e.include("luminance_rgb"),e.format("luminance_rgb("+this.rgb.build(e,"v3")+")",this.getType(e),t)},THREE.LuminanceNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid),t},THREE.ColorAdjustmentNode=function(e,t,n){THREE.TempNode.call(this,"v3"),this.rgb=e,this.adjustment=t,this.method=n||THREE.ColorAdjustmentNode.SATURATION},THREE.ColorAdjustmentNode.SATURATION="saturation",THREE.ColorAdjustmentNode.HUE="hue",THREE.ColorAdjustmentNode.VIBRANCE="vibrance",THREE.ColorAdjustmentNode.BRIGHTNESS="brightness",THREE.ColorAdjustmentNode.CONTRAST="contrast",THREE.ColorAdjustmentNode.prototype=Object.create(THREE.TempNode.prototype),THREE.ColorAdjustmentNode.prototype.constructor=THREE.ColorAdjustmentNode,THREE.ColorAdjustmentNode.prototype.nodeType="ColorAdjustment",THREE.ColorAdjustmentNode.prototype.generate=function(e,t){var n,i=this.rgb.build(e,"v3"),r=this.adjustment.build(e,"fv1");switch(this.method){case THREE.ColorAdjustmentNode.SATURATION:n="saturation_rgb";break;case THREE.ColorAdjustmentNode.HUE:n="hue_rgb";break;case THREE.ColorAdjustmentNode.VIBRANCE:n="vibrance_rgb";break;case THREE.ColorAdjustmentNode.BRIGHTNESS:return e.format("("+i+"+"+r+")",this.getType(e),t);case THREE.ColorAdjustmentNode.CONTRAST:return e.format("("+i+"*"+r+")",this.getType(e),t)}return e.include(n),e.format(n+"("+i+","+r+")",this.getType(e),t)},THREE.ColorAdjustmentNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid,t.adjustment=this.adjustment.toJSON(e).uuid,t.method=this.method),t},THREE.NoiseNode=function(e){THREE.TempNode.call(this,"fv1"),this.coord=e},THREE.NoiseNode.prototype=Object.create(THREE.TempNode.prototype),THREE.NoiseNode.prototype.constructor=THREE.NoiseNode,THREE.NoiseNode.prototype.nodeType="Noise",THREE.NoiseNode.prototype.generate=function(e,t){return e.include("snoise"),e.format("snoise("+this.coord.build(e,"v2")+")",this.getType(e),t)},THREE.NoiseNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).coord=this.coord.toJSON(e).uuid),t},THREE.ResolutionNode=function(e){THREE.Vector2Node.call(this),this.renderer=e},THREE.ResolutionNode.prototype=Object.create(THREE.Vector2Node.prototype),THREE.ResolutionNode.prototype.constructor=THREE.ResolutionNode,THREE.ResolutionNode.prototype.nodeType="Resolution",THREE.ResolutionNode.prototype.updateFrame=function(e){var t=this.renderer.getSize(),n=this.renderer.getPixelRatio();this.x=t.width*n,this.y=t.height*n},THREE.ResolutionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).renderer=this.renderer.uuid),t},THREE.BumpNode=function(e,t,n){THREE.TempNode.call(this,"v3"),this.value=e,this.coord=t||new THREE.UVNode,this.scale=n||new THREE.Vector2Node(1,1)},THREE.BumpNode.fBumpToNormal=new THREE.FunctionNode(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, vec2 scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 + ( dBx * scale.x ), .5 + ( dBy * scale.y ), 1.0 );","}"].join("\n"),null,{derivatives:!0}),THREE.BumpNode.prototype=Object.create(THREE.TempNode.prototype),THREE.BumpNode.prototype.constructor=THREE.BumpNode,THREE.BumpNode.prototype.nodeType="Bump",THREE.BumpNode.prototype.generate=function(e,t){e.material;var n=THREE.BumpNode.fBumpToNormal;return e.include(n),e.isShader("fragment")?e.format(n.name+"("+this.value.build(e,"sampler2D")+","+this.coord.build(e,"v2")+","+this.scale.build(e,"v2")+")",this.getType(e),t):(console.warn("THREE.BumpNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t))},THREE.BumpNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.coord=this.coord.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},THREE.BlurNode=function(e,t,n,i){THREE.TempNode.call(this,"v4"),this.value=e,this.coord=t||new THREE.UVNode,this.radius=new THREE.Vector2Node(1,1),this.size=i,this.blurX=!0,this.blurY=!0,this.horizontal=new THREE.FloatNode(1/64),this.vertical=new THREE.FloatNode(1/64)},THREE.BlurNode.fBlurX=new THREE.FunctionNode(["vec4 blurX( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum;","}"].join("\n")),THREE.BlurNode.fBlurY=new THREE.FunctionNode(["vec4 blurY( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum;","}"].join("\n")),THREE.BlurNode.prototype=Object.create(THREE.TempNode.prototype),THREE.BlurNode.prototype.constructor=THREE.BlurNode,THREE.BlurNode.prototype.nodeType="Blur",THREE.BlurNode.prototype.updateFrame=function(e){if(this.size)this.horizontal.number=this.radius.x/this.size.x,this.vertical.number=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var t=this.value.value.image;this.horizontal.number=this.radius.x/t.width,this.vertical.number=this.radius.y/t.height}},THREE.BlurNode.prototype.generate=function(e,t){e.material;var n=THREE.BlurNode.fBlurX,i=THREE.BlurNode.fBlurY;if(e.include(n),e.include(i),e.isShader("fragment")){var r,o=[];return this.blurX&&o.push(n.name+"("+this.value.build(e,"sampler2D")+","+this.coord.build(e,"v2")+","+this.horizontal.build(e,"fv1")+")"),this.blurY&&o.push(i.name+"("+this.value.build(e,"sampler2D")+","+this.coord.build(e,"v2")+","+this.vertical.build(e,"fv1")+")"),r=2==o.length?"("+o.join("+")+"/2.0)":o.length?"("+o[0]+")":"vec4( 0.0 )",e.format(r,this.getType(e),t)}return console.warn("THREE.BlurNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},THREE.BlurNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.coord=this.coord.toJSON(e).uuid,t.radius=this.radius.toJSON(e).uuid,this.size&&(t.size={x:this.size.x,y:this.size.y}),t.blurX=this.blurX,t.blurY=this.blurY),t},THREE.UVTransformNode=function(){THREE.FunctionNode.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=new THREE.UVNode,this.transform=new THREE.Matrix3Node},THREE.UVTransformNode.prototype=Object.create(THREE.FunctionNode.prototype),THREE.UVTransformNode.prototype.constructor=THREE.UVTransformNode,THREE.UVTransformNode.prototype.nodeType="UVTransform",THREE.UVTransformNode.prototype.generate=function(e,t){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.transform,THREE.FunctionNode.prototype.generate.call(this,e,t)},THREE.UVTransformNode.prototype.setUvTransform=function(e,t,n,i,r,o,a){o=void 0!==o?o:.5,a=void 0!==a?a:.5,this.transform.value.setUvTransform(e,t,n,i,r,o,a)},THREE.UVTransformNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.transform=this.transform.toJSON(e).uuid),t},THREE.PhongNode=function(){THREE.GLNode.call(this),this.color=new THREE.ColorNode(15658734),this.specular=new THREE.ColorNode(1118481),this.shininess=new THREE.FloatNode(30)},THREE.PhongNode.prototype=Object.create(THREE.GLNode.prototype),THREE.PhongNode.prototype.constructor=THREE.PhongNode,THREE.PhongNode.prototype.nodeType="Phong",THREE.PhongNode.prototype.build=function(e){var t,n=e.material;if(n.define("PHONG"),n.define("ALPHATEST","0.0"),n.requires.lights=!0,e.isShader("vertex")){var i=this.transform?this.transform.parseAndBuildCode(e,"v3",{cache:"transform"}):void 0;n.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights])),n.addVertexPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>"].join("\n"));var r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];i&&r.push(i.code,"transformed = "+i.result+";"),r.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>"),t=r.join("\n")}else{this.color.parse(e,{slot:"color"}),this.specular.parse(e),this.shininess.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.normalScale&&this.normal&&this.normalScale.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.parse(e);var o=this.color.buildCode(e,"c",{slot:"color"}),a=this.specular.buildCode(e,"c"),s=this.shininess.buildCode(e,"fv1"),l=this.alpha?this.alpha.buildCode(e,"fv1"):void 0,u=this.normal?this.normal.buildCode(e,"v3"):void 0,c=this.normalScale&&this.normal?this.normalScale.buildCode(e,"v2"):void 0,h=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,d=this.ao?this.ao.buildCode(e,"fv1"):void 0,p=this.ambient?this.ambient.buildCode(e,"c"):void 0,f=this.shadow?this.shadow.buildCode(e,"c"):void 0,m=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,g=this.environment?this.environment.buildCode(e,"c",{slot:"environment"}):void 0,v=this.environmentAlpha&&this.environment?this.environmentAlpha.buildCode(e,"fv1"):void 0;n.requires.transparent=null!=l,n.addFragmentPars(["#include <common>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));r=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;",o.code,"\tvec3 diffuseColor = "+o.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",a.code,"\tvec3 specular = "+a.result+";",s.code,"\tfloat shininess = max(0.0001,"+s.result+");","\tfloat specularStrength = 1.0;"];l&&r.push(l.code,"if ( "+l.result+" <= ALPHATEST ) discard;"),u&&(e.include("perturbNormal2Arb"),r.push(u.code),c&&r.push(c.code),r.push("normal = perturbNormal2Arb(-vViewPosition,normal,"+u.result+","+(new THREE.UVNode).build(e,"v2")+","+(c?c.result:"vec2( 1.0 )")+");")),r.push("material.diffuseColor = "+(h?"vec3( 1.0 )":"diffuseColor")+";"),r.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h&&(r.push(h.code,"reflectedLight.directDiffuse = "+h.result+";"),r.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),d&&r.push(d.code,"reflectedLight.indirectDiffuse *= "+d.result+";"),p&&r.push(p.code,"reflectedLight.indirectDiffuse += "+p.result+";"),f&&r.push(f.code,"reflectedLight.directDiffuse *= "+f.result+";","reflectedLight.directSpecular *= "+f.result+";"),m&&r.push(m.code,"reflectedLight.directDiffuse += "+m.result+";"),r.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),g&&(r.push(g.code),v?r.push(v.code,"outgoingLight = mix( outgoingLight, "+g.result+", "+v.result+" );"):r.push("outgoingLight = "+g.result+";")),l?r.push("gl_FragColor = vec4( outgoingLight, "+l.result+" );"):r.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),r.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),t=r.join("\n")}return t},THREE.PhongNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.transform&&(t.transform=this.transform.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.normalScale&&(t.normalScale=this.normalScale.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t},THREE.PhongNodeMaterial=function(){this.node=new THREE.PhongNode,THREE.NodeMaterial.call(this,this.node,this.node),this.type="PhongNodeMaterial"},THREE.PhongNodeMaterial.prototype=Object.create(THREE.NodeMaterial.prototype),THREE.PhongNodeMaterial.prototype.constructor=THREE.PhongNodeMaterial,THREE.NodeMaterial.addShortcuts(THREE.PhongNodeMaterial.prototype,"node",["color","alpha","specular","shininess","normal","normalScale","emissive","ambient","light","shadow","ao","environment","environmentAlpha","transform"]),THREE.StandardNode=function(){THREE.GLNode.call(this),this.color=new THREE.ColorNode(15658734),this.roughness=new THREE.FloatNode(.5),this.metalness=new THREE.FloatNode(.5)},THREE.StandardNode.prototype=Object.create(THREE.GLNode.prototype),THREE.StandardNode.prototype.constructor=THREE.StandardNode,THREE.StandardNode.prototype.nodeType="Standard",THREE.StandardNode.prototype.build=function(e){var t,n=e.material;if(n.define("PHYSICAL"),this.clearCoat||this.clearCoatRoughness||n.define("STANDARD"),n.define("ALPHATEST","0.0"),n.requires.lights=!0,n.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var i=this.transform?this.transform.parseAndBuildCode(e,"v3",{cache:"transform"}):void 0;n.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights])),n.addVertexPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>"].join("\n"));var r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <logdepthbuf_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <logdepthbuf_pars_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];i&&r.push(i.code,"transformed = "+i.result+";"),r.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),t=r.join("\n")}else{var o={bias:new THREE.RoughnessToBlinnExponentNode,offsetU:0,offsetV:0},a=!n.isDefined("STANDARD");this.color.parse(e,{slot:"color"}),this.roughness.parse(e),this.metalness.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.normalScale&&this.normal&&this.normalScale.parse(e),this.clearCoat&&this.clearCoat.parse(e),this.clearCoatRoughness&&this.clearCoatRoughness.parse(e),this.reflectivity&&this.reflectivity.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{cache:"env",requires:o,slot:"environment"});var s=this.color.buildCode(e,"c",{slot:"color"}),l=this.roughness.buildCode(e,"fv1"),u=this.metalness.buildCode(e,"fv1"),c=this.alpha?this.alpha.buildCode(e,"fv1"):void 0,h=this.normal?this.normal.buildCode(e,"v3"):void 0,d=this.normalScale&&this.normal?this.normalScale.buildCode(e,"v2"):void 0,p=this.clearCoat?this.clearCoat.buildCode(e,"fv1"):void 0,f=this.clearCoatRoughness?this.clearCoatRoughness.buildCode(e,"fv1"):void 0,m=this.reflectivity?this.reflectivity.buildCode(e,"fv1"):void 0,g=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,v=this.ao?this.ao.buildCode(e,"fv1"):void 0,y=this.ambient?this.ambient.buildCode(e,"c"):void 0,x=this.shadow?this.shadow.buildCode(e,"c"):void 0,E=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,T=this.environment?this.environment.buildCode(e,"c",{cache:"env",requires:o,slot:"environment"}):void 0,b=a&&T?this.environment.buildCode(e,"c",{cache:"clearCoat",requires:o,slot:"environment"}):void 0;n.requires.transparent=null!=c,n.addFragmentPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <logdepthbuf_vertex>"].join("\n"));r=["\t#include <normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );",s.code,"\tvec3 diffuseColor = "+s.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",l.code,"\tfloat roughnessFactor = "+l.result+";",u.code,"\tfloat metalnessFactor = "+u.result+";"];c&&r.push(c.code,"if ( "+c.result+" <= ALPHATEST ) discard;"),h&&(e.include("perturbNormal2Arb"),r.push(h.code),d&&r.push(d.code),r.push("normal = perturbNormal2Arb(-vViewPosition,normal,"+h.result+","+(new THREE.UVNode).build(e,"v2")+","+(d?d.result:"vec2( 1.0 )")+");")),r.push("material.diffuseColor = "+(g?"vec3( 1.0 )":"diffuseColor * (1.0 - metalnessFactor)")+";"),r.push("material.specularRoughness = clamp( roughnessFactor, DEFAULT_SPECULAR_COEFFICIENT, 1.0 );"),p?r.push(p.code,"material.clearCoat = saturate( "+p.result+" );"):a&&r.push("material.clearCoat = 0.0;"),f?r.push(f.code,"material.clearCoatRoughness = clamp( "+f.result+", DEFAULT_SPECULAR_COEFFICIENT, 1.0 );"):a&&r.push("material.clearCoatRoughness = 0.0;"),m?r.push(m.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+m.result+" ) ), diffuseColor, metalnessFactor );"):r.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),r.push("#include <lights_fragment_begin>","#include <lights_fragment_end>"),g&&(r.push(g.code,"reflectedLight.directDiffuse = "+g.result+";"),r.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),v&&r.push(v.code,"reflectedLight.indirectDiffuse *= "+v.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+v.result+", material.specularRoughness );"),y&&r.push(y.code,"reflectedLight.indirectDiffuse += "+y.result+";"),x&&r.push(x.code,"reflectedLight.directDiffuse *= "+x.result+";","reflectedLight.directSpecular *= "+x.result+";"),E&&r.push(E.code,"reflectedLight.directDiffuse += "+E.result+";"),T&&(r.push(T.code),b&&r.push(b.code,"clearCoatRadiance += "+b.result+";"),r.push("RE_IndirectSpecular("+T.result+", clearCoatRadiance, geometry, material, reflectedLight );")),r.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),c?r.push("gl_FragColor = vec4( outgoingLight, "+c.result+" );"):r.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),r.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),t=r.join("\n")}return t},THREE.StandardNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.transform&&(t.transform=this.transform.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.normalScale&&(t.normalScale=this.normalScale.toJSON(e).uuid),this.clearCoat&&(t.clearCoat=this.clearCoat.toJSON(e).uuid),this.clearCoatRoughness&&(t.clearCoatRoughness=this.clearCoatRoughness.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid)),t},THREE.StandardNodeMaterial=function(){this.node=new THREE.StandardNode,THREE.NodeMaterial.call(this,this.node,this.node),this.type="StandardNodeMaterial"},THREE.StandardNodeMaterial.prototype=Object.create(THREE.NodeMaterial.prototype),THREE.StandardNodeMaterial.prototype.constructor=THREE.StandardNodeMaterial,THREE.NodeMaterial.addShortcuts(THREE.StandardNodeMaterial.prototype,"node",["color","alpha","roughness","metalness","reflectivity","clearCoat","clearCoatRoughness","normal","normalScale","emissive","ambient","light","shadow","ao","environment","transform"]),THREE.NodeMaterialLoader=function(e,t){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=t||{}},THREE.NodeMaterialLoaderUtils={replaceUUIDObject:function(e,t,n,i){if(i=void 0===i||i,"object"==typeof t&&(t=t.uuid),"object"==typeof e)for(var r=Object.keys(e),o=0;o<r.length;o++){var a=r[o];i&&(e[a]=this.replaceUUIDObject(e[a],t,n)),a===t&&(e[t]=e[a],delete e[a])}return e===t?n:e},replaceUUID:function(e,t,n){return this.replaceUUIDObject(e,t,n,!1),this.replaceUUIDObject(e.nodes,t,n),this.replaceUUIDObject(e.materials,t,n),this.replaceUUIDObject(e.passes,t,n),this.replaceUUIDObject(e.library,t,n,!1),e}},Object.assign(THREE.NodeMaterialLoader.prototype,{load:function(e,t,n,i){var r=this;return new THREE.FileLoader(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},n,i),this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},parse:function(e){var t,n,i,r,o;for(t in e.nodes)n=e.nodes[t],i=new THREE[n.type],n.name?(i.name=n.name,this.names[i.name]=i):i.readonly=!0,void 0!==n.readonly&&(i.readonly=n.readonly),this.nodes[t]=i;for(t in e.materials)n=e.materials[t],i=new THREE[n.type],n.name&&(i.name=n.name,this.names[i.name]=i),this.materials[t]=i;for(t in e.passes)n=e.passes[t],i=new THREE[n.type],n.name&&(i.name=n.name,this.names[i.name]=i),this.passes[t]=i;for(t in e.material&&(this.material=this.materials[t]),e.pass&&(this.pass=this.passes[t]),e.nodes)switch(n=e.nodes[t],i=this.nodes[t],n.type){case"FloatNode":i.number=n.number;break;case"ColorNode":i.value.copy(n);break;case"Vector2Node":i.x=n.x,i.y=n.y;break;case"Vector3Node":i.x=n.x,i.y=n.y,i.z=n.z;break;case"Vector4Node":i.x=n.x,i.y=n.y,i.z=n.z,i.w=n.w;break;case"Matrix3Node":case"Matrix4Node":i.value.fromArray(n.elements);break;case"OperatorNode":i.a=this.getNode(n.a),i.b=this.getNode(n.b),i.op=n.op;break;case"Math1Node":i.a=this.getNode(n.a),i.method=n.method;break;case"Math2Node":i.a=this.getNode(n.a),i.b=this.getNode(n.b),i.method=n.method;break;case"Math3Node":i.a=this.getNode(n.a),i.b=this.getNode(n.b),i.c=this.getNode(n.c),i.method=n.method;break;case"UVNode":case"ColorsNode":i.index=n.index;break;case"LuminanceNode":i.rgb=this.getNode(n.rgb);break;case"PositionNode":case"NormalNode":case"ReflectNode":case"LightNode":i.scope=n.scope;break;case"SwitchNode":i.node=this.getNode(n.node),i.components=n.components;break;case"JoinNode":for(r in n.inputs)i[r]=this.getNode(n.inputs[r]);break;case"CameraNode":switch(i.setScope(n.scope),n.camera&&i.setCamera(this.getNode(n.camera)),n.scope){case THREE.CameraNode.DEPTH:i.near.number=n.near,i.far.number=n.far}break;case"ColorAdjustmentNode":i.rgb=this.getNode(n.rgb),i.adjustment=this.getNode(n.adjustment),i.method=n.method;break;case"UVTransformNode":i.uv=this.getNode(n.uv),i.transform=this.getNode(n.transform);break;case"BumpNode":i.value=this.getNode(n.value),i.coord=this.getNode(n.coord),i.scale=this.getNode(n.scale);break;case"BlurNode":i.value=this.getNode(n.value),i.coord=this.getNode(n.coord),i.scale=this.getNode(n.scale),i.value=this.getNode(n.value),i.coord=this.getNode(n.coord),i.radius=this.getNode(n.radius),void 0!==n.size&&(i.size=new THREE.Vector2(n.size.x,n.size.y)),i.blurX=n.blurX,i.blurY=n.blurY;break;case"ResolutionNode":i.renderer=this.getNode(n.renderer);break;case"ScreenUVNode":i.resolution=this.getNode(n.resolution);break;case"VelocityNode":n.target&&i.setTarget(this.getNode(n.target)),i.setParams(n.params);break;case"TimerNode":i.scope=n.scope,i.scale=n.scale;break;case"ConstNode":i.name=n.name,i.type=n.out,i.value=n.value,i.useDefine=!0===n.useDefine;break;case"AttributeNode":case"VarNode":i.type=n.out;break;case"ReflectorNode":i.setMirror(this.getNode(n.mirror)),n.offset&&(i.offset=this.getNode(n.offset));break;case"NoiseNode":i.coord=this.getNode(n.coord);break;case"FunctionNode":for(r in i.isMethod=n.isMethod,i.useKeywords=n.useKeywords,i.extensions=n.extensions,i.keywords={},n.keywords)i.keywords[r]=this.getNode(n.keywords[r]);if(n.includes)for(o=0;o<n.includes.length;o++)i.includes.push(this.getNode(n.includes[o]));i.eval(n.src,i.includes,i.extensions,i.keywords),i.isMethod||(i.type=n.out);break;case"FunctionCallNode":for(r in n.inputs)i.inputs[r]=this.getNode(n.inputs[r]);i.value=this.getNode(n.value);break;case"TextureNode":case"CubeTextureNode":case"ScreenNode":n.value&&(i.value=this.getNode(n.value)),i.coord=this.getNode(n.coord),n.bias&&(i.bias=this.getNode(n.bias)),void 0!==i.project&&(i.project=n.project);break;case"RoughnessToBlinnExponentNode":break;case"RawNode":i.value=this.getNode(n.value);break;case"StandardNode":case"PhongNode":case"SpriteNode":i.color=this.getNode(n.color),n.alpha&&(i.alpha=this.getNode(n.alpha)),n.specular&&(i.specular=this.getNode(n.specular)),n.shininess&&(i.shininess=this.getNode(n.shininess)),n.roughness&&(i.roughness=this.getNode(n.roughness)),n.metalness&&(i.metalness=this.getNode(n.metalness)),n.reflectivity&&(i.reflectivity=this.getNode(n.reflectivity)),n.clearCoat&&(i.clearCoat=this.getNode(n.clearCoat)),n.clearCoatRoughness&&(i.clearCoatRoughness=this.getNode(n.clearCoatRoughness)),n.normal&&(i.normal=this.getNode(n.normal)),n.normalScale&&(i.normalScale=this.getNode(n.normalScale)),n.emissive&&(i.emissive=this.getNode(n.emissive)),n.ambient&&(i.ambient=this.getNode(n.ambient)),n.shadow&&(i.shadow=this.getNode(n.shadow)),n.light&&(i.light=this.getNode(n.light)),n.ao&&(i.ao=this.getNode(n.ao)),n.environment&&(i.environment=this.getNode(n.environment)),n.environmentAlpha&&(i.environmentAlpha=this.getNode(n.environmentAlpha)),n.transform&&(i.transform=this.getNode(n.transform)),!1===n.spherical&&(i.spherical=!1);break;default:console.warn(n.type,"not supported.")}for(t in e.materials)n=e.materials[t],i=this.materials[t],void 0!==n.name&&(i.name=n.name),void 0!==n.blending&&(i.blending=n.blending),void 0!==n.flatShading&&(i.flatShading=n.flatShading),void 0!==n.side&&(i.side=n.side),i.depthFunc=n.depthFunc,i.depthTest=n.depthTest,i.depthWrite=n.depthWrite,void 0!==n.wireframe&&(i.wireframe=n.wireframe),void 0!==n.wireframeLinewidth&&(i.wireframeLinewidth=n.wireframeLinewidth),void 0!==n.wireframeLinecap&&(i.wireframeLinecap=n.wireframeLinecap),void 0!==n.wireframeLinejoin&&(i.wireframeLinejoin=n.wireframeLinejoin),void 0!==n.skinning&&(i.skinning=n.skinning),void 0!==n.morphTargets&&(i.morphTargets=n.morphTargets),void 0!==n.visible&&(i.visible=n.visible),void 0!==n.userData&&(i.userData=n.userData),i.vertex=this.getNode(n.vertex),i.fragment=this.getNode(n.fragment),i.vertex===i.fragment&&(i.node=i.vertex),i.build(),void 0!==n.fog&&(i.fog=n.fog),void 0!==n.lights&&(i.lights=n.lights),void 0!==n.transparent&&(i.transparent=n.transparent);for(t in e.passes)n=e.passes[t],(i=this.passes[t]).value=this.getNode(n.value),i.build();return this.material||this.pass||this}}),THREE.HDRLoader=THREE.RGBELoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.RGBELoader.prototype=Object.create(THREE.DataTextureLoader.prototype),THREE.RGBELoader.prototype._parser=function(e){var y=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},l=function(e,t,n){t=t||1024;for(var i=e.pos,r=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));(r=s.indexOf("\n"))<0&&o<t&&i<e.byteLength;)a+=s,o+=s.length,i+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return-1<r&&(!1!==n&&(e.pos+=o+r+1),a+s.slice(0,r))},t=new Uint8Array(e);t.byteLength;t.pos=0;var n=function(e){var t,n,i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(t=l(e)))return y(1,"no header found");if(!(n=t.match(/^#\?(\S+)$/)))return y(3,"bad initial token");for(s.valid|=1,s.programtype=n[1],s.string+=t+"\n";!1!==(t=l(e));)if(s.string+=t+"\n","#"!==t.charAt(0)){if((n=t.match(i))&&(s.gamma=parseFloat(n[1],10)),(n=t.match(r))&&(s.exposure=parseFloat(n[1],10)),(n=t.match(o))&&(s.valid|=2,s.format=n[1]),(n=t.match(a))&&(s.valid|=4,s.height=parseInt(n[1],10),s.width=parseInt(n[2],10)),2&s.valid&&4&s.valid)break}else s.comments+=t+"\n";return 2&s.valid?4&s.valid?s:y(3,"missing image size specifier"):y(3,"missing format specifier")}(t);if(-1!==n){var i=n.width,r=n.height,o=function(e,t,n){var i,r,o,a,s,l,u,c,h,d,p,f,m,g=t,v=n;if(g<8||32767<g||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return y(3,"wrong scanline width");if(!(i=new Uint8Array(4*t*n))||!i.length)return y(4,"unable to allocate buffer space");for(o=r=0,c=4*g,m=new Uint8Array(4),l=new Uint8Array(c);0<v&&o<e.byteLength;){if(o+4>e.byteLength)return y(1);if(m[0]=e[o++],m[1]=e[o++],m[2]=e[o++],m[3]=e[o++],2!=m[0]||2!=m[1]||(m[2]<<8|m[3])!=g)return y(3,"bad rgbe scanline format");for(u=0;u<c&&o<e.byteLength;){if((f=128<(a=e[o++]))&&(a-=128),0===a||c<u+a)return y(3,"bad scanline data");if(f)for(s=e[o++],h=0;h<a;h++)l[u++]=s;else l.set(e.subarray(o,o+a),u),u+=a,o+=a}for(d=g,h=0;h<d;h++)p=0,i[r]=l[h+p],p+=g,i[r+1]=l[h+p],p+=g,i[r+2]=l[h+p],p+=g,i[r+3]=l[h+p],r+=4;v--}return i}(t.subarray(t.pos),i,r);if(-1!==o)return{width:i,height:r,data:o,header:n.string,gamma:n.gamma,exposure:n.exposure,format:THREE.RGBEFormat,type:THREE.UnsignedByteType}}return null},THREE.HDRCubeTextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.hdrLoader=new THREE.RGBELoader},THREE.HDRCubeTextureLoader.prototype.load=function(u,i,e,t,n){var c=function(e,t,n,i){var r=e[t+3],o=Math.pow(2,r-128)/255;n[i+0]=e[t+0]*o,n[i+1]=e[t+1]*o,n[i+2]=e[t+2]*o},h=function(){var o=new Float32Array(1),a=new Int32Array(o.buffer);function s(e){o[0]=e;var t=a[0],n=t>>16&32768,i=t>>12&2047,r=t>>23&255;return r<103?n:142<r?(n|=31744,n|=(255==r?0:1)&&8388607&t):r<113?n|=((i|=2048)>>114-r)+(i>>113-r&1):(n|=r-112<<10|i>>1,n+=1&i)}return function(e,t,n,i){var r=e[t+3],o=Math.pow(2,r-128)/255;n[i+0]=s(e[t+0]*o),n[i+1]=s(e[t+1]*o),n[i+2]=s(e[t+2]*o)}}(),d=new THREE.CubeTexture;d.type=u,d.encoding=u===THREE.UnsignedByteType?THREE.RGBEEncoding:THREE.LinearEncoding,d.format=u===THREE.UnsignedByteType?THREE.RGBAFormat:THREE.RGBFormat,d.minFilter=d.encoding===THREE.RGBEEncoding?THREE.NearestFilter:THREE.LinearFilter,d.magFilter=d.encoding===THREE.RGBEEncoding?THREE.NearestFilter:THREE.LinearFilter,d.generateMipmaps=d.encoding!==THREE.RGBEEncoding,d.anisotropy=0;var p=this.hdrLoader,f=0;function r(s,l,e,t){var n=new THREE.FileLoader(this.manager);n.setResponseType("arraybuffer"),n.load(i[s],function(e){f++;var t=p._parser(e);if(t){if(u===THREE.FloatType){for(var n=t.data.length/4*3,i=new Float32Array(n),r=0;r<n;r++)c(t.data,4*r,i,3*r);t.data=i}else if(u===THREE.HalfFloatType){n=t.data.length/4*3;var o=new Uint16Array(n);for(r=0;r<n;r++)h(t.data,4*r,o,3*r);t.data=o}if(void 0!==t.image)d[s].images=t.image;else if(void 0!==t.data){var a=new THREE.DataTexture(t.data,t.width,t.height);a.format=d.format,a.type=d.type,a.encoding=d.encoding,a.minFilter=d.minFilter,a.magFilter=d.magFilter,a.generateMipmaps=d.generateMipmaps,d.images[s]=a}6===f&&(d.needsUpdate=!0,l&&l(d))}},e,t)}for(var o=0;o<i.length;o++)r(o,e,t,n);return d},THREE.PMREMGenerator=function(e,t,n){this.sourceTexture=e,this.resolution=void 0!==n?n:256,this.samplesPerLevel=void 0!==t?t:16;var i=e.encoding===THREE.LinearEncoding||e.encoding===THREE.GammaEncoding||e.encoding===THREE.sRGBEncoding;this.sourceTexture.minFilter=i?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.magFilter=i?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&i,this.cubeLods=[];var r=this.resolution,o={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(r)/Math.log(2)-2;for(var a=0;a<this.numLods;a++){var s=new THREE.WebGLRenderTargetCube(r,r,o);s.texture.name="PMREMGenerator.cube"+a,this.cubeLods.push(s),r=Math.max(16,r/2)}this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1e3),this.shader=this.getShader(),this.shader.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,this.planeMesh=new THREE.Mesh(new THREE.PlaneGeometry(2,2,0),this.shader),this.planeMesh.material.side=THREE.DoubleSide,this.scene=new THREE.Scene,this.scene.add(this.planeMesh),this.scene.add(this.camera),this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture},THREE.PMREMGenerator.prototype={constructor:THREE.PMREMGenerator,update:function(e){this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture;var t=e.gammaInput,n=e.gammaOutput,i=e.toneMapping,r=e.toneMappingExposure,o=e.getRenderTarget();e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.gammaInput=!1,e.gammaOutput=!1;for(var a=0;a<this.numLods;a++){var s=a/(this.numLods-1);this.shader.uniforms.roughness.value=.9*s,this.shader.uniforms.queryScale.value.x=0==a?-1:1;var l=this.cubeLods[a].width;this.shader.uniforms.mapSize.value=l,this.renderToCubeMapTarget(e,this.cubeLods[a]),a<5&&(this.shader.uniforms.envMap.value=this.cubeLods[a].texture)}e.setRenderTarget(o),e.toneMapping=i,e.toneMappingExposure=r,e.gammaInput=t,e.gammaOutput=n},renderToCubeMapTarget:function(e,t){for(var n=0;n<6;n++)this.renderToCubeMapTargetFace(e,t,n)},renderToCubeMapTargetFace:function(e,t,n){t.activeCubeFace=n,this.shader.uniforms.faceIndex.value=n,e.render(this.scene,this.camera,t,!0)},getShader:function(){return new THREE.ShaderMaterial({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},queryScale:{value:new THREE.Vector3(1,1,1)},testColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform vec3 testColor;\n\t\t\t\tuniform vec3 queryScale;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tmat3 vecSpace = matrixFromVector(normalize(sampleDirection * queryScale));\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap,vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:THREE.CustomBlending,blendSrc:THREE.OneFactor,blendDst:THREE.ZeroFactor,blendSrcAlpha:THREE.OneFactor,blendDstAlpha:THREE.ZeroFactor,blendEquation:THREE.AddEquation})}},THREE.PMREMCubeUVPacker=function(e,t){this.cubeLods=e,this.numLods=t;var n=4*e[0].width,i=e[0].texture,r={format:i.format,magFilter:i.magFilter,minFilter:i.minFilter,type:i.type,generateMipmaps:i.generateMipmaps,anisotropy:i.anisotropy,encoding:i.encoding===THREE.RGBEEncoding?THREE.RGBM16Encoding:i.encoding};r.encoding===THREE.RGBM16Encoding&&(r.magFilter=THREE.LinearFilter,r.minFilter=THREE.LinearFilter),this.CubeUVRenderTarget=new THREE.WebGLRenderTarget(n,n,r),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=THREE.CubeUVReflectionMapping,this.camera=new THREE.OrthographicCamera(.5*-n,.5*n,.5*-n,.5*n,0,1e3),this.scene=new THREE.Scene,this.scene.add(this.camera),this.objects=[];var o=[];o.push(new THREE.Vector2(0,0)),o.push(new THREE.Vector2(1,0)),o.push(new THREE.Vector2(2,0)),o.push(new THREE.Vector2(0,1)),o.push(new THREE.Vector2(1,1)),o.push(new THREE.Vector2(2,1));var a=n;n=e[0].width;var s=0,l=4;this.numLods=Math.log(e[0].width)/Math.log(2)-2;for(var u=0;u<this.numLods;u++){var c=.5*(a-a/l);16<n&&(l*=2);for(var h=16<n?6:1,d=0,p=0,f=n,m=0;m<h;m++){for(var g=0;g<6;g++){var v=this.getShader();v.uniforms.envMap.value=this.cubeLods[u].texture,v.envMap=this.cubeLods[u].texture,v.uniforms.faceIndex.value=g,v.uniforms.mapSize.value=f;var y=new THREE.Mesh(new THREE.PlaneGeometry(f,f,0),v);y.position.x=o[g].x*f-c+d,y.position.y=o[g].y*f-c+s+p,y.material.side=THREE.DoubleSide,this.scene.add(y),this.objects.push(y)}p+=1.75*f,d+=1.25*f,f/=2}s+=2*n,16<n&&(n/=2)}},THREE.PMREMCubeUVPacker.prototype={constructor:THREE.PMREMCubeUVPacker,update:function(e){var t=e.gammaInput,n=e.gammaOutput,i=e.toneMapping,r=e.toneMappingExposure,o=e.getRenderTarget();e.gammaInput=!1,e.gammaOutput=!1,e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.render(this.scene,this.camera,this.CubeUVRenderTarget,!1),e.setRenderTarget(o),e.toneMapping=i,e.toneMappingExposure=r,e.gammaInput=t,e.gammaOutput=n},getShader:function(){return new THREE.ShaderMaterial({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tvoid main() {\t\t\t\t\tvUv = uv;\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\t\t\t\t}",fragmentShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform samplerCube envMap;\t\t\t\tuniform float mapSize;\t\t\t\tuniform vec3 testColor;\t\t\t\tuniform int faceIndex;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec3 sampleDirection;\t\t\t\t\tvec2 uv = vUv;\t\t\t\t\tuv = uv * 2.0 - 1.0;\t\t\t\t\tuv.y *= -1.0;\t\t\t\t\tif(faceIndex == 0) {\t\t\t\t\t\tsampleDirection = normalize(vec3(1.0, uv.y, -uv.x));\t\t\t\t\t} else if(faceIndex == 1) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, 1.0, uv.y));\t\t\t\t\t} else if(faceIndex == 2) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, uv.y, 1.0));\t\t\t\t\t} else if(faceIndex == 3) {\t\t\t\t\t\tsampleDirection = normalize(vec3(-1.0, uv.y, uv.x));\t\t\t\t\t} else if(faceIndex == 4) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));\t\t\t\t\t} else {\t\t\t\t\t\tsampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));\t\t\t\t\t}\t\t\t\t\tvec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );\t\t\t\t\tgl_FragColor = linearToOutputTexel( color );\t\t\t\t}",blending:THREE.CustomBlending,premultipliedAlpha:!1,blendSrc:THREE.OneFactor,blendDst:THREE.ZeroFactor,blendSrcAlpha:THREE.OneFactor,blendDstAlpha:THREE.ZeroFactor,blendEquation:THREE.AddEquation})}},function(V){"use strict";var c={objectMaxDepth:5};function e(e){if(!Te(e))return c;Ee(e.objectMaxDepth)&&(c.objectMaxDepth=u(e.objectMaxDepth)?e.objectMaxDepth:NaN)}function u(e){return _(e)&&0<e}function A(a,s){s=s||Error;var l="https://errors.angularjs.org/1.6.10/",e=l.replace(".","\\.")+"[\\s\\S]*",u=new RegExp(e,"g");return function(){var e,t,n=arguments[0],i=arguments[1],r="["+(a?a+":":"")+n+"] ",o=Fe(arguments,2).map(function(e){return Ye(e,c.objectMaxDepth)});for(r+=i.replace(/\{\d+\}/g,function(e){var t=+e.slice(1,-1);return t<o.length?o[t].replace(u,""):e}),r+="\n"+l+(a?a+"/":"")+n,t=0,e="?";t<o.length;t++,e="&")r+=e+"p"+t+"="+encodeURIComponent(o[t]);return new s(r)}}var o=/^\/(.+)\/([a-z]*)$/,h="validity",z=Object.prototype.hasOwnProperty,ce=function(e){return be(e)?e.toLowerCase():e},d=function(e){return be(e)?e.toUpperCase():e};"i"!=="I".toLowerCase()&&(ce=function(e){return be(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},d=function(e){return be(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e});var he,de,a,v,s=[].slice,i=[].splice,t=[].push,pe=Object.prototype.toString,p=Object.getPrototypeOf,f=A("ng"),x=V.angular||(V.angular={}),n=0;function O(e){if(null==e||P(e))return!1;if(_e(e)||be(e)||de&&e instanceof de)return!0;var t="length"in Object(e)&&e.length;return _(t)&&(0<=t&&(t-1 in e||e instanceof Array)||"function"==typeof e.item)}function fe(e,t,n){var i,r;if(e)if(Se(e))for(i in e)"prototype"!==i&&"length"!==i&&"name"!==i&&e.hasOwnProperty(i)&&t.call(n,e[i],i,e);else if(_e(e)||O(e)){var o="object"!=typeof e;for(i=0,r=e.length;i<r;i++)(o||i in e)&&t.call(n,e[i],i,e)}else if(e.forEach&&e.forEach!==fe)e.forEach(t,n,e);else if(b(e))for(i in e)t.call(n,e[i],i,e);else if("function"==typeof e.hasOwnProperty)for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e);else for(i in e)z.call(e,i)&&t.call(n,e[i],i,e);return e}function l(e,t,n){for(var i=Object.keys(e).sort(),r=0;r<i.length;r++)t.call(n,e[i[r]],i[r]);return i}function y(n){return function(e,t){n(t,e)}}function R(){return++n}function m(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function g(e,t,n){for(var i=e.$$hashKey,r=0,o=t.length;r<o;++r){var a=t[r];if(Te(a)||Se(a))for(var s=Object.keys(a),l=0,u=s.length;l<u;l++){var c=s[l],h=a[c];n&&Te(h)?w(h)?e[c]=new Date(h.valueOf()):S(h)?e[c]=new RegExp(h):h.nodeName?e[c]=h.cloneNode(!0):$(h)?e[c]=h.clone():(Te(e[c])||(e[c]=_e(h)?[]:{}),g(e[c],[h],!0)):e[c]=h}}return m(e,i),e}function me(e){return g(e,s.call(arguments,1),!1)}function r(e){return g(e,s.call(arguments,1),!0)}function E(e){return parseInt(e,10)}he=V.document.documentMode;var N=Number.isNaN||function(e){return e!=e};function ge(e,t){return me(Object.create(e),t)}function ve(){}function ye(e){return e}function M(e){return function(){return e}}function T(e){return Se(e.toString)&&e.toString!==pe}function xe(e){return void 0===e}function Ee(e){return void 0!==e}function Te(e){return null!==e&&"object"==typeof e}function b(e){return null!==e&&"object"==typeof e&&!p(e)}function be(e){return"string"==typeof e}function _(e){return"number"==typeof e}function w(e){return"[object Date]"===pe.call(e)}ve.$inject=[],ye.$inject=[];var _e=Array.isArray;function we(e){switch(pe.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}function Se(e){return"function"==typeof e}function S(e){return"[object RegExp]"===pe.call(e)}function P(e){return e&&e.window===e}function Me(e){return e&&e.$evalAsync&&e.$watch}function Ae(e){return"boolean"==typeof e}function L(e){return e&&Se(e.then)}var C=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/;var Re=function(e){return be(e)?e.trim():e},F=function(e){return e.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};function $(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function Ne(e){return ce(e.nodeName||e[0]&&e[0].nodeName)}function H(e,t){return-1!==Array.prototype.indexOf.call(e,t)}function Pe(e,t){var n=e.indexOf(t);return 0<=n&&e.splice(n,1),n}function I(e,n,t){var i,r,o=[],a=[];if(t=u(t)?t:NaN,n){if((r=n)&&_(r.length)&&C.test(pe.call(r))||(i=n,"[object ArrayBuffer]"===pe.call(i)))throw f("cpta","Can't copy! TypedArray destination cannot be mutated.");if(e===n)throw f("cpi","Can't copy! Source and destination are identical.");return _e(n)?n.length=0:fe(n,function(e,t){"$$hashKey"!==t&&delete n[t]}),o.push(e),a.push(n),s(e,n,t)}return l(e,t);function s(e,t,n){if(--n<0)return"...";var i,r=t.$$hashKey;if(_e(e))for(var o=0,a=e.length;o<a;o++)t.push(l(e[o],n));else if(b(e))for(i in e)t[i]=l(e[i],n);else if(e&&"function"==typeof e.hasOwnProperty)for(i in e)e.hasOwnProperty(i)&&(t[i]=l(e[i],n));else for(i in e)z.call(e,i)&&(t[i]=l(e[i],n));return m(t,r),t}function l(e,t){if(!Te(e))return e;var n=o.indexOf(e);if(-1!==n)return a[n];if(P(e)||Me(e))throw f("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var i=!1,r=function(e){switch(pe.call(e)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new e.constructor(l(e.buffer),e.byteOffset,e.length);case"[object ArrayBuffer]":if(!e.slice){var t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}return e.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new e.constructor(e.valueOf());case"[object RegExp]":var n=new RegExp(e.source,e.toString().match(/[^/]*$/)[0]);return n.lastIndex=e.lastIndex,n;case"[object Blob]":return new e.constructor([e],{type:e.type})}if(Se(e.cloneNode))return e.cloneNode(!0)}(e);return void 0===r&&(r=_e(e)?[]:Object.create(p(e)),i=!0),o.push(e),a.push(r),i?s(e,r,t):r}}function Le(e,t){return e===t||e!=e&&t!=t}function Ce(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n,i,r,o=typeof e;if(o===typeof t&&"object"===o){if(!_e(e)){if(w(e))return!!w(t)&&Le(e.getTime(),t.getTime());if(S(e))return!!S(t)&&e.toString()===t.toString();if(Me(e)||Me(t)||P(e)||P(t)||_e(t)||w(t)||S(t))return!1;for(i in r=ke(),e)if("$"!==i.charAt(0)&&!Se(e[i])){if(!Ce(e[i],t[i]))return!1;r[i]=!0}for(i in t)if(!(i in r)&&"$"!==i.charAt(0)&&Ee(t[i])&&!Se(t[i]))return!1;return!0}if(!_e(t))return!1;if((n=e.length)===t.length){for(i=0;i<n;i++)if(!Ce(e[i],t[i]))return!1;return!0}}return!1}var U=function(){if(!Ee(U.rules)){var e=V.document.querySelector("[ng-csp]")||V.document.querySelector("[data-ng-csp]");if(e){var t=e.getAttribute("ng-csp")||e.getAttribute("data-ng-csp");U.rules={noUnsafeEval:!t||-1!==t.indexOf("no-unsafe-eval"),noInlineStyle:!t||-1!==t.indexOf("no-inline-style")}}else U.rules={noUnsafeEval:function(){try{return new Function(""),!1}catch(e){return!0}}(),noInlineStyle:!1}}return U.rules},D=function(){if(Ee(D.name_))return D.name_;var e,t,n,i,r=te.length;for(t=0;t<r;++t)if(n=te[t],e=V.document.querySelector("["+n.replace(":","\\:")+"jq]")){i=e.getAttribute(n+"jq");break}return D.name_=i};function B(e,t,n){return e.concat(s.call(t,n))}function Fe(e,t){return s.call(e,t||0)}function Oe(e,t){var n=2<arguments.length?Fe(arguments,2):[];return!Se(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,B(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function k(e,t){var n=t;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?n=void 0:P(t)?n="$WINDOW":t&&V.document===t?n="$DOCUMENT":Me(t)&&(n="$SCOPE"),n}function G(e,t){if(!xe(e))return _(t)||(t=t?2:null),JSON.stringify(e,k,t)}function j(e){return be(e)?JSON.parse(e):e}var W=/:/g;function X(e,t){e=e.replace(W,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return N(n)?t:n}function q(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function Y(e,t,n){n=n?-1:1;var i=e.getTimezoneOffset();return q(e,n*(X(t,i)-i))}function $e(e){e=de(e).clone().empty();var t=de("<div></div>").append(e).html();try{return e[0].nodeType===Ge?ce(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(e,t){return"<"+ce(t)})}catch(e){return ce(t)}}function J(e){try{return decodeURIComponent(e)}catch(e){}}function Q(e){var r={};return fe((e||"").split("&"),function(e){var t,n,i;e&&(n=e=e.replace(/\+/g,"%20"),-1!==(t=e.indexOf("="))&&(n=e.substring(0,t),i=e.substring(t+1)),Ee(n=J(n))&&(i=!Ee(i)||J(i),z.call(r,n)?_e(r[n])?r[n].push(i):r[n]=[r[n],i]:r[n]=i))}),r}function Z(e){var n=[];return fe(e,function(e,t){_e(e)?fe(e,function(e){n.push(ee(t,!0)+(!0===e?"":"="+ee(e,!0)))}):n.push(ee(t,!0)+(!0===e?"":"="+ee(e,!0)))}),n.length?n.join("&"):""}function K(e){return ee(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ee(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}var te=["ng-","data-ng-","ng:","x-ng-"];var ne=function(n){var e=n.currentScript;if(!e)return!0;if(!(e instanceof V.HTMLScriptElement||e instanceof V.SVGScriptElement))return!1;var t=e.attributes;return[t.getNamedItem("src"),t.getNamedItem("href"),t.getNamedItem("xlink:href")].every(function(e){if(!e)return!0;if(!e.value)return!1;var t=n.createElement("a");if(t.href=e.value,n.location.origin===t.origin)return!0;switch(t.protocol){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}})}(V.document);function ie(i,e){var r,o,t={};if(fe(te,function(e){var t=e+"app";!r&&i.hasAttribute&&i.hasAttribute(t)&&(o=(r=i).getAttribute(t))}),fe(te,function(e){var t,n=e+"app";!r&&(t=i.querySelector("["+n.replace(":","\\:")+"]"))&&(o=(r=t).getAttribute(n))}),r){if(!ne)return void V.console.error("AngularJS: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match.");t.strictDi=null!==function(e,t){var n,i,r=te.length;for(i=0;i<r;++i)if(n=te[i]+t,be(n=e.getAttribute(n)))return n;return null}(r,"strict-di"),e(r,o?[o]:[],t)}}function re(n,i,r){Te(r)||(r={});r=me({strictDi:!1},r);var t=function(){if((n=de(n)).injector()){var e=n[0]===V.document?"document":$e(n);throw f("btstrpd","App already bootstrapped with this element '{0}'",e.replace(/</,"&lt;").replace(/>/,"&gt;"))}(i=i||[]).unshift(["$provide",function(e){e.value("$rootElement",n)}]),r.debugInfoEnabled&&i.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),i.unshift("ng");var t=Qt(i,r.strictDi);return t.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,i){e.$apply(function(){t.data("$injector",i),n(t)(e)})}]),t},e=/^NG_ENABLE_DEBUG_INFO!/,o=/^NG_DEFER_BOOTSTRAP!/;if(V&&e.test(V.name)&&(r.debugInfoEnabled=!0,V.name=V.name.replace(e,"")),V&&!o.test(V.name))return t();V.name=V.name.replace(o,""),x.resumeBootstrap=function(e){return fe(e,function(e){i.push(e)}),t()},Se(x.resumeDeferredBootstrap)&&x.resumeDeferredBootstrap()}function oe(){V.name="NG_ENABLE_DEBUG_INFO!"+V.name,V.location.reload()}function ae(e){var t=x.element(e).injector();if(!t)throw f("test","no injector found for element argument to getTestability");return t.get("$$testability")}var se=/[A-Z]/g;function He(e,n){return n=n||"_",e.replace(se,function(e,t){return(t?n:"")+e.toLowerCase()})}var le=!1;function Ie(e,t,n){if(!e)throw f("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function ue(e,t,n){return n&&_e(e)&&(e=e[e.length-1]),Ie(Se(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function Ue(e,t){if("hasOwnProperty"===e)throw f("badname","hasOwnProperty is not a valid {0} name",t)}function De(e,t,n){if(!t)return e;for(var i,r=t.split("."),o=e,a=r.length,s=0;s<a;s++)i=r[s],e&&(e=(o=e)[i]);return!n&&Se(e)?Oe(o,e):e}function Be(e){for(var t,n=e[0],i=e[e.length-1],r=1;n!==i&&(n=n.nextSibling);r++)(t||e[r]!==n)&&(t||(t=de(s.call(e,0,r))),t.push(n));return t||e}function ke(){return Object.create(null)}function Ve(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=!T(e)||_e(e)||w(e)?G(e):e.toString()}return e}var ze=1,Ge=3,je=8,We=9,Xe=11;function qe(e,t){if(_e(e)){t=t||[];for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}else if(Te(e))for(var r in t=t||{},e)"$"===r.charAt(0)&&"$"===r.charAt(1)||(t[r]=e[r]);return t||e}function Ye(e,t){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):xe(e)?"undefined":"string"!=typeof e?(n=e,r=[],u(i=t)&&(n=x.copy(n,null,i)),JSON.stringify(n,function(e,t){if(Te(t=k(e,t))){if(0<=r.indexOf(t))return"...";r.push(t)}return t})):e;var n,i,r}var Je={full:"1.6.10",major:1,minor:6,dot:10,codeName:"crystalline-persuasion"};ft.expando="ng339";var Qe=ft.cache={},Ze=1;ft._data=function(e){return this.cache[e[this.expando]]||{}};var Ke=/-([a-z])/g,et=/^-ms-/,tt={mouseleave:"mouseout",mouseenter:"mouseover"},nt=A("jqLite");function it(e,t){return t.toUpperCase()}function rt(e){return e.replace(Ke,it)}var ot=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,at=/<|&#?\w+;/,st=/<([\w:-]+)/,lt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ut={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ct(e){return!at.test(e)}function ht(e){var t=e.nodeType;return t===ze||!t||t===We}function dt(e,t){var n,i,r,o,a=t.createDocumentFragment(),s=[];if(ct(e))s.push(t.createTextNode(e));else{for(n=a.appendChild(t.createElement("div")),i=(st.exec(e)||["",""])[1].toLowerCase(),r=ut[i]||ut._default,n.innerHTML=r[1]+e.replace(lt,"<$1></$2>")+r[2],o=r[0];o--;)n=n.lastChild;s=B(s,n.childNodes),(n=a.firstChild).textContent=""}return a.textContent="",a.innerHTML="",fe(s,function(e){a.appendChild(e)}),a}ut.optgroup=ut.option,ut.tbody=ut.tfoot=ut.colgroup=ut.caption=ut.thead,ut.th=ut.td;var pt=V.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};function ft(e){if(e instanceof ft)return e;var t,n,i,r;if(be(e)&&(e=Re(e),t=!0),!(this instanceof ft)){if(t&&"<"!==e.charAt(0))throw nt("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new ft(e)}t?wt(this,(n=e,i=i||V.document,(r=ot.exec(n))?[i.createElement(r[1])]:(r=dt(n,i))?r.childNodes:[])):Se(e)?Nt(e):wt(this,e)}function mt(e){return e.cloneNode(!0)}function gt(e,t){!t&&ht(e)&&de.cleanData([e]),e.querySelectorAll&&de.cleanData(e.querySelectorAll("*"))}function vt(n,e,i,t){if(Ee(t))throw nt("offargs","jqLite#off() does not support the `selector` argument");var r=xt(n),o=r&&r.events,a=r&&r.handle;if(a)if(e){var s=function(e){var t=o[e];Ee(i)&&Pe(t||[],i),Ee(i)&&t&&0<t.length||(n.removeEventListener(e,a),delete o[e])};fe(e.split(" "),function(e){s(e),tt[e]&&s(tt[e])})}else for(e in o)"$destroy"!==e&&n.removeEventListener(e,a),delete o[e]}function yt(e,t){var n=e.ng339,i=n&&Qe[n];if(i){if(t)return void delete i.data[t];i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),vt(e)),delete Qe[n],e.ng339=void 0}}function xt(e,t){var n=e.ng339,i=n&&Qe[n];return t&&!i&&(e.ng339=n=++Ze,i=Qe[n]={events:{},data:{},handle:void 0}),i}function Et(e,t,n){if(ht(e)){var i,r=Ee(n),o=!r&&t&&!Te(t),a=!t,s=xt(e,!o),l=s&&s.data;if(r)l[rt(t)]=n;else{if(a)return l;if(o)return l&&l[rt(t)];for(i in t)l[rt(i)]=t[i]}}}function Tt(e,t){return!!e.getAttribute&&-1<(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")}function bt(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),i=n;fe(t.split(" "),function(e){e=Re(e),i=i.replace(" "+e+" "," ")}),i!==n&&e.setAttribute("class",Re(i))}}function _t(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),i=n;fe(t.split(" "),function(e){e=Re(e),-1===i.indexOf(" "+e+" ")&&(i+=e+" ")}),i!==n&&e.setAttribute("class",Re(i))}}function wt(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var i=0;i<n;i++)e[e.length++]=t[i]}else e[e.length++]=t}}function St(e,t){return Mt(e,"$"+(t||"ngController")+"Controller")}function Mt(e,t,n){e.nodeType===We&&(e=e.documentElement);for(var i=_e(t)?t:[t];e;){for(var r=0,o=i.length;r<o;r++)if(Ee(n=de.data(e,i[r])))return n;e=e.parentNode||e.nodeType===Xe&&e.host}}function At(e){for(gt(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function Rt(e,t){t||gt(e);var n=e.parentNode;n&&n.removeChild(e)}function Nt(e){function t(){V.document.removeEventListener("DOMContentLoaded",t),V.removeEventListener("load",t),e()}"complete"===V.document.readyState?V.setTimeout(e):(V.document.addEventListener("DOMContentLoaded",t),V.addEventListener("load",t))}var Pt=ft.prototype={ready:Nt,toString:function(){var t=[];return fe(this,function(e){t.push(""+e)}),"["+t.join(", ")+"]"},eq:function(e){return de(0<=e?this[e]:this[this.length+e])},length:0,push:t,sort:[].sort,splice:[].splice},Lt={};fe("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){Lt[ce(e)]=e});var Ct={};fe("input,select,option,textarea,button,form,details".split(","),function(e){Ct[e]=!0});var Ft={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern",ngStep:"step"};function Ot(e,t){var n=Lt[t.toLowerCase()];return n&&Ct[Ne(e)]&&n}function $t(e,t,n){n.call(e,t)}function Ht(e,t,n){var i=t.relatedTarget;i&&(i===e||pt.call(e,i))||n.call(e,t)}function It(){this.$get=function(){return me(ft,{hasClass:function(e,t){return e.attr&&(e=e[0]),Tt(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),_t(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),bt(e,t)}})}}function Ut(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var i=typeof e;return n="function"===i||"object"===i&&null!==e?e.$$hashKey=i+":"+(t||R)():i+":"+e}fe({data:Et,removeData:yt,hasData:function(e){for(var t in Qe[e.ng339])return!0;return!1},cleanData:function(e){for(var t=0,n=e.length;t<n;t++)yt(e[t])}},function(e,t){ft[t]=e}),fe({data:Et,inheritedData:Mt,scope:function(e){return de.data(e,"$scope")||Mt(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return de.data(e,"$isolateScope")||de.data(e,"$isolateScopeNoTemplate")},controller:St,injector:function(e){return Mt(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:Tt,css:function(e,t,n){if(t=rt(t.replace(et,"ms-")),!Ee(n))return e.style[t];e.style[t]=n},attr:function(e,t,n){var i,r=e.nodeType;if(r!==Ge&&2!==r&&r!==je&&e.getAttribute){var o=ce(t),a=Lt[o];if(!Ee(n))return i=e.getAttribute(t),a&&null!==i&&(i=o),null===i?void 0:i;null===n||!1===n&&a?e.removeAttribute(t):e.setAttribute(t,a?o:n)}},prop:function(e,t,n){if(!Ee(n))return e[t];e[t]=n},text:function(){return e.$dv="",e;function e(e,t){if(xe(t)){var n=e.nodeType;return n===ze||n===Ge?e.textContent:""}e.textContent=t}}(),val:function(e,t){if(xe(t)){if(e.multiple&&"select"===Ne(e)){var n=[];return fe(e.options,function(e){e.selected&&n.push(e.value||e.text)}),n}return e.value}e.value=t},html:function(e,t){if(xe(t))return e.innerHTML;gt(e,!0),e.innerHTML=t},empty:At},function(u,e){ft.prototype[e]=function(e,t){var n,i,r=this.length;if(u!==At&&xe(2===u.length&&u!==Tt&&u!==St?e:t)){if(Te(e)){for(n=0;n<r;n++)if(u===Et)u(this[n],e);else for(i in e)u(this[n],i,e[i]);return this}for(var o=u.$dv,a=xe(o)?Math.min(r,1):r,s=0;s<a;s++){var l=u(this[s],e,t);o=o?o+l:l}return o}for(n=0;n<r;n++)u(this[n],e,t);return this}}),fe({removeData:yt,on:function(r,e,o,t){if(Ee(t))throw nt("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(ht(r)){var s,l,n,i=xt(r,!0),a=i.events,u=i.handle;u||(u=i.handle=(l=a,(n=function(e,t){e.isDefaultPrevented=function(){return e.defaultPrevented};var n=l[t||e.type],i=n?n.length:0;if(i){if(xe(e.immediatePropagationStopped)){var r=e.stopImmediatePropagation;e.stopImmediatePropagation=function(){e.immediatePropagationStopped=!0,e.stopPropagation&&e.stopPropagation(),r&&r.call(e)}}e.isImmediatePropagationStopped=function(){return!0===e.immediatePropagationStopped};var o=n.specialHandlerWrapper||$t;1<i&&(n=qe(n));for(var a=0;a<i;a++)e.isImmediatePropagationStopped()||o(s,e,n[a])}}).elem=s=r,n));for(var c=0<=e.indexOf(" ")?e.split(" "):[e],h=c.length,d=function(e,t,n){var i=a[e];i||((i=a[e]=[]).specialHandlerWrapper=t,"$destroy"===e||n||r.addEventListener(e,u)),i.push(o)};h--;)e=c[h],tt[e]?(d(tt[e],Ht),d(e,void 0,!0)):d(e)}},off:vt,one:function(t,n,i){(t=de(t)).on(n,function e(){t.off(n,i),t.off(n,e)}),t.on(n,i)},replaceWith:function(t,e){var n,i=t.parentNode;gt(t),fe(new ft(e),function(e){n?i.insertBefore(e,n.nextSibling):i.replaceChild(e,t),n=e})},children:function(e){var t=[];return fe(e.childNodes,function(e){e.nodeType===ze&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===ze||n===Xe)for(var i=0,r=(t=new ft(t)).length;i<r;i++){var o=t[i];e.appendChild(o)}},prepend:function(t,e){if(t.nodeType===ze){var n=t.firstChild;fe(new ft(e),function(e){t.insertBefore(e,n)})}},wrap:function(e,t){var n,i,r;n=e,i=de(t).eq(0).clone()[0],(r=n.parentNode)&&r.replaceChild(i,n),i.appendChild(n)},remove:Rt,detach:function(e){Rt(e,!0)},after:function(e,t){var n=e,i=e.parentNode;if(i)for(var r=0,o=(t=new ft(t)).length;r<o;r++){var a=t[r];i.insertBefore(a,n.nextSibling),n=a}},addClass:_t,removeClass:bt,toggleClass:function(n,e,i){e&&fe(e.split(" "),function(e){var t=i;xe(t)&&(t=!Tt(n,e)),(t?_t:bt)(n,e)})},parent:function(e){var t=e.parentNode;return t&&t.nodeType!==Xe?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:mt,triggerHandler:function(t,e,n){var i,r,o,a=e.type||e,s=xt(t),l=s&&s.events,u=l&&l[a];u&&(i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:ve,type:a,target:t},e.type&&(i=me(i,e)),r=qe(u),o=n?[i].concat(n):[i],fe(r,function(e){i.isImmediatePropagationStopped()||e.apply(t,o)}))}},function(a,e){ft.prototype[e]=function(e,t,n){for(var i,r=0,o=this.length;r<o;r++)xe(i)?Ee(i=a(this[r],e,t,n))&&(i=de(i)):wt(i,a(this[r],e,t,n));return Ee(i)?i:this}}),ft.prototype.bind=ft.prototype.on,ft.prototype.unbind=ft.prototype.off;var Dt=Object.create(null);function Bt(){this._keys=[],this._values=[],this._lastKey=NaN,this._lastIndex=-1}Bt.prototype={_idx:function(e){return e===this._lastKey||(this._lastKey=e,this._lastIndex=this._keys.indexOf(e)),this._lastIndex},_transformKey:function(e){return N(e)?Dt:e},get:function(e){e=this._transformKey(e);var t=this._idx(e);if(-1!==t)return this._values[t]},set:function(e,t){e=this._transformKey(e);var n=this._idx(e);-1===n&&(n=this._lastIndex=this._keys.length),this._keys[n]=e,this._values[n]=t},delete:function(e){e=this._transformKey(e);var t=this._idx(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),this._lastKey=NaN,this._lastIndex=-1,!0)}};var kt=Bt,Vt=[function(){this.$get=[function(){return kt}]}],zt=/^([^(]+?)=>/,Gt=/^[^(]*\(\s*([^)]*)\)/m,jt=/,/,Wt=/^\s*(_?)(\S+?)\1\s*$/,Xt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,qt=A("$injector");function Yt(e){return Function.prototype.toString.call(e)}function Jt(e){var t=Yt(e).replace(Xt,"");return t.match(zt)||t.match(Gt)}function Qt(e,u){u=!0===u;var r={},a="Provider",s=[],o=new kt,c={$provide:{provider:d(p),factory:d(f),service:d(function(e,t){return f(e,["$injector",function(e){return e.instantiate(t)}])}),value:d(function(e,t){return f(e,M(t),!1)}),constant:d(function(e,t){Ue(e,"constant"),c[e]=t,n[e]=t}),decorator:function(e,t){var n=l.get(e+a),i=n.$get;n.$get=function(){var e=h.invoke(i,n);return h.invoke(t,null,{$delegate:e})}}}},l=c.$injector=g(c,function(e,t){throw x.isString(t)&&s.push(t),qt("unpr","Unknown provider: {0}",s.join(" <- "))}),n={},t=g(n,function(e,t){var n=l.get(e+a,t);return h.invoke(n.$get,n,void 0,e)}),h=t;c["$injector"+a]={$get:M(t)},h.modules=l.modules=ke();var i=m(e);return(h=t.get("$injector")).strictDi=u,fe(i,function(e){e&&h.invoke(e)}),h.loadNewModules=function(e){fe(m(e),function(e){e&&h.invoke(e)})},h;function d(n){return function(e,t){if(!Te(e))return n(e,t);fe(e,y(n))}}function p(e,t){if(Ue(e,"service"),(Se(t)||_e(t))&&(t=l.instantiate(t)),!t.$get)throw qt("pget","Provider '{0}' must define $get factory method.",e);return c[e+a]=t}function f(e,t,n){return p(e,{$get:!1!==n?(i=e,r=t,function(){var e=h.invoke(r,this);if(xe(e))throw qt("undef","Provider '{0}' must return a value from $get factory method.",i);return e}):t});var i,r}function m(e){Ie(xe(e)||_e(e),"modulesToLoad","not an array");var n,i=[];return fe(e,function(t){if(!o.get(t)){o.set(t,!0);try{be(t)?(n=v(t),h.modules[t]=n,i=i.concat(m(n.requires)).concat(n._runBlocks),e(n._invokeQueue),e(n._configBlocks)):Se(t)?i.push(l.invoke(t)):_e(t)?i.push(l.invoke(t)):ue(t,"module")}catch(e){throw _e(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),qt("modulerr","Failed to instantiate module {0} due to:\n{1}",t,e.stack||e.message||e)}}function e(e){var t,n;for(t=0,n=e.length;t<n;t++){var i=e[t],r=l.get(i[0]);r[i[1]].apply(r,i[2])}}}),i}function g(n,i){function l(t,e){if(n.hasOwnProperty(t)){if(n[t]===r)throw qt("cdep","Circular dependency found: {0}",t+" <- "+s.join(" <- "));return n[t]}try{return s.unshift(t),n[t]=r,n[t]=i(t,e),n[t]}catch(e){throw n[t]===r&&delete n[t],e}finally{s.shift()}}function o(e,t,n){for(var i=[],r=Qt.$$annotate(e,u,n),o=0,a=r.length;o<a;o++){var s=r[o];if("string"!=typeof s)throw qt("itkn","Incorrect injection token! Expected service name as string, got {0}",s);i.push(t&&t.hasOwnProperty(s)?t[s]:l(s,n))}return i}return{invoke:function(e,t,n,i){"string"==typeof n&&(i=n,n=null);var r=o(e,n,i);return _e(e)&&(e=e[e.length-1]),function(e){if(he||"function"!=typeof e)return!1;var t=e.$$ngIsClass;return Ae(t)||(t=e.$$ngIsClass=/^(?:class\b|constructor\()/.test(Yt(e))),t}(e)?(r.unshift(null),new(Function.prototype.bind.apply(e,r))):e.apply(t,r)},instantiate:function(e,t,n){var i=_e(e)?e[e.length-1]:e,r=o(e,t,n);return r.unshift(null),new(Function.prototype.bind.apply(i,r))},get:l,annotate:Qt.$$annotate,has:function(e){return c.hasOwnProperty(e+a)||n.hasOwnProperty(e)}}}}function Zt(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(i,r,o){var a=i.document;function s(e){if(e){e.scrollIntoView();var t=function(){var e=l.yOffset;if(Se(e))e=e();else if($(e)){var t=e[0];e="fixed"!==i.getComputedStyle(t).position?0:t.getBoundingClientRect().bottom}else _(e)||(e=0);return e}();if(t){var n=e.getBoundingClientRect().top;i.scrollBy(0,n-t)}}else i.scrollTo(0,0)}function l(e){var t,n,i;(e=be(e)?e:_(e)?e.toString():r.hash())?(t=a.getElementById(e))?s(t):(n=a.getElementsByName(e),i=null,Array.prototype.some.call(n,function(e){if("a"===Ne(e))return i=e,!0}),(t=i)?s(t):"top"===e&&s(null)):s(null)}return e&&o.$watch(function(){return r.hash()},function(e,t){var n,i;e===t&&""===e||(n=function(){o.$evalAsync(l)},"complete"===(i=i||V).document.readyState?i.setTimeout(n):de(i).on("load",n))}),l}]}Qt.$$annotate=function(e,t,n){var i,r,o;if("function"==typeof e){if(!(i=e.$inject)){if(i=[],e.length){if(t)throw be(n)&&n||(n=e.name||((o=Jt(e))?"function("+(o[1]||"").replace(/[\s\r\n]+/," ")+")":"fn")),qt("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);fe(Jt(e)[1].split(jt),function(e){e.replace(Wt,function(e,t,n){i.push(n)})})}e.$inject=i}}else _e(e)?(ue(e[r=e.length-1],"fn"),i=e.slice(0,r)):ue(e,"fn",!0);return i};var Kt=A("$animate"),en=1,tn="ng-animate";function nn(e,t){return e||t?e?t?(_e(e)&&(e=e.join(" ")),_e(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function rn(e){return Te(e)?e:{}}var on=function(){this.$get=ve},an=function(){var m=new kt,g=[];this.$get=["$$AnimateRunner","$rootScope",function(h,d){return{enabled:ve,on:ve,off:ve,pin:ve,push:function(e,t,n,i){var r,o,a,s,l,u;i&&i(),(n=n||{}).from&&e.css(n.from),n.to&&e.css(n.to),(n.addClass||n.removeClass)&&(r=e,o=n.addClass,a=n.removeClass,s=m.get(r)||{},l=p(s,o,!0),u=p(s,a,!1),(l||u)&&(m.set(r,s),g.push(r),1===g.length&&d.$$postDigest(f)));var c=new h;return c.complete(),c}};function p(t,e,n){var i=!1;return e&&fe(e=be(e)?e.split(" "):_e(e)?e:[],function(e){e&&(i=!0,t[e]=n)}),i}function f(){fe(g,function(e){var t=m.get(e);if(t){var n=function(e){be(e)&&(e=e.split(" "));var t=ke();return fe(e,function(e){e.length&&(t[e]=!0)}),t}(e.attr("class")),i="",r="";fe(t,function(e,t){e!==!!n[t]&&(e?i+=(i.length?" ":"")+t:r+=(r.length?" ":"")+t)}),fe(e,function(e){i&&_t(e,i),r&&bt(e,r)}),m.delete(e)}}),g.length=0}}]},sn=["$provide",function(i){var r=this,t=null,n=null;this.$$registeredAnimations=Object.create(null),this.register=function(e,t){if(e&&"."!==e.charAt(0))throw Kt("notcsel","Expecting class selector starting with '.' got '{0}'.",e);var n=e+"-animation";r.$$registeredAnimations[e.substr(1)]=n,i.factory(n,t)},this.customFilter=function(e){return 1===arguments.length&&(n=Se(e)?e:null),n},this.classNameFilter=function(e){if(1===arguments.length&&((t=e instanceof RegExp?e:null)&&new RegExp("[(\\s|\\/)]"+tn+"[(\\s|\\/)]").test(t.toString())))throw t=null,Kt("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',tn);return t},this.$get=["$$animateQueue",function(o){function r(e,t,n){if(n){var i=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===en)return n}}(n);!i||i.parentNode||i.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:o.on,off:o.off,pin:o.pin,enabled:o.enabled,cancel:function(e){e.end&&e.end()},enter:function(e,t,n,i){return t=t&&de(t),n=n&&de(n),r(e,t=t||n.parent(),n),o.push(e,"enter",rn(i))},move:function(e,t,n,i){return t=t&&de(t),n=n&&de(n),r(e,t=t||n.parent(),n),o.push(e,"move",rn(i))},leave:function(e,t){return o.push(e,"leave",rn(t),function(){e.remove()})},addClass:function(e,t,n){return(n=rn(n)).addClass=nn(n.addclass,t),o.push(e,"addClass",n)},removeClass:function(e,t,n){return(n=rn(n)).removeClass=nn(n.removeClass,t),o.push(e,"removeClass",n)},setClass:function(e,t,n,i){return(i=rn(i)).addClass=nn(i.addClass,t),i.removeClass=nn(i.removeClass,n),o.push(e,"setClass",i)},animate:function(e,t,n,i,r){return(r=rn(r)).from=r.from?me(r.from,t):t,r.to=r.to?me(r.to,n):n,i=i||"ng-inline-animate",r.tempClasses=nn(r.tempClasses,i),o.push(e,"animate",r)}}}]}],ln=function(){this.$get=["$$rAF",function(t){var n=[];function i(e){n.push(e),1<n.length||t(function(){for(var e=0;e<n.length;e++)n[e]();n=[]})}return function(){var t=!1;return i(function(){t=!0}),function(e){t?e():i(e)}}}]},un=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(t,e,n,i,r){function o(e){this.setHost(e);var t=n();this._doneCallbacks=[],this._tick=function(e){i()?r(e,0,!1):t(e)},this._state=0}return o.chain=function(e,n){var i=0;!function t(){if(i===e.length)return void n(!0);e[i](function(e){!1!==e?(i++,t()):n(!1)})}()},o.all=function(t,n){var i=0,r=!0;function o(e){r=r&&e,++i===t.length&&n(r)}fe(t,function(e){e.done(o)})},o.prototype={setHost:function(e){this.host=e||{}},done:function(e){2===this._state?e():this._doneCallbacks.push(e)},progress:ve,getPromise:function(){if(!this.promise){var e=this;this.promise=t(function(t,n){e.done(function(e){!1===e?n():t()})})}return this.promise},then:function(e,t){return this.getPromise().then(e,t)},catch:function(e){return this.getPromise().catch(e)},finally:function(e){return this.getPromise().finally(e)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(e){var t=this;0===t._state&&(t._state=1,t._tick(function(){t._resolve(e)}))},_resolve:function(t){2!==this._state&&(fe(this._doneCallbacks,function(e){e(t)}),this._doneCallbacks.length=0,this._state=2)}},o}]},cn=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(a,e,s){return function(e,t){var n=t||{};n.$$prepared||(n=I(n)),n.cleanupStyles&&(n.from=n.to=null),n.from&&(e.css(n.from),n.from=null);var i,r=new s;return{start:o,end:o};function o(){return a(function(){!function(){n.addClass&&(e.addClass(n.addClass),n.addClass=null);n.removeClass&&(e.removeClass(n.removeClass),n.removeClass=null);n.to&&(e.css(n.to),n.to=null)}(),i||r.complete(),i=!0}),r}}}]};function hn(s,e,t,l){var u=this,c=s.location,h=s.history,i=s.setTimeout,n=s.clearTimeout,r={};u.isMock=!1;var o=0,a=[];function d(e){try{e.apply(null,Fe(arguments,1))}finally{if(0===--o)for(;a.length;)try{a.pop()()}catch(e){t.error(e)}}}u.$$completeOutstandingRequest=d,u.$$incOutstandingRequestCount=function(){o++},u.notifyWhenNoOutstandingRequests=function(e){0===o?e():a.push(e)};var p,f,m=c.href,g=e.find("base"),v=null,y=l.history?function(){try{return h.state}catch(e){}}:ve;_(),u.url=function(e,t,n){if(xe(n)&&(n=null),c!==s.location&&(c=s.location),h!==s.history&&(h=s.history),e){var i=f===n;if(m===e&&(!l.history||i))return u;var r=m&&si(m)===si(e);return m=e,f=n,!l.history||r&&i?(r||(v=e),t?c.replace(e):r?c.hash=-1===(a=(o=e).indexOf("#"))?"":o.substr(a):c.href=e,c.href!==e&&(v=e)):(h[t?"replaceState":"pushState"](n,"",e),_()),v&&(v=e),u}return v||c.href.replace(/%27/g,"'");var o,a},u.state=function(){return p};var x=[],E=!1;function T(){v=null,w()}var b=null;function _(){Ce(p=xe(p=y())?null:p,b)&&(p=b),f=b=p}function w(){var e=f;_(),m===u.url()&&e===p||(m=u.url(),f=p,fe(x,function(e){e(u.url(),p)}))}u.onUrlChange=function(e){return E||(l.history&&de(s).on("popstate",T),de(s).on("hashchange",T),E=!0),x.push(e),e},u.$$applicationDestroyed=function(){de(s).off("hashchange popstate",T)},u.$$checkUrlChange=w,u.baseHref=function(){var e=g.attr("href");return e?e.replace(/^(https?:)?\/\/[^/]*/,""):""},u.defer=function(e,t){var n;return o++,n=i(function(){delete r[n],d(e)},t||0),r[n]=!0,n},u.defer.cancel=function(e){return!!r[e]&&(delete r[e],n(e),d(ve),!0)}}function dn(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,i){return new hn(e,i,t,n)}]}function pn(){this.$get=function(){var h={};function e(e,t){if(e in h)throw A("$cacheFactory")("iid","CacheId '{0}' is already taken!",e);var n=0,i=me({},t,{id:e}),r=ke(),o=t&&t.capacity||Number.MAX_VALUE,a=ke(),s=null,l=null;return h[e]={put:function(e,t){if(!xe(t)){if(o<Number.MAX_VALUE)u(a[e]||(a[e]={key:e}));return e in r||n++,r[e]=t,o<n&&this.remove(l.key),t}},get:function(e){if(o<Number.MAX_VALUE){var t=a[e];if(!t)return;u(t)}return r[e]},remove:function(e){if(o<Number.MAX_VALUE){var t=a[e];if(!t)return;t===s&&(s=t.p),t===l&&(l=t.n),c(t.n,t.p),delete a[e]}e in r&&(delete r[e],n--)},removeAll:function(){r=ke(),n=0,a=ke(),s=l=null},destroy:function(){a=i=r=null,delete h[e]},info:function(){return me({},i,{size:n})}};function u(e){e!==s&&(l?l===e&&(l=e.n):l=e,c(e.n,e.p),c(e,s),(s=e).n=null)}function c(e,t){e!==t&&(e&&(e.p=t),t&&(t.n=e))}}return e.info=function(){var n={};return fe(h,function(e,t){n[t]=e.info()}),n},e.get=function(e){return h[e]},e}}function fn(){this.$get=["$cacheFactory",function(e){return e("templates")}]}var mn=A("$compile");var gn=new function(){};function vn(n,t){var f={},m="Directive",U=/^\s*directive:\s*([\w-]+)\s+(.*)$/,D=/(([\w-]+)(?::([^;]+))?;?)/,c=function(e){var t,n={},i=e.split(",");for(t=0;t<i.length;t++)n[i[t]]=!0;return n}("ngSrc,ngSrcset,src,srcset"),d=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,h=/^(on[a-z]+|formaction)$/,s=ke();function i(e,i,r){var o=/^([@&<]|=(\*?))(\??)\s*([\w$]*)$/,a=ke();return fe(e,function(e,t){if((e=e.trim())in s)a[t]=s[e];else{var n=e.match(o);if(!n)throw mn("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",i,t,e,r?"controller bindings definition":"isolate scope definition");a[t]={mode:n[1][0],collection:"*"===n[2],optional:"?"===n[3],attrName:n[4]||t},n[4]&&(s[e]=a[t])}}),a}function g(e,t){var n={isolateScope:null,bindToController:null};if(Te(e.scope)&&(!0===e.bindToController?(n.bindToController=i(e.scope,t,!0),n.isolateScope={}):n.isolateScope=i(e.scope,t,!1)),Te(e.bindToController)&&(n.bindToController=i(e.bindToController,t,!0)),n.bindToController&&!e.controller)throw mn("noctrl","Cannot bind to controller without directive '{0}'s controller.",t);return n}this.directive=function e(l,t){return Ie(l,"name"),Ue(l,"directive"),be(l)?(!function(e){var t=e.charAt(0);if(!t||t!==ce(t))throw mn("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",e);if(e!==e.trim())throw mn("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",e)}(l),Ie(t,"directiveFactory"),f.hasOwnProperty(l)||(f[l]=[],n.factory(l+m,["$injector","$exceptionHandler",function(o,a){var s=[];return fe(f[l],function(e,t){try{var n=o.invoke(e);Se(n)?n={compile:M(n)}:!n.compile&&n.link&&(n.compile=M(n.link)),n.priority=n.priority||0,n.index=t,n.name=n.name||l,n.require=(r=(i=n).require||i.controller&&i.name,!_e(r)&&Te(r)&&fe(r,function(e,t){var n=e.match(d);e.substring(n[0].length)||(r[t]=n[0]+t)}),r),n.restrict=function(e,t){if(e&&(!be(e)||!/[EACM]/.test(e)))throw mn("badrestrict","Restrict property '{0}' of directive '{1}' is invalid",e,t);return e||"EA"}(n.restrict,l),n.$$moduleName=e.$$moduleName,s.push(n)}catch(e){a(e)}var i,r}),s}])),f[l].push(t)):fe(l,y(e)),this},this.component=function e(t,r){if(!be(t))return fe(t,y(Oe(this,e))),this;var o=r.controller||function(){};function n(i){function e(n){return Se(n)||_e(n)?function(e,t){return i.invoke(n,this,{$element:e,$attrs:t})}:n}var t=r.template||r.templateUrl?r.template:"",n={controller:o,controllerAs:function(e,t){if(t&&be(t))return t;if(be(e)){var n=Sn.exec(e);if(n)return n[3]}}(r.controller)||r.controllerAs||"$ctrl",template:e(t),templateUrl:e(r.templateUrl),transclude:r.transclude,scope:{},bindToController:r.bindings||{},restrict:"E",require:r.require};return fe(r,function(e,t){"$"===t.charAt(0)&&(n[t]=e)}),n}return fe(r,function(e,t){"$"===t.charAt(0)&&(n[t]=e,Se(o)&&(o[t]=e))}),n.$inject=["$injector"],this.directive(t,n)},this.aHrefSanitizationWhitelist=function(e){return Ee(e)?(t.aHrefSanitizationWhitelist(e),this):t.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return Ee(e)?(t.imgSrcSanitizationWhitelist(e),this):t.imgSrcSanitizationWhitelist()};var u=!0,ue=!(this.debugInfoEnabled=function(e){return Ee(e)?(u=e,this):u}),_=!(this.preAssignBindingsEnabled=function(e){return Ee(e)?(ue=e,this):ue});this.strictComponentBindingsEnabled=function(e){return Ee(e)?(_=e,this):_};var w=10;this.onChangesTtl=function(e){return arguments.length?(w=e,this):w};var B=!0;this.commentDirectivesEnabled=function(e){return arguments.length?(B=e,this):B};var k=!0;this.cssClassDirectivesEnabled=function(e){return arguments.length?(k=e,this):k},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(p,S,G,e,x,j,o,r,a,v){var s,y=/^\w/,E=V.document.createElement("div"),M=B,A=k,t=w;function l(){try{if(!--t)throw s=void 0,mn("infchng","{0} $onChanges() iterations reached. Aborting!\n",w);o.$apply(function(){for(var e=0,t=s.length;e<t;++e)try{s[e]()}catch(e){G(e)}s=void 0})}finally{t++}}function W(e,t){if(t){var n,i,r,o=Object.keys(t);for(n=0,i=o.length;n<i;n++)this[r=o[n]]=t[r]}else this.$attr={};this.$$element=e}function R(e,t){try{e.addClass(t)}catch(e){}}W.prototype={$normalize:Tn,$addClass:function(e){e&&0<e.length&&a.addClass(this.$$element,e)},$removeClass:function(e){e&&0<e.length&&a.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=bn(e,t);n&&n.length&&a.addClass(this.$$element,n);var i=bn(t,e);i&&i.length&&a.removeClass(this.$$element,i)},$set:function(e,t,n,i){var r,o=Ot(this.$$element[0],e),a=Ft[e],s=e;if(o?(this.$$element.prop(e,t),i=o):a&&(this[a]=t,s=a),this[e]=t,i?this.$attr[e]=i:(i=this.$attr[e])||(this.$attr[e]=i=He(e,"-")),"a"===(r=Ne(this.$$element))&&("href"===e||"xlinkHref"===e)||"img"===r&&"src"===e)this[e]=t=null==t?t:v(t,"src"===e);else if("img"===r&&"srcset"===e&&Ee(t)){for(var l="",u=Re(t),c=/\s/.test(u)?/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/:/(,)/,h=u.split(c),d=Math.floor(h.length/2),p=0;p<d;p++){var f=2*p;l+=v(Re(h[f]),!0),l+=" "+Re(h[f+1])}var m=Re(h[2*p]).split(/\s/);l+=v(Re(m[0]),!0),2===m.length&&(l+=" "+Re(m[1])),this[e]=t=l}!1!==n&&(null==t?this.$$element.removeAttr(i):y.test(i)?this.$$element.attr(i,t):function(e,t,n){E.innerHTML="<span "+t+">";var i=E.firstChild.attributes,r=i[0];i.removeNamedItem(r.name),r.value=n,e.attributes.setNamedItem(r)}(this.$$element[0],i,t));var g=this.$$observers;g&&fe(g[s],function(e){try{e(t)}catch(e){G(e)}})},$observe:function(e,t){var n=this,i=n.$$observers||(n.$$observers=ke()),r=i[e]||(i[e]=[]);return r.push(t),o.$evalAsync(function(){r.$$inter||!n.hasOwnProperty(e)||xe(n[e])||t(n[e])}),function(){Pe(r,t)}}};var n=S.startSymbol(),i=S.endSymbol(),X="{{"===n&&"}}"===i?ye:function(e){return e.replace(/\{\{/g,n).replace(/}}/g,i)},N=/^ngAttr[A-Z]/,P=/^(.+)Start$/;return q.$$addBindingInfo=u?function(e,t){var n=e.data("$binding")||[];_e(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:ve,q.$$addBindingClass=u?function(e){R(e,"ng-binding")}:ve,q.$$addScopeInfo=u?function(e,t,n,i){var r=n?i?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(r,t)}:ve,q.$$addScopeClass=u?function(e,t){R(e,t?"ng-isolate-scope":"ng-scope")}:ve,q.$$createComment=function(e,t){var n="";return u&&(n=" "+(e||"")+": ",t&&(n+=t+" ")),V.document.createComment(n)},q;function q(c,e,t,n,h){c instanceof de||(c=de(c));var d=L(c,e,c,t,n,h);q.$$addScopeClass(c);var p=null;return function(e,t,n){if(!c)throw mn("multilink","This element has already been linked.");Ie(e,"scope"),h&&h.needsNewScope&&(e=e.$parent.$new());var i,r,o,a=(n=n||{}).parentBoundTranscludeFn,s=n.transcludeControllers,l=n.futureParentElement;if(a&&a.$$boundTransclude&&(a=a.$$boundTransclude),p||(r=(i=l)&&i[0],p=r&&"foreignobject"!==Ne(r)&&pe.call(r).match(/SVG/)?"svg":"html"),o="html"!==p?de(re(p,de("<div></div>").append(c).html())):t?Pt.clone.call(c):c,s)for(var u in s)o.data("$"+u+"Controller",s[u].instance);return q.$$addScopeInfo(o,e),t&&t(o,e),d&&d(e,o,o,a),t||(c=d=null),o}}function L(e,f,t,n,i,r){for(var o,a,s,l,u,c,m,g=[],h=_e(e)||e instanceof de,d=0;d<e.length;d++)o=new W,11===he&&T(e,d,h),(s=(a=Y(e[d],[],o,0===d?n:void 0,i)).length?F(a,e[d],o,f,t,null,[],[],r):null)&&s.scope&&q.$$addScopeClass(o.$$element),u=s&&s.terminal||!(l=e[d].childNodes)||!l.length?null:L(l,s?(s.transcludeOnThisElement||!s.templateOnThisElement)&&s.transclude:f),(s||u)&&(g.push(d,s,u),c=!0,m=m||s),r=null;return c?function(e,t,n,i){var r,o,a,s,l,u,c,h,d;if(m){var p=t.length;for(d=new Array(p),l=0;l<g.length;l+=3)c=g[l],d[c]=t[c]}else d=t;for(l=0,u=g.length;l<u;)a=d[g[l++]],r=g[l++],o=g[l++],r?(r.scope?(s=e.$new(),q.$$addScopeInfo(de(a),s)):s=e,h=r.transcludeOnThisElement?C(e,r.transclude,i):!r.templateOnThisElement&&i?i:!i&&f?C(e,f):null,r(o,s,a,n,h)):o&&o(e,a.childNodes,void 0,i)}:null}function T(e,t,n){var i,r=e[t],o=r.parentNode;if(r.nodeType===Ge)for(;(i=o?r.nextSibling:e[t+1])&&i.nodeType===Ge;)r.nodeValue=r.nodeValue+i.nodeValue,i.parentNode&&i.parentNode.removeChild(i),n&&i===e[t+1]&&e.splice(t+1,1)}function C(o,a,s){function e(e,t,n,i,r){return e||((e=o.$new(!1,r)).$$transcluded=!0),a(e,t,{parentBoundTranscludeFn:s,transcludeControllers:n,futureParentElement:i})}var t=e.$$slots=ke();for(var n in a.$$slots)a.$$slots[n]?t[n]=C(o,a.$$slots[n],s):t[n]=null;return e}function Y(e,t,n,i,r){var o,a,s,l,u,c,h=e.nodeType,d=n.$attr;switch(h){case ze:O(t,Tn(a=Ne(e)),"E",i,r);for(var p,f,m,g,v,y,x=e.attributes,E=0,T=x&&x.length;E<T;E++){var b=!1,_=!1;f=(p=x[E]).name,v=p.value,g=Tn(f),(y=N.test(g))&&(f=f.replace(xn,"").substr(8).replace(/_(.)/g,function(e,t){return t.toUpperCase()}));var w=g.match(P);w&&$(w[1])&&(_=(b=f).substr(0,f.length-5)+"end",f=f.substr(0,f.length-6)),d[m=Tn(f.toLowerCase())]=f,!y&&n.hasOwnProperty(m)||(n[m]=v,Ot(e,m)&&(n[m]=!0)),I(e,t,v,m,y),O(t,m,"A",i,r,b,_)}if("input"===a&&"hidden"===e.getAttribute("type")&&e.setAttribute("autocomplete","off"),!A)break;if(Te(s=e.className)&&(s=s.animVal),be(s)&&""!==s)for(;o=D.exec(s);)O(t,m=Tn(o[2]),"C",i,r)&&(n[m]=Re(o[3])),s=s.substr(o.index+o[0].length);break;case Ge:l=t,u=e.nodeValue,(c=S(u,!0))&&l.push({priority:0,compile:function(e){var t=e.parent(),i=!!t.length;return i&&q.$$addBindingClass(t),function(e,t){var n=t.parent();i||q.$$addBindingClass(n),q.$$addBindingInfo(n,c.expressions),e.$watch(c,function(e){t[0].nodeValue=e})}}});break;case je:if(!M)break;!function(e,t,n,i,r){try{var o=U.exec(e.nodeValue);if(o){var a=Tn(o[1]);O(t,a,"M",i,r)&&(n[a]=Re(o[2]))}}catch(e){}}(e,t,n,i,r)}return t.sort(H),t}function J(e,t,n){var i=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw mn("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType===ze&&(e.hasAttribute(t)&&r++,e.hasAttribute(n)&&r--),i.push(e),e=e.nextSibling}while(0<r);else i.push(e);return de(i)}function Q(o,a,s){return function(e,t,n,i,r){return t=J(t[0],a,s),o(e,t,n,i,r)}}function Z(e,t,n,i,r,o){var a;return e?q(t,n,i,r,o):function(){return a||(a=q(t,n,i,r,o),t=n=o=null),a.apply(this,arguments)}}function F(e,T,b,t,n,i,_,w,r){r=r||{};for(var o,a,s,l,u,c=-Number.MAX_VALUE,S=r.newScopeDirective,M=r.controllerDirectives,A=r.newIsolateScopeDirective,R=r.templateDirective,h=r.nonTlbTranscludeDirective,d=!1,p=!1,N=r.hasElementTranscludeDirective,f=b.$$element=de(T),m=i,g=t,v=!1,y=!1,x=0,E=e.length;x<E;x++){var P=(o=e[x]).$$start,L=o.$$end;if(P&&(f=J(T,P,L)),s=void 0,c>o.priority)break;if((u=o.scope)&&(o.templateUrl||(Te(u)?(ie("new/isolated scope",A||S,o,f),A=o):ie("new/isolated scope",A,o,f)),S=S||o),a=o.name,!v&&(o.replace&&(o.templateUrl||o.template)||o.transclude&&!o.$$tlb)){for(var C,F=x+1;C=e[F++];)if(C.transclude&&!C.$$tlb||C.replace&&(C.templateUrl||C.template)){y=!0;break}v=!0}if(!o.templateUrl&&o.controller&&(M=M||ke(),ie("'"+a+"' controller",M[a],o,f),M[a]=o),u=o.transclude)if(d=!0,o.$$tlb||(ie("transclusion",h,o,f),h=o),"element"===u)N=!0,c=o.priority,s=f,f=b.$$element=de(q.$$createComment(a,b[a])),T=f[0],oe(n,Fe(s),T),s[0].$$parentNode=s[0].parentNode,g=Z(y,s,t,c,m&&m.name,{nonTlbTranscludeDirective:h});else{var O=ke();if(Te(u)){s=[];var $=ke(),H=ke();for(var I in fe(u,function(e,t){var n="?"===e.charAt(0);e=n?e.substring(1):e,$[e]=t,O[t]=null,H[t]=n}),fe(f.contents(),function(e){var t=$[Tn(Ne(e))];t?(H[t]=!0,O[t]=O[t]||[],O[t].push(e)):s.push(e)}),fe(H,function(e,t){if(!e)throw mn("reqslot","Required transclusion slot `{0}` was not filled.",t)}),O)O[I]&&(O[I]=Z(y,O[I],t))}else s=de(mt(T)).contents();f.empty(),(g=Z(y,s,t,void 0,void 0,{needsNewScope:o.$$isolateScope||o.$$newScope})).$$slots=O}if(o.template)if(p=!0,ie("template",R,o,f),u=Se((R=o).template)?o.template(f,b):o.template,u=X(u),o.replace){if(m=o,s=ct(u)?[]:_n(re(o.templateNamespace,Re(u))),T=s[0],1!==s.length||T.nodeType!==ze)throw mn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",a,"");oe(n,f,T);var U={$attr:{}},D=Y(T,[],U),B=e.splice(x+1,e.length-(x+1));(A||S)&&ee(D,A,S),e=e.concat(D).concat(B),te(b,U),E=e.length}else f.html(u);if(o.templateUrl)p=!0,ie("template",R,o,f),(R=o).replace&&(m=o),z=ne(e.splice(x,e.length-x),f,b,n,d&&g,_,w,{controllerDirectives:M,newScopeDirective:S!==o&&S,newIsolateScopeDirective:A,templateDirective:R,nonTlbTranscludeDirective:h}),E=e.length;else if(o.compile)try{l=o.compile(f,b,g);var k=o.$$originalDirective||o;Se(l)?V(null,Oe(k,l),P,L):l&&V(Oe(k,l.pre),Oe(k,l.post),P,L)}catch(e){G(e,$e(f))}o.terminal&&(z.terminal=!0,c=Math.max(c,o.priority))}return z.scope=S&&!0===S.scope,z.transcludeOnThisElement=d,z.templateOnThisElement=p,z.transclude=g,r.hasElementTranscludeDirective=N,z;function V(e,t,n,i){e&&(n&&(e=Q(e,n,i)),e.require=o.require,e.directiveName=a,(A===o||o.$$isolateScope)&&(e=ae(e,{isolateScope:!0})),_.push(e)),t&&(n&&(t=Q(t,n,i)),t.require=o.require,t.directiveName=a,(A===o||o.$$isolateScope)&&(t=ae(t,{isolateScope:!0})),w.push(t))}function z(e,t,n,i,a){var r,o,s,l,u,c,h,d,p,f;for(var m in T===n?d=(p=b).$$element:p=new W(d=de(n),b),u=t,A?l=t.$new(!0):S&&(u=t.$parent),a&&((h=function(e,t,n,i){var r;Me(e)||(i=n,n=t,t=e,e=void 0);N&&(r=c);n||(n=N?d.parent():d);{if(!i)return a(e,t,r,n,E);var o=a.$$slots[i];if(o)return o(e,t,r,n,E);if(xe(o))throw mn("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',i,$e(d))}}).$$boundTransclude=a,h.isSlotFilled=function(e){return!!a.$$slots[e]}),M&&(c=function(e,t,n,i,r,o,a){var s=ke();for(var l in i){var u=i[l],c={$scope:u===a||u.$$isolateScope?r:o,$element:e,$attrs:t,$transclude:n},h=u.controller;"@"===h&&(h=t[u.name]);var d=j(h,c,!0,u.controllerAs);s[u.name]=d,e.data("$"+u.name+"Controller",d.instance)}return s}(d,p,h,M,l,t,A)),A&&(q.$$addScopeInfo(d,l,!0,!(R&&(R===A||R===A.$$originalDirective))),q.$$addScopeClass(d,!0),l.$$isolateBindings=A.$$isolateBindings,(f=le(t,p,l,l.$$isolateBindings,A)).removeWatches&&l.$on("$destroy",f.removeWatches)),c){var g=M[m],v=c[m],y=g.$$bindings.bindToController;if(ue){v.bindingInfo=y?le(u,p,v.instance,y,g):{};var x=v();x!==v.instance&&(v.instance=x,d.data("$"+g.name+"Controller",x),v.bindingInfo.removeWatches&&v.bindingInfo.removeWatches(),v.bindingInfo=le(u,p,v.instance,y,g))}else v.instance=v(),d.data("$"+g.name+"Controller",v.instance),v.bindingInfo=le(u,p,v.instance,y,g)}for(fe(M,function(e,t){var n=e.require;e.bindToController&&!_e(n)&&Te(n)&&me(c[t].instance,K(t,n,d,c))}),fe(c,function(e){var t=e.instance;if(Se(t.$onChanges))try{t.$onChanges(e.bindingInfo.initialChanges)}catch(e){G(e)}if(Se(t.$onInit))try{t.$onInit()}catch(e){G(e)}Se(t.$doCheck)&&(u.$watch(function(){t.$doCheck()}),t.$doCheck()),Se(t.$onDestroy)&&u.$on("$destroy",function(){t.$onDestroy()})}),r=0,o=_.length;r<o;r++)se(s=_[r],s.isolateScope?l:t,d,p,s.require&&K(s.directiveName,s.require,d,c),h);var E=t;for(A&&(A.template||null===A.templateUrl)&&(E=l),e&&e(E,n.childNodes,void 0,a),r=w.length-1;0<=r;r--)se(s=w[r],s.isolateScope?l:t,d,p,s.require&&K(s.directiveName,s.require,d,c),h);fe(c,function(e){var t=e.instance;Se(t.$postLink)&&t.$postLink()})}}function K(n,e,i,r){var o;if(be(e)){var t=e.match(d),a=e.substring(t[0].length),s=t[1]||t[3],l="?"===t[2];if("^^"===s?i=i.parent():o=(o=r&&r[a])&&o.instance,!o){var u="$"+a+"Controller";o=s?i.inheritedData(u):i.data(u)}if(!o&&!l)throw mn("ctreq","Controller '{0}', required by directive '{1}', can't be found!",a,n)}else if(_e(e)){o=[];for(var c=0,h=e.length;c<h;c++)o[c]=K(n,e[c],i,r)}else Te(e)&&(o={},fe(e,function(e,t){o[t]=K(n,e,i,r)}));return o||null}function ee(e,t,n){for(var i=0,r=e.length;i<r;i++)e[i]=ge(e[i],{$$isolateScope:t,$$newScope:n})}function O(e,t,n,i,r,o,a){if(t===r)return null;var s=null;if(f.hasOwnProperty(t))for(var l,u=p.get(t+m),c=0,h=u.length;c<h;c++)if(l=u[c],(xe(i)||i>l.priority)&&-1!==l.restrict.indexOf(n)){if(o&&(l=ge(l,{$$start:o,$$end:a})),!l.$$bindings){var d=l.$$bindings=g(l,l.name);Te(d.isolateScope)&&(l.$$isolateBindings=d.isolateScope)}e.push(l),s=l}return s}function $(e){if(f.hasOwnProperty(e))for(var t=p.get(e+m),n=0,i=t.length;n<i;n++)if(t[n].multiElement)return!0;return!1}function te(n,i){var r=i.$attr,o=n.$attr;fe(n,function(e,t){"$"!==t.charAt(0)&&(i[t]&&i[t]!==e&&(e.length?e+=("style"===t?";":" ")+i[t]:e=i[t]),n.$set(t,e,!0,r[t]))}),fe(i,function(e,t){n.hasOwnProperty(t)||"$"===t.charAt(0)||(n[t]=e,"class"!==t&&"style"!==t&&(o[t]=r[t]))})}function ne(d,p,f,m,g,v,y,x){var E,T,b=[],_=p[0],w=d.shift(),S=ge(w,{templateUrl:null,transclude:null,replace:null,$$originalDirective:w}),M=Se(w.templateUrl)?w.templateUrl(p,f):w.templateUrl,A=w.templateNamespace;return p.empty(),e(M).then(function(e){var n,t,i,r;if(e=X(e),w.replace){if(i=ct(e)?[]:_n(re(A,Re(e))),n=i[0],1!==i.length||n.nodeType!==ze)throw mn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",w.name,M);t={$attr:{}},oe(m,p,n);var o=Y(n,[],t);Te(w.scope)&&ee(o,!0),d=o.concat(d),te(f,t)}else n=_,p.html(e);for(d.unshift(S),E=F(d,n,f,g,p,w,v,y,x),fe(m,function(e,t){e===n&&(m[t]=p[0])}),T=L(p[0].childNodes,g);b.length;){var a=b.shift(),s=b.shift(),l=b.shift(),u=b.shift(),c=p[0];if(!a.$$destroyed){if(s!==_){var h=s.className;x.hasElementTranscludeDirective&&w.replace||(c=mt(n)),oe(l,de(s),c),R(de(c),h)}r=E.transcludeOnThisElement?C(a,E.transclude,u):u,E(T,a,c,m,r)}}b=null}).catch(function(e){we(e)&&G(e)}),function(e,t,n,i,r){var o=r;t.$$destroyed||(b?b.push(t,n,i,o):(E.transcludeOnThisElement&&(o=C(t,E.transclude,r)),E(T,t,n,i,o)))}}function H(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function ie(e,t,n,i){function r(e){return e?" (module: "+e+")":""}if(t)throw mn("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",t.name,r(t.$$moduleName),n.name,r(n.$$moduleName),e,$e(i))}function re(e,t){switch(e=ce(e||"html")){case"svg":case"math":var n=V.document.createElement("div");return n.innerHTML="<"+e+">"+t+"</"+e+">",n.childNodes[0].childNodes;default:return t}}function I(e,t,o,a,n){var s=function(e,t){if("srcdoc"===t)return r.HTML;var n=Ne(e);if("src"===t||"ngSrc"===t){if(-1===["img","video","audio","source","track"].indexOf(n))return r.RESOURCE_URL}else if("xlinkHref"===t||"form"===n&&"action"===t||"link"===n&&"href"===t)return r.RESOURCE_URL}(e,a),i=!n,l=c[a]||n,u=S(o,i,s,l);if(u){if("multiple"===a&&"select"===Ne(e))throw mn("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",$e(e));if(h.test(a))throw mn("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");t.push({priority:100,compile:function(){return{pre:function(e,t,n){var i=n.$$observers||(n.$$observers=ke()),r=n[a];r!==o&&(u=r&&S(r,!0,s,l),o=r),u&&(n[a]=u(e),(i[a]||(i[a]=[])).$$inter=!0,(n.$$observers&&n.$$observers[a].$$scope||e).$watch(u,function(e,t){"class"===a&&e!==t?n.$updateClass(e,t):n.$set(a,e)}))}}}})}}function oe(e,t,n){var i,r,o=t[0],a=t.length,s=o.parentNode;if(e)for(i=0,r=e.length;i<r;i++)if(e[i]===o){e[i++]=n;for(var l=i,u=l+a-1,c=e.length;l<c;l++,u++)u<c?e[l]=e[u]:delete e[l];e.length-=a-1,e.context===o&&(e.context=n);break}s&&s.replaceChild(n,o);var h=V.document.createDocumentFragment();for(i=0;i<a;i++)h.appendChild(t[i]);for(de.hasData(o)&&(de.data(n,de.data(o)),de(o).off("$destroy")),de.cleanData(h.querySelectorAll("*")),i=1;i<a;i++)delete t[i];t[0]=n,t.length=1}function ae(e,t){return me(function(){return e.apply(null,arguments)},e,t)}function se(e,t,n,i,r,o){try{e(t,n,i,r,o)}catch(e){G(e,$e(n))}}function b(e,t){if(_)throw mn("missingattr","Attribute '{0}' of '{1}' is non-optional and must be set!",e,t)}function le(d,p,f,e,m){var i,g=[],v={};function y(e,t,n){Se(f.$onChanges)&&!Le(t,n)&&(s||(d.$$postDigest(l),s=[]),i||(i={},s.push(r)),i[e]&&(n=i[e].previousValue),i[e]=new yn(n,t))}function r(){f.$onChanges(i),i=void 0}return fe(e,function(e,n){var t,i,r,o,a,s=e.attrName,l=e.optional;switch(e.mode){case"@":l||z.call(p,s)||(b(s,m.name),f[n]=p[s]=void 0),a=p.$observe(s,function(e){if(be(e)||Ae(e)){var t=f[n];y(n,e,t),f[n]=e}}),p.$$observers[s].$$scope=d,be(t=p[s])?f[n]=S(t)(d):Ae(t)&&(f[n]=t),v[n]=new yn(gn,f[n]),g.push(a);break;case"=":if(!z.call(p,s)){if(l)break;b(s,m.name),p[s]=void 0}if(l&&!p[s])break;i=x(p[s]),o=i.literal?Ce:Le,r=i.assign||function(){throw t=f[n]=i(d),mn("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",p[s],s,m.name)},t=f[n]=i(d);var u=function(e){return o(e,f[n])||(o(e,t)?r(d,e=f[n]):f[n]=e),t=e};u.$stateful=!0,a=e.collection?d.$watchCollection(p[s],u):d.$watch(x(p[s],u),null,i.literal),g.push(a);break;case"<":if(!z.call(p,s)){if(l)break;b(s,m.name),p[s]=void 0}if(l&&!p[s])break;var c=(i=x(p[s])).literal,h=f[n]=i(d);v[n]=new yn(gn,f[n]),a=d.$watch(i,function(e,t){if(t===e){if(t===h||c&&Ce(t,h))return;t=h}y(n,e,t),f[n]=e},c),g.push(a);break;case"&":if(l||z.call(p,s)||b(s,m.name),(i=p.hasOwnProperty(s)?x(p[s]):ve)===ve&&l)break;f[n]=function(e){return i(d,e)}}}),{initialChanges:v,removeWatches:g.length&&function(){for(var e=0,t=g.length;e<t;++e)g[e]()}}}}]}function yn(e,t){this.previousValue=e,this.currentValue=t}vn.$inject=["$provide","$$sanitizeUriProvider"],yn.prototype.isFirstChange=function(){return this.previousValue===gn};var xn=/^((?:x|data)[:\-_])/i,En=/[:\-_]+(.)/g;function Tn(e){return e.replace(xn,"").replace(En,function(e,t,n){return n?t.toUpperCase():t})}function bn(e,t){var n="",i=e.split(/\s+/),r=t.split(/\s+/);e:for(var o=0;o<i.length;o++){for(var a=i[o],s=0;s<r.length;s++)if(a===r[s])continue e;n+=(0<n.length?" ":"")+a}return n}function _n(e){var t=(e=de(e)).length;if(t<=1)return e;for(;t--;){var n=e[t];(n.nodeType===je||n.nodeType===Ge&&""===n.nodeValue.trim())&&i.call(e,t,1)}return e}var wn=A("$controller"),Sn=/^(\S+)(\s+as\s+([\w$]+))?$/;function Mn(){var d={},p=!1;this.has=function(e){return d.hasOwnProperty(e)},this.register=function(e,t){Ue(e,"controller"),Te(e)?me(d,e):d[e]=t},this.allowGlobals=function(){p=!0},this.$get=["$injector","$window",function(u,c){return function(t,n,e,i){var r,o,a,s;if(e=!0===e,i&&be(i)&&(s=i),be(t)){if(!(o=t.match(Sn)))throw wn("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",t);if(a=o[1],s=s||o[3],!(t=d.hasOwnProperty(a)?d[a]:De(n.$scope,a,!0)||(p?De(c,a,!0):void 0)))throw wn("ctrlreg","The controller with the name '{0}' is not registered.",a);ue(t,a,!0)}if(e){var l=(_e(t)?t[t.length-1]:t).prototype;return r=Object.create(l||null),s&&h(n,s,r,a||t.name),me(function(){var e=u.invoke(t,r,n,a);return e!==r&&(Te(e)||Se(e))&&(r=e,s&&h(n,s,r,a||t.name)),r},{instance:r,identifier:s})}return r=u.instantiate(t,n,a),s&&h(n,s,r,a||t.name),r};function h(e,t,n,i){if(!e||!Te(e.$scope))throw A("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",i,t);e.$scope[t]=n}}]}function An(){this.$get=["$window",function(e){return de(e.document)}]}function Rn(){this.$get=["$document","$rootScope",function(e,t){var n=e[0],i=n&&n.hidden;function r(){i=n.hidden}return e.on("visibilitychange",r),t.$on("$destroy",function(){e.off("visibilitychange",r)}),function(){return i}}]}function Nn(){this.$get=["$log",function(n){return function(e,t){n.error.apply(n,arguments)}}]}var Pn=function(){this.$get=["$document",function(t){return function(e){return e?!e.nodeType&&e instanceof de&&(e=e[0]):e=t[0].body,e.offsetWidth+1}}]},Ln="application/json",Cn={"Content-Type":Ln+";charset=utf-8"},Fn=/^\[|^\{(?!\{)/,On={"[":/]$/,"{":/}$/},$n=/^\)]\}',?\n/,Hn=A("$http");function In(e){return Te(e)?w(e)?e.toISOString():G(e):e}function Un(){this.$get=function(){return function(e){if(!e)return"";var n=[];return l(e,function(e,t){null===e||xe(e)||Se(e)||(_e(e)?fe(e,function(e){n.push(ee(t)+"="+ee(In(e)))}):n.push(ee(t)+"="+ee(In(e))))}),n.join("&")}}}function Dn(){this.$get=function(){return function(e){if(!e)return"";var t=[];return function n(e,i,r){if(null===e||xe(e))return;_e(e)?fe(e,function(e,t){n(e,i+"["+(Te(e)?t:"")+"]")}):Te(e)&&!w(e)?l(e,function(e,t){n(e,i+(r?"":"[")+t+(r?"":"]"))}):t.push(ee(i)+"="+ee(In(e)))}(e,"",!0),t.join("&")}}}function Bn(t,e){if(be(t)){var n=t.replace($n,"").trim();if(n){var i=e("Content-Type"),r=i&&0===i.indexOf(Ln);if(r||(a=(o=n).match(Fn))&&On[a[0]].test(o))try{t=j(n)}catch(e){if(!r)return t;throw Hn("baddata",'Data must be a valid JSON object. Received: "{0}". Parse error: "{1}"',t,e)}}}var o,a;return t}function kn(e){var t,n=ke();function i(e,t){e&&(n[e]=n[e]?n[e]+", "+t:t)}return be(e)?fe(e.split("\n"),function(e){t=e.indexOf(":"),i(ce(Re(e.substr(0,t))),Re(e.substr(t+1)))}):Te(e)&&fe(e,function(e,t){i(ce(t),Re(e))}),n}function Vn(n){var i;return function(e){if(i||(i=kn(n)),e){var t=i[ce(e)];return void 0===t&&(t=null),t}return i}}function zn(t,n,i,e){return Se(e)?e(t,n,i):(fe(e,function(e){t=e(t,n,i)}),t)}function Gn(e){return 200<=e&&e<300}function jn(){var w=this.defaults={transformResponse:[Bn],transformRequest:[function(e){return Te(e)&&(i=e,"[object File]"!==pe.call(i))&&(n=e,"[object Blob]"!==pe.call(n))&&(t=e,"[object FormData]"!==pe.call(t))?G(e):e;var t,n,i}],headers:{common:{Accept:"application/json, text/plain, */*"},post:qe(Cn),put:qe(Cn),patch:qe(Cn)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},S=!1;this.useApplyAsync=function(e){return Ee(e)?(S=!!e,this):S};var t=this.interceptors=[],i=this.xsrfWhitelistedOrigins=[];this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function(s,g,v,e,y,x,l,E){var T=e("$http");w.paramSerializer=be(w.paramSerializer)?l.get(w.paramSerializer):w.paramSerializer;var u=[];fe(t,function(e){u.unshift(be(e)?l.get(e):l.invoke(e))});var n,b=(n=[or].concat(i.map(ar)),function(e){var t=ar(e);return n.some(sr.bind(null,t))});function _(e){if(!Te(e))throw A("$http")("badreq","Http request configuration must be an object.  Received: {0}",e);if(!be(E.valueOf(e.url)))throw A("$http")("badreq","Http request configuration url must be a string or a $sce trusted object.  Received: {0}",e.url);var n=me({method:"get",transformRequest:w.transformRequest,transformResponse:w.transformResponse,paramSerializer:w.paramSerializer,jsonpCallbackParam:w.jsonpCallbackParam},e);n.headers=function(e){var t,n,i,r=w.headers,o=me({},e.headers);r=me({},r.common,r[ce(e.method)]);e:for(t in r){for(i in n=ce(t),o)if(ce(i)===n)continue e;o[t]=r[t]}return a=o,s=qe(e),u={},fe(a,function(e,t){Se(e)?null!=(l=e(s))&&(u[t]=l):u[t]=e}),u;var a,s,l,u}(e),n.method=d(n.method),n.paramSerializer=be(n.paramSerializer)?l.get(n.paramSerializer):n.paramSerializer,s.$$incOutstandingRequestCount();var t=[],i=[],r=x.resolve(n);return fe(u,function(e){(e.request||e.requestError)&&t.unshift(e.request,e.requestError),(e.response||e.responseError)&&i.push(e.response,e.responseError)}),r=(r=o(r=(r=o(r,t)).then(function(e){var n=e.headers,t=zn(e.data,Vn(n),void 0,e.transformRequest);xe(t)&&fe(n,function(e,t){"content-type"===ce(t)&&delete n[t]});xe(e.withCredentials)&&!xe(w.withCredentials)&&(e.withCredentials=w.withCredentials);return function(o,e){var a,t,s=x.defer(),n=s.promise,i=o.headers,r="jsonp"===ce(o.method),l=o.url;r?l=E.getTrustedResourceUrl(l):be(l)||(l=E.valueOf(l));u=l,c=o.paramSerializer(o.params),0<c.length&&(u+=(-1===u.indexOf("?")?"?":"&")+c),l=u,r&&(l=function(n,i){var e=n.split("?");if(2<e.length)throw Hn("badjsonp",'Illegal use more than one "?", in url, "{1}"',n);return fe(Q(e[1]),function(e,t){if("JSON_CALLBACK"===e)throw Hn("badjsonp",'Illegal use of JSON_CALLBACK in url, "{0}"',n);if(t===i)throw Hn("badjsonp",'Illegal use of callback param, "{0}", in url, "{1}"',i,n)}),n+=(-1===n.indexOf("?")?"?":"&")+i+"=JSON_CALLBACK"}(l,o.jsonpCallbackParam));var u,c;_.pendingRequests.push(o),n.then(m,m),!o.cache&&!w.cache||!1===o.cache||"GET"!==o.method&&"JSONP"!==o.method||(a=Te(o.cache)?o.cache:Te(w.cache)?w.cache:T);a&&(Ee(t=a.get(l))?L(t)?t.then(f,f):_e(t)?p(t[1],t[0],qe(t[2]),t[3],t[4]):p(t,200,{},"OK","complete"):a.put(l,n));if(xe(t)){var h=b(o.url)?v()[o.xsrfCookieName||w.xsrfCookieName]:void 0;h&&(i[o.xsrfHeaderName||w.xsrfHeaderName]=h),g(o.method,l,e,function(e,t,n,i,r){a&&(Gn(e)?a.put(l,[e,t,kn(n),i,r]):a.remove(l));function o(){p(t,e,n,i,r)}S?y.$applyAsync(o):(o(),y.$$phase||y.$apply())},i,o.timeout,o.withCredentials,o.responseType,d(o.eventHandlers),d(o.uploadEventHandlers))}return n;function d(e){if(e){var t={};return fe(e,function(n,e){t[e]=function(e){function t(){n(e)}S?y.$applyAsync(t):y.$$phase?t():y.$apply(t)}}),t}}function p(e,t,n,i,r){(Gn(t=-1<=t?t:0)?s.resolve:s.reject)({data:e,status:t,headers:Vn(n),config:o,statusText:i,xhrStatus:r})}function f(e){p(e.data,e.status,qe(e.headers()),e.statusText,e.xhrStatus)}function m(){var e=_.pendingRequests.indexOf(o);-1!==e&&_.pendingRequests.splice(e,1)}}(e,t).then(a,a)}),i)).finally(function(){s.$$completeOutstandingRequest(ve)});function o(e,t){for(var n=0,i=t.length;n<i;){var r=t[n++],o=t[n++];e=e.then(r,o)}return t.length=0,e}function a(e){var t=me({},e);return t.data=zn(e.data,e.headers,e.status,n.transformResponse),Gn(e.status)?t:x.reject(t)}}return _.pendingRequests=[],function(e){fe(arguments,function(n){_[n]=function(e,t){return _(me({},t||{},{method:n,url:e}))}})}("get","delete","head","jsonp"),function(e){fe(arguments,function(i){_[i]=function(e,t,n){return _(me({},n||{},{method:i,url:e,data:t}))}})}("post","put","patch"),_.defaults=w,_}]}function Wn(){this.$get=function(){return function(){return new V.XMLHttpRequest}}}function Xn(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(e,t,n,i){return y=i,x=(v=e).defer,E=t,T=n[0],function(e,i,t,r,n,o,a,s,l,u){if(i=i||v.url(),"jsonp"===ce(e))var c=E.createCallback(i),h=function(e,i,r){e=e.replace("JSON_CALLBACK",i);var o=T.createElement("script"),a=null;return o.type="text/javascript",o.src=e,o.async=!0,a=function(e){o.removeEventListener("load",a),o.removeEventListener("error",a),T.body.removeChild(o),o=null;var t=-1,n="unknown";e&&("load"!==e.type||E.wasCalled(i)||(e={type:"error"}),n=e.type,t="error"===e.type?404:200),r&&r(t,n)},o.addEventListener("load",a),o.addEventListener("error",a),T.body.appendChild(o),a}(i,c,function(e,t){var n=200===e&&E.getResponse(c);g(r,e,n,"",t,"complete"),E.removeCallback(c)});else{var d=y(e,i),p=!1;if(d.open(e,i,!0),fe(n,function(e,t){Ee(e)&&d.setRequestHeader(t,e)}),d.onload=function(){var e=d.statusText||"",t="response"in d?d.response:d.responseText,n=1223===d.status?204:d.status;0===n&&(n=t?200:"file"===ar(i).protocol?404:0),g(r,n,t,d.getAllResponseHeaders(),e,"complete")},d.onerror=function(){g(r,-1,null,null,"","error")},d.ontimeout=function(){g(r,-1,null,null,"","timeout")},d.onabort=function(){g(r,-1,null,null,"",p?"timeout":"abort")},fe(l,function(e,t){d.addEventListener(t,e)}),fe(u,function(e,t){d.upload.addEventListener(t,e)}),a&&(d.withCredentials=!0),s)try{d.responseType=s}catch(e){if("json"!==s)throw e}d.send(xe(t)?null:t)}if(0<o)var f=x(function(){m("timeout")},o);else L(o)&&o.then(function(){m(Ee(o.$$timeoutId)?"timeout":"abort")});function m(e){p="timeout"===e,h&&h(),d&&d.abort()}function g(e,t,n,i,r,o){Ee(f)&&x.cancel(f),h=d=null,e(t,n,i,r,o)}};var v,y,x,E,T}]}var qn=x.$interpolateMinErr=A("$interpolate");function Yn(){var w="{{",S="}}";this.startSymbol=function(e){return e?(w=e,this):w},this.endSymbol=function(e){return e?(S=e,this):S},this.$get=["$parse","$exceptionHandler","$sce",function(v,y,x){var E=w.length,T=S.length,t=new RegExp(w.replace(/./g,e),"g"),n=new RegExp(S.replace(/./g,e),"g");function e(e){return"\\\\\\"+e}function b(e){return e.replace(t,w).replace(n,S)}function _(e,t,n,i){var r=e.$watch(function(e){return r(),i(e)},t,n);return r}function i(r,e,t,i){if(!r.length||-1===r.indexOf(w)){var n;if(!e)(n=M(b(r))).exp=r,n.expressions=[],n.$$watchDelegate=_;return n}i=!!i;for(var o,a,s,l=0,u=[],c=[],h=r.length,d=[],p=[];l<h;){if(-1===(o=r.indexOf(w,l))||-1===(a=r.indexOf(S,o+E))){l!==h&&d.push(b(r.substring(l)));break}l!==o&&d.push(b(r.substring(l,o))),s=r.substring(o+E,a),u.push(s),c.push(v(s,g)),l=a+T,p.push(d.length),d.push("")}if(t&&1<d.length&&qn.throwNoconcat(r),!e||u.length){var f=function(e){for(var t=0,n=u.length;t<n;t++){if(i&&xe(e[t]))return;d[p[t]]=e[t]}return d.join("")},m=function(e){return t?x.getTrusted(t,e):x.valueOf(e)};return me(function(e){var t=0,n=u.length,i=new Array(n);try{for(;t<n;t++)i[t]=c[t](e);return f(i)}catch(e){y(qn.interr(r,e))}},{exp:r,expressions:u,$$watchDelegate:function(i,r){var o;return i.$watchGroup(c,function(e,t){var n=f(e);r.call(this,n,e!==t?o:n,i),o=n})}})}function g(e){try{return e=m(e),i&&!Ee(e)?e:Ve(e)}catch(e){y(qn.interr(r,e))}}}return i.startSymbol=function(){return w},i.endSymbol=function(){return S},i}]}function Jn(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(p,f,m,g,v){var y={};function e(e,t,n,i){var r=4<arguments.length,o=r?Fe(arguments,4):[],a=f.setInterval,s=f.clearInterval,l=0,u=Ee(i)&&!i,c=(u?g:m).defer(),h=c.promise;return n=Ee(n)?n:0,h.$$intervalId=a(function(){u?v.defer(d):p.$evalAsync(d),c.notify(l++),0<n&&n<=l&&(c.resolve(l),s(h.$$intervalId),delete y[h.$$intervalId]),u||p.$apply()},t),y[h.$$intervalId]=c,h;function d(){r?e.apply(null,o):e(l)}}return e.cancel=function(e){return!!(e&&e.$$intervalId in y)&&(Vi(y[e.$$intervalId].promise),y[e.$$intervalId].reject("canceled"),f.clearInterval(e.$$intervalId),delete y[e.$$intervalId],!0)},e}]}qn.throwNoconcat=function(e){throw qn("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",e)},qn.interr=function(e,t){return qn("interr","Can't interpolate: {0}\n{1}",e,t.toString())};var Qn=function(){this.$get=function(){var o=x.callbacks,a={};return{createCallback:function(e){var t,n="_"+(o.$$counter++).toString(36),i="angular.callbacks."+n,r=((t=function(e){t.data=e,t.called=!0}).id=n,t);return a[i]=o[n]=r,i},wasCalled:function(e){return a[e].called},getResponse:function(e){return a[e].data},removeCallback:function(e){var t=a[e];delete o[t.id],delete a[e]}}}},Zn=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,Kn={http:80,https:443,ftp:21},ei=A("$location");function ti(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=K(t[n].replace(/%2F/g,"/"));return t.join("/")}function ni(e,t){var n=ar(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=E(n.port)||Kn[n.protocol]||null}var ii=/^\s*[\\/]{2,}/;function ri(e,t,n){if(ii.test(e))throw ei("badpath",'Invalid url "{0}".',e);var i="/"!==e.charAt(0);i&&(e="/"+e);var r=ar(e),o=i&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname;t.$$path=function(e,t){for(var n=e.split("/"),i=n.length;i--;)n[i]=decodeURIComponent(n[i]),t&&(n[i]=n[i].replace(/\//g,"%2F"));return n.join("/")}(o,n),t.$$search=Q(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!==t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function oi(e,t){return e.slice(0,t.length)===t}function ai(e,t){if(oi(t,e))return t.substr(e.length)}function si(e){var t=e.indexOf("#");return-1===t?e:e.substr(0,t)}function li(e){return e.replace(/(#.+)|#$/,"$1")}function ui(o,a,s){this.$$html5=!0,s=s||"",ni(o,this),this.$$parse=function(e){var t=ai(a,e);if(!be(t))throw ei("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,a);ri(t,this,!0),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=Z(this.$$search),t=this.$$hash?"#"+K(this.$$hash):"";this.$$url=ti(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=a+this.$$url.substr(1),this.$$urlUpdatedByLocation=!0},this.$$parseLinkUrl=function(e,t){return t&&"#"===t[0]?(this.hash(t.slice(1)),!0):(Ee(n=ai(o,e))?(i=n,r=s&&Ee(n=ai(s,n))?a+(ai("/",n)||n):o+i):Ee(n=ai(a,e))?r=a+n:a===e+"/"&&(r=a),r&&this.$$parse(r),!!r);var n,i,r}}function ci(i,r,o){ni(i,this),this.$$parse=function(e){var t,n=ai(i,e)||ai(r,e);xe(n)||"#"!==n.charAt(0)?this.$$html5?t=n:(t="",xe(n)&&(i=e,this.replace())):xe(t=ai(o,n))&&(t=n),ri(t,this,!1),this.$$path=function(e,t,n){var i,r=/^\/[A-Z]:(\/.*)/;oi(t,n)&&(t=t.replace(n,""));if(r.exec(t))return e;return(i=r.exec(e))?i[1]:e}(this.$$path,t,i),this.$$compose()},this.$$compose=function(){var e=Z(this.$$search),t=this.$$hash?"#"+K(this.$$hash):"";this.$$url=ti(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=i+(this.$$url?o+this.$$url:""),this.$$urlUpdatedByLocation=!0},this.$$parseLinkUrl=function(e,t){return si(i)===si(e)&&(this.$$parse(e),!0)}}function hi(r,o,a){this.$$html5=!0,ci.apply(this,arguments),this.$$parseLinkUrl=function(e,t){return t&&"#"===t[0]?(this.hash(t.slice(1)),!0):(r===si(e)?n=e:(i=ai(o,e))?n=r+a+i:o===e+"/"&&(n=o),n&&this.$$parse(n),!!n);var n,i},this.$$compose=function(){var e=Z(this.$$search),t=this.$$hash?"#"+K(this.$$hash):"";this.$$url=ti(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=r+a+this.$$url,this.$$urlUpdatedByLocation=!0}}var di={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:pi("$$absUrl"),url:function(e){if(xe(e))return this.$$url;var t=Zn.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:pi("$$protocol"),host:pi("$$host"),port:pi("$$port"),path:fi("$$path",function(e){return"/"===(e=null!==e?e.toString():"").charAt(0)?e:"/"+e}),search:function(n,e){switch(arguments.length){case 0:return this.$$search;case 1:if(be(n)||_(n))n=n.toString(),this.$$search=Q(n);else{if(!Te(n))throw ei("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");fe(n=I(n,{}),function(e,t){null==e&&delete n[t]}),this.$$search=n}break;default:xe(e)||null===e?delete this.$$search[n]:this.$$search[n]=e}return this.$$compose(),this},hash:fi("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};function pi(e){return function(){return this[e]}}function fi(t,n){return function(e){return xe(e)?this[t]:(this[t]=n(e),this.$$compose(),this)}}function mi(){var v="!",y={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(e){return Ee(e)?(v=e,this):v},this.html5Mode=function(e){return Ae(e)?(y.enabled=e,this):Te(e)?(Ae(e.enabled)&&(y.enabled=e.enabled),Ae(e.requireBase)&&(y.requireBase=e.requireBase),(Ae(e.rewriteLinks)||be(e.rewriteLinks))&&(y.rewriteLinks=e.rewriteLinks),this):y},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(a,s,t,o,l){var u,e,n,i,r=s.baseHref(),c=s.url();if(y.enabled){if(!r&&y.requireBase)throw ei("nobase","$location in HTML5 mode requires a <base> tag to be present!");n=(i=c).substring(0,i.indexOf("/",i.indexOf("//")+2))+(r||"/"),e=t.history?ui:hi}else n=si(c),e=ci;var h,d=(h=n).substr(0,si(h).lastIndexOf("/")+1);(u=new e(n,d,"#"+v)).$$parseLinkUrl(c,c),u.$$state=s.state();var p=/^\s*(javascript|mailto):/i;function f(e,t,n){var i=u.url(),r=u.$$state;try{s.url(e,t,n),u.$$state=s.state()}catch(e){throw u.url(i),u.$$state=r,e}}o.on("click",function(e){var t=y.rewriteLinks;if(t&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!==e.which&&2!==e.button){for(var n=de(e.target);"a"!==Ne(n[0]);)if(n[0]===o[0]||!(n=n.parent())[0])return;if(!be(t)||!xe(n.attr(t))){var i=n.prop("href"),r=n.attr("href")||n.attr("xlink:href");Te(i)&&"[object SVGAnimatedString]"===i.toString()&&(i=ar(i.animVal).href),p.test(i)||!i||n.attr("target")||e.isDefaultPrevented()||u.$$parseLinkUrl(i,r)&&(e.preventDefault(),u.absUrl()!==s.url()&&(a.$apply(),l.angular["ff-684208-preventDefault"]=!0))}}}),li(u.absUrl())!==li(c)&&s.url(u.absUrl(),!0);var m=!0;return s.onUrlChange(function(i,r){oi(i,d)?(a.$evalAsync(function(){var e,t=u.absUrl(),n=u.$$state;i=li(i),u.$$parse(i),u.$$state=r,e=a.$broadcast("$locationChangeStart",i,t,r,n).defaultPrevented,u.absUrl()===i&&(e?(u.$$parse(t),f(t,!1,u.$$state=n)):(m=!1,g(t,n)))}),a.$$phase||a.$digest()):l.location.href=i}),a.$watch(function(){if(m||u.$$urlUpdatedByLocation){u.$$urlUpdatedByLocation=!1;var n=li(s.url()),e=li(u.absUrl()),i=s.state(),r=u.$$replace,o=n!==e||u.$$html5&&t.history&&i!==u.$$state;(m||o)&&(m=!1,a.$evalAsync(function(){var e=u.absUrl(),t=a.$broadcast("$locationChangeStart",e,n,u.$$state,i).defaultPrevented;u.absUrl()===e&&(t?(u.$$parse(n),u.$$state=i):(o&&f(e,r,i===u.$$state?null:u.$$state),g(n,i)))}))}u.$$replace=!1}),u;function g(e,t){a.$broadcast("$locationChangeSuccess",u.absUrl(),e,u.$$state,t)}}]}function gi(){var i=!0,o=this;this.debugEnabled=function(e){return Ee(e)?(i=e,this):i},this.$get=["$window",function(n){var e,r=he||/\bEdge\//.test(n.navigator&&n.navigator.userAgent);return{log:t("log"),info:t("info"),warn:t("warn"),error:t("error"),debug:(e=t("debug"),function(){i&&e.apply(o,arguments)})};function t(e){var t=n.console||{},i=t[e]||t.log||ve;return function(){var n=[];return fe(arguments,function(e){var t;n.push((we(t=e)&&(t.stack&&r?t=t.message&&-1===t.stack.indexOf(t.message)?"Error: "+t.message+"\n"+t.stack:t.stack:t.sourceURL&&(t=t.message+"\n"+t.sourceURL+":"+t.line)),t))}),Function.prototype.apply.call(i,t,n)}}}]}fe([hi,ci,ui],function(t){t.prototype=Object.create(di),t.prototype.state=function(e){if(!arguments.length)return this.$$state;if(t!==ui||!this.$$html5)throw ei("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=xe(e)?null:e,this.$$urlUpdatedByLocation=!0,this}});var vi=A("$parse"),yi={}.constructor.prototype.valueOf;function xi(e){return e+""}var Ei=ke();fe("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(e){Ei[e]=!0});var Ti={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},bi=function(e){this.options=e};bi.prototype={constructor:bi,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),i=n+this.peek(2),r=Ei[t],o=Ei[n],a=Ei[i];if(r||o||a){var s=a?i:o?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||" "===e},isIdentifierStart:function(e){return this.options.isIdentifierStart?this.options.isIdentifierStart(e,this.codePointAt(e)):this.isValidIdentifierStart(e)},isValidIdentifierStart:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isIdentifierContinue:function(e){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(e,this.codePointAt(e)):this.isValidIdentifierContinue(e)},isValidIdentifierContinue:function(e,t){return this.isValidIdentifierStart(e,t)||this.isNumber(e)},codePointAt:function(e){return 1===e.length?e.charCodeAt(0):(e.charCodeAt(0)<<10)+e.charCodeAt(1)-56613888},peekMultichar:function(){var e=this.text.charAt(this.index),t=this.peek();if(!t)return e;var n=e.charCodeAt(0),i=t.charCodeAt(0);return 55296<=n&&n<=56319&&56320<=i&&i<=57343?e+t:e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var i=Ee(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw vi("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,i,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=ce(this.text.charAt(this.index));if("."===n||this.isNumber(n))e+=n;else{var i=this.peek();if("e"===n&&this.isExpOperator(i))e+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"===e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!==e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){var e=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var t=this.peekMultichar();if(!this.isIdentifierContinue(t))break;this.index+=t.length}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",i=e,r=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(i+=o,r){if("u"===o){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else{n+=Ti[o]||o}r=!1}else if("\\"===o)r=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:i,constant:!0,value:n});n+=o}this.index++}this.throwError("Unterminated quote",t)}};var _i=function(e,t){this.lexer=e,this.options=t};function wi(e,t){return void 0!==e?e:t}function Si(e,t){return void 0===e?t:void 0===t?e:e+t}_i.Program="Program",_i.ExpressionStatement="ExpressionStatement",_i.AssignmentExpression="AssignmentExpression",_i.ConditionalExpression="ConditionalExpression",_i.LogicalExpression="LogicalExpression",_i.BinaryExpression="BinaryExpression",_i.UnaryExpression="UnaryExpression",_i.CallExpression="CallExpression",_i.MemberExpression="MemberExpression",_i.Identifier="Identifier",_i.Literal="Literal",_i.ArrayExpression="ArrayExpression",_i.Property="Property",_i.ObjectExpression="ObjectExpression",_i.ThisExpression="ThisExpression",_i.LocalsExpression="LocalsExpression",_i.NGValueParameter="NGValueParameter",_i.prototype={ast:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var e=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:_i.Program,body:e}},expressionStatement:function(){return{type:_i.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();if(this.expect("=")){if(!Pi(e))throw vi("lval","Trying to assign a value to a non l-value");e={type:_i.AssignmentExpression,left:e,right:this.assignment(),operator:"="}}return e},ternary:function(){var e,t,n=this.logicalOR();return this.expect("?")&&(e=this.expression(),this.consume(":"))?(t=this.expression(),{type:_i.ConditionalExpression,test:n,alternate:e,consequent:t}):n},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:_i.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:_i.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t={type:_i.BinaryExpression,operator:e.text,left:t,right:this.relational()};return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t={type:_i.BinaryExpression,operator:e.text,left:t,right:this.additive()};return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t={type:_i.BinaryExpression,operator:e.text,left:t,right:this.multiplicative()};return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t={type:_i.BinaryExpression,operator:e.text,left:t,right:this.unary()};return t},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:_i.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e,t;for(this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?e=I(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?e={type:_i.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());t=this.expect("(","[",".");)"("===t.text?(e={type:_i.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:_i.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:_i.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){for(var t=[e],n={type:_i.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return n},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)for(;e.push(this.filterChain()),this.expect(","););return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:_i.Identifier,name:e.text}},constant:function(){return{type:_i.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:_i.ArrayExpression,elements:e}},object:function(){var e,t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;e={type:_i.Property,kind:"init"},this.peek().constant?(e.key=this.constant(),e.computed=!1,this.consume(":"),e.value=this.expression()):this.peek().identifier?(e.key=this.identifier(),e.computed=!1,this.peek(":")?(this.consume(":"),e.value=this.expression()):e.value=e.key):this.peek("[")?(this.consume("["),e.key=this.expression(),this.consume("]"),e.computed=!0,this.consume(":"),e.value=this.expression()):this.throwError("invalid key",this.peek()),t.push(e)}while(this.expect(","));return this.consume("}"),{type:_i.ObjectExpression,properties:t}},throwError:function(e,t){throw vi("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw vi("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw vi("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,i){return this.peekAhead(0,e,t,n,i)},peekAhead:function(e,t,n,i,r){if(this.tokens.length>e){var o=this.tokens[e],a=o.text;if(a===t||a===n||a===i||a===r||!t&&!n&&!i&&!r)return o}return!1},expect:function(e,t,n,i){var r=this.peek(e,t,n,i);return!!r&&(this.tokens.shift(),r)},selfReferential:{this:{type:_i.ThisExpression},$locals:{type:_i.LocalsExpression}}};var Mi=1,Ai=2;function Ri(e,t,n){var i,r,o,a,s,l=e.isPure=function(e,t){switch(e.type){case _i.MemberExpression:if(e.computed)return!1;break;case _i.UnaryExpression:return Mi;case _i.BinaryExpression:return"+"!==e.operator&&Mi;case _i.CallExpression:return!1}return void 0===t?Ai:t}(e,n);switch(e.type){case _i.Program:i=!0,fe(e.body,function(e){Ri(e.expression,t,l),i=i&&e.expression.constant}),e.constant=i;break;case _i.Literal:e.constant=!0,e.toWatch=[];break;case _i.UnaryExpression:Ri(e.argument,t,l),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case _i.BinaryExpression:Ri(e.left,t,l),Ri(e.right,t,l),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case _i.LogicalExpression:Ri(e.left,t,l),Ri(e.right,t,l),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case _i.ConditionalExpression:Ri(e.test,t,l),Ri(e.alternate,t,l),Ri(e.consequent,t,l),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case _i.Identifier:e.constant=!1,e.toWatch=[e];break;case _i.MemberExpression:Ri(e.object,t,l),e.computed&&Ri(e.property,t,l),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=e.constant?[]:[e];break;case _i.CallExpression:o=!!e.filter&&(a=t,s=e.callee.name,!a(s).$stateful),i=o,r=[],fe(e.arguments,function(e){Ri(e,t,l),i=i&&e.constant,r.push.apply(r,e.toWatch)}),e.constant=i,e.toWatch=o?r:[e];break;case _i.AssignmentExpression:Ri(e.left,t,l),Ri(e.right,t,l),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case _i.ArrayExpression:i=!0,r=[],fe(e.elements,function(e){Ri(e,t,l),i=i&&e.constant,r.push.apply(r,e.toWatch)}),e.constant=i,e.toWatch=r;break;case _i.ObjectExpression:i=!0,r=[],fe(e.properties,function(e){Ri(e.value,t,l),i=i&&e.value.constant,r.push.apply(r,e.value.toWatch),e.computed&&(Ri(e.key,t,!1),i=i&&e.key.constant,r.push.apply(r,e.key.toWatch))}),e.constant=i,e.toWatch=r;break;case _i.ThisExpression:case _i.LocalsExpression:e.constant=!1,e.toWatch=[]}}function Ni(e){if(1===e.length){var t=e[0].expression,n=t.toWatch;return 1!==n.length?n:n[0]!==t?n:void 0}}function Pi(e){return e.type===_i.Identifier||e.type===_i.MemberExpression}function Li(e){if(1===e.body.length&&Pi(e.body[0].expression))return{type:_i.AssignmentExpression,left:e.body[0].expression,right:{type:_i.NGValueParameter},operator:"="}}function Ci(e){this.$filter=e}function Fi(e){this.$filter=e}function Oi(e,t,n){this.ast=new _i(e,n),this.astCompiler=n.csp?new Fi(t):new Ci(t)}function $i(e){return Se(e.valueOf)?e.valueOf():yi.call(e)}function Hi(){var n,i,h=ke(),p={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(e,t){p[e]=t},this.setIdentifierFns=function(e,t){return n=e,i=t,this},this.$get=["$filter",function(r){var o={csp:U().noUnsafeEval,literals:I(p),isIdentifierStart:Se(n)&&n,isIdentifierContinue:Se(i)&&i};return e.$$getAst=function(e){return new Oi(new bi(o),r,o).getAst(e).ast},e;function e(e,t){var n,i;switch(typeof e){case"string":if(e=e.trim(),!(n=h[i=e]))(n=new Oi(new bi(o),r,o).parse(e)).constant?n.$$watchDelegate=a:n.oneTime?n.$$watchDelegate=n.literal?c:u:n.inputs&&(n.$$watchDelegate=l),h[i]=n;return s(n,t);case"function":return s(e,t);default:return s(ve,t)}}function d(e,t,n){return null==e||null==t?e===t:!("object"==typeof e&&"object"==typeof(e=$i(e))&&!n)&&(e===t||e!=e&&t!=t)}function l(e,t,n,o,i){var a,s=o.inputs;if(1===s.length){var r=d;return s=s[0],e.$watch(function(e){var t=s(e);return d(t,r,s.isPure)||(a=o(e,void 0,void 0,[t]),r=t&&$i(t)),a},t,n,i)}for(var l=[],u=[],c=0,h=s.length;c<h;c++)l[c]=d,u[c]=null;return e.$watch(function(e){for(var t=!1,n=0,i=s.length;n<i;n++){var r=s[n](e);(t||(t=!d(r,l[n],s[n].isPure)))&&(u[n]=r,l[n]=r&&$i(r))}return t&&(a=o(e,void 0,void 0,u)),a},t,n,i)}function u(e,i,t,n,r){var o,a;return o=n.inputs?l(e,s,t,n,r):e.$watch(function(e){return n(e)},s,t);function s(e,t,n){a=e,Se(i)&&i(e,t,n),Ee(e)&&n.$$postDigest(function(){Ee(a)&&o()})}}function c(e,i,t,n){var r,o;return r=e.$watch(function(e){return n(e)},function(e,t,n){o=e,Se(i)&&i(e,t,n),a(e)&&n.$$postDigest(function(){a(o)&&r()})},t);function a(e){var t=!0;return fe(e,function(e){Ee(e)||(t=!1)}),t}}function a(e,t,n,i){var r=e.$watch(function(e){return r(),i(e)},t,n);return r}function s(a,s){if(!s)return a;var e=a.$$watchDelegate,o=!1,t=e!==c&&e!==u?function(e,t,n,i){var r=o&&i?i[0]:a(e,t,n,i);return s(r,e,t)}:function(e,t,n,i){var r=a(e,t,n,i),o=s(r,e,t);return Ee(r)?o:r};return o=!a.inputs,e&&e!==l?(t.$$watchDelegate=e,t.inputs=a.inputs):s.$stateful||(t.$$watchDelegate=l,t.inputs=a.inputs?a.inputs:[a]),t.inputs&&(t.inputs=t.inputs.map(function(t){return t.isPure===Ai?function(e){return t(e)}:t})),t}}]}function Ii(){var n=!0;this.$get=["$rootScope","$exceptionHandler",function(t,e){return Di(function(e){t.$evalAsync(e)},e,n)}],this.errorOnUnhandledRejections=function(e){return Ee(e)?(n=e,this):n}}function Ui(){var n=!0;this.$get=["$browser","$exceptionHandler",function(t,e){return Di(function(e){t.defer(e)},e,n)}],this.errorOnUnhandledRejections=function(e){return Ee(e)?(n=e,this):n}}function Di(a,s,l){var n=A("$q",TypeError),u=0,i=[];function r(){return new e}function e(){var t=this.promise=new o;this.resolve=function(e){d(t,e)},this.reject=function(e){p(t,e)},this.notify=function(e){m(t,e)}}function o(){this.$$state={status:0}}function c(){for(;!u&&i.length;){var e=i.shift();if(!Bi(e)){ki(e);var t="Possibly unhandled rejection: "+Ye(e.value);we(e.value)?s(e.value,t):s(t)}}}function h(e){!l||e.pending||2!==e.status||Bi(e)||(0===u&&0===i.length&&a(c),i.push(e)),!e.processScheduled&&e.pending&&(e.processScheduled=!0,++u,a(function(){!function(e){var t,n,i;i=e.pending,e.processScheduled=!1,e.pending=void 0;try{for(var r=0,o=i.length;r<o;++r){ki(e),n=i[r][0],t=i[r][e.status];try{Se(t)?d(n,t(e.value)):1===e.status?d(n,e.value):p(n,e.value)}catch(e){p(n,e),e&&!0===e.$$passToExceptionHandler&&s(e)}}}finally{--u,l&&0===u&&a(c)}}(e)}))}function d(e,t){e.$$state.status||(t===e?f(e,n("qcycle","Expected promise to be resolved with value other than itself '{0}'",t)):function t(n,e){var i;var r=!1;try{(Te(e)||Se(e))&&(i=e.then),Se(i)?(n.$$state.status=-1,i.call(e,function o(e){if(r)return;r=!0,function t(n,e){var i;var r=!1;try{(Te(e)||Se(e))&&(i=e.then),Se(i)?(n.$$state.status=-1,i.call(e,o,a,function(e){m(n,e)})):(n.$$state.value=e,n.$$state.status=1,h(n.$$state))}catch(e){a(e)}function o(e){r||(r=!0,t(n,e))}function a(e){r||(r=!0,f(n,e))}}(n,e)},a,function(e){m(n,e)})):(n.$$state.value=e,n.$$state.status=1,h(n.$$state))}catch(e){a(e)}function o(e){r||(r=!0,t(n,e))}function a(e){r||(r=!0,f(n,e))}}(e,t))}function p(e,t){e.$$state.status||f(e,t)}function f(e,t){e.$$state.value=t,e.$$state.status=2,h(e.$$state)}function m(e,r){var o=e.$$state.pending;e.$$state.status<=0&&o&&o.length&&a(function(){for(var e,t,n=0,i=o.length;n<i;n++){t=o[n][0],e=o[n][3];try{m(t,Se(e)?e(r):r)}catch(e){s(e)}}})}function g(e){var t=new o;return p(t,e),t}function v(e,t,n){var i=null;try{Se(n)&&(i=n())}catch(e){return g(e)}return L(i)?i.then(function(){return t(e)},g):t(e)}function y(e,t,n,i){var r=new o;return d(r,e),r.then(t,n,i)}me(o.prototype,{then:function(e,t,n){if(xe(e)&&xe(t)&&xe(n))return this;var i=new o;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([i,e,t,n]),0<this.$$state.status&&h(this.$$state),i},catch:function(e){return this.then(null,e)},finally:function(t,e){return this.then(function(e){return v(e,x,t)},function(e){return v(e,g,t)},e)}});var x=y;function t(e){if(!Se(e))throw n("norslvr","Expected resolverFn, got '{0}'",e);var t=new o;return e(function(e){d(t,e)},function(e){p(t,e)}),t}return t.prototype=o.prototype,t.defer=r,t.reject=g,t.when=y,t.resolve=x,t.all=function(e){var n=new o,i=0,r=_e(e)?[]:{};return fe(e,function(e,t){i++,y(e).then(function(e){r[t]=e,--i||d(n,r)},function(e){p(n,e)})}),0===i&&d(n,r),n},t.race=function(e){var t=r();return fe(e,function(e){y(e).then(t.resolve,t.reject)}),t.promise},t}function Bi(e){return!!e.pur}function ki(e){e.pur=!0}function Vi(e){ki(e.$$state)}function zi(){this.$get=["$window","$timeout",function(e,n){var i=e.requestAnimationFrame||e.webkitRequestAnimationFrame,r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,t=!!i,o=t?function(e){var t=i(e);return function(){r(t)}}:function(e){var t=n(e,16.66,!1);return function(){n.cancel(t)}};return o.supported=t,o}]}function Gi(){var _=10,w=A("$rootScope"),S=null,M=null;this.digestTtl=function(e){return arguments.length&&(_=e),_},this.$get=["$exceptionHandler","$parse","$browser",function(d,f,p){function i(e){e.currentScope.$$destroyed=!0}function r(){this.$id=R(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,(this.$root=this).$$destroyed=!1,this.$$suspended=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}r.prototype={constructor:r,$new:function(e,t){var n;return t=t||this,e?(n=new r).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=R(),this.$$ChildScope=null,this.$$suspended=!1}return t.prototype=e,t}(this)),n=new this.$$ChildScope),n.$parent=t,n.$$prevSibling=t.$$childTail,t.$$childHead?(t.$$childTail.$$nextSibling=n,t.$$childTail=n):t.$$childHead=t.$$childTail=n,(e||t!==this)&&n.$on("$destroy",i),n},$watch:function(e,t,n,i){var r=f(e),o=Se(t)?t:ve;if(r.$$watchDelegate)return r.$$watchDelegate(this,o,n,r,e);var a=this,s=a.$$watchers,l={fn:o,last:T,get:r,exp:i||e,eq:!!n};return S=null,s||((s=a.$$watchers=[]).$$digestWatchIndex=-1),s.unshift(l),s.$$digestWatchIndex++,u(this,1),function(){var e=Pe(s,l);0<=e&&(u(a,-1),e<s.$$digestWatchIndex&&s.$$digestWatchIndex--),S=null}},$watchGroup:function(e,i){var r=new Array(e.length),o=new Array(e.length),a=[],s=this,l=!1,t=!0;if(!e.length){var n=!0;return s.$evalAsync(function(){n&&i(o,o,s)}),function(){n=!1}}if(1===e.length)return this.$watch(e[0],function(e,t,n){o[0]=e,r[0]=t,i(o,e===t?o:r,n)});function u(){l=!1,t?(t=!1,i(o,o,s)):i(o,r,s)}return fe(e,function(e,n){var t=s.$watch(e,function(e,t){o[n]=e,r[n]=t,l||(l=!0,s.$evalAsync(u))});a.push(t)}),function(){for(;a.length;)a.shift()()}},$watchCollection:function(e,n){p.$stateful=!0;var a,s,i,r=this,o=1<n.length,l=0,t=f(e,p),u=[],c={},h=!0,d=0;function p(e){var t,n,i,r;if(!xe(a=e)){if(Te(a))if(O(a)){s!==u&&(d=(s=u).length=0,l++),t=a.length,d!==t&&(l++,s.length=d=t);for(var o=0;o<t;o++)r=s[o],i=a[o],r!=r&&i!=i||r===i||(l++,s[o]=i)}else{for(n in s!==c&&(s=c={},d=0,l++),t=0,a)z.call(a,n)&&(t++,i=a[n],r=s[n],n in s?r!=r&&i!=i||r===i||(l++,s[n]=i):(d++,s[n]=i,l++));if(t<d)for(n in l++,s)z.call(a,n)||(d--,delete s[n])}else s!==a&&(s=a,l++);return l}}return this.$watch(t,function(){if(h?(h=!1,n(a,a,r)):n(a,i,r),o)if(Te(a))if(O(a)){i=new Array(a.length);for(var e=0;e<a.length;e++)i[e]=a[e]}else for(var t in i={},a)z.call(a,t)&&(i[t]=a[t]);else i=a})},$digest:function(){var e,t,n,i,r,o,a,s,l,u=_,c=[];x("$digest"),p.$$checkUrlChange(),this===m&&null!==M&&(p.defer.cancel(M),b()),S=null;do{r=!1,a=this;for(var h=0;h<g.length;h++){try{(0,(l=g[h]).fn)(l.scope,l.locals)}catch(e){d(e)}S=null}g.length=0;e:do{if(i=!a.$$suspended&&a.$$watchers)for(i.$$digestWatchIndex=i.length;i.$$digestWatchIndex--;)try{if(e=i[i.$$digestWatchIndex])if((t=(0,e.get)(a))===(n=e.last)||(e.eq?Ce(t,n):N(t)&&N(n))){if(e===S){r=!1;break e}}else r=!0,(S=e).last=e.eq?I(t,null):t,(0,e.fn)(t,n===T?t:n,a),u<5&&(c[s=4-u]||(c[s]=[]),c[s].push({msg:Se(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:t,oldVal:n}))}catch(e){d(e)}if(!(o=!a.$$suspended&&a.$$watchersCount&&a.$$childHead||a!==this&&a.$$nextSibling))for(;a!==this&&!(o=a.$$nextSibling);)a=a.$parent}while(a=o);if((r||g.length)&&!u--)throw E(),w("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",_,c)}while(r||g.length);for(E();y<v.length;)try{v[y++]()}catch(e){d(e)}v.length=y=0,p.$$checkUrlChange()},$suspend:function(){this.$$suspended=!0},$isSuspended:function(){return this.$$suspended},$resume:function(){this.$$suspended=!1},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;for(var t in this.$broadcast("$destroy"),this.$$destroyed=!0,this===m&&p.$$applicationDestroyed(),u(this,-this.$$watchersCount),this.$$listenerCount)o(this,this.$$listenerCount[t],t);e&&e.$$childHead===this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail===this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=ve,this.$on=this.$watch=this.$watchGroup=function(){return ve},this.$$listeners={},this.$$nextSibling=null,function e(t){9===he&&(t.$$childHead&&e(t.$$childHead),t.$$nextSibling&&e(t.$$nextSibling)),t.$parent=t.$$nextSibling=t.$$prevSibling=t.$$childHead=t.$$childTail=t.$root=t.$$watchers=null}(this)}},$eval:function(e,t){return f(e)(this,t)},$evalAsync:function(e,t){m.$$phase||g.length||p.defer(function(){g.length&&m.$digest()}),g.push({scope:this,fn:f(e),locals:t})},$$postDigest:function(e){v.push(e)},$apply:function(e){try{x("$apply");try{return this.$eval(e)}finally{E()}}catch(e){d(e)}finally{try{m.$digest()}catch(e){throw d(e),e}}},$applyAsync:function(e){var t=this;e&&n.push(function(){t.$eval(e)}),e=f(e),null===M&&(M=p.defer(function(){m.$apply(b)}))},$on:function(t,n){var i=this.$$listeners[t];i||(this.$$listeners[t]=i=[]),i.push(n);for(var e=this;e.$$listenerCount[t]||(e.$$listenerCount[t]=0),e.$$listenerCount[t]++,e=e.$parent;);var r=this;return function(){var e=i.indexOf(n);-1!==e&&(delete i[e],o(r,1,t))}},$emit:function(e,t){var n,i,r,o=[],a=this,s=!1,l={name:e,targetScope:a,stopPropagation:function(){s=!0},preventDefault:function(){l.defaultPrevented=!0},defaultPrevented:!1},u=B([l],arguments,1);do{for(n=a.$$listeners[e]||o,l.currentScope=a,i=0,r=n.length;i<r;i++)if(n[i])try{n[i].apply(null,u)}catch(e){d(e)}else n.splice(i,1),i--,r--;if(s)break;a=a.$parent}while(a);return l.currentScope=null,l},$broadcast:function(e,t){var n=this,i=this,r={name:e,targetScope:this,preventDefault:function(){r.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[e])return r;for(var o,a,s,l=B([r],arguments,1);n=i;){for(a=0,s=(o=(r.currentScope=n).$$listeners[e]||[]).length;a<s;a++)if(o[a])try{o[a].apply(null,l)}catch(e){d(e)}else o.splice(a,1),a--,s--;if(!(i=n.$$listenerCount[e]&&n.$$childHead||n!==this&&n.$$nextSibling))for(;n!==this&&!(i=n.$$nextSibling);)n=n.$parent}return r.currentScope=null,r}};var m=new r,g=m.$$asyncQueue=[],v=m.$$postDigestQueue=[],n=m.$$applyAsyncQueue=[],y=0;return m;function x(e){if(m.$$phase)throw w("inprog","{0} already in progress",m.$$phase);m.$$phase=e}function E(){m.$$phase=null}function u(e,t){for(;e.$$watchersCount+=t,e=e.$parent;);}function o(e,t,n){for(;e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n],e=e.$parent;);}function T(){}function b(){for(;n.length;)try{n.shift()()}catch(e){d(e)}M=null}}]}function ji(){var r=/^\s*(https?|s?ftp|mailto|tel|file):/,o=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(e){return Ee(e)?(r=e,this):r},this.imgSrcSanitizationWhitelist=function(e){return Ee(e)?(o=e,this):o},this.$get=function(){return function(e,t){var n,i=t?o:r;return""===(n=ar(e&&e.trim()).href)||n.match(i)?e:"unsafe:"+n}}}Ci.prototype={compile:function(e){var r=this;this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},Ri(e,r.$filter);var t,n="";if(this.stage="assign",t=Li(e)){this.state.computing="assign";var i=this.nextId();this.recurse(t,i),this.return_(i),n="fn.assign="+this.generateFunction("assign","s,v,l")}var o=Ni(e.body);r.stage="inputs",fe(o,function(e,t){var n="fn"+t;r.state[n]={vars:[],body:[],own:{}},r.state.computing=n;var i=r.nextId();r.recurse(e,i),r.return_(i),r.state.inputs.push({name:n,isPure:e.isPure}),e.watchId=t}),this.state.computing="fn",this.stage="main",this.recurse(e);var a='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+n+this.watchFns()+"return fn;",s=new Function("$filter","getStringValue","ifDefined","plus",a)(this.$filter,xi,wi,Si);return this.state=this.stage=void 0,s},USE:"use",STRICT:"strict",watchFns:function(){var t=[],e=this.state.inputs,n=this;return fe(e,function(e){t.push("var "+e.name+"="+n.generateFunction(e.name,"s")),e.isPure&&t.push(e.name,".isPure="+JSON.stringify(e.isPure)+";")}),e.length&&t.push("fn.inputs=["+e.map(function(e){return e.name}).join(",")+"];"),t.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var n=[],i=this;return fe(this.state.filters,function(e,t){n.push(e+"=$filter("+i.escape(t)+")")}),n.length?"var "+n.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(n,t,e,i,r,o){var a,s,l,u,c,h=this;if(i=i||ve,!o&&Ee(n.watchId))return t=t||this.nextId(),void this.if_("i",this.lazyAssign(t,this.computedMember("i",n.watchId)),this.lazyRecurse(n,t,e,i,r,!0));switch(n.type){case _i.Program:fe(n.body,function(e,t){h.recurse(e.expression,void 0,void 0,function(e){s=e}),t!==n.body.length-1?h.current().body.push(s,";"):h.return_(s)});break;case _i.Literal:u=this.escape(n.value),this.assign(t,u),i(t||u);break;case _i.UnaryExpression:this.recurse(n.argument,void 0,void 0,function(e){s=e}),u=n.operator+"("+this.ifDefined(s,0)+")",this.assign(t,u),i(u);break;case _i.BinaryExpression:this.recurse(n.left,void 0,void 0,function(e){a=e}),this.recurse(n.right,void 0,void 0,function(e){s=e}),u="+"===n.operator?this.plus(a,s):"-"===n.operator?this.ifDefined(a,0)+n.operator+this.ifDefined(s,0):"("+a+")"+n.operator+"("+s+")",this.assign(t,u),i(u);break;case _i.LogicalExpression:t=t||this.nextId(),h.recurse(n.left,t),h.if_("&&"===n.operator?t:h.not(t),h.lazyRecurse(n.right,t)),i(t);break;case _i.ConditionalExpression:t=t||this.nextId(),h.recurse(n.test,t),h.if_(t,h.lazyRecurse(n.alternate,t),h.lazyRecurse(n.consequent,t)),i(t);break;case _i.Identifier:t=t||this.nextId(),e&&(e.context="inputs"===h.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",n.name)+"?l:s"),e.computed=!1,e.name=n.name),h.if_("inputs"===h.stage||h.not(h.getHasOwnProperty("l",n.name)),function(){h.if_("inputs"===h.stage||"s",function(){r&&1!==r&&h.if_(h.isNull(h.nonComputedMember("s",n.name)),h.lazyAssign(h.nonComputedMember("s",n.name),"{}")),h.assign(t,h.nonComputedMember("s",n.name))})},t&&h.lazyAssign(t,h.nonComputedMember("l",n.name))),i(t);break;case _i.MemberExpression:a=e&&(e.context=this.nextId())||this.nextId(),t=t||this.nextId(),h.recurse(n.object,a,void 0,function(){h.if_(h.notNull(a),function(){n.computed?(s=h.nextId(),h.recurse(n.property,s),h.getStringValue(s),r&&1!==r&&h.if_(h.not(h.computedMember(a,s)),h.lazyAssign(h.computedMember(a,s),"{}")),u=h.computedMember(a,s),h.assign(t,u),e&&(e.computed=!0,e.name=s)):(r&&1!==r&&h.if_(h.isNull(h.nonComputedMember(a,n.property.name)),h.lazyAssign(h.nonComputedMember(a,n.property.name),"{}")),u=h.nonComputedMember(a,n.property.name),h.assign(t,u),e&&(e.computed=!1,e.name=n.property.name))},function(){h.assign(t,"undefined")}),i(t)},!!r);break;case _i.CallExpression:t=t||this.nextId(),n.filter?(s=h.filter(n.callee.name),l=[],fe(n.arguments,function(e){var t=h.nextId();h.recurse(e,t),l.push(t)}),u=s+"("+l.join(",")+")",h.assign(t,u),i(t)):(s=h.nextId(),a={},l=[],h.recurse(n.callee,s,a,function(){h.if_(h.notNull(s),function(){fe(n.arguments,function(e){h.recurse(e,n.constant?void 0:h.nextId(),void 0,function(e){l.push(e)})}),u=a.name?h.member(a.context,a.name,a.computed)+"("+l.join(",")+")":s+"("+l.join(",")+")",h.assign(t,u)},function(){h.assign(t,"undefined")}),i(t)}));break;case _i.AssignmentExpression:s=this.nextId(),a={},this.recurse(n.left,void 0,a,function(){h.if_(h.notNull(a.context),function(){h.recurse(n.right,s),u=h.member(a.context,a.name,a.computed)+n.operator+s,h.assign(t,u),i(t||u)})},1);break;case _i.ArrayExpression:l=[],fe(n.elements,function(e){h.recurse(e,n.constant?void 0:h.nextId(),void 0,function(e){l.push(e)})}),u="["+l.join(",")+"]",this.assign(t,u),i(t||u);break;case _i.ObjectExpression:c=!(l=[]),fe(n.properties,function(e){e.computed&&(c=!0)}),c?(t=t||this.nextId(),this.assign(t,"{}"),fe(n.properties,function(e){e.computed?(a=h.nextId(),h.recurse(e.key,a)):a=e.key.type===_i.Identifier?e.key.name:""+e.key.value,s=h.nextId(),h.recurse(e.value,s),h.assign(h.member(t,a,e.computed),s)})):(fe(n.properties,function(t){h.recurse(t.value,n.constant?void 0:h.nextId(),void 0,function(e){l.push(h.escape(t.key.type===_i.Identifier?t.key.name:""+t.key.value)+":"+e)})}),u="{"+l.join(",")+"}",this.assign(t,u)),i(t||u);break;case _i.ThisExpression:this.assign(t,"s"),i(t||"s");break;case _i.LocalsExpression:this.assign(t,"l"),i(t||"l");break;case _i.NGValueParameter:this.assign(t,"v"),i(t||"v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,i=this.current().own;return i.hasOwnProperty(n)||(i[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),i[n]},assign:function(e,t){if(e)return this.current().body.push(e,"=",t,";"),e},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(!0===e)t();else{var i=this.current().body;i.push("if(",e,"){"),t(),i.push("}"),n&&(i.push("else{"),n(),i.push("}"))}},not:function(e){return"!("+e+")"},isNull:function(e){return e+"==null"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(t)?e+"."+t:e+'["'+t.replace(/[^$_a-zA-Z0-9]/g,this.stringEscapeFn)+'"]'},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},getStringValue:function(e){this.assign(e,"getStringValue("+e+")")},lazyRecurse:function(e,t,n,i,r,o){var a=this;return function(){a.recurse(e,t,n,i,r,o)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(be(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(_(e))return e.toString();if(!0===e)return"true";if(!1===e)return"false";if(null===e)return"null";if(void 0===e)return"undefined";throw vi("esc","IMPOSSIBLE")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){return this.state[this.state.computing]}},Fi.prototype={compile:function(e){var t,i,r=this;Ri(e,r.$filter),(t=Li(e))&&(i=this.recurse(t));var o,n=Ni(e.body);n&&(o=[],fe(n,function(e,t){var n=r.recurse(e);n.isPure=e.isPure,e.input=n,o.push(n),e.watchId=t}));var a=[];fe(e.body,function(e){a.push(r.recurse(e.expression))});var s=0===e.body.length?ve:1===e.body.length?a[0]:function(t,n){var i;return fe(a,function(e){i=e(t,n)}),i};return i&&(s.assign=function(e,t,n){return i(e,n,t)}),o&&(s.inputs=o),s},recurse:function(e,l,t){var a,u,c,n=this;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case _i.Literal:return this.value(e.value,l);case _i.UnaryExpression:return u=this.recurse(e.argument),this["unary"+e.operator](u,l);case _i.BinaryExpression:case _i.LogicalExpression:return a=this.recurse(e.left),u=this.recurse(e.right),this["binary"+e.operator](a,u,l);case _i.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),l);case _i.Identifier:return n.identifier(e.name,l,t);case _i.MemberExpression:return a=this.recurse(e.object,!1,!!t),e.computed||(u=e.property.name),e.computed&&(u=this.recurse(e.property)),e.computed?this.computedMember(a,u,l,t):this.nonComputedMember(a,u,l,t);case _i.CallExpression:return c=[],fe(e.arguments,function(e){c.push(n.recurse(e))}),e.filter&&(u=this.$filter(e.callee.name)),e.filter||(u=this.recurse(e.callee,!0)),e.filter?function(e,t,n,i){for(var r=[],o=0;o<c.length;++o)r.push(c[o](e,t,n,i));var a=u.apply(void 0,r,i);return l?{context:void 0,name:void 0,value:a}:a}:function(e,t,n,i){var r,o=u(e,t,n,i);if(null!=o.value){for(var a=[],s=0;s<c.length;++s)a.push(c[s](e,t,n,i));r=o.value.apply(o.context,a)}return l?{value:r}:r};case _i.AssignmentExpression:return a=this.recurse(e.left,!0,1),u=this.recurse(e.right),function(e,t,n,i){var r=a(e,t,n,i),o=u(e,t,n,i);return r.context[r.name]=o,l?{value:o}:o};case _i.ArrayExpression:return c=[],fe(e.elements,function(e){c.push(n.recurse(e))}),function(e,t,n,i){for(var r=[],o=0;o<c.length;++o)r.push(c[o](e,t,n,i));return l?{value:r}:r};case _i.ObjectExpression:return c=[],fe(e.properties,function(e){e.computed?c.push({key:n.recurse(e.key),computed:!0,value:n.recurse(e.value)}):c.push({key:e.key.type===_i.Identifier?e.key.name:""+e.key.value,computed:!1,value:n.recurse(e.value)})}),function(e,t,n,i){for(var r={},o=0;o<c.length;++o)c[o].computed?r[c[o].key(e,t,n,i)]=c[o].value(e,t,n,i):r[c[o].key]=c[o].value(e,t,n,i);return l?{value:r}:r};case _i.ThisExpression:return function(e){return l?{value:e}:e};case _i.LocalsExpression:return function(e,t){return l?{value:t}:t};case _i.NGValueParameter:return function(e,t,n){return l?{value:n}:n}}},"unary+":function(o,a){return function(e,t,n,i){var r=o(e,t,n,i);return r=Ee(r)?+r:0,a?{value:r}:r}},"unary-":function(o,a){return function(e,t,n,i){var r=o(e,t,n,i);return r=Ee(r)?-r:-0,a?{value:r}:r}},"unary!":function(o,a){return function(e,t,n,i){var r=!o(e,t,n,i);return a?{value:r}:r}},"binary+":function(o,a,s){return function(e,t,n,i){var r=Si(o(e,t,n,i),a(e,t,n,i));return s?{value:r}:r}},"binary-":function(s,l,u){return function(e,t,n,i){var r=s(e,t,n,i),o=l(e,t,n,i),a=(Ee(r)?r:0)-(Ee(o)?o:0);return u?{value:a}:a}},"binary*":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)*a(e,t,n,i);return s?{value:r}:r}},"binary/":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)/a(e,t,n,i);return s?{value:r}:r}},"binary%":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)%a(e,t,n,i);return s?{value:r}:r}},"binary===":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)===a(e,t,n,i);return s?{value:r}:r}},"binary!==":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)!==a(e,t,n,i);return s?{value:r}:r}},"binary==":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)==a(e,t,n,i);return s?{value:r}:r}},"binary!=":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)!=a(e,t,n,i);return s?{value:r}:r}},"binary<":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)<a(e,t,n,i);return s?{value:r}:r}},"binary>":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)>a(e,t,n,i);return s?{value:r}:r}},"binary<=":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)<=a(e,t,n,i);return s?{value:r}:r}},"binary>=":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)>=a(e,t,n,i);return s?{value:r}:r}},"binary&&":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)&&a(e,t,n,i);return s?{value:r}:r}},"binary||":function(o,a,s){return function(e,t,n,i){var r=o(e,t,n,i)||a(e,t,n,i);return s?{value:r}:r}},"ternary?:":function(o,a,s,l){return function(e,t,n,i){var r=o(e,t,n,i)?a(e,t,n,i):s(e,t,n,i);return l?{value:r}:r}},value:function(e,t){return function(){return t?{context:void 0,name:void 0,value:e}:e}},identifier:function(a,s,l){return function(e,t,n,i){var r=t&&a in t?t:e;l&&1!==l&&r&&null==r[a]&&(r[a]={});var o=r?r[a]:void 0;return s?{context:r,name:a,value:o}:o}},computedMember:function(s,l,u,c){return function(e,t,n,i){var r,o,a=s(e,t,n,i);return null!=a&&(r=xi(r=l(e,t,n,i)),c&&1!==c&&a&&!a[r]&&(a[r]={}),o=a[r]),u?{context:a,name:r,value:o}:o}},nonComputedMember:function(a,s,l,u){return function(e,t,n,i){var r=a(e,t,n,i);u&&1!==u&&r&&null==r[s]&&(r[s]={});var o=null!=r?r[s]:void 0;return l?{context:r,name:s,value:o}:o}},inputs:function(r,o){return function(e,t,n,i){return i?i[o]:r(e,t,n)}}},Oi.prototype={constructor:Oi,parse:function(e){var t,n=this.getAst(e),i=this.astCompiler.compile(n.ast);return i.literal=0===(t=n.ast).body.length||1===t.body.length&&(t.body[0].expression.type===_i.Literal||t.body[0].expression.type===_i.ArrayExpression||t.body[0].expression.type===_i.ObjectExpression),i.constant=n.ast.constant,i.oneTime=n.oneTime,i},getAst:function(e){var t=!1;return":"===(e=e.trim()).charAt(0)&&":"===e.charAt(1)&&(t=!0,e=e.substring(2)),{ast:this.ast.ast(e),oneTime:t}}};var Wi=A("$sce"),Xi={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},qi=/_([a-z])/g;function Yi(e){return e.replace(qi,it)}function Ji(e){var t=[];return Ee(e)&&fe(e,function(e){t.push(function(e){if("self"===e)return e;if(be(e)){if(-1<e.indexOf("***"))throw Wi("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=F(e).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*"),new RegExp("^"+e+"$")}if(S(e))return new RegExp("^"+e.source+"$");throw Wi("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}(e))}),t}function Qi(){this.SCE_CONTEXTS=Xi;var a=["self"],s=[];this.resourceUrlWhitelist=function(e){return arguments.length&&(a=Ji(e)),a},this.resourceUrlBlacklist=function(e){return arguments.length&&(s=Ji(e)),s},this.$get=["$injector",function(e){var i=function(e){throw Wi("unsafe","Attempting to use an unsafe value in a safe context.")};function o(e,t){return"self"===e?sr(t,or):!!e.exec(t.href)}function t(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}e.has("$sanitize")&&(i=e.get("$sanitize"));var n=t(),r={};return r[Xi.HTML]=t(n),r[Xi.CSS]=t(n),r[Xi.URL]=t(n),r[Xi.JS]=t(n),r[Xi.RESOURCE_URL]=t(r[Xi.URL]),{trustAs:function(e,t){var n=r.hasOwnProperty(e)?r[e]:null;if(!n)throw Wi("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||xe(t)||""===t)return t;if("string"!=typeof t)throw Wi("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new n(t)},getTrusted:function(e,t){if(null===t||xe(t)||""===t)return t;var n=r.hasOwnProperty(e)?r[e]:null;if(n&&t instanceof n)return t.$$unwrapTrustedValue();if(e===Xi.RESOURCE_URL){if(function(e){var t,n,i=ar(e.toString()),r=!1;for(t=0,n=a.length;t<n;t++)if(o(a[t],i)){r=!0;break}if(r)for(t=0,n=s.length;t<n;t++)if(o(s[t],i)){r=!1;break}return r}(t))return t;throw Wi("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",t.toString())}if(e===Xi.HTML)return i(t);throw Wi("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(e){return e instanceof n?e.$$unwrapTrustedValue():e}}}]}function Zi(){var t=!0;this.enabled=function(e){return arguments.length&&(t=!!e),t},this.$get=["$parse","$sceDelegate",function(i,e){if(t&&he<8)throw Wi("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var r=qe(Xi);r.isEnabled=function(){return t},r.trustAs=e.trustAs,r.getTrusted=e.getTrusted,r.valueOf=e.valueOf,t||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=ye),r.parseAs=function(t,e){var n=i(e);return n.literal&&n.constant?n:i(e,function(e){return r.getTrusted(t,e)})};var o=r.parseAs,a=r.getTrusted,s=r.trustAs;return fe(Xi,function(t,e){var n=ce(e);r[Yi("parse_as_"+n)]=function(e){return o(t,e)},r[Yi("get_trusted_"+n)]=function(e){return a(t,e)},r[Yi("trust_as_"+n)]=function(e){return s(t,e)}}),r}]}function Ki(){this.$get=["$window","$document",function(e,t){var n={},i=!(!(e.nw&&e.nw.process)&&e.chrome&&(e.chrome.app&&e.chrome.app.runtime||!e.chrome.app&&e.chrome.runtime&&e.chrome.runtime.id))&&e.history&&e.history.pushState,r=E((/android (\d+)/.exec(ce((e.navigator||{}).userAgent))||[])[1]),o=/Boxee/i.test((e.navigator||{}).userAgent),a=t[0]||{},s=a.body&&a.body.style,l=!1,u=!1;return s&&(l=!!("transition"in s||"webkitTransition"in s),u=!!("animation"in s||"webkitAnimation"in s)),{history:!(!i||r<4||o),hasEvent:function(e){if("input"===e&&he)return!1;if(xe(n[e])){var t=a.createElement("div");n[e]="on"+e in t}return n[e]},csp:U(),transitions:l,animations:u,android:r}}]}var er=A("$compile");function tr(){var u;this.httpOptions=function(e){return e?(u=e,this):u},this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(i,r,o,a,s){function l(t,n){l.totalPendingRequests++,be(t)&&!xe(r.get(t))||(t=s.getTrustedResourceUrl(t));var e=o.defaults&&o.defaults.transformResponse;return _e(e)?e=e.filter(function(e){return e!==Bn}):e===Bn&&(e=null),o.get(t,me({cache:r,transformResponse:e},u)).finally(function(){l.totalPendingRequests--}).then(function(e){return r.put(t,e.data),e.data},function(e){n||(e=er("tpload","Failed to load template: {0} (HTTP status: {1} {2})",t,e.status,e.statusText),i(e));return a.reject(e)})}return l.totalPendingRequests=0,l}]}function nr(){this.$get=["$rootScope","$browser","$location",function(t,n,i){var e={findBindings:function(e,n,i){var t=e.getElementsByClassName("ng-binding"),r=[];return fe(t,function(t){var e=x.element(t).data("$binding");e&&fe(e,function(e){i?new RegExp("(^|\\s)"+F(n)+"(\\s|\\||$)").test(e)&&r.push(t):-1!==e.indexOf(n)&&r.push(t)})}),r},findModels:function(e,t,n){for(var i=["ng-","data-ng-","ng\\:"],r=0;r<i.length;++r){var o="["+i[r]+"model"+(n?"=":"*=")+'"'+t+'"]',a=e.querySelectorAll(o);if(a.length)return a}},getLocation:function(){return i.url()},setLocation:function(e){e!==i.url()&&(i.url(e),t.$digest())},whenStable:function(e){n.notifyWhenNoOutstandingRequests(e)}};return e}]}function ir(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(l,u,c,h,d){var p={};function e(e,t,n){Se(e)||(n=t,t=e,e=ve);var i,r=Fe(arguments,3),o=Ee(n)&&!n,a=(o?h:c).defer(),s=a.promise;return i=u.defer(function(){try{a.resolve(e.apply(null,r))}catch(e){a.reject(e),d(e)}finally{delete p[s.$$timeoutId]}o||l.$apply()},t),s.$$timeoutId=i,p[i]=a,s}return e.cancel=function(e){return!!(e&&e.$$timeoutId in p)&&(Vi(p[e.$$timeoutId].promise),p[e.$$timeoutId].reject("canceled"),delete p[e.$$timeoutId],u.defer.cancel(e.$$timeoutId))},e}]}var rr=V.document.createElement("a"),or=ar(V.location.href);function ar(e){if(!be(e))return e;var t=e;return he&&(rr.setAttribute("href",t),t=rr.href),rr.setAttribute("href",t),{href:rr.href,protocol:rr.protocol?rr.protocol.replace(/:$/,""):"",host:rr.host,search:rr.search?rr.search.replace(/^\?/,""):"",hash:rr.hash?rr.hash.replace(/^#/,""):"",hostname:rr.hostname,port:rr.port,pathname:"/"===rr.pathname.charAt(0)?rr.pathname:"/"+rr.pathname}}function sr(e,t){return e=ar(e),t=ar(t),e.protocol===t.protocol&&e.host===t.host}function lr(){this.$get=M(V)}function ur(e){var a=e[0]||{},s={},l="";function u(t){try{return decodeURIComponent(t)}catch(e){return t}}return function(){var e,t,n,i,r,o=function(e){try{return e.cookie||""}catch(e){return""}}(a);if(o!==l)for(e=(l=o).split("; "),s={},n=0;n<e.length;n++)0<(i=(t=e[n]).indexOf("="))&&(r=u(t.substring(0,i)),xe(s[r])&&(s[r]=u(t.substring(i+1))));return s}}function cr(){this.$get=ur}function hr(i){var r="Filter";function o(e,t){if(Te(e)){var n={};return fe(e,function(e,t){n[t]=o(t,e)}),n}return i.factory(e+r,t)}this.register=o,this.$get=["$injector",function(t){return function(e){return t.get(e+r)}}],o("currency",yr),o("date",Pr),o("filter",dr),o("json",Lr),o("limitTo",Or),o("lowercase",Cr),o("number",xr),o("orderBy",Hr),o("uppercase",Fr)}function dr(){return function(e,t,n,i){if(!O(e)){if(null==e)return e;throw A("filter")("notarray","Expected array but received: {0}",e)}var r,o;switch(i=i||"$",fr(t)){case"function":r=t;break;case"boolean":case"null":case"number":case"string":o=!0;case"object":r=function(t,n,i,r){var o=Te(t)&&i in t;!0===n?n=Ce:Se(n)||(n=function(e,t){return!xe(e)&&(null===e||null===t?e===t:!(Te(t)||Te(e)&&!T(e))&&(e=ce(""+e),t=ce(""+t),-1!==e.indexOf(t)))});return function(e){return o&&!Te(e)?pr(e,t[i],n,i,!1):pr(e,t,n,i,r)}}(t,n,i,o);break;default:return e}return Array.prototype.filter.call(e,r)}}function pr(e,t,n,i,r,o){var a=fr(e),s=fr(t);if("string"===s&&"!"===t.charAt(0))return!pr(e,t.substring(1),n,i,r);if(_e(e))return e.some(function(e){return pr(e,t,n,i,r)});switch(a){case"object":var l;if(r){for(l in e)if(l.charAt&&"$"!==l.charAt(0)&&pr(e[l],t,n,i,!0))return!0;return!o&&pr(e,t,n,i,!1)}if("object"===s){for(l in t){var u=t[l];if(!Se(u)&&!xe(u)){var c=l===i;if(!pr(c?e:e[l],u,n,i,c,c))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function fr(e){return null===e?"null":typeof e}ur.$inject=["$document"],hr.$inject=["$provide"];var mr=22,gr=".",vr="0";function yr(e){var r=e.NUMBER_FORMATS;return function(e,t,n){xe(t)&&(t=r.CURRENCY_SYM),xe(n)&&(n=r.PATTERNS[1].maxFrac);var i=t?/\u00A4/g:/\s*\u00A4\s*/g;return null==e?e:Er(e,r.PATTERNS[1],r.GROUP_SEP,r.DECIMAL_SEP,n).replace(i,t)}}function xr(e){var n=e.NUMBER_FORMATS;return function(e,t){return null==e?e:Er(e,n.PATTERNS[0],n.GROUP_SEP,n.DECIMAL_SEP,t)}}function Er(e,t,n,i,r){if(!be(e)&&!_(e)||isNaN(e))return"";var o,a=!isFinite(e),s=!1,l=Math.abs(e)+"",u="";if(a)u="∞";else{(function(e,t,n,i){var r=e.d,o=r.length-e.i,a=(t=xe(t)?Math.min(Math.max(n,o),i):+t)+e.i,s=r[a];if(0<a){r.splice(Math.max(e.i,a));for(var l=a;l<r.length;l++)r[l]=0}else{o=Math.max(0,o),e.i=1,r.length=Math.max(1,a=t+1),r[0]=0;for(var u=1;u<a;u++)r[u]=0}if(5<=s)if(a-1<0){for(var c=0;a<c;c--)r.unshift(0),e.i++;r.unshift(1),e.i++}else r[a-1]++;for(;o<Math.max(0,t);o++)r.push(0);var h=r.reduceRight(function(e,t,n,i){return t+=e,i[n]=t%10,Math.floor(t/10)},0);h&&(r.unshift(h),e.i++)})(o=function(e){var t,n,i,r,o,a=0;for(-1<(n=e.indexOf(gr))&&(e=e.replace(gr,"")),0<(i=e.search(/e/i))?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charAt(i)===vr;i++);if(i===(o=e.length))t=[0],n=1;else{for(o--;e.charAt(o)===vr;)o--;for(n-=i,t=[],r=0;i<=o;i++,r++)t[r]=+e.charAt(i)}return mr<n&&(t=t.splice(0,mr-1),a=n-1,n=1),{d:t,e:a,i:n}}(l),r,t.minFrac,t.maxFrac);var c=o.d,h=o.i,d=o.e,p=[];for(s=c.reduce(function(e,t){return e&&!t},!0);h<0;)c.unshift(0),h++;0<h?p=c.splice(h,c.length):(p=c,c=[0]);var f=[];for(c.length>=t.lgSize&&f.unshift(c.splice(-t.lgSize,c.length).join(""));c.length>t.gSize;)f.unshift(c.splice(-t.gSize,c.length).join(""));c.length&&f.unshift(c.join("")),u=f.join(n),p.length&&(u+=i+p.join("")),d&&(u+="e+"+d)}return e<0&&!s?t.negPre+u+t.negSuf:t.posPre+u+t.posSuf}function Tr(e,t,n,i){var r="";for((e<0||i&&e<=0)&&(i?e=1-e:(e=-e,r="-")),e=""+e;e.length<t;)e=vr+e;return n&&(e=e.substr(e.length-t)),r+e}function br(n,i,r,o,a){return r=r||0,function(e){var t=e["get"+n]();return(0<r||-r<t)&&(t+=r),0===t&&-12===r&&(t=12),Tr(t,i,o,a)}}function _r(i,r,o){return function(e,t){var n=e["get"+i]();return t[d((o?"STANDALONE":"")+(r?"SHORT":"")+i)][n]}}function wr(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function Sr(r){return function(e){var t,n=wr(e.getFullYear()),i=+(t=e,new Date(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay())))-+n;return Tr(1+Math.round(i/6048e5),r)}}function Mr(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}yr.$inject=["$locale"];var Ar={yyyy:br("FullYear",4,0,!(xr.$inject=["$locale"]),!0),yy:br("FullYear",2,0,!0,!0),y:br("FullYear",1,0,!1,!0),MMMM:_r("Month"),MMM:_r("Month",!0),MM:br("Month",2,1),M:br("Month",1,1),LLLL:_r("Month",!1,!0),dd:br("Date",2),d:br("Date",1),HH:br("Hours",2),H:br("Hours",1),hh:br("Hours",2,-12),h:br("Hours",1,-12),mm:br("Minutes",2),m:br("Minutes",1),ss:br("Seconds",2),s:br("Seconds",1),sss:br("Milliseconds",3),EEEE:_r("Day"),EEE:_r("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e,t,n){var i=-1*n,r=0<=i?"+":"";return r+=Tr(Math[0<i?"floor":"ceil"](i/60),2)+Tr(Math.abs(i%60),2)},ww:Sr(2),w:Sr(1),G:Mr,GG:Mr,GGG:Mr,GGGG:function(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}},Rr=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,Nr=/^-?\d+$/;function Pr(l){var h=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(t,e,n){var i,r,o="",a=[];if(e=e||"mediumDate",e=l.DATETIME_FORMATS[e]||e,be(t)&&(t=Nr.test(t)?E(t):function(e){var t;if(t=e.match(h)){var n=new Date(0),i=0,r=0,o=t[8]?n.setUTCFullYear:n.setFullYear,a=t[8]?n.setUTCHours:n.setHours;t[9]&&(i=E(t[9]+t[10]),r=E(t[9]+t[11])),o.call(n,E(t[1]),E(t[2])-1,E(t[3]));var s=E(t[4]||0)-i,l=E(t[5]||0)-r,u=E(t[6]||0),c=Math.round(1e3*parseFloat("0."+(t[7]||0)));return a.call(n,s,l,u,c),n}return e}(t)),_(t)&&(t=new Date(t)),!w(t)||!isFinite(t.getTime()))return t;for(;e;)(r=Rr.exec(e))?e=(a=B(a,r,1)).pop():(a.push(e),e=null);var s=t.getTimezoneOffset();return n&&(s=X(n,s),t=Y(t,n,!0)),fe(a,function(e){i=Ar[e],o+=i?i(t,l.DATETIME_FORMATS,s):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),o}}function Lr(){return function(e,t){return xe(t)&&(t=2),G(e,t)}}Pr.$inject=["$locale"];var Cr=M(ce),Fr=M(d);function Or(){return function(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):E(t),N(t)?e:(_(e)&&(e=e.toString()),O(e)?(n=(n=!n||isNaN(n)?0:E(n))<0?Math.max(0,e.length+n):n,0<=t?$r(e,n,n+t):0===n?$r(e,t,e.length):$r(e,Math.max(0,n+t),n)):e)}}function $r(e,t,n){return be(e)?e.slice(t,n):s.call(e,t,n)}function Hr(l){return function(e,t,n,i){if(null==e)return e;if(!O(e))throw A("orderBy")("notarray","Expected array but received: {0}",e);_e(t)||(t=[t]),0===t.length&&(t=["+"]);var o=t.map(function(e){var t=1,n=ye;if(Se(e))n=e;else if(be(e)&&("+"!==e.charAt(0)&&"-"!==e.charAt(0)||(t="-"===e.charAt(0)?-1:1,e=e.substring(1)),""!==e&&(n=l(e)).constant)){var i=n();n=function(e){return e[i]}}return{get:n,descending:t}}),a=n?-1:1,s=Se(i)?i:c,r=Array.prototype.map.call(e,function(t,n){return{value:t,tieBreaker:{value:n,type:"number",index:n},predicateValues:o.map(function(e){return function(e,t){var n=typeof e;null===e?(n="string",e="null"):"object"===n&&(e=function(e){if(Se(e.valueOf)&&u(e=e.valueOf()))return e;if(T(e)&&u(e=e.toString()))return e;return e}(e));return{value:e,type:n,index:t}}(e.get(t),n)})}});return r.sort(function(e,t){for(var n=0,i=o.length;n<i;n++){var r=s(e.predicateValues[n],t.predicateValues[n]);if(r)return r*o[n].descending*a}return(s(e.tieBreaker,t.tieBreaker)||c(e.tieBreaker,t.tieBreaker))*a}),e=r.map(function(e){return e.value})};function u(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function c(e,t){var n=0,i=e.type,r=t.type;if(i===r){var o=e.value,a=t.value;"string"===i?(o=o.toLowerCase(),a=a.toLowerCase()):"object"===i&&(Te(o)&&(o=e.index),Te(a)&&(a=t.index)),o!==a&&(n=o<a?-1:1)}else n=i<r?-1:1;return n}}function Ir(e){return Se(e)&&(e={link:e}),e.restrict=e.restrict||"AC",M(e)}Hr.$inject=["$parse"];var Ur=M({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===pe.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}}),Dr={};fe(Lt,function(e,i){if("multiple"!==e){var r=Tn("ng-"+i),t=o;"checked"===e&&(t=function(e,t,n){n.ngModel!==n[r]&&o(e,0,n)}),Dr[r]=function(){return{restrict:"A",priority:100,link:t}}}function o(e,t,n){e.$watch(n[r],function(e){n.$set(i,!!e)})}}),fe(Ft,function(e,r){Dr[r]=function(){return{priority:100,link:function(e,t,n){if("ngPattern"===r&&"/"===n.ngPattern.charAt(0)){var i=n.ngPattern.match(o);if(i)return void n.$set("ngPattern",new RegExp(i[1],i[2]))}e.$watch(n[r],function(e){n.$set(r,e)})}}}}),fe(["src","srcset","href"],function(o){var a=Tn("ng-"+o);Dr[a]=function(){return{priority:99,link:function(e,t,n){var i=o,r=o;"href"===o&&"[object SVGAnimatedString]"===pe.call(t.prop("href"))&&(r="xlinkHref",n.$attr[r]="xlink:href",i=null),n.$observe(a,function(e){e?(n.$set(r,e),he&&i&&t.prop(i,n[r])):"href"===o&&n.$set(r,null)})}}}});var Br={$addControl:ve,$$renameControl:function(e,t){e.$name=t},$removeControl:ve,$setValidity:ve,$setDirty:ve,$setPristine:ve,$setSubmitted:ve},kr="ng-pending",Vr="ng-submitted";function zr(e,t,n,i,r){this.$$controls=[],this.$error={},this.$$success={},this.$pending=void 0,this.$name=r(t.name||t.ngForm||"")(n),this.$dirty=!1,this.$pristine=!0,this.$valid=!0,this.$invalid=!1,this.$submitted=!1,this.$$parentForm=Br,this.$$element=e,this.$$animate=i,Xr(this)}zr.$inject=["$element","$attrs","$scope","$animate","$interpolate"],zr.prototype={$rollbackViewValue:function(){fe(this.$$controls,function(e){e.$rollbackViewValue()})},$commitViewValue:function(){fe(this.$$controls,function(e){e.$commitViewValue()})},$addControl:function(e){Ue(e.$name,"input"),this.$$controls.push(e),e.$name&&(this[e.$name]=e),e.$$parentForm=this},$$renameControl:function(e,t){var n=e.$name;this[n]===e&&delete this[n],(this[t]=e).$name=t},$removeControl:function(n){n.$name&&this[n.$name]===n&&delete this[n.$name],fe(this.$pending,function(e,t){this.$setValidity(t,null,n)},this),fe(this.$error,function(e,t){this.$setValidity(t,null,n)},this),fe(this.$$success,function(e,t){this.$setValidity(t,null,n)},this),Pe(this.$$controls,n),n.$$parentForm=Br},$setDirty:function(){this.$$animate.removeClass(this.$$element,Vo),this.$$animate.addClass(this.$$element,zo),this.$dirty=!0,this.$pristine=!1,this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,Vo,zo+" "+Vr),this.$dirty=!1,this.$pristine=!0,this.$submitted=!1,fe(this.$$controls,function(e){e.$setPristine()})},$setUntouched:function(){fe(this.$$controls,function(e){e.$setUntouched()})},$setSubmitted:function(){this.$$animate.addClass(this.$$element,Vr),this.$submitted=!0,this.$$parentForm.$setSubmitted()}},qr({clazz:zr,set:function(e,t,n){var i=e[t];i?-1===i.indexOf(n)&&i.push(n):e[t]=[n]},unset:function(e,t,n){var i=e[t];i&&(Pe(i,n),0===i.length&&delete e[t])}});var Gr=function(n){return["$timeout","$parse",function(l,t){return{name:"form",restrict:n?"EAC":"E",require:["form","^^?form"],controller:zr,compile:function(e,t){e.addClass(Vo).addClass(Bo);var s=t.name?"name":!(!n||!t.ngForm)&&"ngForm";return{pre:function(t,e,n,i){var r=i[0];if(!("action"in n)){var o=function(e){t.$apply(function(){r.$commitViewValue(),r.$setSubmitted()}),e.preventDefault()};e[0].addEventListener("submit",o),e.on("$destroy",function(){l(function(){e[0].removeEventListener("submit",o)},0,!1)})}(i[1]||r.$$parentForm).$addControl(r);var a=s?u(r.$name):ve;s&&(a(t,r),n.$observe(s,function(e){r.$name!==e&&(a(t,void 0),r.$$parentForm.$$renameControl(r,e),(a=u(r.$name))(t,r))})),e.on("$destroy",function(){r.$$parentForm.$removeControl(r),a(t,void 0),me(r,Br)})}}}};function u(e){return""===e?t('this[""]').assign:t(e).assign||ve}}]},jr=Gr(),Wr=Gr(!0);function Xr(e){e.$$classCache={},e.$$classCache[ko]=!(e.$$classCache[Bo]=e.$$element.hasClass(Bo))}function qr(e){var t=e.clazz,r=e.set,o=e.unset;function a(e,t,n){n&&!e.$$classCache[t]?(e.$$animate.addClass(e.$$element,t),e.$$classCache[t]=!0):!n&&e.$$classCache[t]&&(e.$$animate.removeClass(e.$$element,t),e.$$classCache[t]=!1)}function s(e,t,n){t=t?"-"+He(t,"-"):"",a(e,Bo+t,!0===n),a(e,ko+t,!1===n)}t.prototype.$setValidity=function(e,t,n){var i;xe(t)?function(e,t,n,i){e[t]||(e[t]={});r(e[t],n,i)}(this,"$pending",e,n):function(e,t,n,i){e[t]&&o(e[t],n,i);Yr(e[t])&&(e[t]=void 0)}(this,"$pending",e,n),Ae(t)?t?(o(this.$error,e,n),r(this.$$success,e,n)):(r(this.$error,e,n),o(this.$$success,e,n)):(o(this.$error,e,n),o(this.$$success,e,n)),this.$pending?(a(this,kr,!0),this.$valid=this.$invalid=void 0,s(this,"",null)):(a(this,kr,!1),this.$valid=Yr(this.$error),this.$invalid=!this.$valid,s(this,"",this.$valid)),s(this,e,i=this.$pending&&this.$pending[e]?void 0:!this.$error[e]&&(!!this.$$success[e]||null)),this.$$parentForm.$setValidity(e,i,this)}}function Yr(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Jr=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,Qr=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,Zr=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,Kr=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,eo=/^(\d{4,})-(\d{2})-(\d{2})$/,to=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,no=/^(\d{4,})-W(\d\d)$/,io=/^(\d{4,})-(\d\d)$/,ro=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,oo="keydown wheel mousedown",ao=ke();fe("date,datetime-local,month,time,week".split(","),function(e){ao[e]=!0});var so={text:function(e,t,n,i,r,o){uo(e,t,n,i,r,o),lo(i)},date:ho("date",eo,co(eo,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":ho("datetimelocal",to,co(to,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:ho("time",ro,co(ro,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:ho("week",no,function(e,t){if(w(e))return e;if(be(e)){no.lastIndex=0;var n=no.exec(e);if(n){var i=+n[1],r=+n[2],o=0,a=0,s=0,l=0,u=wr(i),c=7*(r-1);return t&&(o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds()),new Date(i,0,u.getDate()+c,o,a,s,l)}}return NaN},"yyyy-Www"),month:ho("month",io,co(io,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,i,r,o){var a,s;po(e,t,n,i),fo(i),uo(e,t,n,i,r,o),(Ee(n.min)||n.ngMin)&&(i.$validators.min=function(e){return i.$isEmpty(e)||xe(a)||a<=e},n.$observe("min",function(e){a=mo(e),i.$validate()}));(Ee(n.max)||n.ngMax)&&(i.$validators.max=function(e){return i.$isEmpty(e)||xe(s)||e<=s},n.$observe("max",function(e){s=mo(e),i.$validate()}));if(Ee(n.step)||n.ngStep){var l;i.$validators.step=function(e,t){return i.$isEmpty(t)||xe(l)||yo(t,a||0,l)},n.$observe("step",function(e){l=mo(e),i.$validate()})}},url:function(e,t,n,i,r,o){uo(e,t,n,i,r,o),lo(i),i.$$parserName="url",i.$validators.url=function(e,t){var n=e||t;return i.$isEmpty(n)||Qr.test(n)}},email:function(e,t,n,i,r,o){uo(e,t,n,i,r,o),lo(i),i.$$parserName="email",i.$validators.email=function(e,t){var n=e||t;return i.$isEmpty(n)||Zr.test(n)}},radio:function(e,n,i,r){var o=!i.ngTrim||"false"!==Re(i.ngTrim);xe(i.name)&&n.attr("name",R());n.on("click",function(e){var t;n[0].checked&&(t=i.value,o&&(t=Re(t)),r.$setViewValue(t,e&&e.type))}),r.$render=function(){var e=i.value;o&&(e=Re(e)),n[0].checked=e===r.$viewValue},i.$observe("value",r.$render)},range:function(e,n,i,r,t,o){po(e,n,i,r),fo(r),uo(e,n,i,r,t,o);var a=r.$$hasNativeValidators&&"range"===n[0].type,s=a?0:void 0,l=a?100:void 0,u=a?1:void 0,c=n[0].validity,h=Ee(i.min),d=Ee(i.max),p=Ee(i.step),f=r.$render;r.$render=a&&Ee(c.rangeUnderflow)&&Ee(c.rangeOverflow)?function(){f(),r.$setViewValue(n.val())}:f,h&&(r.$validators.min=a?function(){return!0}:function(e,t){return r.$isEmpty(t)||xe(s)||s<=t},m("min",function(e){if(s=mo(e),N(r.$modelValue))return;if(a){var t=n.val();t<s&&(t=s,n.val(t)),r.$setViewValue(t)}else r.$validate()}));d&&(r.$validators.max=a?function(){return!0}:function(e,t){return r.$isEmpty(t)||xe(l)||t<=l},m("max",function(e){if(l=mo(e),N(r.$modelValue))return;if(a){var t=n.val();l<t&&(n.val(l),t=l<s?s:l),r.$setViewValue(t)}else r.$validate()}));p&&(r.$validators.step=a?function(){return!c.stepMismatch}:function(e,t){return r.$isEmpty(t)||xe(u)||yo(t,s||0,u)},m("step",function(e){if(u=mo(e),N(r.$modelValue))return;a&&r.$viewValue!==n.val()?r.$setViewValue(n.val()):r.$validate()}));function m(e,t){n.attr(e,i[e]),i.$observe(e,t)}},checkbox:function(e,t,n,i,r,o,a,s){var l=xo(s,e,"ngTrueValue",n.ngTrueValue,!0),u=xo(s,e,"ngFalseValue",n.ngFalseValue,!1);t.on("click",function(e){i.$setViewValue(t[0].checked,e&&e.type)}),i.$render=function(){t[0].checked=i.$viewValue},i.$isEmpty=function(e){return!1===e},i.$formatters.push(function(e){return Ce(e,l)}),i.$parsers.push(function(e){return e?l:u})},hidden:ve,button:ve,submit:ve,reset:ve,file:ve};function lo(t){t.$formatters.push(function(e){return t.$isEmpty(e)?e:e.toString()})}function uo(e,i,r,o,t,a){var s,l=ce(i[0].type);if(!t.android){var u=!1;i.on("compositionstart",function(){u=!0}),i.on("compositionupdate",function(e){(xe(e.data)||""===e.data)&&(u=!1)}),i.on("compositionend",function(){u=!1,c()})}var c=function(e){if(s&&(a.defer.cancel(s),s=null),!u){var t=i.val(),n=e&&e.type;"password"===l||r.ngTrim&&"false"===r.ngTrim||(t=Re(t)),(o.$viewValue!==t||""===t&&o.$$hasNativeValidators)&&o.$setViewValue(t,n)}};if(t.hasEvent("input"))i.on("input",c);else{var n=function(e,t,n){s||(s=a.defer(function(){s=null,t&&t.value===n||c(e)}))};i.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||n(e,this,this.value)}),t.hasEvent("paste")&&i.on("paste cut drop",n)}i.on("change",c),ao[l]&&o.$$hasNativeValidators&&l===r.type&&i.on(oo,function(e){if(!s){var t=this[h],n=t.badInput,i=t.typeMismatch;s=a.defer(function(){s=null,t.badInput===n&&t.typeMismatch===i||c(e)})}}),o.$render=function(){var e=o.$isEmpty(o.$viewValue)?"":o.$viewValue;i.val()!==e&&i.val(e)}}function co(r,o){return function(e,t){var n,i;if(w(e))return e;if(be(e)){if('"'===e.charAt(0)&&'"'===e.charAt(e.length-1)&&(e=e.substring(1,e.length-1)),Jr.test(e))return new Date(e);if(r.lastIndex=0,n=r.exec(e))return n.shift(),i=t?{yyyy:t.getFullYear(),MM:t.getMonth()+1,dd:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds(),sss:t.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},fe(n,function(e,t){t<o.length&&(i[o[t]]=+e)}),new Date(i.yyyy,i.MM-1,i.dd,i.HH,i.mm,i.ss||0,1e3*i.sss||0)}return NaN}}function ho(f,m,g,v){return function(e,t,n,r,i,o,a){var s,l,u,c;(po(e,t,n,r),uo(0,t,n,r,i,o),r.$$parserName=f,r.$parsers.push(function(e){return r.$isEmpty(e)?null:m.test(e)?p(e,s):void 0}),r.$formatters.push(function(e){if(e&&!w(e))throw Xo("datefmt","Expected `{0}` to be a date",e);if(h(e)){s=e;var t=r.$options.getOption("timezone");return t&&(s=Y(s,l=t,!0)),a("date")(e,v,t)}return l=s=null,""}),Ee(n.min)||n.ngMin)&&(r.$validators.min=function(e){return!h(e)||xe(u)||g(e)>=u},n.$observe("min",function(e){u=d(e),r.$validate()}));(Ee(n.max)||n.ngMax)&&(r.$validators.max=function(e){return!h(e)||xe(c)||g(e)<=c},n.$observe("max",function(e){c=d(e),r.$validate()}));function h(e){return e&&!(e.getTime&&e.getTime()!=e.getTime())}function d(e){return Ee(e)&&!w(e)?p(e)||void 0:e}function p(e,t){var n=r.$options.getOption("timezone");l&&l!==n&&(t=q(t,X(l)));var i=g(e,t);return!isNaN(i)&&n&&(i=Y(i,n)),i}}}function po(e,n,t,i){var r=n[0];(i.$$hasNativeValidators=Te(r.validity))&&i.$parsers.push(function(e){var t=n.prop(h)||{};return t.badInput||t.typeMismatch?void 0:e})}function fo(t){t.$$parserName="number",t.$parsers.push(function(e){return t.$isEmpty(e)?null:Kr.test(e)?parseFloat(e):void 0}),t.$formatters.push(function(e){if(!t.$isEmpty(e)){if(!_(e))throw Xo("numfmt","Expected `{0}` to be a number",e);e=e.toString()}return e})}function mo(e){return Ee(e)&&!_(e)&&(e=parseFloat(e)),N(e)?void 0:e}function go(e){return(0|e)===e}function vo(e){var t=e.toString(),n=t.indexOf(".");if(-1===n){if(-1<e&&e<1){var i=/e-(\d+)$/.exec(t);if(i)return Number(i[1])}return 0}return t.length-n-1}function yo(e,t,n){var i=Number(e),r=!go(i),o=!go(t),a=!go(n);if(r||o||a){var s=r?vo(i):0,l=o?vo(t):0,u=a?vo(n):0,c=Math.max(s,l,u),h=Math.pow(10,c);i*=h,t*=h,n*=h,r&&(i=Math.round(i)),o&&(t=Math.round(t)),a&&(n=Math.round(n))}return(i-t)%n==0}function xo(e,t,n,i,r){var o;if(Ee(i)){if(!(o=e(i)).constant)throw Xo("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,i);return o(t)}return r}var Eo=["$browser","$sniffer","$filter","$parse",function(r,o,a,s){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,t,n,i){i[0]&&(so[ce(n.type)]||so.text)(e,t,n,i[0],o,r,a,s)}}}}],To=/^(true|false|\d+)$/,bo=function(){function i(e,t,n){var i=Ee(n)?n:9===he?"":null;e.prop("value",i),t.$set("value",n)}return{restrict:"A",priority:100,compile:function(e,t){return To.test(t.ngValue)?function(e,t,n){i(t,n,e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){i(t,n,e)})}}}},_o=["$compile",function(i){return{restrict:"AC",compile:function(e){return i.$$addBindingClass(e),function(e,t,n){i.$$addBindingInfo(t,n.ngBind),t=t[0],e.$watch(n.ngBind,function(e){t.textContent=Ve(e)})}}}}],wo=["$interpolate","$compile",function(r,o){return{compile:function(e){return o.$$addBindingClass(e),function(e,t,n){var i=r(t.attr(n.$attr.ngBindTemplate));o.$$addBindingInfo(t,i.expressions),t=t[0],n.$observe("ngBindTemplate",function(e){t.textContent=xe(e)?"":e})}}}}],So=["$sce","$parse","$compile",function(o,n,a){return{restrict:"A",compile:function(e,t){var i=n(t.ngBindHtml),r=n(t.ngBindHtml,function(e){return o.valueOf(e)});return a.$$addBindingClass(e),function(t,n,e){a.$$addBindingInfo(n,e.ngBindHtml),t.$watch(r,function(){var e=i(t);n.html(o.getTrustedHtml(e)||"")})}}}}],Mo=M({restrict:"A",require:"ngModel",link:function(e,t,n,i){i.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}});function Ao(p,f){var m;return p="ngClass"+p,["$parse",function(d){return{restrict:"AC",link:function(e,t,l){var u,n=l[p].trim(),i=":"===n.charAt(0)&&":"===n.charAt(1),r=d(n,i?x:y),o=i?function(e){var t=y(e);t!==u&&s(t)}:s,a=t.data("$classCounts"),c=!0;function h(e,t){var n=[];return fe(e,function(e){(0<t||a[e])&&(a[e]=(a[e]||0)+t,a[e]===+(0<t)&&n.push(e))}),n.join(" ")}function s(e){var t,n,i,r,o,a,s;c===f&&(t=e,n=v(u),i=v(t),r=g(n,i),o=g(i,n),a=h(r,-1),s=h(o,1),l.$addClass(s),l.$removeClass(a)),u=e}a||(a=ke(),t.data("$classCounts",a)),"ngClass"!==p&&(m||(m=d("$index",function(e){return 1&e})),e.$watch(m,function(e){e===f?(n=h(v(n=u),1),l.$addClass(n)):(t=h(v(t=u),-1),l.$removeClass(t));var t;var n;c=e})),e.$watch(r,o,i)}}}];function g(e,t){if(!e||!e.length)return[];if(!t||!t.length)return e;var n=[];e:for(var i=0;i<e.length;i++){for(var r=e[i],o=0;o<t.length;o++)if(r===t[o])continue e;n.push(r)}return n}function v(e){return e&&e.split(" ")}function y(t){var e=t;return _e(t)?e=t.map(y).join(" "):Te(t)&&(e=Object.keys(t).filter(function(e){return t[e]}).join(" ")),e}function x(n){var e=n;if(_e(n))e=n.map(x);else if(Te(n)){var i=!1;e=Object.keys(n).filter(function(e){var t=n[e];return!i&&xe(t)&&(i=!0),t}),i&&e.push(void 0)}return e}}var Ro=Ao("",!0),No=Ao("Odd",0),Po=Ao("Even",1),Lo=Ir({compile:function(e,t){t.$set("ngCloak",void 0),e.removeClass("ng-cloak")}}),Co=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Fo={},Oo={blur:!0,focus:!0};fe("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(o){var a=Tn("ng-"+o);Fo[a]=["$parse","$rootScope",function(n,r){return{restrict:"A",compile:function(e,t){var i=n(t[a]);return function(n,e){e.on(o,function(e){var t=function(){i(n,{$event:e})};Oo[o]&&r.$$phase?n.$evalAsync(t):n.$apply(t)})}}}}]});var $o=["$animate","$compile",function(l,u){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(e,n,i,t,r){var o,a,s;e.$watch(i.ngIf,function(e){e?a||r(function(e,t){a=t,e[e.length++]=u.$$createComment("end ngIf",i.ngIf),o={clone:e},l.enter(e,n.parent(),n)}):(s&&(s.remove(),s=null),a&&(a.$destroy(),a=null),o&&(s=Be(o.clone),l.leave(s).done(function(e){!1!==e&&(s=null)}),o=null))})}}}],Ho=["$templateRequest","$anchorScroll","$animate",function(g,v,y){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:x.noop,compile:function(e,t){var n=t.ngInclude||t.src,f=t.onload||"",m=t.autoscroll;return function(a,s,e,l,u){var c,t,h,d=0,p=function(){t&&(t.remove(),t=null),c&&(c.$destroy(),c=null),h&&(y.leave(h).done(function(e){!1!==e&&(t=null)}),t=h,h=null)};a.$watch(n,function(i){var r=function(e){!1===e||!Ee(m)||m&&!a.$eval(m)||v()},o=++d;i?(g(i,!0).then(function(e){if(!a.$$destroyed&&o===d){var t=a.$new();l.template=e;var n=u(t,function(e){p(),y.enter(e,null,s).done(r)});h=n,(c=t).$emit("$includeContentLoaded",i),a.$eval(f)}},function(){a.$$destroyed||o===d&&(p(),a.$emit("$includeContentError",i))}),a.$emit("$includeContentRequested",i)):(p(),l.template=null)})}}}}],Io=["$compile",function(r){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(e,t,n,i){if(pe.call(t[0]).match(/SVG/))return t.empty(),void r(dt(i.template,V.document).childNodes)(e,function(e){t.append(e)},{futureParentElement:t});t.html(i.template),r(t.contents())(e)}}}],Uo=Ir({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),Do=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,n,i){var r=n.ngList||", ",o="false"!==n.ngTrim,a=o?Re(r):r;i.$parsers.push(function(e){if(!xe(e)){var t=[];return e&&fe(e.split(a),function(e){e&&t.push(o?Re(e):e)}),t}}),i.$formatters.push(function(e){if(_e(e))return e.join(r)}),i.$isEmpty=function(e){return!e||!e.length}}}},Bo="ng-valid",ko="ng-invalid",Vo="ng-pristine",zo="ng-dirty",Go="ng-untouched",jo="ng-touched",Wo="ng-not-empty",Xo=A("ngModel");function qo(e,t,n,i,r,o,a,s,l){var u;this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=l(n.name||"",!1)(e),this.$$parentForm=Br,this.$options=Yo,this.$$updateEvents="",this.$$updateEventHandler=this.$$updateEventHandler.bind(this),this.$$parsedNgModel=r(n.ngModel),this.$$parsedNgModelAssign=this.$$parsedNgModel.assign,this.$$ngModelGet=this.$$parsedNgModel,this.$$ngModelSet=this.$$parsedNgModelAssign,this.$$pendingDebounce=null,this.$$parserValid=void 0,this.$$currentValidationRunId=0,Object.defineProperty(this,"$$scope",{value:e}),this.$$attr=n,this.$$element=i,this.$$animate=o,this.$$timeout=a,this.$$parse=r,this.$$q=s,this.$$exceptionHandler=t,Xr(this),(u=this).$$scope.$watch(function(e){var t=u.$$ngModelGet(e);return t===u.$modelValue||u.$modelValue!=u.$modelValue&&t!=t||u.$$setModelValue(t),t})}qo.$inject=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$q","$interpolate"],qo.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var n=this.$$parse(this.$$attr.ngModel+"()"),i=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(e){var t=this.$$parsedNgModel(e);return Se(t)&&(t=n(e)),t},this.$$ngModelSet=function(e,t){Se(this.$$parsedNgModel(e))?i(e,{$$$p:t}):this.$$parsedNgModelAssign(e,t)}}else if(!this.$$parsedNgModel.assign)throw Xo("nonassign","Expression '{0}' is non-assignable. Element: {1}",this.$$attr.ngModel,$e(this.$$element))},$render:ve,$isEmpty:function(e){return xe(e)||""===e||null===e||e!=e},$$updateEmptyClasses:function(e){this.$isEmpty(e)?(this.$$animate.removeClass(this.$$element,Wo),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,Wo))},$setPristine:function(){this.$dirty=!1,this.$pristine=!0,this.$$animate.removeClass(this.$$element,zo),this.$$animate.addClass(this.$$element,Vo)},$setDirty:function(){this.$dirty=!0,this.$pristine=!1,this.$$animate.removeClass(this.$$element,Vo),this.$$animate.addClass(this.$$element,zo),this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1,this.$untouched=!0,this.$$animate.setClass(this.$$element,Go,jo)},$setTouched:function(){this.$touched=!0,this.$untouched=!1,this.$$animate.setClass(this.$$element,jo,Go)},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce),this.$viewValue=this.$$lastCommittedViewValue,this.$render()},$validate:function(){if(!N(this.$modelValue)){var e=this.$$lastCommittedViewValue,t=this.$$rawModelValue,n=this.$valid,i=this.$modelValue,r=this.$options.getOption("allowInvalid"),o=this;this.$$runValidators(t,e,function(e){r||n===e||(o.$modelValue=e?t:void 0,o.$modelValue!==i&&o.$$writeModelToScope())})}},$$runValidators:function(r,o,t){this.$$currentValidationRunId++;var i,a,n=this.$$currentValidationRunId,s=this;(function(){var e=s.$$parserName||"parse";{if(!xe(s.$$parserValid))return s.$$parserValid||(fe(s.$validators,function(e,t){l(t,null)}),fe(s.$asyncValidators,function(e,t){l(t,null)})),l(e,s.$$parserValid),s.$$parserValid;l(e,null)}return!0})()?!function(){var i=!0;if(fe(s.$validators,function(e,t){var n=Boolean(e(r,o));i=i&&n,l(t,n)}),!i)return fe(s.$asyncValidators,function(e,t){l(t,null)}),!1;return!0}()?e(!1):(i=[],a=!0,fe(s.$asyncValidators,function(e,t){var n=e(r,o);if(!L(n))throw Xo("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",n);l(t,void 0),i.push(n.then(function(){l(t,!0)},function(){l(t,a=!1)}))}),i.length?s.$$q.all(i).then(function(){e(a)},ve):e(!0)):e(!1);function l(e,t){n===s.$$currentValidationRunId&&s.$setValidity(e,t)}function e(e){n===s.$$currentValidationRunId&&t(e)}},$commitViewValue:function(){var e=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce),(this.$$lastCommittedViewValue!==e||""===e&&this.$$hasNativeValidators)&&(this.$$updateEmptyClasses(e),this.$$lastCommittedViewValue=e,this.$pristine&&this.$setDirty(),this.$$parseAndValidate())},$$parseAndValidate:function(){var t=this.$$lastCommittedViewValue,n=this;if(this.$$parserValid=!xe(t)||void 0,this.$$parserValid)for(var e=0;e<this.$parsers.length;e++)if(xe(t=this.$parsers[e](t))){this.$$parserValid=!1;break}N(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var i=this.$modelValue,r=this.$options.getOption("allowInvalid");function o(){n.$modelValue!==i&&n.$$writeModelToScope()}this.$$rawModelValue=t,r&&(this.$modelValue=t,o()),this.$$runValidators(t,this.$$lastCommittedViewValue,function(e){r||(n.$modelValue=e?t:void 0,o())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,this.$modelValue),fe(this.$viewChangeListeners,function(e){try{e()}catch(e){this.$$exceptionHandler(e)}},this)},$setViewValue:function(e,t){this.$viewValue=e,this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(t)},$$debounceViewValueCommit:function(e){var t=this.$options.getOption("debounce");_(t[e])?t=t[e]:_(t.default)&&(t=t.default),this.$$timeout.cancel(this.$$pendingDebounce);var n=this;0<t?this.$$pendingDebounce=this.$$timeout(function(){n.$commitViewValue()},t):this.$$scope.$root.$$phase?this.$commitViewValue():this.$$scope.$apply(function(){n.$commitViewValue()})},$overrideModelOptions:function(e){this.$options=this.$options.createChild(e),this.$$setUpdateOnEvents()},$processModelValue:function(){var e=this.$$format();this.$viewValue!==e&&(this.$$updateEmptyClasses(e),this.$viewValue=this.$$lastCommittedViewValue=e,this.$render(),this.$$runValidators(this.$modelValue,this.$viewValue,ve))},$$format:function(){for(var e=this.$formatters,t=e.length,n=this.$modelValue;t--;)n=e[t](n);return n},$$setModelValue:function(e){this.$modelValue=this.$$rawModelValue=e,this.$$parserValid=void 0,this.$processModelValue()},$$setUpdateOnEvents:function(){this.$$updateEvents&&this.$$element.off(this.$$updateEvents,this.$$updateEventHandler),this.$$updateEvents=this.$options.getOption("updateOn"),this.$$updateEvents&&this.$$element.on(this.$$updateEvents,this.$$updateEventHandler)},$$updateEventHandler:function(e){this.$$debounceViewValueCommit(e&&e.type)}},qr({clazz:qo,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]}});var Yo,Jo=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:qo,priority:1,compile:function(e){return e.addClass(Vo).addClass(Go).addClass(Bo),{pre:function(e,t,n,i){var r=i[0],o=i[1]||r.$$parentForm,a=i[2];a&&(r.$options=a.$options),r.$$initGetterSetters(),o.$addControl(r),n.$observe("name",function(e){r.$name!==e&&r.$$parentForm.$$renameControl(r,e)}),e.$on("$destroy",function(){r.$$parentForm.$removeControl(r)})},post:function(e,t,n,i){var r=i[0];function o(){r.$setTouched()}r.$$setUpdateOnEvents(),t.on("blur",function(){r.$touched||(a.$$phase?e.$evalAsync(o):e.$apply(o))})}}}}}],Qo=/(\s+|^)default(\s+|$)/;function Zo(e){this.$$options=e}Zo.prototype={getOption:function(e){return this.$$options[e]},createChild:function(n){var i=!1;return fe(n=me({},n),function(e,t){"$inherit"===e?"*"===t?i=!0:(n[t]=this.$$options[t],"updateOn"===t&&(n.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===t&&(n.updateOnDefault=!1,n[t]=Re(e.replace(Qo,function(){return n.updateOnDefault=!0," "})))},this),i&&(delete n["*"],ea(n,this.$$options)),ea(n,Yo.$$options),new Zo(n)}},Yo=new Zo({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,timezone:null});var Ko=function(){function e(e,t){this.$$attrs=e,this.$$scope=t}return e.$inject=["$attrs","$scope"],e.prototype={$onInit:function(){var e=this.parentCtrl?this.parentCtrl.$options:Yo,t=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=e.createChild(t)}},{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:e}};function ea(n,e){fe(e,function(e,t){Ee(n[t])||(n[t]=e)})}var ta=Ir({terminal:!0,priority:1e3}),na=A("ngOptions"),ia=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ra=["$compile","$document","$parse",function(g,v,w){var y=V.document.createElement("option"),x=V.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(e,t,n,i){i[0].registerOption=ve},post:function(e,a,t,n){for(var s=n[0],l=n[1],u=t.multiple,i=0,r=a.children(),o=r.length;i<o;i++)if(""===r[i].value){s.hasEmptyOption=!0,s.emptyOption=r.eq(i);break}a.empty();var c,h=!!s.emptyOption;de(y.cloneNode(!1)).val("?");var d=function(e,t,d){var h=e.match(ia);if(!h)throw na("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",e,$e(t));var n=h[5]||h[7],i=h[6],r=/ as /.test(h[0])&&h[1],p=h[9],o=w(h[2]?h[1]:n),f=r&&w(r)||o,a=p&&w(p),m=p?function(e,t){return a(d,t)}:function(e){return Ut(e)},g=function(e,t){return m(e,T(e,t))},v=w(h[2]||h[1]),y=w(h[3]||""),x=w(h[4]||""),E=w(h[8]),s={},T=i?function(e,t){return s[i]=t,s[n]=e,s}:function(e){return s[n]=e,s};function b(e,t,n,i,r){this.selectValue=e,this.viewValue=t,this.label=n,this.group=i,this.disabled=r}function _(e){var t;if(!i&&O(e))t=e;else for(var n in t=[],e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t.push(n);return t}return{trackBy:p,getTrackByValue:g,getWatchables:w(E,function(e){for(var t=[],n=_(e=e||[]),i=n.length,r=0;r<i;r++){var o=e===n?r:n[r],a=e[o],s=T(a,o),l=m(a,s);if(t.push(l),h[2]||h[1]){var u=v(d,s);t.push(u)}if(h[4]){var c=x(d,s);t.push(c)}}return t}),getOptions:function(){for(var e=[],t={},n=E(d)||[],i=_(n),r=i.length,o=0;o<r;o++){var a=n===i?o:i[o],s=n[a],l=T(s,a),u=f(d,l),c=m(u,l),h=new b(c,u,v(d,l),y(d,l),x(d,l));e.push(h),t[c]=h}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[g(e)]},getViewValueFromOption:function(e){return p?I(e.viewValue):e.viewValue}}}}}(t.ngOptions,a,e),p=v[0].createDocumentFragment();function f(e,t){var n,i,r=y.cloneNode(!1);t.appendChild(r),i=r,((n=e).element=i).disabled=n.disabled,n.label!==i.label&&(i.label=n.label,i.textContent=n.label),i.value=n.selectValue}function m(e){var t=c.getOptionFromViewValue(e),n=t&&t.element;return n&&!n.selected&&(n.selected=!0),t}s.generateUnknownOptionValue=function(e){return"?"},u?(s.writeValue=function(e){if(c){var t=e&&e.map(m)||[];c.items.forEach(function(e){e.element.selected&&!H(t,e)&&(e.element.selected=!1)})}},s.readValue=function(){var e=a.val()||[],n=[];return fe(e,function(e){var t=c.selectValueMap[e];t&&!t.disabled&&n.push(c.getViewValueFromOption(t))}),n},d.trackBy&&e.$watchCollection(function(){if(_e(l.$viewValue))return l.$viewValue.map(function(e){return d.getTrackByValue(e)})},function(){l.$render()})):(s.writeValue=function(e){if(c){var t=a[0].options[a[0].selectedIndex],n=c.getOptionFromViewValue(e);t&&t.removeAttribute("selected"),n?(a[0].value!==n.selectValue&&(s.removeUnknownOption(),a[0].value=n.selectValue,n.element.selected=!0),n.element.setAttribute("selected","selected")):s.selectUnknownOrEmptyOption(e)}},s.readValue=function(){var e=c.selectValueMap[a.val()];return e&&!e.disabled?(s.unselectEmptyOption(),s.removeUnknownOption(),c.getViewValueFromOption(e)):null},d.trackBy&&e.$watch(function(){return d.getTrackByValue(l.$viewValue)},function(){l.$render()})),h&&(g(s.emptyOption)(e),a.prepend(s.emptyOption),s.emptyOption[0].nodeType===je?(s.hasEmptyOption=!1,s.registerOption=function(e,t){""===t.val()&&(s.hasEmptyOption=!0,s.emptyOption=t,s.emptyOption.removeClass("ng-scope"),l.$render(),t.on("$destroy",function(){var e=s.$isEmptyOptionSelected();s.hasEmptyOption=!1,s.emptyOption=void 0,e&&l.$render()}))}):s.emptyOption.removeClass("ng-scope")),e.$watchCollection(d.getWatchables,function(){var e=c&&s.readValue();if(c)for(var t=c.items.length-1;0<=t;t--){var n=c.items[t];Ee(n.group)?Rt(n.element.parentNode):Rt(n.element)}c=d.getOptions();var i={};if(c.items.forEach(function(e){var t;Ee(e.group)?((t=i[e.group])||(t=x.cloneNode(!1),p.appendChild(t),t.label=null===e.group?"null":e.group,i[e.group]=t),f(e,t)):f(e,p)}),a[0].appendChild(p),l.$render(),!l.$isEmpty(e)){var r=s.readValue(),o=d.trackBy||u;(o?Ce(e,r):e===r)||(l.$setViewValue(r),l.$render())}})}}}}],oa=["$locale","$interpolate","$log",function(f,m,g){var v=/{}/g,y=/^when(Minus)?(.+)$/;return{link:function(r,o,a){var s,e=a.count,l=a.$attr.when&&o.attr(a.$attr.when),u=a.offset||0,c=r.$eval(l)||{},h={},t=m.startSymbol(),n=m.endSymbol(),i=t+e+"-"+u+n,d=x.noop;function p(e){o.text(e||"")}fe(a,function(e,t){var n=y.exec(t);if(n){var i=(n[1]?"-":"")+ce(n[2]);c[i]=o.attr(a.$attr[t])}}),fe(c,function(e,t){h[t]=m(e.replace(v,i))}),r.$watch(e,function(e){var t=parseFloat(e),n=N(t);if(n||t in c||(t=f.pluralCat(t-u)),!(t===s||n&&N(s))){d();var i=h[t];xe(i)?(null!=e&&g.debug("ngPluralize: no rule defined for '"+t+"' in "+l),d=ve,p()):d=r.$watch(i,p),s=t}})}}}],aa=["$parse","$animate","$compile",function(l,P,u){var L="$$NG_REMOVED",C=A("ngRepeat"),F=function(e,t,n,i,r,o,a){e[n]=i,r&&(e[r]=o),e.$index=t,e.$first=0===t,e.$last=t===a-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0==(1&t))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(e,t){var b=t.ngRepeat,_=u.$$createComment("end ngRepeat",b),n=b.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!n)throw C("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",b);var i=n[1],r=n[2],w=n[3],o=n[4];if(!(n=i.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/)))throw C("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",i);var a,S,M,A,R=n[3]||n[1],N=n[2];if(w&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(w)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(w)))throw C("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",w);var s={$id:Ut};return o?a=l(o):(M=function(e,t){return Ut(t)},A=function(e){return e}),function(y,x,e,t,E){a&&(S=function(e,t,n){return N&&(s[N]=e),s[R]=t,s.$index=n,a(y,s)});var T=ke();y.$watchCollection(r,function(e){var i,t,n,r,o,a,s,l,u,c,h,d,p,f=x[0],m=ke();if(w&&(y[w]=e),O(e))u=e,l=S||M;else for(var g in l=S||A,u=[],e)z.call(e,g)&&"$"!==g.charAt(0)&&u.push(g);for(r=u.length,h=new Array(r),i=0;i<r;i++)if(o=e===u?i:u[i],a=e[o],s=l(o,a,i),T[s])c=T[s],delete T[s],m[s]=c,h[i]=c;else{if(m[s])throw fe(h,function(e){e&&e.scope&&(T[e.id]=e)}),C("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",b,s,a);h[i]={id:s,scope:void 0,clone:void 0},m[s]=!0}for(var v in T){if(d=Be((c=T[v]).clone),P.leave(d),d[0].parentNode)for(i=0,t=d.length;i<t;i++)d[i][L]=!0;c.scope.$destroy()}for(i=0;i<r;i++)if(o=e===u?i:u[i],a=e[o],(c=h[i]).scope){for(n=f;(n=n.nextSibling)&&n[L];);c.clone[0]!==n&&P.move(Be(c.clone),null,f),f=(p=c).clone[p.clone.length-1],F(c.scope,i,R,a,N,o,r)}else E(function(e,t){c.scope=t;var n=_.cloneNode(!1);e[e.length++]=n,P.enter(e,null,f),f=n,c.clone=e,m[c.id]=c,F(c.scope,i,R,a,N,o,r)});T=m})}}}}],sa="ng-hide-animate",la=["$animate",function(i){return{restrict:"A",multiElement:!0,link:function(e,t,n){e.$watch(n.ngShow,function(e){i[e?"removeClass":"addClass"](t,"ng-hide",{tempClasses:sa})})}}}],ua=["$animate",function(i){return{restrict:"A",multiElement:!0,link:function(e,t,n){e.$watch(n.ngHide,function(e){i[e?"addClass":"removeClass"](t,"ng-hide",{tempClasses:sa})})}}}],ca=Ir(function(e,n,t){e.$watch(t.ngStyle,function(e,t){t&&e!==t&&fe(t,function(e,t){n.css(t,"")}),e&&n.css(e)},!0)}),ha=["$animate","$compile",function(c,h){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(e,t,n,r){var i=n.ngSwitch||n.on,o=[],a=[],s=[],l=[],u=function(t,n){return function(e){!1!==e&&t.splice(n,1)}};e.$watch(i,function(e){for(var t,n;s.length;)c.cancel(s.pop());for(t=0,n=l.length;t<n;++t){var i=Be(a[t].clone);l[t].$destroy(),(s[t]=c.leave(i)).done(u(s,t))}a.length=0,l.length=0,(o=r.cases["!"+e]||r.cases["?"])&&fe(o,function(r){r.transclude(function(e,t){l.push(t);var n=r.element;e[e.length++]=h.$$createComment("end ngSwitchWhen");var i={clone:e};a.push(i),c.enter(e,n.parent(),n)})})})}}}],da=Ir({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){fe(n.ngSwitchWhen.split(n.ngSwitchWhenSeparator).sort().filter(function(e,t,n){return n[t-1]!==e}),function(e){i.cases["!"+e]=i.cases["!"+e]||[],i.cases["!"+e].push({transclude:r,element:t})})}}),pa=Ir({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){i.cases["?"]=i.cases["?"]||[],i.cases["?"].push({transclude:r,element:t})}}),fa=A("ngTransclude"),ma=["$compile",function(t){return{restrict:"EAC",compile:function(e){var s=t(e.contents());return e.empty(),function(e,n,t,i,r){if(!r)throw fa("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",$e(n));t.ngTransclude===t.$attr.ngTransclude&&(t.ngTransclude="");var o=t.ngTransclude||t.ngTranscludeSlot;function a(){s(e,function(e){n.append(e)})}r(function(e,t){e.length&&function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i.nodeType!==Ge||i.nodeValue.trim())return!0}}(e)?n.append(e):(a(),t.$destroy())},null,o),o&&!r.isSlotFilled(o)&&a()}}}}],ga=["$templateCache",function(r){return{restrict:"E",terminal:!0,compile:function(e,t){if("text/ng-template"===t.type){var n=t.id,i=e[0].text;r.put(n,i)}}}}],va={$setViewValue:ve,$render:ve};function ya(e,t){e.prop("selected",t),e.attr("selected",t)}var xa=["$element","$scope",function(r,t){var s=this,i=new kt;s.selectValueMap={},s.ngModelCtrl=va,s.multiple=!1,s.unknownOption=de(V.document.createElement("option")),s.hasEmptyOption=!1,s.emptyOption=void 0,s.renderUnknownOption=function(e){var t=s.generateUnknownOptionValue(e);s.unknownOption.val(t),r.prepend(s.unknownOption),ya(s.unknownOption,!0),r.val(t)},s.updateUnknownOption=function(e){var t=s.generateUnknownOptionValue(e);s.unknownOption.val(t),ya(s.unknownOption,!0),r.val(t)},s.generateUnknownOptionValue=function(e){return"? "+Ut(e)+" ?"},s.removeUnknownOption=function(){s.unknownOption.parent()&&s.unknownOption.remove()},s.selectEmptyOption=function(){s.emptyOption&&(r.val(""),ya(s.emptyOption,!0))},s.unselectEmptyOption=function(){s.hasEmptyOption&&ya(s.emptyOption,!1)},t.$on("$destroy",function(){s.renderUnknownOption=ve}),s.readValue=function(){var e=r.val(),t=e in s.selectValueMap?s.selectValueMap[e]:e;return s.hasOption(t)?t:null},s.writeValue=function(e){var t=r[0].options[r[0].selectedIndex];if(t&&ya(de(t),!1),s.hasOption(e)){s.removeUnknownOption();var n=Ut(e);r.val(n in s.selectValueMap?n:e);var i=r[0].options[r[0].selectedIndex];ya(de(i),!0)}else s.selectUnknownOrEmptyOption(e)},s.addOption=function(e,t){if(t[0].nodeType!==je){Ue(e,'"option value"'),""===e&&(s.hasEmptyOption=!0,s.emptyOption=t);var n=i.get(e)||0;i.set(e,n+1),l()}},s.removeOption=function(e){var t=i.get(e);t&&(1===t?(i.delete(e),""===e&&(s.hasEmptyOption=!1,s.emptyOption=void 0)):i.set(e,t-1))},s.hasOption=function(e){return!!i.get(e)},s.$hasEmptyOption=function(){return s.hasEmptyOption},s.$isUnknownOptionSelected=function(){return r[0].options[0]===s.unknownOption[0]},s.$isEmptyOptionSelected=function(){return s.hasEmptyOption&&r[0].options[r[0].selectedIndex]===s.emptyOption[0]};var e=!(s.selectUnknownOrEmptyOption=function(e){null==e&&s.emptyOption?(s.removeUnknownOption(),s.selectEmptyOption()):s.unknownOption.parent().length?s.updateUnknownOption(e):s.renderUnknownOption(e)});function l(){e||(e=!0,t.$$postDigest(function(){e=!1,s.ngModelCtrl.$render()}))}var n=!1;function u(e){n||(n=!0,t.$$postDigest(function(){t.$$destroyed||(n=!1,s.ngModelCtrl.$setViewValue(s.readValue()),e&&s.ngModelCtrl.$render())}))}s.registerOption=function(e,i,r,t,n){if(r.$attr.ngValue){var o,a=NaN;r.$observe("value",function(e){var t,n=i.prop("selected");Ee(a)&&(s.removeOption(o),delete s.selectValueMap[a],t=!0),a=Ut(e),o=e,s.selectValueMap[a]=e,s.addOption(e,i),i.attr("value",a),t&&n&&u()})}else t?r.$observe("value",function(e){var t;s.readValue();var n=i.prop("selected");Ee(o)&&(s.removeOption(o),t=!0),o=e,s.addOption(e,i),t&&n&&u()}):n?e.$watch(n,function(e,t){r.$set("value",e);var n=i.prop("selected");t!==e&&s.removeOption(t),s.addOption(e,i),t&&n&&u()}):s.addOption(r.value,i);r.$observe("disabled",function(e){("true"===e||e&&i.prop("selected"))&&(s.multiple?u(!0):(s.ngModelCtrl.$setViewValue(null),s.ngModelCtrl.$render()))}),i.on("$destroy",function(){var e=s.readValue(),t=r.value;s.removeOption(t),l(),(s.multiple&&e&&-1!==e.indexOf(t)||e===t)&&u(!0)})}}],Ea=function(){return{restrict:"E",require:["select","?ngModel"],controller:xa,priority:1,link:{pre:function(e,t,n,i){var r=i[0],o=i[1];if(!o)return void(r.registerOption=ve);if(r.ngModelCtrl=o,t.on("change",function(){r.removeUnknownOption(),e.$apply(function(){o.$setViewValue(r.readValue())})}),n.multiple){r.multiple=!0,r.readValue=function(){var n=[];return fe(t.find("option"),function(e){if(e.selected&&!e.disabled){var t=e.value;n.push(t in r.selectValueMap?r.selectValueMap[t]:t)}}),n},r.writeValue=function(i){fe(t.find("option"),function(e){var t=!!i&&(H(i,e.value)||H(i,r.selectValueMap[e.value])),n=e.selected;t!==n&&ya(de(e),t)})};var a,s=NaN;e.$watch(function(){s!==o.$viewValue||Ce(a,o.$viewValue)||(a=qe(o.$viewValue),o.$render()),s=o.$viewValue}),o.$isEmpty=function(e){return!e||0===e.length}}},post:function(e,t,n,i){var r=i[1];if(!r)return;var o=i[0];r.$render=function(){o.writeValue(r.$viewValue)}}}}},Ta=["$interpolate",function(n){return{restrict:"E",priority:100,compile:function(e,t){var a,s;return Ee(t.ngValue)||(Ee(t.value)?a=n(t.value,!0):(s=n(e.text(),!0))||t.$set("value",e.text())),function(e,t,n){var i="$selectController",r=t.parent(),o=r.data(i)||r.parent().data(i);o&&o.registerOption(e,t,n,a,s)}}}}],ba=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){i&&(n.required=!0,i.$validators.required=function(e,t){return!n.required||!i.$isEmpty(t)},n.$observe("required",function(){i.$validate()}))}}},_a=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r,o=n.ngPattern||n.pattern;n.$observe("pattern",function(e){if(be(e)&&0<e.length&&(e=new RegExp("^"+e+"$")),e&&!e.test)throw A("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",o,e,$e(t));r=e||void 0,i.$validate()}),i.$validators.pattern=function(e,t){return i.$isEmpty(t)||xe(r)||r.test(t)}}}}},wa=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=-1;n.$observe("maxlength",function(e){var t=E(e);r=N(t)?-1:t,i.$validate()}),i.$validators.maxlength=function(e,t){return r<0||i.$isEmpty(t)||t.length<=r}}}}},Sa=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=0;n.$observe("minlength",function(e){r=E(e)||0,i.$validate()}),i.$validators.minlength=function(e,t){return i.$isEmpty(t)||t.length>=r}}}}};V.angular.bootstrap?V.console&&console.log("WARNING: Tried to load AngularJS more than once."):(!function(){var r;if(!le){var e=D();(a=xe(e)?V.jQuery:e?V[e]:void 0)&&a.fn.on?(me((de=a).fn,{scope:Pt.scope,isolateScope:Pt.isolateScope,controller:Pt.controller,injector:Pt.injector,inheritedData:Pt.inheritedData}),r=a.cleanData,a.cleanData=function(e){for(var t,n,i=0;null!=(n=e[i]);i++)(t=a._data(n,"events"))&&t.$destroy&&a(n).triggerHandler("$destroy");r(e)}):de=ft,x.element=de,le=!0}}(),me(x,{errorHandlingConfig:e,bootstrap:re,copy:I,extend:me,merge:r,equals:Ce,element:de,forEach:fe,injector:Qt,noop:ve,bind:Oe,toJson:G,fromJson:j,identity:ye,isUndefined:xe,isDefined:Ee,isString:be,isFunction:Se,isObject:Te,isNumber:_,isElement:$,isArray:_e,version:Je,isDate:w,lowercase:ce,uppercase:d,callbacks:{$$counter:0},getTestability:ae,reloadWithDebugInfo:oe,$$minErr:A,$$csp:U,$$encodeUriSegment:K,$$encodeUriQuery:ee,$$stringify:Ve}),(v=function(e){var h=A("$injector"),d=A("ng");function t(e,t,n){return e[t]||(e[t]=n())}var n=t(e,"angular",Object);return n.$$minErr=n.$$minErr||A,t(n,"module",function(){var e={};return function(s,l,u){var c={};return function(e,t){if("hasOwnProperty"===e)throw d("badname","hasOwnProperty is not a valid {0} name",t)}(s,"module"),l&&e.hasOwnProperty(s)&&(e[s]=null),t(e,s,function(){if(!l)throw h("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",s);var o=[],e=[],t=[],n=i("$injector","invoke","push",e),a={_invokeQueue:o,_configBlocks:e,_runBlocks:t,info:function(e){if(Ee(e)){if(!Te(e))throw d("aobj","Argument '{0}' must be an object","value");return c=e,this}return c},requires:l,name:s,provider:r("$provide","provider"),factory:r("$provide","factory"),service:r("$provide","service"),value:i("$provide","value"),constant:i("$provide","constant","unshift"),decorator:r("$provide","decorator",e),animation:r("$animateProvider","register"),filter:r("$filterProvider","register"),controller:r("$controllerProvider","register"),directive:r("$compileProvider","directive"),component:r("$compileProvider","component"),config:n,run:function(e){return t.push(e),this}};return u&&n(u),a;function i(e,t,n,i){return i||(i=o),function(){return i[n||"push"]([e,t,arguments]),a}}function r(n,i,r){return r||(r=o),function(e,t){return t&&Se(t)&&(t.$$moduleName=s),r.push([n,i,arguments]),a}}})}})}(V))("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:ji}),e.provider("$compile",vn).directive({a:Ur,input:Eo,textarea:Eo,form:jr,script:ga,select:Ea,option:Ta,ngBind:_o,ngBindHtml:So,ngBindTemplate:wo,ngClass:Ro,ngClassEven:Po,ngClassOdd:No,ngCloak:Lo,ngController:Co,ngForm:Wr,ngHide:ua,ngIf:$o,ngInclude:Ho,ngInit:Uo,ngNonBindable:ta,ngPluralize:oa,ngRepeat:aa,ngShow:la,ngStyle:ca,ngSwitch:ha,ngSwitchWhen:da,ngSwitchDefault:pa,ngOptions:ra,ngTransclude:ma,ngModel:Jo,ngList:Do,ngChange:Mo,pattern:_a,ngPattern:_a,required:ba,ngRequired:ba,minlength:Sa,ngMinlength:Sa,maxlength:wa,ngMaxlength:wa,ngValue:bo,ngModelOptions:Ko}).directive({ngInclude:Io}).directive(Dr).directive(Fo),e.provider({$anchorScroll:Zt,$animate:sn,$animateCss:cn,$$animateJs:on,$$animateQueue:an,$$AnimateRunner:un,$$animateAsyncRun:ln,$browser:dn,$cacheFactory:pn,$controller:Mn,$document:An,$$isDocumentHidden:Rn,$exceptionHandler:Nn,$filter:hr,$$forceReflow:Pn,$interpolate:Yn,$interval:Jn,$http:jn,$httpParamSerializer:Un,$httpParamSerializerJQLike:Dn,$httpBackend:Xn,$xhrFactory:Wn,$jsonpCallbacks:Qn,$location:mi,$log:gi,$parse:Hi,$rootScope:Gi,$q:Ii,$$q:Ui,$sce:Zi,$sceDelegate:Qi,$sniffer:Ki,$templateCache:fn,$templateRequest:tr,$$testability:nr,$timeout:ir,$window:lr,$$rAF:zi,$$jqLite:It,$$Map:Vt,$$cookieReader:cr})}]).info({angularVersion:"1.6.10"}),x.module("ngLocale",[],["$provide",function(e){var r="one",o="other";e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(e,t){var n=0|e,i=function(e,t){var n,i,r=t;void 0===r&&(r=Math.min((n=e,-1==(i=(n+="").indexOf("."))?0:n.length-i-1),3));var o=Math.pow(10,r);return{v:r,f:(e*o|0)%o}}(e,t);return 1==n&&0==i.v?r:o}})}]),de(function(){ie(V.document,re)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),angular.module("jsonFormatter",["RecursionHelper"]).provider("JSONFormatterConfig",function(){var t=!1,n=100,i=5;return{get hoverPreviewEnabled(){return t},set hoverPreviewEnabled(e){t=!!e},get hoverPreviewArrayCount(){return n},set hoverPreviewArrayCount(e){n=parseInt(e,10)},get hoverPreviewFieldCount(){return i},set hoverPreviewFieldCount(e){i=parseInt(e,10)},$get:function(){return{hoverPreviewEnabled:t,hoverPreviewArrayCount:n,hoverPreviewFieldCount:i}}}}).directive("jsonFormatter",["RecursionHelper","JSONFormatterConfig",function(t,r){function n(e){if(void 0===e)return"";if(null===e)return"Object";if("object"==typeof e&&!e.constructor)return"Object";if(void 0!==e.__proto__&&void 0!==e.__proto__.constructor&&void 0!==e.__proto__.constructor.name)return e.__proto__.constructor.name;var t=/function (.{1,})\(/.exec(e.constructor.toString());return t&&1<t.length?t[1]:""}function o(e){return null===e?"null":typeof e}function a(e,t){var n=o(e);return"null"===n||"undefined"===n?n:("string"===n&&(t='"'+t.replace('"','"')+'"'),"function"===n?e.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{…}":t)}function s(e){var t="";return angular.isObject(e)?(t=n(e),angular.isArray(e)&&(t+="["+e.length+"]")):t=a(e,e),t}function i(i){i.isArray=function(){return angular.isArray(i.json)},i.isObject=function(){return angular.isObject(i.json)},i.getKeys=function(){if(i.isObject())return Object.keys(i.json).map(function(e){return""===e?'""':e})},i.type=o(i.json),i.hasKey=void 0!==i.key,i.getConstructorName=function(){return n(i.json)},"string"===i.type&&("Invalid Date"!==new Date(i.json).toString()&&(i.isDate=!0),0===i.json.indexOf("http")&&(i.isUrl=!0)),i.isEmptyObject=function(){return i.getKeys()&&!i.getKeys().length&&i.isOpen&&!i.isArray()},i.isOpen=!!i.open,i.toggleOpen=function(){i.isOpen=!i.isOpen},i.childrenOpen=function(){return 1<i.open?i.open-1:0},i.openLink=function(e){e&&(window.location.href=i.json)},i.parseValue=function(e){return a(i.json,e)},i.showThumbnail=function(){return!!r.hoverPreviewEnabled&&i.isObject()&&!i.isOpen},i.getThumbnail=function(){if(i.isArray())return i.json.length>r.hoverPreviewArrayCount?"Array["+i.json.length+"]":"["+i.json.map(s).join(", ")+"]";var e=i.getKeys(),t=e.slice(0,r.hoverPreviewFieldCount).map(function(e){return e+":"+s(i.json[e])}),n=5<=e.length?"…":"";return"{"+t.join(", ")+n+"}"}}return{templateUrl:"json-formatter.html",restrict:"E",replace:!0,scope:{json:"=",key:"=",open:"="},compile:function(e){return t.compile(e,i)}}}]),"object"==typeof module&&(module.exports="jsonFormatter"),angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(o){return{compile:function(e,n){angular.isFunction(n)&&(n={post:n});var i,r=e.contents().remove();return{pre:n&&n.pre?n.pre:null,post:function(e,t){i||(i=o(r)),i(e,function(e){t.append(e)}),n&&n.post&&n.post.apply(null,arguments)}}}}}]),angular.module("jsonFormatter").run(["$templateCache",function(e){e.put("json-formatter.html",'<div ng-init="isOpen = open && open > 0" class="json-formatter-row"><a ng-click="toggleOpen()"><span class="toggler {{isOpen ? \'open\' : \'\'}}" ng-if="isObject()"></span> <span class="key" ng-if="hasKey"><span class="key-text">{{key}}</span><span class="colon">:</span></span> <span class="value"><span ng-if="isObject()"><span class="constructor-name">{{getConstructorName(json)}}</span> <span ng-if="isArray()"><span class="bracket">[</span><span class="number">{{json.length}}</span><span class="bracket">]</span></span></span> <span ng-if="!isObject()" ng-click="openLink(isUrl)" class="{{type}}" ng-class="{date: isDate, url: isUrl}">{{parseValue(json)}}</span></span> <span ng-if="showThumbnail()" class="thumbnail-text">{{getThumbnail()}}</span></a><div class="children" ng-if="getKeys().length && isOpen"><json-formatter ng-repeat="key in getKeys() track by $index" json="json[key]" key="key" open="childrenOpen()"></json-formatter></div><div class="children empty object" ng-if="isEmptyObject()"></div><div class="children empty array" ng-if="getKeys() && !getKeys().length && isOpen && isArray()"></div></div>')}]);
//# sourceMappingURL=vendors.min.js.map
