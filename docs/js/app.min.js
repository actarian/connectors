!function(){"use strict";var e=function(){function e(){this.loader=new THREE.JSONLoader}return e.prototype={load:function(t){var o=this;!function(e){var n={method:"GET",responseType:"text"};if(!e||!e.url||!e.onload)return;for(var t in e)n[t]=e[t];var o=new XMLHttpRequest;o.open(n.method,n.url,!0),o.responseType=n.responseType,o.onload=function(){200===this.status&&n.onload(this.response)},n.onerror&&(o.onerror=n.onerror);n.onprogress&&(o.onerror=n.onprogress);o.send()}({url:"img/Body 1.js",onload:function(e){e=e.replace(new RegExp("transparency","g"),"opacity");var n=o.loader.parse(JSON.parse(e));t(n.geometry,n.materials)}})}},e}();window.Forge=e}(),function(){"use strict";var s=!0,f=Math.PI/180;function p(e){return e*f}var a=function(){function e(e,n){var t=this;t.size=new THREE.Vector3,t.box=new THREE.Box3,t.group=new THREE.Group,t.inner=new THREE.Group,t.init(e,n)}return e.prototype={init:function(e,n){var t=this,o=t.box,i=t.size,r=t.group,a=t.inner;e=new THREE.BoxGeometry(10,4,4);var s=new THREE.MeshStandardMaterial({color:8947848,wireframe:!1}),c=new THREE.Mesh(e,s);o.setFromObject(c),o.getSize(i),c.position.set(i.x/2,0,0);var d=t.joint(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-p(180)),65280),u=t.joint(new THREE.Vector3(i.x,0,0),new THREE.Vector3(0,0,-p(10)+p(20)*Math.random()),16711680);a.position.x=i.x/2,a.add(c),a.add(d),a.add(u),r.add(a),t.model=c,t.left=d,t.right=u},flip:function(e){var n=this,t=n.model;n.flipped=!n.flipped,TweenLite.to(t.rotation,.3,{y:n.flipped?Math.PI:0,ease:Power2.easeOut,onComplete:function(){"function"==typeof e&&e()}})},joint:function(e,n,t){var o=this.size.x/10,i=new THREE.Group;i.position.copy(e),i.rotation.x=n.x,i.rotation.y=n.y,i.rotation.z=n.z;var r=new THREE.Quaternion;if(r.setFromAxisAngle(new THREE.Vector3(0,0,1),p(180)),i.oppositeQuaternion=(new THREE.Quaternion).multiplyQuaternions(r,i.quaternion),s){var a=new THREE.ArrowHelper(new THREE.Vector3(1,0,0),new THREE.Vector3,o,t,o/2,o/2);i.arrow=a,i.add(a)}return i}},e}(),e=function(){function e(e,n,t){var o=this;o.scene=e,o.camera=n,o.controls=t,o.flipping=0,o.items=[],o.hittables=[],o.projector=new THREE.Projector,o.center=new THREE.Vector3,o.size=new THREE.Vector3,o.group=new THREE.Group,o.box=new THREE.Box3,o.boxhelper=new THREE.Box3Helper(o.box,16711680),o.centerhelper=new THREE.Mesh(new THREE.BoxGeometry(.3,.3,.3),new THREE.MeshBasicMaterial({color:16711680})),s&&(o.scene.add(o.boxhelper),o.scene.add(o.centerhelper))}return e.prototype={add:function(e,n){var t=this,o=(t.box,t.size,t.items),i=(t.hittables,t.group),r=new a(e,n);return o.push(r),o.map(function(e){return e.model}),i.add(r.group),t.fitCamera(),r},combine:function(){var e=this.items,n=this.group,o=new THREE.Quaternion,i=new THREE.Vector3,r=new THREE.Vector3;e.length&&(n.getWorldPosition(r),e.filter(function(e,n){if(e.inner.position.x+=(1-e.inner.position.x)/5,0<n){var t=(new THREE.Quaternion).multiplyQuaternions(o,e.left.oppositeQuaternion);e.group.position.copy(i.sub(r)),e.group.setRotationFromQuaternion(t)}e.right.getWorldQuaternion(o),e.right.getWorldPosition(i)}))},fit:function(){var e=this,n=e.box,t=e.size,o=e.center,i=e.centerhelper,r=e.group;return n.setFromObject(r),n.getCenter(o),n.getSize(t),i.position.copy(o),r.worldToLocal(o),r.position.x=-o.x,r.position.y=-o.y,r.position.z=-o.z,t},fitCamera:function(e,n){e||(e=1.3);n||(n=new THREE.Vector3(0,1,0));var t=this,o=(t.projector,t.box),i=t.size,r=t.center,a=t.group,s=t.camera,c=t.controls;o.setFromObject(a),o.getCenter(r),s.up=n,s.lookAt(r),s.updateProjectionMatrix();var d=t.toScreen(o.min),u=t.toScreen(o.max),p=t.toScreen(r);console.log(d,u,p),o.applyMatrix4(s.matrixWorldInverse),o.getSize(i);var l=i.x/i.y,E=s.aspect>l?i.y:i.x;s.aspect<l&&(E/=s.aspect);var w=(E*=e)/2/Math.sin(s.fov/2*f);s.position.normalize().multiplyScalar(w);s.position.distanceTo(r);s.updateProjectionMatrix(),c&&c.update()},flip:function(e){var n=this,t=n.items,o=n.hittables,i=e.intersectObjects(o);if(i.length){var r=o.indexOf(i[0].object),a=t[r];n.flipping++,a.flip(function(){n.flipping--})}},remove:function(){var e=this.items,n=(this.hittables,this.group);if(1<e.length){var t=e.pop();t.group.parent&&n.remove(t.group),e.map(function(e){return e.model}),this.fitCamera()}},select:function(e){var n=this.items,t=this.hittables,o=e.intersectObjects(t);{if(o.length){var i=combiner.hittables.indexOf(o[0].object),r=n[i],a=r.inner.rotation.clone();return{index:i,item:r,rotation:a}}return null}},update:function(){var e=this.group;this.combine(),0===this.flipping&&this.fitGroup(e)},toScreen:function(e){var n=this.camera,t=window.innerWidth/2,o=window.innerHeight/2,i=e.clone();return i.project(n),i.x=(i.x+1)*t,i.y=(1-i.y)*o,i},toWorld:function(e){var n=this.projector,t=this.camera,o=window.innerWidth/2,i=window.innerHeight/2,r=e.clone();return r.x=r.x/o-1,r.y=-r.y/i+1,n.unprojectVector(r,t),r}},e}();window.Combiner=e}(),function(){"use strict";if(Detector.webgl){var e=new Forge,n=document.querySelector(".editor"),t=document.querySelector(".btn-add"),o=document.querySelector(".btn-remove"),i=new THREE.WebGLRenderer({alpha:!0});i.setSize(window.innerWidth,window.innerHeight),n.appendChild(i.domElement);var r=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,5e4);r.position.set(0,20,40),r.lookAt(0,0,0);var a=new THREE.OrbitControls(r),s=new THREE.Scene,c=new THREE.PointLight(14540270,1,2e3);c.position.set(0,200,0),s.add(c);var d=new THREE.PointLightHelper(c,10);s.add(d);var u=new THREE.GridHelper(30,30,8947848,11184810);s.add(u);var p=new Combiner(s,r,a);s.add(p.group),e.load(function(e,n){p.add(e,n)}),e.load(function(e,n){p.add(e,n)}),e.load(function(e,n){p.add(e,n)}),function e(){requestAnimationFrame(e);i.render(s,r);p.combine();0===p.flipping&&(p.fit(),u.position.y=-p.size.y/2)}();var l,E=new THREE.Raycaster;i.domElement.addEventListener("mousedown",function(e){l=w(e),E.setFromCamera(l,r);var n=p.select(E);n?(a.enabled=!1,l.index=n.index,l.item=n.item,l.rotation=n.rotation):l=null}),i.domElement.addEventListener("mousemove",function(e){if(l){var n=w(e).sub(l);l.index,l.item.inner.rotation.x=l.rotation.x+n.y*Math.PI}}),i.domElement.addEventListener("dblclick",function(e){var n=w(e);E.setFromCamera(n,r),p.flip(E)}),window.addEventListener("mouseup",function(e){l=null,a.enabled=!0}),window.addEventListener("resize",function(){r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)},!1),t.addEventListener("click",function(){e.load(function(e,n){p.add(e,n)})}),o.addEventListener("click",function(){p.remove()})}else Detector.addGetWebGLMessage();function w(e){return new THREE.Vector2(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)}}();
//# sourceMappingURL=app.min.js.map
