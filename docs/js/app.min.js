!function(){"use strict";Element.prototype.hasClass=function(e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(this.className)},Element.prototype.addClass=function(e){this.hasClass(e)||(this.className=this.className?this.className+" "+e:e)},Element.prototype.removeClass=function(e){this.hasClass(e)&&(this.className=this.className.split(e).join("").replace(/\s\s+/g," "))},Element.prototype.isDescendant=function(e){return function e(t,n){return t===n||!!t.parentNode&&e(t.parentNode,n)}(this,e)},Element.prototype.getBounds=function(){var e={x:0,y:0,width:this.offsetWidth,height:this.offsetHeight,center:{x:0,y:0}};return e.center.x=e.width/2,e.center.y=e.height/2,e},window.getTouch=function(e){var t=new THREE.Vector2;if(t.t=new THREE.Vector2,t.relativeTo=function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,r=window.pageYOffset||document.documentElement.scrollTop;this.x=(this.x-t.left-n)/e.offsetWidth*2-1,this.y=-(this.y-t.top-r)/e.offsetHeight*2+1},t.pinchSize=function(){return Math.sqrt((this.x-this.t.x)*(this.x-this.t.x)+(this.y-this.t.y)*(this.y-this.t.y))},t.count=1,"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var n=null,r=null,i=e.originalEvent?e.originalEvent.touches||e.originalEvent.changedTouches:e.touches||e.changedTouches;i&&i.length&&(n=i[0],1<i.length&&(r=i[1])),n&&(t.x=n.pageX,t.y=n.pageY),r&&(t.t.x=r.pageX,t.t.y=r.pageY,t.count=2)}else"click"!=e.type&&"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(t.x=e.pageX,t.y=e.pageY);return t}}(),function(){"use strict";var L={HELPER:!0,JOINTS:!0,MODELS:!0,ANGLE:!1,FINISH:"standard"},z=(Math.PI,.025),S=0;var j=new THREE.Quaternion;j.setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI);var p=function(){function e(){var e=this;e.size=new THREE.Vector3,e.box=new THREE.Box3,e.group=new THREE.Group,e.outer=new THREE.Group,e.inner=new THREE.Group}return e.prototype={enter:function(e){var t=this;t.outer.position.x=t.size.x,TweenLite.to(t.outer.position,.6,{x:0,ease:Power2.easeOut,overwrite:"all",onComplete:function(){"function"==typeof e&&e()}})},load:function(e,t,n,r){for(var i=this,o=i.box,a=i.size,s=i.group,p=i.outer,c=i.inner,l=0;l<e.vertices.length;l++)e.vertices[l].x*=z,e.vertices[l].y*=z,e.vertices[l].z*=z;u=t,h=n,d=r,g=["left","right","top","bottom"],E=[16711680,65280,255,16776960],d=d||L.FINISH,t=u.map(function(e,t){var n=g.indexOf(e.name);return-1!==n?new THREE.MeshStandardMaterial({name:e.name,color:new THREE.Color(E[n]),visible:!1}):(e.name=e.name.replace("chrome","silver"),h.materials[d][e.name].clone())});var u,h,d,g,E;var m=new THREE.Mesh(e,t);o.setFromObject(m),o.getSize(a);var f=i.getJoints(e,t,a);i.quaternionL=m.quaternion.clone();var v=(new THREE.Quaternion).setFromUnitVectors(f.left.normal.clone().multiplyScalar(-1),f.right.normal);if(i.quaternionR=(new THREE.Quaternion).multiplyQuaternions(i.quaternionL,j).multiply(v.inverse()),i.positionL=new THREE.Vector3,i.positionR=f.left.origin.clone().sub(f.right.origin.clone().applyQuaternion(i.quaternionR)),console.log(i.positionR),m.geometry.computeVertexNormals(),m.geometry.verticesNeedUpdate=!0,m.geometry.uvsNeedUpdate=!0,L.MODELS){t[1].color=new THREE.Color(0),e=new THREE.BoxGeometry(a.x,a.y,a.z);var w=new THREE.MeshStandardMaterial({color:new THREE.Color(.2*++S,0,0),wireframe:!1,transparent:!1,opacity:1});m=new THREE.Mesh(e,w)}for(var T in f){var R=f[T],y=R.normal.x,x=R.normal.y,H=-R.normal.z,M=new THREE.Euler(0,Math.atan2(H,y),Math.atan2(x,Math.sqrt(y*y+H*H)));if(R.rotation.copy(M),m.add(R),L.JOINTS){var b=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:R.color}));R.add(b)}}c.position.set(a.x/2,0,0),c.add(m),p.add(c),s.add(p),i.joints=f,i.model=m},flip:function(e){var t=this;t.inner;t.flipped=!t.flipped;var n={pow:t.flipped?0:1};TweenLite.to(n,.3,{pow:t.flipped?1:0,ease:Power2.easeOut,overwrite:"all",onUpdate:function(){THREE.Quaternion.slerp(t.quaternionL,t.quaternionR,t.model.quaternion,n.pow),t.model.position.lerpVectors(t.positionL,t.positionR,n.pow)},onComplete:function(){"function"==typeof e&&e()}})},getJoints:function(e,t,n){var r,i,o={},a={},s=["left","right","top","bottom"],p=[16711680,65280,255,16776960];t.filter(function(e,t){var n=s.indexOf(e.name);if(-1!==n){var r=new THREE.Group;r.name=s[n],r.color=p[n],r.vertices=[],o[e.name]=r,a[t]=r}});for(var c=0;c<e.faces.length;c++)i=e.faces[c],(r=a[String(i.materialIndex)])&&(r.normal=r.normal||i.normal,r.vertices.push(e.vertices[i.a]),r.vertices.push(e.vertices[i.b]),r.vertices.push(e.vertices[i.c]));for(var l in o)(r=o[l]).position.copy((u=r.vertices,void 0,h=u.reduce(function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}),(new THREE.Vector3).add(h).divideScalar(u.length))),r.origin=r.position.clone(),r.vertices=null;var u,h;o.left||(o.left=new THREE.Group,o.left.position.set(-n.x/2,0,0),o.left.origin=r.position.clone(),o.left.normal=new THREE.Vector3(-1,0,0),o.left.c=p[0]);o.right||(o.right=new THREE.Group,o.right.position.set(n.x/2,0,0),o.right.origin=r.position.clone(),o.right.normal=new THREE.Vector3(1,0,0),o.right.c=p[1]);L.ANGLE&&(o.right.normal.y+=.2);return o},setFlip:function(){var e=this,t=e.model;t.quaternion.copy(e.flipped?e.quaternionR:e.quaternionL),t.position.copy(e.flipped?e.positionR:e.positionL),e.group.updateMatrixWorld()}},e}(),e=function(){function e(e,t){var n=this;n.flags={rotate:!1},n.scene=e,n.library=t,n.flipping=0,n.entering=0,n.items=[],n.hittables=[],n.center=new THREE.Vector3,n.size=new THREE.Vector3,n.group=new THREE.Group,n.box=new THREE.Box3,L.HELPER&&(n.boxhelper=new THREE.Box3Helper(n.box,16711935),n.originhelper=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:11141375})),n.centerhelper=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:16711935})),n.scene.add(n.boxhelper),n.scene.add(n.originhelper),n.scene.add(n.centerhelper))}return e.prototype={add:function(e,t,n,r){var i=this,n=i.library,o=(i.box,i.size,i.items),a=(i.hittables,i.group);i.unselect();var s=new p;return s.load(e,t,n,r),o.push(s),i.hittables=o.map(function(e){return e.model}),a.add(s.group),s.setFlip(),i.adjust(),s},adjust:function(){this.combine(),this.fit()},busy:function(){return this.entering||this.flipping},combine:function(){var n,r,e=this.items,i=(this.group,new THREE.Quaternion),o=(new THREE.Vector3,new THREE.Vector3);e.length&&e.filter(function(e,t){e.flipped?(n=e.joints.right,r=e.joints.left):(n=e.joints.left,r=e.joints.right);0<t&&(e.group.setRotationFromQuaternion(i),e.group.position.copy(o));console.log(n.origin),r.getWorldQuaternion(i),r.getWorldPosition(o)})},fit:function(){var e=this,t=e.box,n=e.size,r=e.center,i=e.centerhelper,o=e.group;t.setFromObject(o),t.getCenter(r),t.getSize(n),L.HELPER&&i.position.copy(r);return n},flip:function(e){var t=this;t.items,t.hittables;t.selection&&t.flipItem(t.selection.item,e)},flipItem:function(e,t){var n=this;n.flipping++,e.flip(function(){n.flipping--,n.adjust(),"function"==typeof t&&setTimeout(function(){t()},100)})},hitAndFlip:function(e,t){var n=this.items,r=this.hittables,i=e.intersectObjects(r);if(i.length){var o=r.indexOf(i[0].object),a=n[o];this.flipItem(a,t)}},pop:function(){var e=this,t=e.items,n=(e.hittables,e.group);if(t.length){var r=t.pop();return r.group.parent&&n.remove(r.group),e.hittables=t.map(function(e){return e.model}),e.adjust(),r}},remove:function(){var e=this,t=e.items,n=(e.hittables,e.group);{if(e.selection){var r=e.selection,i=r.item;return t.splice(r.index,1),i.group.parent&&n.remove(i.group),e.hittables=t.map(function(e){return e.model}),e.unselect(),e.adjust(),t.length>r.index&&(e.entering++,t[r.index].enter(function(){e.entering--})),i}return e.pop()}},rotate:function(e){this.selection.item.outer.rotation.x=this.selection.rotation.x+e,this.selection.item.group.updateMatrixWorld(),this.adjust()},select:function(e){var t=this.items,n=this.hittables;this.unselect();var r=e.intersectObjects(n),i=null;if(r.length){var o=n.indexOf(r[0].object),a=t[o],s=a.outer.rotation.clone();i={index:o,item:a,rotation:s},this.selection=i}return i},unselect:function(){this.selection&&(this.selection=null)},update:function(){var e=this,t=e.flags;if(!e.busy())if(t.rotate){if(e.items.length){var n=e.items[0];n.outer.rotation.x+=.01,e.adjust()}}else e.fit()}},e}();window.Combiner=e}(),function(){"use strict";var e=function(){function e(e,t,n,r,i){var o=new THREE.RenderPass(e,t),a=new THREE.OutlinePass(new THREE.Vector2(r,i),e,t);a.visibleEdgeColor.set(65280),a.hiddenEdgeColor.set(0),a.edgeStrength=5,a.edgeGlow=0,a.edgeThickness=1,a.pulsePeriod=2,a.rotate=!1,a.usePatternTexture=!1;var s=new THREE.ShaderPass(THREE.FXAAShader);s.uniforms.resolution.value.set(1/r,1/i),s.renderToScreen=!0;var p=new THREE.EffectComposer(n);p.addPass(o),p.addPass(a),p.addPass(s),this.renderPass=o,this.outlinePass=a,this.fxaaPass=s,this.composer=p}return e.prototype={update:function(){this.composer.render()},resize:function(e,t){this.composer.setSize(e,t),this.fxaaPass.uniforms.resolution.value.set(1/e,1/t)},select:function(e){this.outlinePass.selectedObjects=[e]},unselect:function(){this.outlinePass.selectedObjects=[]}},e}();window.Effects=e}(),function(){"use strict";var i=!0,w=Math.PI/180;var e=function(){function e(e,t,n){var r=this;r.scene=e,r.camera=t,r.dummy=t.clone(),r.controls=n,r.projector=new THREE.Projector,r.position=new THREE.Vector3,r.target=new THREE.Vector3,r.center=new THREE.Vector3,r.size=new THREE.Vector3,r.box=new THREE.Box3,r.boxhelper=new THREE.Box3Helper(r.box,16711680),r.rotate=!1,r.target=new THREE.Vector3(0,0,0),r.distance=22,r.angle=0,r.endTarget=new THREE.Vector3(0,0,0),r.position=new THREE.Vector3(0,0,0),r.distanceMin=10,r.distanceMax=34,r.rotationAngle=1,r.dragAngle=0,r.zoom=1,r.pow=0,i&&r.scene.add(r.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var r=this,i=(r.projector,r.box),o=r.size,a=r.center,s=r.camera,p=r.controls,c=r.dummy,l=e.selection?e.selection.item.group:e.group;i.setFromObject(l),i.getCenter(a),c.position.copy(s.position),c.quaternion.copy(s.quaternion),c.up=n,c.lookAt(a),c.updateProjectionMatrix();r.toScreen(i.min),r.toScreen(i.max),r.toScreen(a);i.applyMatrix4(c.matrixWorldInverse),i.getSize(o);var u=o.x/o.y,h=s.aspect>u?o.y:o.x;s.aspect<u&&(h/=s.aspect);var d=(h*=t)/2/Math.sin(s.fov/2*w);c.position.normalize().multiplyScalar(d),r.distance=c.position.distanceTo(a),c.updateProjectionMatrix();var g=s.position.clone(),E=c.position,m=s.quaternion.clone(),f=c.quaternion,v={pow:0};TweenLite.to(v,.6,{pow:1,ease:Power2.easeOut,overwrite:"all",onUpdate:function(){s.position.lerpVectors(g,E,v.pow),THREE.Quaternion.slerp(m,f,s.quaternion,v.pow),s.updateProjectionMatrix()},onComplete:function(){p&&(p.target.copy(a),p.update())}})},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,r=window.innerHeight/2,i=e.clone();return i.project(t),i.x=(i.x+1)*n,i.y=(1-i.y)*r,i},toWorld:function(e){var t=this.projector,n=this.camera,r=window.innerWidth/2,i=window.innerHeight/2,o=e.clone();return o.x=o.x/r-1,o.y=-o.y/i+1,t.unprojectVector(o,n),o},update:function(){var e=this,t=e.target,n=e.endTarget,r=e.position,i=e.distance,o=e.zoom,a=e.dragAngle,s=e.rotationAngle,p=(e.pow,e.camera);e.rotate&&(s=e.rotationAngle+=2e-4);t.x+=(n.x-t.x)/40,t.y+=(n.y-t.y)/40,t.z+=(n.z-t.z)/40,r.x=t.x+i*o*Math.cos(a+s),r.y=t.y+i*o,r.z=t.z+i*o*Math.sin(a+s),p.position.x+=(r.x-p.position.x)/13,p.position.y+=(r.y-p.position.y)/13,p.position.z+=(r.z-p.position.z)/13,p.lookAt(t)}},e}();window.Fitter=e}(),function(){"use strict";var e=function(){function e(){this.loader=new THREE.JSONLoader}e.prototype={load:function(n){var r=this;(function(e){var t={method:"GET",responseType:"text"};if(!e||!e.url||!e.onload)return;for(var n in e)t[n]=e[n];var r=new XMLHttpRequest;r.open(t.method,t.url,!0),r.responseType=t.responseType,r.onload=function(){200===this.status&&t.onload(this.response)},t.onerror&&(r.onerror=t.onerror);t.onprogress&&(r.onerror=t.onprogress);r.send()})({url:t%2==0?"img/Curved Body 2.js":"img/Angled Emitter 1.js",onload:function(e){e=(e=e.replace(new RegExp("transparency","g"),"opacity")).replace(new RegExp(".#QNAN0","g"),".0");var t=r.loader.parse(JSON.parse(e));n(t.geometry,t.materials)}}),t++}};var t=0;return e}();window.Forge=e}(),function(){"use strict";var e=function(){var n="img/textures/",r=1;function e(e){r=e.capabilities.getMaxAnisotropy(),this.replaceShader();var t=new THREE.LoadingManager;t.onProgress=function(e,t,n){console.log("Library.manager.onProgress",e,t,n)},this.renderer=e,this.manager=t,this.textures=this.getTextures(),this.materials=this.getMaterials()}return e.prototype={getMaterials:function(){this.manager,this.loader;var e=this.textures;return{floor:new THREE.MeshPhongMaterial({bumpMap:e.floor,bumpScale:.05,color:1052688,specular:1052688,reflectivity:.15,shininess:12}),wrap:new THREE.MeshPhongMaterial({name:"wrap",color:1052688,specular:4473924,shininess:7,reflectivity:.75,specularMap:e.leatherLight,bumpMap:e.leatherBump,bumpScale:.15,combine:THREE.MixOperation}),bronze:new THREE.MeshPhongMaterial({name:"bronze",color:12615517,specular:5592405,specularMap:e.silver,shininess:10,reflectivity:.2,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.001}),gold:new THREE.MeshPhongMaterial({name:"gold",color:13151584,specular:5592405,specularMap:e.silver,shininess:10,reflectivity:.2,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.001}),green:new THREE.MeshPhongMaterial({name:"green",color:43520,specular:3355443,specularMap:e.silver,shininess:30,reflectivity:.1,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.003}),red:new THREE.MeshPhongMaterial({name:"red",color:14483456,specular:3355443,specularMap:e.silver,shininess:30,reflectivity:.1,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.003}),standard:{silver:new THREE.MeshPhongMaterial({name:"chrome",color:8947848,specular:5592405,specularMap:e.silver,shininess:30,reflectivity:.15,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.003}),black:new THREE.MeshPhongMaterial({name:"black",color:855309,reflectivity:.3,envMap:e.env,combine:THREE.MultiplyOperation})},weathered:{silver:new THREE.MeshPhongMaterial({name:"chrome",color:4473924,specular:5592405,specularMap:e.weathered,shininess:90,reflectivity:.15,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.003,map:e.weathered,roughness:.2,metalness:.5,metalnessMap:e.weathered}),black:new THREE.MeshPhongMaterial({name:"chrome",color:3355443,specular:4473924,specularMap:e.weathered,shininess:90,reflectivity:.05,envMap:e.env,combine:THREE.MixOperation,bumpMap:e.silver,bumpScale:.003,map:e.weathered,roughness:1.4,roughnessMap:e.weathered,metalness:.5,metalnessMap:e.silver})},black:{silver:new THREE.MeshPhongMaterial({name:"chrome",color:460551,specular:657930,reflectivity:.05,envMap:e.env,combine:THREE.MultiplyOperation}),black:new THREE.MeshPhongMaterial({name:"black",color:394758,specular:657930,reflectivity:.05,envMap:e.env,combine:THREE.MultiplyOperation})},light:{off:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,specular:8947848,shininess:20,reflectivity:.3}),on6:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,emissive:4473924,specular:8947848,shininess:20,reflectivity:.3}),on12:new THREE.MeshPhongMaterial({name:"light",color:16777215,emissive:8947848,specular:16777215,shininess:100,reflectivity:.3})},glare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:e.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:e.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0})},emitterGlare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:e.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:e.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:100,combine:THREE.MixOperation,reflectivity:0})}}},getTextures:function(){var e=this,t=(this.manager,{});return t.env=e.getTextureCube("env/"),t.env.anisotropy=r,t.env.format=THREE.RGBFormat,t.floor=e.getTexture("floor.jpg"),t.floor.anisotropy=r,t.floor.wrapS=THREE.RepeatWrapping,t.floor.wrapT=THREE.RepeatWrapping,t.floor.repeat.set(40,40),t.silver=e.getTexture("brushed-light.jpg"),t.silver.anisotropy=r,t.silver.wrapT=THREE.RepeatWrapping,t.weathered=e.getTexture("brushed-dark.jpg"),t.weathered.anisotropy=r,t.weathered.wrapT=THREE.RepeatWrapping,t.bump=e.getTexture("brushed-dark.jpg"),t.bump.anisotropy=r,t.bump.wrapS=THREE.RepeatWrapping,t.bump.wrapT=THREE.RepeatWrapping,t.bump.repeat.set(5,5),t.glare=e.getTexture("glare.jpg"),t.glare.anisotropy=r,t.emitterGlare=e.getTexture("emitter-glare.jpg"),t.emitterGlare.anisotropy=r,t.leatherBump=e.getTexture("leather-bump.jpg"),t.leatherBump.anisotropy=r,t.leatherBump.wrapS=THREE.RepeatWrapping,t.leatherBump.wrapT=THREE.RepeatWrapping,t.leatherLight=e.getTexture("leather-light.jpg"),t.leatherLight.anisotropy=r,t.leatherLight.wrapS=THREE.RepeatWrapping,t.leatherLight.wrapT=THREE.RepeatWrapping,t.reptileBump=e.getTexture("reptile-bump.jpg"),t.reptileBump.anisotropy=r,t.reptileBump.wrapS=THREE.RepeatWrapping,t.reptileBump.wrapT=THREE.RepeatWrapping,t.reptileLight=e.getTexture("reptile-light.jpg"),t.reptileLight.anisotropy=r,t.reptileLight.wrapS=THREE.RepeatWrapping,t.reptileLight.wrapT=THREE.RepeatWrapping,t.stingrayBump=e.getTexture("stingray-bump.jpg"),t.stingrayBump.anisotropy=r,t.stingrayBump.wrapS=THREE.RepeatWrapping,t.stingrayBump.wrapT=THREE.RepeatWrapping,t.stingrayLight=e.getTexture("stingray-light.jpg"),t.stingrayLight.anisotropy=r,t.stingrayLight.wrapS=THREE.RepeatWrapping,t.stingrayLight.wrapT=THREE.RepeatWrapping,t},getTexture:function(e){var t=this.manager;this.textures;return new THREE.TextureLoader(t).load(n+e,function(e){},function(e,t){},function(e){})},getTextureCube:function(e){var t=this.manager;this.textures;return new THREE.CubeTextureLoader(t).setPath(n+e).load(["px.jpg","nx.jpg","py.jpg","ny.jpg","pz.jpg","nz.jpg"],function(e){},function(e,t){},function(e){})},getTextureCubeHdr:function(e,r){var i=this,o=this.renderer,a=(this.manager,this.textures),t=[n+e+"px.hdr",n+e+"nx.hdr",n+e+"py.hdr",n+e+"ny.hdr",n+e+"pz.hdr",n+e+"nz.hdr"];return(new THREE.HDRCubeTextureLoader).load(THREE.UnsignedByteType,t,function(e){o.gammaInput=!0,o.gammaOutput=!0,o.toneMapping=THREE.LinearToneMapping,o.toneMappingExposure=1.3;var t=new THREE.PMREMGenerator(e);t.update(o);var n=new THREE.PMREMCubeUVPacker(t.cubeLods);n.update(o),a[r]=n.CubeUVRenderTarget,e.dispose(),i.materials.weathered.silver.envMap=n.CubeUVRenderTarget,i.materials.weathered.silver.needsUpdate=!0,i.materials.weathered.black.envMap=n.CubeUVRenderTarget,i.materials.weathered.black.needsUpdate=!0})},replaceShader:function(){var e=THREE.ShaderChunk.meshphong_frag;THREE.ShaderChunk.meshphong_frag=e.replace("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * specular + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;")}},e}();window.Library=e}(),function(){"use strict";var i=!1,d=Math.PI/180,g=11;var e=function(){function e(e,t,n){var r=this;r.scene=e,r.camera=t,r.dummy=t.clone(),r.controls=n,r.projector=new THREE.Projector,r.center=new THREE.Vector3,r.size=new THREE.Vector3,r.box=new THREE.Box3,r.boxhelper=new THREE.Box3Helper(r.box,16711680),r.rotate=!0,r.target=new THREE.Vector3(0,0,0),r.distance=2*g,r.rotationAngle=1,r.dragAngle=0,r.zoom=1,r.pow=0,r.values={target:new THREE.Vector3(0,0,0),distance:2*g,rotationAngle:0,dragAngle:0,zoom:0,pow:0},r.distanceMin=g,r.distanceMax=3*g,r.set(r.camera,r.target),i&&r.scene.add(r.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var r=this,i=(r.projector,r.box),o=r.size,a=r.center,s=r.camera,p=(r.controls,r.dummy),c=e.selection?e.selection.item.group:e.group;if(i.setFromObject(c),i.getCenter(a),i.getSize(o),0<e.items.length){r.set(p,a),p.fov=s.fov,p.aspect=s.aspect,o.applyMatrix4(p.matrixWorldInverse);var l=o.x/o.y,u=s.aspect>l?o.y:o.x;s.aspect<l&&(u/=s.aspect);var h=(u*=t)/2/Math.sin(s.fov/2*d);r.distance=h}else r.distance=g;r.distanceMin=.5*r.distance,r.distanceMax=1.5*r.distance,r.target.copy(a)},set:function(e,t){var n=this.values;e.position.x=t.x+n.distance*n.zoom*Math.cos(n.dragAngle+n.rotationAngle),e.position.y=t.y+n.distance*n.zoom,e.position.z=t.z+n.distance*n.zoom*Math.sin(n.dragAngle+n.rotationAngle),e.lookAt(t)},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,r=window.innerHeight/2,i=e.clone();return i.project(t),i.x=(i.x+1)*n,i.y=(1-i.y)*r,i},toWorld:function(e){var t=this.projector,n=this.camera,r=window.innerWidth/2,i=window.innerHeight/2,o=e.clone();return o.x=o.x/r-1,o.y=-o.y/i+1,t.unprojectVector(o,n),o},tween:function(){var e=this,t=e.target,n=e.values;e.rotate&&(e.rotationAngle+=2e-4);var r=1/15;n.target.x+=(t.x-n.target.x)*r,n.target.y+=(t.y-n.target.y)*r,n.target.z+=(t.z-n.target.z)*r,n.distance+=(e.distance-n.distance)*r,n.rotationAngle+=(e.rotationAngle-n.rotationAngle)*r,n.dragAngle+=(e.dragAngle-n.dragAngle)*r,n.zoom+=(e.zoom-n.zoom)*r,n.pow+=(e.pow-n.pow)*r},update:function(){this.tween(),this.set(this.camera,this.values.target)}},e}();window.Orbiter=e}(),function(){"use strict";if(Detector.webgl){var e=document.querySelector(".btn-add"),t=document.querySelector(".btn-remove"),n=document.querySelector(".btn-flip"),i=document.querySelector(".editor"),r=i.offsetWidth,o=i.offsetHeight,a=new Forge,s=new THREE.WebGLRenderer({alpha:!0,antialias:!0});s.setSize(r,o),i.appendChild(s.domElement);var p,c,l=new THREE.PerspectiveCamera(45,r/o,1,5e4),u=new THREE.Scene,h=new Library(s),d=function(e){var t=new THREE.Group;t.name="pivot",t.rotation.y=Math.PI/180*90;var n=new THREE.AmbientLight(4473924);e.add(n);var r=new THREE.DirectionalLight(15654365,1,2e3);r.name="light1",r.position.set(-30,20,10),t.add(r);var i=new THREE.DirectionalLight(14540270,1,2e3);return i.name="light2",i.position.set(30,20,-10),t.add(i),e.add(t),t}(u),g=(p=u,(c=new THREE.Mesh(new THREE.PlaneBufferGeometry(500,500),h.materials.floor)).name="floor",c.rotation.x=-Math.PI/2,c.position.y=-3.5,c.visible=!0,p.add(c),c),E=new Combiner(u,h);u.add(E.group);var m,f=new Orbiter(u,l),v=new Effects(u,l,s,r,o),w=new THREE.Raycaster,T=0;i.addEventListener("mousedown",function(e){y(e),window.addEventListener("mousemove",x),window.addEventListener("mouseup",H)}),i.addEventListener("touchstart",function(e){y(e),window.addEventListener("touchmove",x),window.addEventListener("touchend",H),e.stopPropagation(),e.preventDefault()}),i.addEventListener("mousewheel",function(e){e=window.event||e;var t=i.getBounds();if(Math.abs(e.pageX-t.center.x)<t.width/3){var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));f.distance+=n,f.distance=Math.min(f.distanceMax,Math.max(f.distanceMin,f.distance)),f.update(),e.preventDefault()}}),window.addEventListener("resize",function(){r=i.offsetWidth,o=i.offsetHeight,l.aspect=r/o,l.updateProjectionMatrix(),f.fit(E),s.setSize(r,o),v&&v.resize(r,o)},!1),e.addEventListener("click",R),t.addEventListener("click",function(){E.busy()||(E.remove(),f.fit(E))}),n.addEventListener("click",function(){E.flip(function(){f.fit(E)})}),function e(){!function(){E.update();var e=E.center.y-E.size.y/2-3;g.position.y+=(e-g.position.y)/8,d.position.x+=(E.center.x-d.position.x)/8,d.position.y+=(E.center.y-d.position.y)/8,d.position.z+=(E.center.z-d.position.z)/8,f.update(),v.update()}(),requestAnimationFrame(e)}(),setTimeout(R,1e3)}else Detector.addGetWebGLMessage();function R(){E.busy()||a.load(function(e,t){v&&v.unselect();var n=E.add(e,t);f.fit(E),E.entering++,n.enter(function(){E.entering--})})}function y(e){(m=getTouch(e)).relativeTo(i),m.mx=m.x,m.startDragAngle=f.dragAngle,m.startDistance=f.distance,w.setFromCamera(m,l);var t=E.select(w);t?(m.index=t.index,m.item=t.item,m.rotation=t.rotation,v&&v.select(m.item.model)):v&&v.unselect(),f.fit(E)}function x(e){T++;var t=1;if("touchmove"===e.type&&(e.stopPropagation(),e.preventDefault(),t*=4),m){var n=getTouch(e);n.relativeTo(i);var r=n.sub(m);2==n.count&&2==m.count?f.distance=m.startDistance+(m.pinchSize()-n.pinchSize())*t*10:E.selection&&E.selection.item===m.item?E.rotate(r.y*t*10):(f.dragAngle=m.startDragAngle+r.x*t*10,f.distance=m.startDistance+r.y*t*-10),f.distance=Math.min(f.distanceMax,Math.max(f.distanceMin,f.distance))}}function H(e){m&&T<5&&(m.item||E.selectedItem),m=null,T=0,window.removeEventListener("touchmove mousemove",x),window.removeEventListener("touchend mouseup",H)}}();
//# sourceMappingURL=app.min.js.map
