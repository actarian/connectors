!function(){"use strict";Element.prototype.hasClass=function(e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(this.className)},Element.prototype.addClass=function(e){this.hasClass(e)||(this.className=this.className?this.className+" "+e:e)},Element.prototype.removeClass=function(e){this.hasClass(e)&&(this.className=this.className.split(e).join("").replace(/\s\s+/g," "))},Element.prototype.isDescendant=function(e){return function e(t,n){return t===n||!!t.parentNode&&e(t.parentNode,n)}(this,e)},Element.prototype.getBounds=function(){var e={x:0,y:0,width:this.offsetWidth,height:this.offsetHeight,center:{x:0,y:0}};return e.center.x=e.width/2,e.center.y=e.height/2,e},window.getTouch=function(e){var t=new THREE.Vector2;if(t.t=new THREE.Vector2,t.relativeTo=function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,r=window.pageYOffset||document.documentElement.scrollTop;this.x=(this.x-t.left-n)/e.offsetWidth*2-1,this.y=-(this.y-t.top-r)/e.offsetHeight*2+1},t.pinchSize=function(){return Math.sqrt((this.x-this.t.x)*(this.x-this.t.x)+(this.y-this.t.y)*(this.y-this.t.y))},t.count=1,"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var n=null,r=null,a=e.originalEvent?e.originalEvent.touches||e.originalEvent.changedTouches:e.touches||e.changedTouches;a&&a.length&&(n=a[0],1<a.length&&(r=a[1])),n&&(t.x=n.pageX,t.y=n.pageY),r&&(t.t.x=r.pageX,t.t.y=r.pageY,t.count=2)}else"click"!=e.type&&"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(t.x=e.pageX,t.y=e.pageY);return t}}(),function(){"use strict";function r(e,t,n){return e.filter(function(e){return e.angleTo(t)<n*Math.PI/180}).reduce(function(e,t){return e.clone().add(t)}).normalize()}var b={HELPER:!(THREE.GeometryUtils.computeVertexNormals=function(e,t){e.computeFaceNormals();var n=e.vertices.map(function(){return[]});e.faces.map(function(e){n[e.a].push(e.normal),n[e.b].push(e.normal),n[e.c].push(e.normal)}),e.faces.map(function(e){e.vertexNormals[0]=r(n[e.a],e.normal,t),e.vertexNormals[1]=r(n[e.b],e.normal,t),e.vertexNormals[2]=r(n[e.c],e.normal,t)}),0<e.faces.length&&(e.normalsNeedUpdate=!0)}),JOINTS:!1,MODELS:!0,ANGLE:!1},y=(Math.PI,.025),H=0;var x=new THREE.Quaternion;x.setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI);var o=function(){function e(){var e=this;e.size=new THREE.Vector3,e.box=new THREE.Box3,e.group=new THREE.Group,e.outer=new THREE.Group,e.inner=new THREE.Group}return e.prototype={enter:function(e){var t=this;t.outer.position.x=t.size.x,TweenLite.to(t.outer.position,.6,{x:0,ease:Power2.easeOut,overwrite:"all",onComplete:function(){"function"==typeof e&&e()}})},load:function(e,t){for(var n=this,r=n.box,a=n.size,i=n.group,o=n.outer,s=n.inner,l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,p=0;p<e.vertices.length;p++)e.vertices[p].x*=y,e.vertices[p].y*=y,e.vertices[p].z*=y,l=Math.min(l,e.vertices[p].x),c=Math.max(c,e.vertices[p].x);var u=(c+l)/2;s.position.x=u,console.log(l,c,u);var d=new THREE.Mesh(e,t);r.setFromObject(d),r.getSize(a);var h=n.getJoints(e,t,a);n.quaternionL=d.quaternion.clone();var E=(new THREE.Quaternion).setFromUnitVectors(h.left.normal.clone().multiplyScalar(-1),h.right.normal);if(n.quaternionR=(new THREE.Quaternion).multiplyQuaternions(n.quaternionL,x).multiply(E.inverse()),n.positionL=new THREE.Vector3,n.positionR=h.left.origin.clone().sub(h.right.origin.clone().applyQuaternion(n.quaternionR)),d.geometry.mergeVertices(),THREE.GeometryUtils.computeVertexNormals(d.geometry,20),d.geometry.verticesNeedUpdate=!0,d.geometry.uvsNeedUpdate=!0,d.geometry=(new THREE.BufferGeometry).fromGeometry(d.geometry),Curvature.setGeometry(d.geometry),b.MODELS){t[1].color=new THREE.Color(0),e=new THREE.BoxGeometry(a.x,a.y,a.z);var m=new THREE.MeshStandardMaterial({color:new THREE.Color(.2*++H,0,0),wireframe:!1,transparent:!1,opacity:1});d=new THREE.Mesh(e,m)}for(var g in h){var f=h[g],v=f.normal.x,w=f.normal.y,T=-f.normal.z,R=new THREE.Euler(0,Math.atan2(T,v),Math.atan2(w,Math.sqrt(v*v+T*T)));if(f.rotation.copy(R),d.add(f),b.JOINTS){var M=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:f.color}));f.add(M)}}s.position.set(a.x/2-u,0,0),s.add(d),o.add(s),i.add(o),n.joints=h,n.model=d},flip:function(e){var t=this;t.inner;t.flipped=!t.flipped;var n={pow:t.flipped?0:1};TweenLite.to(n,.3,{pow:t.flipped?1:0,ease:Power2.easeOut,overwrite:"all",onUpdate:function(){THREE.Quaternion.slerp(t.quaternionL,t.quaternionR,t.model.quaternion,n.pow),t.model.position.lerpVectors(t.positionL,t.positionR,n.pow)},onComplete:function(){"function"==typeof e&&e()}})},getJoints:function(e,t,n){var r,a,i={},o={},s=["left","right","top","bottom"],l=[16711680,65280,255,16776960];t.filter(function(e,t){var n=s.indexOf(e.name);if(-1!==n){var r=new THREE.Group;r.name=s[n],r.color=l[n],r.vertices=[],i[e.name]=r,o[t]=r}});for(var c=0;c<e.faces.length;c++)a=e.faces[c],(r=o[String(a.materialIndex)])&&(r.normal=r.normal||a.normal,r.vertices.push(e.vertices[a.a]),r.vertices.push(e.vertices[a.b]),r.vertices.push(e.vertices[a.c]));for(var p in i)(r=i[p]).position.copy((u=r.vertices,void 0,d=u.reduce(function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}),(new THREE.Vector3).add(d).divideScalar(u.length))),r.origin=r.position.clone(),r.vertices=null;var u,d;i.left||(i.left=new THREE.Group,i.left.position.set(-n.x/2,0,0),i.left.origin=i.left.position.clone(),i.left.normal=new THREE.Vector3(-1,0,0),i.left.c=l[0]);i.right||(i.right=new THREE.Group,i.right.position.set(n.x/2,0,0),i.right.origin=i.right.position.clone(),i.right.normal=new THREE.Vector3(1,0,0),i.right.c=l[1]);b.ANGLE&&(i.right.normal.y+=.2);return i},setFlip:function(){var e=this,t=e.model;t.quaternion.copy(e.flipped?e.quaternionR:e.quaternionL),t.position.copy(e.flipped?e.positionR:e.positionL),e.group.updateMatrixWorld()}},e}(),e=function(){function e(e){var t=this;t.flags={rotate:!1},t.scene=e,t.flipping=0,t.entering=0,t.items=[],t.hittables=[],t.center=new THREE.Vector3,t.size=new THREE.Vector3,t.group=new THREE.Group,t.box=new THREE.Box3,b.HELPER&&(t.boxhelper=new THREE.Box3Helper(t.box,16711935),t.originhelper=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:11141375})),t.centerhelper=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshBasicMaterial({color:16711935})),t.group.add(t.originhelper),e.add(t.boxhelper),e.add(t.centerhelper)),e.add(t.group)}return e.prototype={add:function(e,t){var n=this,r=(n.box,n.size,n.items),a=(n.hittables,n.group);n.unselect();var i=new o;return i.load(e,t),r.push(i),n.hittables=r.map(function(e){return e.model}),a.add(i.group),i.setFlip(),n.adjust(),i},adjust:function(){this.combine(),this.fit()},busy:function(){return this.entering||this.flipping},combine:function(){var n,e=this.items,r=(this.group,new THREE.Quaternion),a=(new THREE.Vector3,new THREE.Vector3);e.length&&e.filter(function(e,t){e.flipped?(e.joints.right,n=e.joints.left):(e.joints.left,n=e.joints.right);0<t&&(e.group.setRotationFromQuaternion(r),e.group.position.copy(a));n.getWorldQuaternion(r),n.getWorldPosition(a)})},fit:function(){var e=this,t=e.box,n=e.size,r=e.center,a=e.centerhelper,i=e.group;t.setFromObject(i),t.getCenter(r),t.getSize(n),b.HELPER&&a.position.copy(r);return n},flip:function(e){this.selection&&this.flipItem(this.selection.item,e)},flipItem:function(e,t){var n=this;n.flipping++,e.flip(function(){n.flipping--,n.adjust(),"function"==typeof t&&setTimeout(function(){t()},100)})},hitAndFlip:function(e,t){var n=this.items,r=this.hittables,a=e.intersectObjects(r);if(a.length){var i=r.indexOf(a[0].object),o=n[i];this.flipItem(o,t)}},prev:function(){var e=this.items,t=null;if(e.length){var n=this.selection?this.selection.index:0;n=n-1<0?e.length-1:n-1;var r=e[n],a=r.outer.rotation.clone();t={index:n,item:r,rotation:a},this.selection=t}return t},pop:function(){var e=this,t=e.items,n=(e.hittables,e.group);if(t.length){var r=t.pop();return r.group.parent&&n.remove(r.group),e.hittables=t.map(function(e){return e.model}),e.adjust(),r}},next:function(){var e=this.items,t=null;if(e.length){var n=this.selection?this.selection.index:-1;n=n+1>=e.length?0:n+1;var r=e[n],a=r.outer.rotation.clone();t={index:n,item:r,rotation:a},this.selection=t}return t},remove:function(){var e=this,t=e.items,n=(e.hittables,e.group);{if(e.selection){var r=e.selection,a=r.item;return t.splice(r.index,1),a.group.parent&&n.remove(a.group),e.hittables=t.map(function(e){return e.model}),e.unselect(),e.adjust(),t.length>r.index&&(e.entering++,t[r.index].enter(function(){e.entering--})),a}return e.pop()}},rotate:function(e){this.selection.item.outer.rotation.x=this.selection.rotation.x+e,this.selection.item.group.updateMatrixWorld(),this.adjust()},select:function(e){var t=this.items,n=this.hittables;this.unselect();var r=e.intersectObjects(n),a=null;if(r.length){var i=n.indexOf(r[0].object),o=t[i],s=o.outer.rotation.clone();a={index:i,item:o,rotation:s},this.selection=a}return a},selectedItem:function(e){this.selection&&"function"==typeof e&&e(this.selection.item)},selectedModel:function(e){this.selection&&"function"==typeof e&&e(this.selection.item.model)},unselect:function(){this.selection&&(this.selection=null)},update:function(){var e=this,t=e.flags;if(!e.busy())if(t.rotate){if(e.items.length){var n=e.items[0];n.outer.rotation.x+=.01,e.adjust()}}else e.fit()}},e}();window.Combiner=e}(),function(){"use strict";var e=function(){function e(){}return e.setGeometry=function(e){var t,n,r,a,i,o,s,l,c,p,u,d,h,E,m,g,f,v,w,T,R,M={};for(n=e.attributes.position.array,r=e.attributes.normal.array,t=0;t<e.attributes.position.count;t+=3)a=new THREE.Vector3(n[3*t],n[3*t+1],n[3*t+2]),i=new THREE.Vector3(n[3*(t+1)],n[3*(t+1)+1],n[3*(t+1)+2]),o=new THREE.Vector3(n[3*(t+2)],n[3*(t+2)+1],n[3*(t+2)+2]),s=new THREE.Vector3(r[3*t],r[3*t+1],r[3*t+2]).normalize(),l=new THREE.Vector3(r[3*(t+1)],r[3*(t+1)+1],r[3*(t+1)+2]).normalize(),c=new THREE.Vector3(r[3*(t+2)],r[3*(t+2)+1],r[3*(t+2)+2]).normalize(),p=a.toArray().toString(),u=i.toArray().toString(),d=o.toArray().toString(),h=(new THREE.Vector3).subVectors(i,a),E=(new THREE.Vector3).subVectors(i,o),m=(new THREE.Vector3).subVectors(o,a),(new THREE.Vector3).subVectors(l,s),(new THREE.Vector3).subVectors(l,c),(new THREE.Vector3).subVectors(c,s),g=l.dot(h.normalize()),f=l.dot(E.normalize()),v=c.dot(m.normalize()),w=-s.dot(h.normalize()),T=-c.dot(E.normalize()),R=-s.dot(m.normalize()),M[p]=M[p]||{},M[p][u]=w,M[p][d]=R,M[u]=M[u]||{},M[u][p]=g,M[u][d]=f,M[d]=M[d]||{},M[d][p]=v,M[d][u]=T;var b={},y=1e3,H=0;Object.keys(M).forEach(function(e){var t,n,r;b[e]=(t=M[e],r=n=0,Object.keys(t).forEach(function(e){n+=t[e],r++}),n/r)}),Object.keys(b).forEach(function(e){var t=Math.abs(b[e]);t<y&&(y=t),H<t&&(H=t)});var x=H-y;console.log("range",x),Object.keys(b).forEach(function(e){var t=Math.abs(b[e]);b[e]<0?b[e]=(y-t)/x:b[e]=(t-y)/x});var S,L,z,P=new Float32Array(e.attributes.position.count);for(t=0;t<e.attributes.position.count;t++)n=e.attributes.position.array,S=new THREE.Vector3(n[3*t],n[3*t+1],n[3*t+2]),L=S.toArray().toString(),z=b[L],z=THREE.Math.clamp(2*THREE.Math.smoothstep(z,0,1),0,1),P[t]=z;e.addAttribute("curvature",new THREE.BufferAttribute(P,1))},e.setEdges=function(e,t){t=t||90;var n,r=Math.cos(THREE.Math.DEG2RAD*t),a=e.faces;e=(new THREE.BufferGeometry).fromGeometry(e);var i,o,s,l,c,p,u,d,h,E,m,g,f,v={},w=e.attributes.normal.array;function T(e,t,n,r,a){s=Math.min(e,t),l=Math.max(e,t),void 0===v[o=s+"-"+l]?v[o]={a:n,b:r,c:n,d:r,fa:a,fb:void 0}:(v[o].fb=a,v[o].c=n,v[o].d=r)}for(var R=0;R<a.length;R++)n=a[R],c=9*R,h=n.a,E=n.b,m=n.c,d=(p=c)+6,T(h,E,p,u=c+3,c),T(E,m,u,d,c),T(m,h,d,p,c);var M=new Float32Array(e.attributes.position.count);for(c=0;c<e.attributes.position.count;c++)M[c]=1;var b=Object.keys(v);console.log(b.length);var y=0;function H(e){M[e.a/3]=0,M[e.b/3]=0,M[e.c/3]=0,M[e.d/3]=0,y++}for(o in v)void 0===(i=v[o]).fb?H(i):(p=i.fa,u=i.fb,g=new THREE.Vector3(w[p],w[p+1],w[p+2]),f=new THREE.Vector3(w[u],w[u+1],w[u+2]),g.dot(f)<=r&&H(i));return e.addAttribute("curvature",new THREE.BufferAttribute(M,1)),console.log("matches",y,(y/b.length*100).toFixed(2)),e},e}();window.Curvature=e}(),function(){"use strict";var e=function(){function e(e,t,n,r,a){var i=new THREE.RenderPass(e,t),o=new THREE.OutlinePass(new THREE.Vector2(r,a),e,t);o.visibleEdgeColor.set(65280),o.hiddenEdgeColor.set(0),o.edgeStrength=5,o.edgeGlow=0,o.edgeThickness=1,o.pulsePeriod=2,o.rotate=!1,o.usePatternTexture=!1;var s=new THREE.ShaderPass(THREE.FXAAShader);s.uniforms.resolution.value.set(1/r,1/a),s.renderToScreen=!0;var l=new THREE.EffectComposer(n);l.addPass(i),l.addPass(o),l.addPass(s),this.renderPass=i,this.outlinePass=o,this.fxaaPass=s,this.composer=l}return e.prototype={update:function(){this.composer.render()},resize:function(e,t){this.composer.setSize(e,t),this.fxaaPass.uniforms.resolution.value.set(1/e,1/t)},select:function(e){this.outlinePass.selectedObjects=[e]},unselect:function(){this.outlinePass.selectedObjects=[]}},e}();window.Effects=e}(),function(){"use strict";var a=!0,w=Math.PI/180;var e=function(){function e(e,t,n){var r=this;r.scene=e,r.camera=t,r.dummy=t.clone(),r.controls=n,r.projector=new THREE.Projector,r.position=new THREE.Vector3,r.target=new THREE.Vector3,r.center=new THREE.Vector3,r.size=new THREE.Vector3,r.box=new THREE.Box3,r.boxhelper=new THREE.Box3Helper(r.box,16711680),r.rotate=!1,r.target=new THREE.Vector3(0,0,0),r.distance=22,r.angle=0,r.endTarget=new THREE.Vector3(0,0,0),r.position=new THREE.Vector3(0,0,0),r.distanceMin=10,r.distanceMax=34,r.rotationAngle=1,r.dragAngle=0,r.zoom=1,r.pow=0,a&&r.scene.add(r.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var r=this,a=(r.projector,r.box),i=r.size,o=r.center,s=r.camera,l=r.controls,c=r.dummy,p=e.selection?e.selection.item.group:e.group;a.setFromObject(p),a.getCenter(o),c.position.copy(s.position),c.quaternion.copy(s.quaternion),c.up=n,c.lookAt(o),c.updateProjectionMatrix();r.toScreen(a.min),r.toScreen(a.max),r.toScreen(o);a.applyMatrix4(c.matrixWorldInverse),a.getSize(i);var u=i.x/i.y,d=s.aspect>u?i.y:i.x;s.aspect<u&&(d/=s.aspect);var h=(d*=t)/2/Math.sin(s.fov/2*w);c.position.normalize().multiplyScalar(h),r.distance=c.position.distanceTo(o),c.updateProjectionMatrix();var E=s.position.clone(),m=c.position,g=s.quaternion.clone(),f=c.quaternion,v={pow:0};TweenLite.to(v,.6,{pow:1,ease:Power2.easeOut,overwrite:"all",onUpdate:function(){s.position.lerpVectors(E,m,v.pow),THREE.Quaternion.slerp(g,f,s.quaternion,v.pow),s.updateProjectionMatrix()},onComplete:function(){l&&(l.target.copy(o),l.update())}})},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,r=window.innerHeight/2,a=e.clone();return a.project(t),a.x=(a.x+1)*n,a.y=(1-a.y)*r,a},toWorld:function(e){var t=this.projector,n=this.camera,r=window.innerWidth/2,a=window.innerHeight/2,i=e.clone();return i.x=i.x/r-1,i.y=-i.y/a+1,t.unprojectVector(i,n),i},update:function(){var e=this,t=e.target,n=e.endTarget,r=e.position,a=e.distance,i=e.zoom,o=e.dragAngle,s=e.rotationAngle,l=(e.pow,e.camera);e.rotate&&(s=e.rotationAngle+=2e-4);t.x+=(n.x-t.x)/40,t.y+=(n.y-t.y)/40,t.z+=(n.z-t.z)/40,r.x=t.x+a*i*Math.cos(o+s),r.y=t.y+a*i,r.z=t.z+a*i*Math.sin(o+s),l.position.x+=(r.x-l.position.x)/13,l.position.y+=(r.y-l.position.y)/13,l.position.z+=(r.z-l.position.z)/13,l.lookAt(t)}},e}();window.Fitter=e}(),function(){"use strict";var e=function(){function e(){this.loader=new THREE.JSONLoader}e.prototype={load:function(n){var r=this;(function(e){var t={method:"GET",responseType:"text"};if(!e||!e.url||!e.onload)return;for(var n in e)t[n]=e[n];var r=new XMLHttpRequest;r.open(t.method,t.url,!0),r.responseType=t.responseType,r.onload=function(){200===this.status&&t.onload(this.response)},t.onerror&&(r.onerror=t.onerror);t.onprogress&&(r.onerror=t.onprogress);r.send()})({url:t%2==0?"img/Curved Body 1.js":"img/Angled Emitter 1.js",onload:function(e){e=(e=e.replace(new RegExp("transparency","g"),"opacity")).replace(new RegExp(".#QNAN0","g"),".0");var t=r.loader.parse(JSON.parse(e));n(t.geometry,t.materials)}}),t++}};var t=0;return e}();window.Forge=e}(),function(){"use strict";var e=function(){var t={FINISHES:["standard","black","weathered"],randomFinish:function(){return{key:t.FINISHES[Math.floor(Math.random()*t.FINISHES.length)],color:null}},randomSecondaryFinish:function(){return{key:t.FINISHES[Math.floor(Math.random()*t.FINISHES.length)],color:null}}},n="img/textures/",r=1,a=!1;function c(e){r=e.capabilities.getMaxAnisotropy(),this.replaceShader();var t=new THREE.LoadingManager;this.renderer=e,this.manager=t,this.textures=this.getTextures(),this.materials=this.getMaterials()}function i(e,t){var n=new THREE.StandardNodeMaterial,r=new THREE.AttributeNode("curvature","float"),a=new THREE.ColorNode(263172),i=new THREE.TextureNode(t.brushed),o=new THREE.Math3Node(a,i,r,THREE.Math3Node.MIX);n.color=o;var s=new THREE.FloatNode(.6),l=new THREE.FloatNode(.5),c=new THREE.Math3Node(s,l,r,THREE.Math3Node.MIX);n.roughness=c,n.metalness=new THREE.FloatNode(.7);var p=new THREE.Math3Node(new THREE.ColorNode(263172),new THREE.CubeTextureNode(t.env),r,THREE.Math3Node.MIX);return n.environment=p,n.name=e,n.build(),n}return c.prototype={getMaterials:function(){this.manager,this.loader;var e,t=this.textures;e=a?{floor:new THREE.MeshPhongMaterial({bumpMap:t.floor,bumpScale:.05,color:1052688,specular:1052688,reflectivity:.15,shininess:12}),wrap:new THREE.MeshPhongMaterial({name:"wrap",color:1052688,specular:4473924,shininess:7,reflectivity:.75,specularMap:t.leatherLight,bumpMap:t.leatherBump,bumpScale:.15,combine:THREE.MixOperation}),bronze:new THREE.MeshPhongMaterial({name:"bronze",color:12615517,specular:5592405,specularMap:t.silver,shininess:10,reflectivity:.2,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.001}),gold:new THREE.MeshPhongMaterial({name:"gold",color:13151584,specular:5592405,specularMap:t.silver,shininess:10,reflectivity:.2,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.001}),green:new THREE.MeshPhongMaterial({name:"green",color:43520,specular:3355443,specularMap:t.silver,shininess:30,reflectivity:.1,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.003}),red:new THREE.MeshPhongMaterial({name:"red",color:14483456,specular:3355443,specularMap:t.silver,shininess:30,reflectivity:.1,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.003}),standard:{silver:new THREE.MeshPhongMaterial({name:"silver",color:8947848,specular:5592405,specularMap:t.silver,shininess:30,reflectivity:.15,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.003}),black:new THREE.MeshPhongMaterial({name:"black",color:855309,reflectivity:.3,envMap:t.env,combine:THREE.MultiplyOperation})},weathered:{silver:new THREE.MeshPhongMaterial({name:"silver",color:4473924,specular:5592405,specularMap:t.weathered,shininess:90,reflectivity:.15,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.003,map:t.weathered,roughness:.2,metalness:.5,metalnessMap:t.weathered}),black:new THREE.MeshPhongMaterial({name:"black",color:3355443,specular:4473924,specularMap:t.weathered,shininess:90,reflectivity:.05,envMap:t.env,combine:THREE.MixOperation,bumpMap:t.silver,bumpScale:.003,map:t.weathered,roughness:1.4,roughnessMap:t.weathered,metalness:.5,metalnessMap:t.silver})},black:{silver:new THREE.MeshPhongMaterial({name:"silver",color:460551,specular:657930,reflectivity:.05,envMap:t.env,combine:THREE.MultiplyOperation}),black:new THREE.MeshPhongMaterial({name:"black",color:394758,specular:657930,reflectivity:.05,envMap:t.env,combine:THREE.MultiplyOperation})},light:{off:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,specular:8947848,shininess:20,reflectivity:.3}),on6:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,emissive:4473924,specular:8947848,shininess:20,reflectivity:.3}),on12:new THREE.MeshPhongMaterial({name:"light",color:16777215,emissive:8947848,specular:16777215,shininess:100,reflectivity:.3})},glare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:t.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:t.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0})},emitterGlare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:t.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:t.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:100,combine:THREE.MixOperation,reflectivity:0})}}:{floor:new THREE.MeshStandardMaterial({name:"floor",color:1052688,roughness:.5,metalness:.1,bumpMap:t.floor,bumpScale:.05,envMap:t.env}),wrap:new THREE.MeshPhongMaterial({name:"wrap",color:1052688,specular:4473924,shininess:7,reflectivity:.75,specularMap:t.leatherLight,bumpMap:t.leatherBump,bumpScale:.15}),bronze:new THREE.MeshStandardMaterial({name:"bronze",color:12615517,roughness:.5,roughnessMap:t.silver,metalness:.9,metalnessMap:t.weathered,envMap:t.env,envMapIntensity:.15}),gold:new THREE.MeshStandardMaterial({name:"gold",color:13151584,roughness:.5,roughnessMap:t.silver,metalness:.9,metalnessMap:t.weathered,envMap:t.env,envMapIntensity:.15}),green:new THREE.MeshPhongMaterial({name:"green",color:43520,specular:3355443,specularMap:t.silver,shininess:30,reflectivity:.1,envMap:t.env,bumpMap:t.silver,bumpScale:.003}),red:new THREE.MeshPhongMaterial({name:"red",color:14483456,specular:3355443,specularMap:t.silver,shininess:30,reflectivity:.1,envMap:t.env,bumpMap:t.silver,bumpScale:.003}),standard:{silver:new THREE.MeshStandardMaterial({name:"silver",color:8947848,roughness:.4,metalness:.99,metalnessMap:t.brushed,envMap:t.env,envMapIntensity:1,bumpMap:t.brushed,bumpScale:.01}),black:new THREE.MeshStandardMaterial({name:"black",color:1052688,roughness:.5,metalness:.99,metalnessMap:t.sand,envMap:t.env,envMapIntensity:1,bumpMap:t.sand,bumpScale:.015})},weathered:{silver:i("silver",t),black:i("black",t),_silver:new THREE.MeshStandardMaterial({name:"silver",color:5592405,map:t.brushed,roughness:.6,roughnessMap:t.weatheredInverted,metalness:.99,envMap:t.env,envMapIntensity:1}),_black:new THREE.MeshStandardMaterial({name:"black",color:4473924,map:t.brushed,roughness:.6,roughnessMap:t.weatheredInverted,metalness:.99,envMap:t.env,envMapIntensity:1})},black:{silver:new THREE.MeshStandardMaterial({name:"silver",color:1250067,roughness:.5,metalness:.99,metalnessMap:t.sand,envMap:t.env,envMapIntensity:1,bumpMap:t.sand,bumpScale:.015}),black:new THREE.MeshStandardMaterial({name:"black",color:1052688,roughness:.5,metalness:.99,metalnessMap:t.sand,envMap:t.env,envMapIntensity:1,bumpMap:t.sand,bumpScale:.015})},light:{off:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,specular:8947848,shininess:20,reflectivity:.3}),on6:new THREE.MeshPhongMaterial({name:"light",opacity:.98,transparent:!0,color:4473924,emissive:4473924,specular:8947848,shininess:20,reflectivity:.3}),on12:new THREE.MeshPhongMaterial({name:"light",color:16777215,emissive:8947848,specular:16777215,shininess:100,reflectivity:.3})},glare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:t.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:t.glare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0})},emitterGlare:{off:new THREE.MeshLambertMaterial({name:"glare",opacity:0,transparent:!0,color:0}),on6:new THREE.MeshLambertMaterial({name:"glare",opacity:.6,transparent:!0,color:15529211,map:t.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:0,combine:THREE.MixOperation,reflectivity:0}),on12:new THREE.MeshLambertMaterial({name:"glare",opacity:.85,transparent:!0,color:15529211,map:t.emitterGlare,blending:THREE.AdditiveBlending,specular:0,shininess:100,combine:THREE.MixOperation,reflectivity:0})}};return e.left=new THREE.MeshPhongMaterial({name:"left",color:new THREE.Color(16711680),visible:!1}),e.right=new THREE.MeshPhongMaterial({name:"right",color:new THREE.Color(65280),visible:!1}),e.top=new THREE.MeshPhongMaterial({name:"top",color:new THREE.Color(255),visible:!1}),e.bottom=new THREE.MeshPhongMaterial({name:"bottom",color:new THREE.Color(16776960),visible:!1}),e},getTextures:function(){var e=this,t=(this.manager,{});return t.env=e.getTextureCube("env/"),t.env.anisotropy=r,t.env.format=THREE.RGBFormat,t.floor=e.getTexture("floor.jpg"),t.floor.anisotropy=r,t.floor.wrapS=THREE.RepeatWrapping,t.floor.wrapT=THREE.RepeatWrapping,t.floor.repeat.set(40,40),t.silver=e.getTexture("brushed-light.jpg"),t.silver.anisotropy=r,t.silver.wrapT=THREE.RepeatWrapping,t.weathered=e.getTexture("weathered-512-tile.jpg"),t.weathered.anisotropy=r,t.weathered.wrapS=THREE.RepeatWrapping,t.weathered.wrapT=THREE.RepeatWrapping,t.weathered.repeat.set(2,8),t.weatheredInverted=e.getTexture("weathered-512-inverted.jpg"),t.weatheredInverted.anisotropy=r,t.weatheredInverted.wrapS=THREE.RepeatWrapping,t.weatheredInverted.wrapT=THREE.RepeatWrapping,t.weatheredInverted.repeat.set(2,8),t.sand=e.getTexture("sand.bump.jpg"),t.sand.anisotropy=r,t.sand.wrapS=THREE.RepeatWrapping,t.sand.wrapT=THREE.RepeatWrapping,t.sand.repeat.set(2,6),t.brushed=e.getTexture("brushed-512-tile.jpg"),t.brushed.anisotropy=r,t.brushed.wrapS=THREE.RepeatWrapping,t.brushed.wrapT=THREE.RepeatWrapping,t.brushed.repeat.set(2,2),t.bump=e.getTexture("brushed-dark.jpg"),t.bump.anisotropy=r,t.bump.wrapS=THREE.RepeatWrapping,t.bump.wrapT=THREE.RepeatWrapping,t.bump.repeat.set(5,5),t.glare=e.getTexture("glare.jpg"),t.glare.anisotropy=r,t.emitterGlare=e.getTexture("emitter-glare.jpg"),t.emitterGlare.anisotropy=r,t.leatherBump=e.getTexture("leather-bump.jpg"),t.leatherBump.anisotropy=r,t.leatherBump.wrapS=THREE.RepeatWrapping,t.leatherBump.wrapT=THREE.RepeatWrapping,t.leatherLight=e.getTexture("leather-light.jpg"),t.leatherLight.anisotropy=r,t.leatherLight.wrapS=THREE.RepeatWrapping,t.leatherLight.wrapT=THREE.RepeatWrapping,t.reptileBump=e.getTexture("reptile-bump.jpg"),t.reptileBump.anisotropy=r,t.reptileBump.wrapS=THREE.RepeatWrapping,t.reptileBump.wrapT=THREE.RepeatWrapping,t.reptileLight=e.getTexture("reptile-light.jpg"),t.reptileLight.anisotropy=r,t.reptileLight.wrapS=THREE.RepeatWrapping,t.reptileLight.wrapT=THREE.RepeatWrapping,t.stingrayBump=e.getTexture("stingray-bump.jpg"),t.stingrayBump.anisotropy=r,t.stingrayBump.wrapS=THREE.RepeatWrapping,t.stingrayBump.wrapT=THREE.RepeatWrapping,t.stingrayLight=e.getTexture("stingray-light.jpg"),t.stingrayLight.anisotropy=r,t.stingrayLight.wrapS=THREE.RepeatWrapping,t.stingrayLight.wrapT=THREE.RepeatWrapping,t},getTexture:function(e){var t=this.manager;this.textures;return new THREE.TextureLoader(t).load(n+e,function(e){},function(e,t){},function(e){})},getTextureCube:function(e){var t=this.manager;this.textures;return new THREE.CubeTextureLoader(t).setPath(n+e).load(["px.jpg","nx.jpg","py.jpg","ny.jpg","pz.jpg","nz.jpg"],function(e){},function(e,t){},function(e){})},getTextureCubeHdr:function(e,r){var a=this,i=this.renderer,o=(this.manager,this.textures),t=[n+e+"px.hdr",n+e+"nx.hdr",n+e+"py.hdr",n+e+"ny.hdr",n+e+"pz.hdr",n+e+"nz.hdr"];return(new THREE.HDRCubeTextureLoader).load(THREE.UnsignedByteType,t,function(e){i.gammaInput=!0,i.gammaOutput=!0,i.toneMapping=THREE.LinearToneMapping,i.toneMappingExposure=1.3;var t=new THREE.PMREMGenerator(e);t.update(i);var n=new THREE.PMREMCubeUVPacker(t.cubeLods);n.update(i),o[r]=n.CubeUVRenderTarget,e.dispose(),a.materials.weathered.silver.envMap=n.CubeUVRenderTarget,a.materials.weathered.silver.needsUpdate=!0,a.materials.weathered.black.envMap=n.CubeUVRenderTarget,a.materials.weathered.black.needsUpdate=!0})},replaceShader:function(){var e=THREE.ShaderChunk.meshphong_frag;THREE.ShaderChunk.meshphong_frag=e.replace("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * specular + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;")},setFinish:function(e,n){n=n||t.randomFinish(),e=e.length?e:[e],console.log("library.setFinish",e,n);var r=this;return e.map(function(e,t){switch(e.name){case"silver":case"black":e=r.materials[n.key][e.name]}return e})},setNextFloor:function(){this.materials;var e=this.materials.floor;switch(c.FLOOR=(c.FLOOR+1)%4){case 0:e.color.set(1052688),e.roughness=.5,e.metalness=.1,e.bumpScale=.05;break;case 1:e.color.set(11450305),e.roughness=.5,e.metalness=.1,e.bumpScale=.05;break;case 2:e.color.set(1052688),e.roughness=.5,e.metalness=.1,e.bumpScale=1e-4;break;case 3:e.color.set(11450305),e.roughness=.5,e.metalness=.1,e.bumpScale=1e-4}console.log("library.setNextFloor",c.FLOOR),e.needsUpdate=!0},updateMaterials:function(e,n,r){n=n||t.randomFinish();var a,i,o,s=this,l=this.textures;return e.map(function(e,t){switch(e.name=e.name.replace("chrome","silver"),e.name){case"silver":case"black":a=n.key,e=s.materials[a][e.name];break;case"wrap":a=r.key,i=r.color,e=s.materials.wrap.clone(),-1!=a.indexOf("Leather")?o="leather":-1!=a.indexOf("Reptile")?o="reptile":-1!=a.indexOf("Stingray")&&(o="stingray"),i=c.hexToRgb(i),e.color.r=i.r/255,e.color.g=i.g/255,e.color.b=i.b/255,e.specularMap=l[o+"Light"],e.bumpMap=l[o+"Bump"];break;case"bronze":case"gold":case"red":case"green":case"left":case"right":case"top":case"bottom":e=s.materials[e.name]}return e})}},c.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},c.FLOOR=0,c}();window.Library=e}(),function(){"use strict";var a=!1,h=Math.PI/180,E=11;var e=function(){function e(e,t,n){var r=this;r.scene=e,r.camera=t,r.dummy=t.clone(),r.controls=n,r.projector=new THREE.Projector,r.center=new THREE.Vector3,r.size=new THREE.Vector3,r.box=new THREE.Box3,r.boxhelper=new THREE.Box3Helper(r.box,16711680),r.rotate=!0,r.target=new THREE.Vector3(0,0,0),r.distance=2*E,r.rotationAngle=1,r.dragAngle=0,r.zoom=1,r.pow=0,r.values={target:new THREE.Vector3(0,0,0),distance:2*E,rotationAngle:0,dragAngle:0,zoom:0,pow:0},r.distanceMin=E,r.distanceMax=3*E,r.set(r.camera,r.target),a&&r.scene.add(r.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var r=this,a=(r.projector,r.box),i=r.size,o=r.center,s=r.camera,l=(r.controls,r.dummy),c=e.selection?e.selection.item.group:e.group;if(a.setFromObject(c),a.getCenter(o),a.getSize(i),0<e.items.length){r.set(l,o),l.fov=s.fov,l.aspect=s.aspect,i.applyMatrix4(l.matrixWorldInverse);var p=i.x/i.y,u=s.aspect>p?i.y:i.x;s.aspect<p&&(u/=s.aspect);var d=(u*=t)/2/Math.sin(s.fov/2*h);r.distance=d}else r.distance=E;r.distanceMin=.5*r.distance,r.distanceMax=1.5*r.distance,r.target.copy(o)},set:function(e,t){var n=this.values;e.position.x=t.x+n.distance*n.zoom*Math.cos(n.dragAngle+n.rotationAngle),e.position.y=t.y+n.distance*n.zoom,e.position.z=t.z+n.distance*n.zoom*Math.sin(n.dragAngle+n.rotationAngle),e.lookAt(t)},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,r=window.innerHeight/2,a=e.clone();return a.project(t),a.x=(a.x+1)*n,a.y=(1-a.y)*r,a},toWorld:function(e){var t=this.projector,n=this.camera,r=window.innerWidth/2,a=window.innerHeight/2,i=e.clone();return i.x=i.x/r-1,i.y=-i.y/a+1,t.unprojectVector(i,n),i},tween:function(){var e=this,t=e.target,n=e.values;e.rotate&&(e.rotationAngle+=2e-4);var r=1/15;n.target.x+=(t.x-n.target.x)*r,n.target.y+=(t.y-n.target.y)*r,n.target.z+=(t.z-n.target.z)*r,n.distance+=(e.distance-n.distance)*r,n.rotationAngle+=(e.rotationAngle-n.rotationAngle)*r,n.dragAngle+=(e.dragAngle-n.dragAngle)*r,n.zoom+=(e.zoom-n.zoom)*r,n.pow+=(e.pow-n.pow)*r},update:function(){this.tween(),this.set(this.camera,this.values.target)}},e}();window.Orbiter=e}(),function(){"use strict";if(Detector.webgl){var e,t,n,i=document.querySelector(".editor"),r=i.offsetWidth,a=i.offsetHeight,o={down:!1,moved:0},s=new THREE.Raycaster,l=new Forge,c=((e=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setClearColor(1052688),e.setPixelRatio(window.devicePixelRatio),e.setSize(r,a),i.appendChild(e.domElement),e),p=new Library(c),u=new THREE.PerspectiveCamera(45,r/a,1,5e4),d=new THREE.Scene,h=function(e){var t=new THREE.Group;t.name="pivot",t.rotation.y=Math.PI/180*90;var n=new THREE.AmbientLight(4473924);e.add(n);var r=new THREE.DirectionalLight(15654365,1,2e3);r.name="light1",r.position.set(-30,20,10),t.add(r);var a=new THREE.DirectionalLight(14540270,1,2e3);return a.name="light2",a.position.set(30,20,-10),t.add(a),e.add(t),t}(d),E=(t=d,(n=new THREE.Mesh(new THREE.PlaneBufferGeometry(500,500),p.materials.floor)).name="floor",n.rotation.x=-Math.PI/2,n.position.y=-3.5,n.visible=!0,t.add(n),n),m=new Combiner(d),g=new Orbiter(d,u),f=new Effects(d,u,c,r,a);i.addEventListener("mousedown",function(e){H(e),window.addEventListener("mousemove",x),window.addEventListener("mouseup",S)}),i.addEventListener("touchstart",function(e){H(e),window.addEventListener("touchmove",x),window.addEventListener("touchend",S),e.stopPropagation(),e.preventDefault()}),i.addEventListener("mousewheel",function(e){e=window.event||e;var t=i.getBounds();if(Math.abs(e.pageX-t.center.x)<t.width/3){var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));g.distance+=n,g.distance=Math.min(g.distanceMax,Math.max(g.distanceMin,g.distance)),g.update(),e.preventDefault()}}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 38:case 40:break;case 37:(t=m.prev())?f&&f.select(t.item.model):f&&f.unselect(),g.fit(m);break;case 39:var t;(t=m.next())?f&&f.select(t.item.model):f&&f.unselect(),g.fit(m)}}),window.addEventListener("resize",function(){r=i.offsetWidth,a=i.offsetHeight,u.aspect=r/a,u.updateProjectionMatrix(),g.fit(m),c.setSize(r,a),f&&f.resize(r,a)},!1);var v=document.querySelector(".btn-add"),w=document.querySelector(".btn-remove"),T=document.querySelector(".btn-flip"),R=document.querySelector(".btn-finish"),M=document.querySelector(".btn-floor");v.addEventListener("click",y),w.addEventListener("click",function(){m.busy()||(m.remove(),g.fit(m))}),T.addEventListener("click",function(){m.flip(function(){g.fit(m)})}),R.addEventListener("click",function(){m.selectedModel(function(e){e.material=p.setFinish(e.material,null)})}),M.addEventListener("click",function(){p.setNextFloor()}),b(),setTimeout(y,1e3)}else Detector.addGetWebGLMessage();function b(){!function(){m.update();var e=m.center.y-m.size.y/2-3;E.position.y+=(e-E.position.y)/8,h.position.x+=(m.center.x-h.position.x)/8,h.position.y+=(m.center.y-h.position.y)/8,h.position.z+=(m.center.z-h.position.z)/8,g.update(),f.update()}(),!0===o.snapshot&&(o.snapshot=!1),o.requestId=window.requestAnimationFrame(b,c.domElement)}function y(){m.busy()||l.load(function(e,t){f&&f.unselect(),t=p.updateMaterials(t,null,null);var n=m.add(e,t);g.fit(m),m.entering++,n.enter(function(){m.entering--})})}function H(e){var t=getTouch(e);t.relativeTo(i),t.mx=t.x,t.startDragAngle=g.dragAngle,t.startDistance=g.distance,s.setFromCamera(t,u);var n=m.select(s);n?(t.index=n.index,t.item=n.item,t.rotation=n.rotation,f&&f.select(t.item.model)):f&&f.unselect(),g.fit(m),o.down=t}function x(e){o.moved++;var t=1;"touchmove"===e.type&&(e.stopPropagation(),e.preventDefault(),t*=4);var n=o.down;if(n){var r=getTouch(e);r.relativeTo(i);var a=r.sub(n);2==r.count&&2==n.count?g.distance=n.startDistance+(n.pinchSize()-r.pinchSize())*t*10:m.selection&&m.selection.item===n.item?m.rotate(a.y*t*10):(g.dragAngle=n.startDragAngle+a.x*t*10,g.distance=n.startDistance+a.y*t*-10),g.distance=Math.min(g.distanceMax,Math.max(g.distanceMin,g.distance))}}function S(e){var t=o.down,n=o.moved;t&&n<5&&(t.item||m.selectedItem),o.down=null,o.moved=0,window.removeEventListener("touchmove mousemove",x),window.removeEventListener("touchend mouseup",S)}}();
//# sourceMappingURL=app.min.js.map
