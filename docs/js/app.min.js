!function(){"use strict";if(Detector.webgl){var t,a=Math.PI/180,l=0,c=[],u=[],e=(t=new THREE.JSONLoader,{load:function(o){!function(e){var n={method:"GET",responseType:"text"};if(e&&e.url&&e.onload){for(var o in e)n[o]=e[o];var t=new XMLHttpRequest;t.open(n.method,n.url,!0),t.responseType=n.responseType,t.onload=function(){200===this.status&&n.onload(this.response)},n.onerror&&(t.onerror=n.onerror),n.onprogress&&(t.onerror=n.onprogress),t.send()}}({url:"img/Body 1.js",onload:function(e){e=e.replace(new RegExp("transparency","g"),"opacity");var n=t.parse(JSON.parse(e));o(n.geometry,n.materials)}})}}),n=document.querySelector(".editor"),o=document.querySelector(".btn-add"),r=document.querySelector(".btn-remove"),d=new THREE.WebGLRenderer({alpha:!0});d.setSize(window.innerWidth,window.innerHeight),n.appendChild(d.domElement);var E=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,5e4);E.position.set(0,20,40),E.lookAt(0,0,0);var s=new THREE.OrbitControls(E),w=new THREE.Scene,p=new THREE.GridHelper(30,30,8947848,11184810),f=new THREE.Group,i=new THREE.PointLight(14540270,1,2e3);i.position.set(0,200,0),w.add(i);var H,m,T=new THREE.PointLightHelper(i,10);w.add(T),w.add(p),w.add(f),e.load(h),e.load(h),e.load(h),function e(){requestAnimationFrame(e);d.render(w,E);t=new THREE.Quaternion,r=new THREE.Vector3,i=new THREE.Vector3,c.length&&(f.getWorldPosition(i),c.filter(function(e,n){if(e.inner.position.x+=(1-e.inner.position.x)/5,0<n){var o=(new THREE.Quaternion).multiplyQuaternions(t,e.left.q);e.position.copy(r.sub(i)),e.setRotationFromQuaternion(o)}e.right.getWorldQuaternion(t),e.right.getWorldPosition(r)}));var t,r,i;0===l&&function(e){var n=x();n.setFromObject(e);var o=new THREE.Vector3,t=new THREE.Vector3;n.getCenter(o),n.getSize(t),function(e){if(!m){var n=new THREE.BoxGeometry(.3,.3,.3),o=new THREE.MeshBasicMaterial({color:16711680});m=new THREE.Mesh(n,o),w.add(m)}m.position.copy(e)}(o),e.worldToLocal(o),e.position.x=-o.x,e.position.y=-o.y,e.position.z=-o.z,p.position.y=-t.y/2}(f)}();var R,v=new THREE.Raycaster;d.domElement.addEventListener("mousedown",function(e){R=b(e),v.setFromCamera(R,E);var n=v.intersectObjects(u);if(n.length){s.enabled=!1;var o=u.indexOf(n[0].object);R.index=o,R.rotation=c[o].inner.rotation.clone()}else R=null}),d.domElement.addEventListener("mousemove",function(e){if(R){var n=b(e).sub(R),o=R.index;c[o].inner.rotation.x=R.rotation.x+n.y*Math.PI}}),d.domElement.addEventListener("dblclick",function(e){var n=b(e);v.setFromCamera(n,E);var o=v.intersectObjects(u);if(o.length){var t=u.indexOf(o[0].object);c[t].flip()}}),window.addEventListener("mouseup",function(e){R=null,s.enabled=!0}),window.addEventListener("resize",function(){E.aspect=window.innerWidth/window.innerHeight,E.updateProjectionMatrix(),d.setSize(window.innerWidth,window.innerHeight)},!1),o.addEventListener("click",function(){e.load(h)}),r.addEventListener("click",function(){!function(){if(1<c.length){var e=c.pop();e.parent&&f.remove(e),u=c.map(function(e){return e.model}),y(f)}}()})}else Detector.addGetWebGLMessage();function h(e,n){c.length;var o=new THREE.Group,t=new THREE.Group;e=new THREE.BoxGeometry(10,4,4);var r=new THREE.MeshStandardMaterial({color:8947848,wireframe:!1}),i=new THREE.Mesh(e,r),a=(new THREE.Box3).setFromObject(i),d=new THREE.Vector3;a.getSize(d),console.log(d.x),i.position.set(d.x/2,0,0);var E=g(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-L(180)),65280,d),s=g(new THREE.Vector3(d.x,0,0),new THREE.Vector3(0,0,-L(10)+L(20)*Math.random()),16711680,d);return t.position.x=d.x/2,t.add(i),t.add(E),t.add(s),o.inner=t,o.model=i,o.left=E,o.right=s,o.add(t),o.flip=function(){l++,console.log("flip()"),o.flipped=!o.flipped,TweenLite.to(i.rotation,.3,{y:o.flipped?Math.PI:0,ease:Power2.easeOut,onComplete:function(){console.log("flipped"),l--}})},c.push(o),u=c.map(function(e){return e.model}),f.add(o),y(f),o}function g(e,n,o,t){var r=t.x/10,i=new THREE.Group;i.position.copy(e);var a=new THREE.ArrowHelper(new THREE.Vector3(1,0,0),new THREE.Vector3,r,o,r/2,r/2);i.rotation.x=n.x,i.rotation.y=n.y,i.rotation.z=n.z;var d=new THREE.Quaternion;return d.setFromAxisAngle(new THREE.Vector3(0,0,1),L(180)),i.q=(new THREE.Quaternion).multiplyQuaternions(d,i.quaternion),i.arrow=a,i.add(a),i}function x(){if(H)return H;H=new THREE.Box3;var e=new THREE.Box3Helper(H,16711680);return w.add(e),H}function y(e){var n=x();n.setFromObject(e);var o=new THREE.Vector3;n.getSize(o);var t=Math.max(o.x,o.y,o.z),r=E.fov*a,i=t/2/Math.tan(r/2)*1.5;E.position.normalize().multiplyScalar(i),s.update()}function b(e){return new THREE.Vector2(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)}function L(e){return e*a}}();
//# sourceMappingURL=app.min.js.map
