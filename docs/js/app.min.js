!function(){"use strict";Element.prototype.hasClass=function(e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(this.className)},Element.prototype.addClass=function(e){this.hasClass(e)||(this.className=this.className?this.className+" "+e:e)},Element.prototype.removeClass=function(e){this.hasClass(e)&&(this.className=this.className.split(e).join("").replace(/\s\s+/g," "))},Element.prototype.isDescendant=function(e){return function e(t,n){return t===n||!!t.parentNode&&e(t.parentNode,n)}(this,e)},Element.prototype.getBounds=function(){var e={x:0,y:0,width:this.offsetWidth,height:this.offsetHeight,center:{x:0,y:0}};return e.center.x=e.width/2,e.center.y=e.height/2,e},window.getTouch=function(e){var t=new THREE.Vector2;if(t.t=new THREE.Vector2,t.relativeTo=function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;this.x=(this.x-t.left-n)/e.offsetWidth*2-1,this.y=-(this.y-t.top-o)/e.offsetHeight*2+1},t.pinchSize=function(){return Math.sqrt((this.x-this.t.x)*(this.x-this.t.x)+(this.y-this.t.y)*(this.y-this.t.y))},t.count=1,"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var n=null,o=null,i=e.originalEvent?e.originalEvent.touches||e.originalEvent.changedTouches:e.touches||e.changedTouches;i&&i.length&&(n=i[0],1<i.length&&(o=i[1])),n&&(t.x=n.pageX,t.y=n.pageY),o&&(t.t.x=o.pageX,t.t.y=o.pageY,t.count=2)}else"click"!=e.type&&"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(t.x=e.pageX,t.y=e.pageY);return t}}(),function(){"use strict";var e=function(){function e(){this.loader=new THREE.JSONLoader}e.prototype={load:function(n){var o=this;(function(e){var t={method:"GET",responseType:"text"};if(!e||!e.url||!e.onload)return;for(var n in e)t[n]=e[n];var o=new XMLHttpRequest;o.open(t.method,t.url,!0),o.responseType=t.responseType,o.onload=function(){200===this.status&&t.onload(this.response)},t.onerror&&(o.onerror=t.onerror);t.onprogress&&(o.onerror=t.onprogress);o.send()})({url:t%2==0?"img/Body 1.js":"img/Angled Emitter 1.js",onload:function(e){e=e.replace(new RegExp("transparency","g"),"opacity");var t=o.loader.parse(JSON.parse(e));n(t.geometry,t.materials)}}),t++}};var t=0;return e}();window.Forge=e}(),function(){"use strict";var u=!1,p=Math.PI/180,w=.025,v=0;var x=new THREE.Quaternion;x.setFromAxisAngle(new THREE.Vector3(0,0,1),Math.PI);var a=function(){function e(e,t){var n=this;n.size=new THREE.Vector3,n.box=new THREE.Box3,n.group=new THREE.Group,n.inner=new THREE.Group,n.init(e,t)}return e.prototype={enter:function(){var e=this;e.inner.position.x=e.size.x*w,TweenLite.to(e.inner.position,.6,{x:0,ease:Power2.easeOut,overwrite:"all"})},init:function(e,t){var n=this,o=n.box,i=n.size,r=n.group,a=n.inner,s=new THREE.Mesh(e,t);o.setFromObject(s),o.getSize(i);var c,u=n.getJoints(e,t,i);t[1].color=new THREE.Color(0),s.geometry.uvsNeedUpdate=!0,s.geometry.normalsNeedUpdate=!0,s.geometry.verticesNeedUpdate=!0,s.geometry.computeFaceNormals(),s.geometry.computeVertexNormals(),s.geometry.computeBoundingBox(),e=new THREE.BoxGeometry(i.x,i.y,i.z),c=new THREE.MeshStandardMaterial({color:new THREE.Color(.2*++v,0,0),wireframe:!1,transparent:!0,opacity:.1}),s=new THREE.Mesh(e,c);for(var p in s.position.set(i.x/2,0,0),u){var l=u[p],d=l.normal.x,h=l.normal.y,m=-l.normal.z,E=new THREE.Euler(0,Math.atan2(m,d),Math.atan2(h,Math.sqrt(d*d+m*m)));l.rotation.copy(E),s.add(l),l.oquaternion=(new THREE.Quaternion).multiplyQuaternions(l.quaternion,x);var f=i.x/10,g=new THREE.ArrowHelper(new THREE.Vector3(1,0,0),new THREE.Vector3,f,l.c,f/2,f/2);l.arrow=g,l.add(g)}a.scale.set(w,w,w),a.add(s),r.add(a),n.model=s,n.joints=u},flip:function(e){var t=this.model;this.flipped=!this.flipped,TweenLite.to(t.rotation,.3,{y:this.flipped?Math.PI:0,ease:Power2.easeOut,overwrite:"all",onComplete:function(){"function"==typeof e&&e()}})},getJoints:function(e,t,n){var o,i,r={},a={},s=["left","right","top","bottom"],c=[16711680,65280,255,16776960];t.map(function(e,t){var n=s.indexOf(e.name);if(-1!==n){var o=new THREE.Group;o.name=s[n],o.vertices=[],o.c=c[n],r[e.name]=o,a[t]=o}});for(var u=0;u<e.faces.length;u++)i=e.faces[u],(o=a[String(i.materialIndex)])&&(o.normal=o.normal||i.normal,o.vertices.push(e.vertices[i.a]),o.vertices.push(e.vertices[i.b]),o.vertices.push(e.vertices[i.c]));for(var p in r)(o=r[p]).position.copy((l=o.vertices,void 0,d=l.reduce(function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}),(new THREE.Vector3).add(d).divideScalar(l.length))),o.vertices=null;var l,d;r.left||(r.left=new THREE.Group,r.left.position.set(-n.x/2,0,0),r.left.normal=new THREE.Vector3(-1,0,0),r.left.c=c[0]);r.right||(r.right=new THREE.Group,r.right.position.set(n.x/2,0,0),r.right.normal=new THREE.Vector3(1,0,0),r.right.c=c[1]);return r},getJoint:function(e,t,n){var o=this.size,i=new THREE.Group;i.position.copy(e),i.rotation.x=t.x,i.rotation.y=t.y,i.rotation.z=t.z;var r=new THREE.Quaternion;if(r.setFromAxisAngle(new THREE.Vector3(0,0,1),(c=180,c*p)),i.oppositeQuaternion=(new THREE.Quaternion).multiplyQuaternions(r,i.quaternion),u){var a=o.x/10,s=new THREE.ArrowHelper(new THREE.Vector3(1,0,0),new THREE.Vector3,a,n,a/2,a/2);i.arrow=s,i.add(s)}var c;return i}},e}(),e=function(){function e(e){var t=this;t.scene=e,t.flipping=0,t.items=[],t.hittables=[],t.center=new THREE.Vector3,t.size=new THREE.Vector3,t.group=new THREE.Group,t.box=new THREE.Box3,t.boxhelper=new THREE.Box3Helper(t.box,16711680),t.centerhelper=new THREE.Mesh(new THREE.BoxGeometry(.3,.3,.3),new THREE.MeshBasicMaterial({color:16711680})),u&&(t.scene.add(t.boxhelper),t.scene.add(t.centerhelper))}return e.prototype={add:function(e,t){var n=this,o=(n.box,n.size,n.items),i=(n.hittables,n.group);n.unselect();var r=new a(e,t);return o.push(r),n.hittables=o.map(function(e){return e.model}),i.add(r.group),n.adjust(),r},adjust:function(){var e=this.group;this.combine(),this.fit(e)},combine:function(){var n,o,e=this.items,t=this.group,i=new THREE.Quaternion,r=(new THREE.Quaternion,new THREE.Vector3),a=new THREE.Vector3;e.length&&(t.getWorldPosition(a),e.filter(function(e,t){e.flipped?(n=e.joints.right.quaternion,o=e.joints.left):(n=e.joints.left.oquaternion,o=e.joints.right);0<t&&(e.group.position.copy(r.sub(a)),e.group.setRotationFromQuaternion(i.multiply(n)),e.group.updateMatrixWorld());o.getWorldQuaternion(i),o.getWorldPosition(r)}))},fit:function(){var e=this,t=e.box,n=e.size,o=e.center,i=e.centerhelper,r=e.group;return t.setFromObject(r),t.getCenter(o),t.getSize(n),i.position.copy(o),n},flip:function(e){var t=this;t.items,t.hittables;t.selection&&t.flipItem(t.selection.item,e)},flipItem:function(e,t){var n=this;n.flipping++,e.flip(function(){n.flipping--,n.adjust(),"function"==typeof t&&setTimeout(function(){t()},100)})},hitAndFlip:function(e,t){var n=this.items,o=this.hittables,i=e.intersectObjects(o);if(i.length){var r=o.indexOf(i[0].object),a=n[r];this.flipItem(a,t)}},pop:function(){var e=this,t=e.items,n=(e.hittables,e.group);if(t.length){var o=t.pop();return o.group.parent&&n.remove(o.group),e.hittables=t.map(function(e){return e.model}),e.adjust(),o}},remove:function(){var e=this,t=e.items,n=(e.hittables,e.group);{if(e.selection){var o=e.selection,i=o.item;return t.splice(o.index,1),i.group.parent&&n.remove(i.group),e.hittables=t.map(function(e){return e.model}),e.unselect(),e.adjust(),t.length>o.index&&t[o.index].enter(),i}return e.pop()}},select:function(e){var t=this.items,n=this.hittables;this.unselect();var o=e.intersectObjects(n),i=null;if(o.length){var r=n.indexOf(o[0].object),a=t[r],s=a.inner.rotation.clone();a.model.material.emissive=new THREE.Color(8947848),i={index:r,item:a,rotation:s},this.selection=i}return i},unselect:function(){this.selection&&(this.selection.item.model.material.emissive=new THREE.Color(0),this.selection=null)},update:function(){var e=this.group;0===this.flipping&&this.fit(e)}},e}();window.Combiner=e}(),function(){"use strict";var i=!0,v=Math.PI/180;var e=function(){function e(e,t,n){var o=this;o.scene=e,o.camera=t,o.dummy=t.clone(),o.controls=n,o.projector=new THREE.Projector,o.position=new THREE.Vector3,o.target=new THREE.Vector3,o.center=new THREE.Vector3,o.size=new THREE.Vector3,o.box=new THREE.Box3,o.boxhelper=new THREE.Box3Helper(o.box,16711680),o.rotate=!1,o.target=new THREE.Vector3(0,0,0),o.distance=22,o.angle=0,o.endTarget=new THREE.Vector3(0,0,0),o.position=new THREE.Vector3(0,0,0),o.distanceMin=10,o.distanceMax=34,o.rotationAngle=1,o.dragAngle=0,o.zoom=1,o.pow=0,i&&o.scene.add(o.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var o=this,i=(o.projector,o.box),r=o.size,a=o.center,s=o.camera,c=o.controls,u=o.dummy,p=e.selection?e.selection.item.group:e.group;i.setFromObject(p),i.getCenter(a),u.position.copy(s.position),u.quaternion.copy(s.quaternion),u.up=n,u.lookAt(a),u.updateProjectionMatrix();o.toScreen(i.min),o.toScreen(i.max),o.toScreen(a);i.applyMatrix4(u.matrixWorldInverse),i.getSize(r);var l=r.x/r.y,d=s.aspect>l?r.y:r.x;s.aspect<l&&(d/=s.aspect);var h=(d*=t)/2/Math.sin(s.fov/2*v);u.position.normalize().multiplyScalar(h),o.distance=u.position.distanceTo(a),u.updateProjectionMatrix();var m=s.position.clone(),E=u.position,f=s.quaternion.clone(),g=u.quaternion,w={pow:0};TweenLite.to(w,.6,{pow:1,ease:Power2.easeOut,overwrite:"all",onUpdate:function(){s.position.lerpVectors(m,E,w.pow),THREE.Quaternion.slerp(f,g,s.quaternion,w.pow),s.updateProjectionMatrix()},onComplete:function(){c&&(c.target.copy(a),c.update())}})},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,o=window.innerHeight/2,i=e.clone();return i.project(t),i.x=(i.x+1)*n,i.y=(1-i.y)*o,i},toWorld:function(e){var t=this.projector,n=this.camera,o=window.innerWidth/2,i=window.innerHeight/2,r=e.clone();return r.x=r.x/o-1,r.y=-r.y/i+1,t.unprojectVector(r,n),r},update:function(){var e=this,t=e.target,n=e.endTarget,o=e.position,i=e.distance,r=e.zoom,a=e.dragAngle,s=e.rotationAngle,c=(e.pow,e.camera);e.rotate&&(s=e.rotationAngle+=2e-4);t.x+=(n.x-t.x)/40,t.y+=(n.y-t.y)/40,t.z+=(n.z-t.z)/40,o.x=t.x+i*r*Math.cos(a+s),o.y=t.y+i*r,o.z=t.z+i*r*Math.sin(a+s),c.position.x+=(o.x-c.position.x)/13,c.position.y+=(o.y-c.position.y)/13,c.position.z+=(o.z-c.position.z)/13,c.lookAt(t)}},e}();window.Fitter=e}(),function(){"use strict";var i=!1,h=Math.PI/180,m=11;var e=function(){function e(e,t,n){var o=this;o.scene=e,o.camera=t,o.dummy=t.clone(),o.controls=n,o.projector=new THREE.Projector,o.center=new THREE.Vector3,o.size=new THREE.Vector3,o.box=new THREE.Box3,o.boxhelper=new THREE.Box3Helper(o.box,16711680),o.rotate=!0,o.target=new THREE.Vector3(0,0,0),o.distance=2*m,o.rotationAngle=1,o.dragAngle=0,o.zoom=1,o.pow=0,o.values={target:new THREE.Vector3(0,0,0),distance:2*m,rotationAngle:0,dragAngle:0,zoom:0,pow:0},o.distanceMin=m,o.distanceMax=3*m,o.set(o.camera,o.target),i&&o.scene.add(o.boxhelper)}return e.prototype={fit:function(e,t,n){t||(t=1.3);n||(n=new THREE.Vector3(0,1,0));var o=this,i=(o.projector,o.box),r=o.size,a=o.center,s=o.camera,c=(o.controls,o.dummy),u=e.selection?e.selection.item.group:e.group;if(i.setFromObject(u),i.getCenter(a),i.getSize(r),0<e.items.length){o.set(c,a),c.fov=s.fov,c.aspect=s.aspect,r.applyMatrix4(c.matrixWorldInverse);var p=r.x/r.y,l=s.aspect>p?r.y:r.x;s.aspect<p&&(l/=s.aspect);var d=(l*=t)/2/Math.sin(s.fov/2*h);o.distance=d}else o.distance=m;o.distanceMin=.5*o.distance,o.distanceMax=1.5*o.distance,o.target.copy(a)},set:function(e,t){var n=this.values;e.position.x=t.x+n.distance*n.zoom*Math.cos(n.dragAngle+n.rotationAngle),e.position.y=t.y+n.distance*n.zoom,e.position.z=t.z+n.distance*n.zoom*Math.sin(n.dragAngle+n.rotationAngle),e.lookAt(t)},toScreen:function(e){var t=this.camera,n=window.innerWidth/2,o=window.innerHeight/2,i=e.clone();return i.project(t),i.x=(i.x+1)*n,i.y=(1-i.y)*o,i},toWorld:function(e){var t=this.projector,n=this.camera,o=window.innerWidth/2,i=window.innerHeight/2,r=e.clone();return r.x=r.x/o-1,r.y=-r.y/i+1,t.unprojectVector(r,n),r},tween:function(){var e=this,t=e.target,n=e.values;e.rotate&&(e.rotationAngle+=2e-4);var o=1/15;n.target.x+=(t.x-n.target.x)*o,n.target.y+=(t.y-n.target.y)*o,n.target.z+=(t.z-n.target.z)*o,n.distance+=(e.distance-n.distance)*o,n.rotationAngle+=(e.rotationAngle-n.rotationAngle)*o,n.dragAngle+=(e.dragAngle-n.dragAngle)*o,n.zoom+=(e.zoom-n.zoom)*o,n.pow+=(e.pow-n.pow)*o},update:function(){this.tween(),this.set(this.camera,this.values.target)}},e}();window.Orbiter=e}(),function(){"use strict";if(Detector.webgl){var e=new Forge,i=document.querySelector(".editor"),t=document.querySelector(".btn-add"),n=document.querySelector(".btn-remove"),o=document.querySelector(".btn-flip"),r=new THREE.WebGLRenderer({alpha:!0});r.setSize(window.innerWidth,window.innerHeight),i.appendChild(r.domElement);var a,s=new THREE.PerspectiveCamera(45,i.offsetWidth/i.offsetHeight,1,5e4),c=new THREE.Scene,u=new THREE.PointLight(14540270,1,2e3);u.position.set(0,200,0),c.add(u);var p=new THREE.PointLightHelper(u,10);c.add(p);var l=new THREE.GridHelper(500,500,8947848,11184810);c.add(l);var d=new Combiner(c);c.add(d.group);var h,m=new Orbiter(c,s,a),E=new THREE.Raycaster,f=0;i.addEventListener("mousedown",function(e){g(e),window.addEventListener("mousemove",w),window.addEventListener("mouseup",v)}),i.addEventListener("touchstart",function(e){g(e),window.addEventListener("touchmove",w),window.addEventListener("touchend",v),e.stopPropagation(),e.preventDefault()}),i.addEventListener("mousewheel",function(e){e=window.event||e;var t=i.getBounds();if(Math.abs(e.pageX-t.center.x)<t.width/3){var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));m.distance+=n,m.distance=Math.min(m.distanceMax,Math.max(m.distanceMin,m.distance)),m.update(),e.preventDefault()}}),window.addEventListener("resize",function(){s.aspect=i.offsetWidth/i.offsetHeight,s.updateProjectionMatrix(),m.fit(d),r.setSize(i.offsetWidth,i.offsetHeight)},!1),t.addEventListener("click",x),n.addEventListener("click",function(){d.remove(),m.fit(d)}),o.addEventListener("click",function(){d.flip(function(){m.fit(d)})}),function e(){requestAnimationFrame(e),r.render(c,s),d.update(),l.position.y=-d.size.y/2,l.position.x=d.center.x,l.position.z=d.center.z,m.update()}(),x()}else Detector.addGetWebGLMessage();function g(e){(h=getTouch(e)).relativeTo(i),h.mx=h.x,h.startDragAngle=m.dragAngle,h.startDistance=m.distance,E.setFromCamera(h,s);var t=d.select(E);t&&(a&&(a.enabled=!1),h.index=t.index,h.item=t.item,h.rotation=t.rotation),m.fit(d)}function w(e){f++;var t=1;if("touchmove"===e.type&&(e.stopPropagation(),e.preventDefault(),t*=4),h){var n=getTouch(e);n.relativeTo(i);var o=n.sub(h);if(2==n.count&&2==h.count)m.distance=h.startDistance+(h.pinchSize()-n.pinchSize())*t*10;else if(d.selection&&d.selection.item===h.item){h.index;h.item.inner.rotation.x=h.rotation.x+o.y*t*10,d.adjust()}else m.dragAngle=h.startDragAngle+o.x*t*10,m.distance=h.startDistance+o.y*t*-10;m.distance=Math.min(m.distanceMax,Math.max(m.distanceMin,m.distance))}}function v(e){h&&f<5&&(h.item||d.selectedItem),h=null,f=0,a&&(a.enabled=!0),window.removeEventListener("touchmove mousemove",w),window.removeEventListener("touchend mouseup",v)}function x(){e.load(function(e,t){var n=d.add(e,t);m.fit(d),n.enter()})}}();
//# sourceMappingURL=app.min.js.map
